cscope 15 W:\asteroids_game\src\tools"               0000573795
	@asset_packer/buffers.cpp

1 
	sSŒuùBufãr
 {

2 * 
	md©a
;

3 
u32
 
	m–em_size
;

4 
u32
 
	mtÙ®_couÁ
;

5 
u32
 
	mfËd_couÁ
;

8 
u32
 
	$G‘FËdSizeSŒuùBufãr
(
SŒuùBufãr
* 
sb
) {

9  
sb
->
fËd_couÁ
*sb->
–em_size
;

10 
	}
}

12 * 
	$G‘EËm’tSŒuùBufãr
(
SŒuùBufãr
* 
sb
, 
u32
 
šdex
) {

13 
	`as£¹
(
šdex
 < 
sb
->
fËd_couÁ
);

14  (
u8
*)
sb
->
d©a
 + sb->
–em_size
*
šdex
;

15 
	}
}

17 
u32
 
	$G‘Off£tSŒuùBufãr
(
SŒuùBufãr
* 
sb
) {

18  
sb
->
–em_size
*sb->
fËd_couÁ
;

19 
	}
}

21 * 
	$G‘CursÜSŒuùBufãr
(
SŒuùBufãr
* 
sb
) {

22  (
u8
*)
sb
->
d©a
 + sb->
–em_size
*sb->
fËd_couÁ
;

23 
	}
}

25 
SŒuùBufãr
 
	$MakeSŒuùBufãr
(
u32
 
–em_size
) {

26 
SŒuùBufãr
 
»suÉ
 = {};

27 
»suÉ
.
d©a
 = 
	`ÿÎoc
(1, 
–em_size
);

28 
»suÉ
.
–em_size
 =ƒlem_size;

29 
»suÉ
.
tÙ®_couÁ
 = 1;

30 
»suÉ
.
fËd_couÁ
 = 0;

31  
»suÉ
;

32 
	}
}

34 
	$Re£rveMemÜySŒuùBufãr
(
u32
 
couÁ
, 
SŒuùBufãr
* 
sb
) {

35 if(
sb
->
fËd_couÁ
+
couÁ
 >ğsb->
tÙ®_couÁ
) {

36 
u32
 
Ãw_couÁ
 = 2 * 
sb
->
tÙ®_couÁ
 + 
couÁ
;

37 
u32
 
Ãw_size
 = 
sb
->
–em_size
 * 
Ãw_couÁ
;

38 
sb
->
d©a
 = (*)
	`»®loc
(sb->d©a, 
Ãw_size
);

39 
sb
->
tÙ®_couÁ
 = 
Ãw_couÁ
;

40 
	`as£¹
(
sb
->
d©a
);

42 
	}
}

45 
u32
 
	$PushSŒuùBufãr
(* 
–em’t
, 
u32
 
couÁ
, 
SŒuùBufãr
* 
sb
) {

46 
u32
 
off£t
 = 
	`G‘Off£tSŒuùBufãr
(
sb
);

47 
	`Re£rveMemÜySŒuùBufãr
(
couÁ
, 
sb
);

48 * 
±r
 = (
u8
*)
sb
->
d©a
 + sb->
–em_size
*sb->
fËd_couÁ
;

49 
	`memıy
(
±r
, 
–em’t
, 
sb
->
–em_size
*
couÁ
);

50 
sb
->
fËd_couÁ
 +ğ
couÁ
;

51  
off£t
;

52 
	}
}

54 
	sG’”icBufãr
 {

55 * 
	md©a
;

56 
u32
 
	mtÙ®_size
;

57 
u32
 
	mfËd_size
;

60 * 
	$G‘CursÜG’”icBufãr
(
G’”icBufãr
* 
gb
) {

61  (
u8
*)
gb
->
d©a
 + gb->
fËd_size
;

62 
	}
}

64 
u32
 
	$PushG’”icBufãr
(* 
d©a
, 
u32
 
size
, 
G’”icBufãr
* 
gb
) {

65 
	`as£¹
(
gb
->
tÙ®_size
 - gb->
fËd_size
 >ğ
size
);

66 
	`memıy
(
	`G‘CursÜG’”icBufãr
(
gb
), 
d©a
, 
size
);

67 
gb
->
fËd_size
 +ğ
size
;

68 
	}
}

70 
	$Wr™eSŒuùBufãrToG’”icBufãr
(
G’”icBufãr
* 
gb
, 
SŒuùBufãr
* 
sb
) {

71 * 
gb_±r
 = 
	`G‘CursÜG’”icBufãr
(
gb
);

72 * 
sb_±r
 = 
sb
->
d©a
;

74 
u32
 
size
 = 
sb
->
–em_size
 * sb->
fËd_couÁ
;

75 
	`memıy
(
gb_±r
, 
sb_±r
, 
size
);

76 
gb
->
fËd_size
 +ğ
size
;

77 
	}
}

79 
	$Wr™eSŒuùBufãrEËm’tToG’”icBufãr
(
G’”icBufãr
* 
gb
, 
SŒuùBufãr
* 
sb
, 
u32
 
šdex
) {

80 * 
gb_±r
 = 
	`G‘CursÜG’”icBufãr
(
gb
);

81 * 
sb_±r
 = (
u8
*)
sb
->
d©a
 + sb->
–em_size
*
šdex
;

83 
	`memıy
(
gb_±r
, 
sb_±r
, 
sb
->
–em_size
);

84 
gb
->
fËd_size
 +ğ
sb
->
–em_size
;

85 
	}
}

	@asset_packer/main.cpp

1 
	~<¡dšt.h
>

2 
	~<¡ršg.h
>

4 
	#WIN32_LEAN_AND_MEAN


	)

5 
	~<wšdows.h
>

7 
	#CGLTF_IMPLEMENTATION


	)

8 
	~"../šşude/cgÉf.h
"

9 
	#STB_IMAGE_IMPLEMENTATION


	)

10 
	~"../šşude/¡b_image.h
"

12 
ušt8_t
 
	tu8
;

13 
ušt16_t
 
	tu16
;

14 
ušt32_t
 
	tu32
;

15 
ušt64_t
 
	tu64
;

17 
	~<šŒš.h
>

18 
	#As£¹
(
cÚd
èdØ{ ià(!(cÚd)è
	`__debugb»ak
(); } 0)

	)

20 
	~"bufãrs.ıp
"

21 
	~"../../game/as£t_fÜm©s.h
"

22 
	~"../../game/fe_fÜm©s.h
"

24 
	eASSET_TYPE
 {

25 
	mASSET_TYPE_MODEL
,

26 
	mASSET_TYPE_TEXTURE
,

27 
	mASSET_TYPE_FONT
,

28 
	mASSET_TYPE_TOTAL


31 * 
	gas£t_·th_dœ
[
ASSET_TYPE_TOTAL
] = {

37 * 
	gas£t_fe_fÜm©
[
ASSET_TYPE_TOTAL
] = {

43 
	eFORMAT
 {

44 
	mFORMAT_GAME_ASSET_FILE
,

45 
	mFORMAT_DIRECTORY
,

47 
	mFORMAT_MESHES_BLOB
,

48 
	mFORMAT_TEXTURES_BLOB
,

49 
	mFORMAT_FONTS_BLOB
,

51 
	mFORMAT_MESH
,

53 
	mFORMAT_VERTEX_BUFFER
,

54 
	mFORMAT_VERTEX_BUFFER_FLOAT
,

55 
	mFORMAT_INDEX_BUFFER_U32
,

57 
	mFORMAT_TEXTURE
,

58 
	mFORMAT_PIXELS
,

60 
	mFORMAT_FONT
,

61 
	mFORMAT_TTF
,

63 
	mFORMAT_TOTAL


66 
u32
 
	gfÜm©_–em_sizes
[
FORMAT_TOTAL
] {

67 (
	gGameAs£tFe
),

68 (
	gDœeùÜy
),

70 (
	gMeshesBlob
),

71 (
	gTextu»sBlob
),

72 (
	gFÚtsBlob
),

74 (
	gMeshFÜm©
),

76 (
	gV”‹xBufãrFÜm©
),

78 (
	gu32
),

80 (
	gTextu»FÜm©
),

81 (
	gu8
),

83 (
	gFÚtFÜm©
),

84 (
	gu8
)

87 * 
	$SŒP»³nd
(* 
¡ršg
, * 
´•’d
) {

88 
u8
 
¡ršg_Ën
 = 
	`¡¾’
(
¡ršg
);

89 
u8
 
´•’d_Ën
 = 
	`¡¾’
(
´•’d
);

90 * 
»suÉ
 = (*)
	`ÿÎoc
(
¡ršg_Ën
+
´•’d_Ën
+1, ());

91 
	`¡rÿt
(
»suÉ
, 
´•’d
);

92 
	`¡rÿt
(
»suÉ
+
´•’d_Ën
, 
¡ršg
);

93  
»suÉ
;

94 
	}
}

96 
boŞ
 
	$SŒHasSŒEnd
(* 
Ëá
, * 
right
) {

97 
u8
 
Ëá_n
 = 
	`¡¾’
(
Ëá
);

98 
u8
 
right_n
 = 
	`¡¾’
(
right
);

100 if(
Ëá_n
 <ğ
right_n
è 
çl£
;

101 
u8
 
i
 = 
Ëá_n
-
right_n
;

102  
	`¡rcmp
(
Ëá
+
i
, 
right
) == 0;

103 
	}
}

105 * 
	$MakeFuÎP©h
(* 
dœ
, * 
Çme
, * 
fÜm©
) {

106 * 
»suÉ
 = 0;

108 
u8
 
dœ_n
 = 
	`¡¾’
(
dœ
);

109 
u8
 
Çme_n
 = 
	`¡¾’
(
Çme
);

110 
u8
 
fÜm©_n
 = 
	`¡¾’
(
fÜm©
);

112 
u8
 
·th_n
 = 
dœ_n
 + 
Çme_n
 + 
fÜm©_n
 + 1;

113 
»suÉ
 = (*)
	`ÿÎoc
(
·th_n
, ());

114 
	`¡rıy
(
»suÉ
, 
dœ
);

115 
	`¡rıy
(
»suÉ
+
dœ_n
, "/");

116 
	`¡rıy
(
»suÉ
+
dœ_n
+1, 
Çme
);

117 
	`¡rıy
(
»suÉ
+
dœ_n
+1+
Çme_n
, ".");

118 
	`¡rıy
(
»suÉ
+
dœ_n
+1+
Çme_n
+1, 
fÜm©
);

120  
»suÉ
;

121 
	}
}

123 
	sFeInfo
 {

124 * 
	mÇme
;

125 * 
	mfÜm©
;

126 
u64
 
	msize
;

129 
	sFŞd”Info
 {

130 * 
	mdœ
;

132 
FeInfo
* 
	mfes
;

133 
u32
 
	mfe_couÁ
;

136 
u32
 
	$FšdNumb”OfFesInDœ
(* 
fuÎ_fŞd”_dœ
, * 
dÙ_fe_fÜm©
) {

137 
u32
 
fe_couÁ
 = 0;

138 
HANDLE
 
h
;

139 
WIN32_FIND_DATA
 
fd
;

141 
h
 = 
	`FšdFœ¡Fe
(
fuÎ_fŞd”_dœ
, &
fd
);

142 
	`As£¹
(
h
 !ğ
INVALID_HANDLE_VALUE
);

145 if(
	`SŒHasSŒEnd
(
fd
.
cFeName
, 
dÙ_fe_fÜm©
)è
fe_couÁ
++;

146 } 
	`FšdNextFe
(
h
, &
fd
) != 0);

148  
fe_couÁ
;

149 
	}
};

151 
FŞd”Info
 
	$LßdFŞd”
(* 
dœ
, * 
fe_fÜm©
) {

152 
FŞd”Info
 
fŞd”_šfo
 = {};

154 * 
dÙ_fe_fÜm©
;

155 
	`As£¹
(
fe_fÜm©
[0] != '.');

156 
dÙ_fe_fÜm©
 = 
	`SŒP»³nd
(
fe_fÜm©
, ".");

158 * 
fuÎ_fŞd”_dœ
 = (*)
	`ÿÎoc
(
	`¡¾’
(
dœ
)+3, (
u8
));

159 
	`¡rıy
(
fuÎ_fŞd”_dœ
, 
dœ
);

160 
	`¡rÿt
(
fuÎ_fŞd”_dœ
, "\\*");

162 
u32
 
fe_couÁ
 = 
	`FšdNumb”OfFesInDœ
(
fuÎ_fŞd”_dœ
, 
dÙ_fe_fÜm©
);

164 
WIN32_FIND_DATA
 
fd
;

165 
HANDLE
 
h
;

167 
h
 = 
	`FšdFœ¡Fe
(
fuÎ_fŞd”_dœ
, &
fd
);

168 
	`As£¹
(
h
 !ğ
INVALID_HANDLE_VALUE
);

170 
FeInfo
* 
fe_šfo_a
 = (FeInfo*)
	`ÿÎoc
(
fe_couÁ
, (FileInfo));

171 
u32
 
fe_couÁ”
 = 0;

173 if(
	`SŒHasSŒEnd
(
fd
.
cFeName
, 
dÙ_fe_fÜm©
)) {

174 
FeInfo
* 
fi
 = 
fe_šfo_a
 + 
fe_couÁ”
++;

176 
ULARGE_INTEGER
 
ul
;

177 
ul
.
HighP¬t
 = 
fd
.
nFeSizeHigh
;

178 
ul
.
LowP¬t
 = 
fd
.
nFeSizeLow
;

179 
ULONGLONG
 
fe_size
 = 
ul
.
QuadP¬t
;

181 * 
±r
 = 
	`¡rchr
(
fd
.
cFeName
, '.');

182 
u8
 
Çme_Ën
 = 
±r
 - 
fd
.
cFeName
;

183 * 
fe_Çme
 = (*)
	`ÿÎoc
(
Çme_Ën
+1, ());

184 
	`¡ºıy
(
fe_Çme
, 
fd
.
cFeName
, 
Çme_Ën
);

186 
fi
->
Çme
 = 
fe_Çme
;

187 
fi
->
fÜm©
 = 
fe_fÜm©
;

188 
fi
->
size
 = (
u64
)
fe_size
;

190 } 
	`FšdNextFe
(
h
, &
fd
) != 0);

192 
fŞd”_šfo
.
dœ
 = dir;

193 
fŞd”_šfo
.
fes
 = 
fe_šfo_a
;

194 
fŞd”_šfo
.
fe_couÁ
 = file_count;

196  
fŞd”_šfo
;

197 
	}
};

200 
	$CİyFeToSŒuùBufãr
(* 
·th
, 
u64
 
size
, 
SŒuùBufãr
* 
bufãr
) {

201 
	`Re£rveMemÜySŒuùBufãr
(
size
, 
bufãr
);

203 
HANDLE
 
h
 = 
	`C»©eFeA
(
·th
, 
GENERIC_READ
, 
FILE_SHARE_READ
, 0, 
OPEN_EXISTING
, 0, 0);

204 
	`As£¹
(
h
 !ğ
INVALID_HANDLE_VALUE
);

205 
	`As£¹
(
	`R—dFe
(
h
, 
bufãr
->
d©a
, 
size
, 0, 0));

207 
bufãr
->
fËd_couÁ
 +ğ
size
;

208 
	}
}

210 
	$maš
(
¬gc
, ** 
¬gv
) {

212 
SŒuùBufãr
 
¡ruù_bufãr
[
FORMAT_TOTAL
] = {};

213 
u64
 
blob_off£ts
[
ASSET_BLOB_TOTAL
] = {};

214 
u8
 
i
=0; i<
FORMAT_TOTAL
; i++è
¡ruù_bufãr
[i] = 
	`MakeSŒuùBufãr
(
fÜm©_–em_sizes
[i]);

217 
SŒuùBufãr
* 
gaff_bufãr
 = &
¡ruù_bufãr
[
FORMAT_GAME_ASSET_FILE
];

218 
GameAs£tFe
 
gaff
 = {};

219 
	`¡rıy
(
gaff
.
id’tifiÿtiÚ
, "gaff");

220 
gaff
.
numb”_of_blobs
 = 
ASSET_BLOB_TOTAL
;

221 
	`PushSŒuùBufãr
(&
gaff
, 1, 
gaff_bufãr
);

224 
SŒuùBufãr
* 
ab_dœeùÜy
 = &
¡ruù_bufãr
[
FORMAT_DIRECTORY
];

225 
u8
 
i
=0; i<
ASSET_BLOB_TOTAL
; i++) {

226 
DœeùÜy
 
dœ
 = {};

227 
	`¡rıy
(
dœ
.
Çme_of_blob
, 
blob_Çmes
[
i
]);

228 
	`PushSŒuùBufãr
(&
dœ
, 1, 
ab_dœeùÜy
);

232 
SŒuùBufãr
* 
ab_‹xtu»s_blob
 = &
¡ruù_bufãr
[
FORMAT_TEXTURES_BLOB
];

233 
SŒuùBufãr
* 
ab_‹xtu»
 = &
¡ruù_bufãr
[
FORMAT_TEXTURE
];

234 
SŒuùBufãr
* 
ab_pix–s
 = &
¡ruù_bufãr
[
FORMAT_PIXELS
];

236 
Textu»sBlob
 
‹xtu»s_blob
 = {};

238 * 
dœ
 = 
as£t_·th_dœ
[
ASSET_TYPE_TEXTURE
];

239 * 
fe_fÜm©
 = 
as£t_fe_fÜm©
[
ASSET_TYPE_TEXTURE
];

240 
FŞd”Info
 
fŞd”
 = 
	`LßdFŞd”
(
dœ
, 
fe_fÜm©
);

242 
u8
 
i
=0; i<
fŞd”
.
fe_couÁ
; i++) {

243 
FeInfo
 
fe
 = 
fŞd”
.
fes
[
i
];

244 * 
·th
 = 
	`MakeFuÎP©h
(
fŞd”
.
dœ
, 
fe
.
Çme
, fe.
fÜm©
);

245 
x
, 
y
, 
n
;

246 * 
d©a
 = 
	`¡bi_lßd
(
·th
, &
x
, &
y
, &
n
, 4);

247 
	`As£¹
(
d©a
);

249 
Textu»FÜm©
 
‹xtu»_fÜm©
 = {};

250 
‹xtu»_fÜm©
.
off£t_to_d©a
 = 
	`G‘Off£tSŒuùBufãr
(
ab_pix–s
);

251 
	`Re£rveMemÜySŒuùBufãr
(
x
*
y
*4, 
ab_pix–s
);

252 
	`PushSŒuùBufãr
(
d©a
, 
x
*
y
*4, 
ab_pix–s
);

254 
	`¡rıy
(
‹xtu»_fÜm©
.
Çme
, 
fe
.name);

255 
‹xtu»_fÜm©
.
Çme
[
STRING_LENGTH_TEXTURE
 - 1] = 0;

256 
	`¡rıy
(
‹xtu»_fÜm©
.
ty³
, 
‹xtu»_ty³_Çmes
[
TEXTURE_SLOT_DIFFUSE
]);

257 
‹xtu»_fÜm©
.
width
 = 
x
;

258 
‹xtu»_fÜm©
.
height
 = 
y
;

259 
‹xtu»_fÜm©
.
num_compÚ’ts
 = 4;

261 
	`PushSŒuùBufãr
(&
‹xtu»_fÜm©
, 1, 
ab_‹xtu»
);

262 
‹xtu»s_blob
.
‹xtu»s_couÁ
++;

264 
	`PushSŒuùBufãr
(&
‹xtu»s_blob
, 1,
ab_‹xtu»s_blob
);

265 
blob_off£ts
[
ASSET_BLOB_TEXTURES
] = 
	`G‘Off£tSŒuùBufãr
(
ab_‹xtu»s_blob
) +

266 
	`G‘Off£tSŒuùBufãr
(
ab_‹xtu»
) +

267 
	`G‘Off£tSŒuùBufãr
(
ab_pix–s
);

270 
SŒuùBufãr
* 
ab_fÚts_blob
 = &
¡ruù_bufãr
[
FORMAT_FONTS_BLOB
];

271 
SŒuùBufãr
* 
ab_fÚt
 = &
¡ruù_bufãr
[
FORMAT_FONT
];

272 
SŒuùBufãr
* 
ab_‰f
 = &
¡ruù_bufãr
[
FORMAT_TTF
];

274 * 
dœ
 = 
as£t_·th_dœ
[
ASSET_TYPE_FONT
];

275 * 
fe_fÜm©
 = 
as£t_fe_fÜm©
[
ASSET_TYPE_FONT
];

276 
FŞd”Info
 
fŞd”
 = 
	`LßdFŞd”
(
dœ
, 
fe_fÜm©
);

278 
FÚtsBlob
 
fÚts_blob
 = {};

279 
fÚts_blob
.
fÚts_couÁ
 = 
fŞd”
.
fe_couÁ
;

282 
u8
 
i
=0; i<
fŞd”
.
fe_couÁ
; i++) {

283 
FeInfo
 
fe
 = 
fŞd”
.
fes
[
i
];

284 * 
·th
 = 
	`MakeFuÎP©h
(
fŞd”
.
dœ
, 
fe
.
Çme
, fe.
fÜm©
);

286 
FÚtFÜm©
 
fÚt_fÜm©
 = {};

287 
	`¡rıy
(
fÚt_fÜm©
.
Çme
, 
fe
.name);

288 
fÚt_fÜm©
.
Çme
[
STRING_LENGTH_FONT
-1] = 0;

290 
fÚt_fÜm©
.
off£t_to_d©a
 = 
	`G‘Off£tSŒuùBufãr
(
ab_‰f
);

291 
	`CİyFeToSŒuùBufãr
(
·th
, 
fe
.
size
, 
ab_‰f
);

293 
	`PushSŒuùBufãr
(&
fÚt_fÜm©
, 1, 
ab_fÚt
);

295 
	`PushSŒuùBufãr
(&
fÚts_blob
, 1, 
ab_fÚts_blob
);

296 
blob_off£ts
[
ASSET_BLOB_FONTS
] = 
	`G‘Off£tSŒuùBufãr
(
ab_fÚts_blob
) +

297 
	`G‘Off£tSŒuùBufãr
(
ab_fÚt
) +

298 
	`G‘Off£tSŒuùBufãr
(
ab_‰f
);

301 
SŒuùBufãr
* 
ab_meshes_blob
 = &
¡ruù_bufãr
[
FORMAT_MESHES_BLOB
];

302 
SŒuùBufãr
* 
ab_mesh
 = &
¡ruù_bufãr
[
FORMAT_MESH
];

303 
SŒuùBufãr
* 
ab_v”‹x_bufãr
 = &
¡ruù_bufãr
[
FORMAT_VERTEX_BUFFER
];

304 
SŒuùBufãr
* 
ab_v”‹x_bufãr_æßt
 = &
¡ruù_bufãr
[
FORMAT_VERTEX_BUFFER_FLOAT
];

305 
SŒuùBufãr
* 
ab_šdex_bufãr_u32
 = &
¡ruù_bufãr
[
FORMAT_INDEX_BUFFER_U32
];

307 
MeshesBlob
 
meshes_blob
 = {};

309 * 
dœ
 = 
as£t_·th_dœ
[
ASSET_TYPE_MODEL
];

310 * 
fe_fÜm©
 = 
as£t_fe_fÜm©
[
ASSET_TYPE_MODEL
];

311 
FŞd”Info
 
fŞd”
 = 
	`LßdFŞd”
(
dœ
, 
fe_fÜm©
);

314 
u8
 
i
=0; i<
fŞd”
.
fe_couÁ
; i++) {

315 
FeInfo
 
fe
 = 
fŞd”
.
fes
[
i
];

316 * 
·th
 = 
	`MakeFuÎP©h
(
fŞd”
.
dœ
, 
fe
.
Çme
, fe.
fÜm©
);

318 
cgÉf_d©a
* 
d©a
;

319 
cgÉf_İtiÚs
 
İt
 = {};

320 
	`As£¹
(
	`cgÉf_·r£_fe
(&
İt
, 
·th
, &
d©a
è=ğ
cgÉf_»suÉ_sucûss
);

321 
	`As£¹
(
	`cgÉf_v®id©e
(
d©a
è=ğ
cgÉf_»suÉ_sucûss
);

322 
	`As£¹
(
	`cgÉf_lßd_bufãrs
(&
İt
, 
d©a
, 
·th
è=ğ
cgÉf_»suÉ_sucûss
);

324 
meshes_blob
.
meshes_couÁ
 +ğ
d©a
->meshes_count;

325 
u8
 
j
=0; j<
d©a
->
meshes_couÁ
; j++) {

326 
MeshFÜm©
 
mesh_fÜm©
 = {};

327 
cgÉf_mesh
* 
mesh
 = 
d©a
->
meshes
 + 
j
;

328 
	`As£¹
(
mesh
->
Çme
);

329 
	`¡rıy
(
mesh_fÜm©
.
Çme
, 
mesh
->name);

331 
	`As£¹
(
d©a
->
meshes
[
j
].
´im™ives_couÁ
 == 1);

332 
cgÉf_´im™ive
* 
´im
 = 
mesh
->
´im™ives
;

333 
	`As£¹
(
´im
->
ty³
 =ğ
cgÉf_´im™ive_ty³_ŒŸngËs
);

335 
	`As£¹
(
´im
->
šdiûs
);

336 
mesh_fÜm©
.
šdiûs_couÁ
 = 
´im
->
šdiûs
->
couÁ
;

337 
mesh_fÜm©
.
off£t_to_šdiûs
 = 
	`G‘Off£tSŒuùBufãr
(
ab_šdex_bufãr_u32
);

338 
mesh_fÜm©
.
off£t_to_v”‹x_bufãrs
 = 
	`G‘Off£tSŒuùBufãr
(
ab_v”‹x_bufãr
);

340 
	`Re£rveMemÜySŒuùBufãr
(
´im
->
šdiûs
->
couÁ
, 
ab_šdex_bufãr_u32
);

341 
u32
 
k
=0; k<
´im
->
šdiûs
->
couÁ
; k++) {

342 
u32
 
šdex
 = (u32)
	`cgÉf_acûssÜ_»ad_šdex
(
´im
->
šdiûs
, 
k
);

343 
	`PushSŒuùBufãr
(&
šdex
, 1, 
ab_šdex_bufãr_u32
);

346 
u8
 
k
=0; k<
´im
->
©Œibu‹s_couÁ
; k++) {

347 
cgÉf_©Œibu‹
* 
©t
 = 
´im
->
©Œibu‹s
 + 
k
;

348 
cgÉf_acûssÜ
* 
acc
 = 
©t
->
d©a
;

349 
mesh_fÜm©
.
v”tiûs_couÁ
 = 
acc
->
couÁ
;

351 
cgÉf_size
 
æßt_couÁ
 = 
	`cgÉf_acûssÜ_uÅack_æßts
(
acc
, 
NULL
, 0);

352 
©t
->
ty³
) {

353 
cgÉf_©Œibu‹_ty³_pos™iÚ
: {

354 
	`As£¹
(
acc
->
compÚ’t_ty³
 =ğ
cgÉf_compÚ’t_ty³_r_32f
);

355 
	`As£¹
(
acc
->
ty³
 =ğ
cgÉf_ty³_vec3
);

357 
mesh_fÜm©
.
v”‹x_bufãr_couÁ
++;

358 
V”‹xBufãrFÜm©
 
vbf
 = {};

359 
	`¡rıy
(
vbf
.
ty³
, 
v”‹x_bufãr_Çmes
[
VERTEX_BUFFER_POSITION
]);

360 
vbf
.
off£t_to_d©a
 = 
	`G‘Off£tSŒuùBufãr
(
ab_v”‹x_bufãr_æßt
);

362 
	`Re£rveMemÜySŒuùBufãr
(
æßt_couÁ
, 
ab_v”‹x_bufãr_æßt
);

363 
	`cgÉf_acûssÜ_uÅack_æßts
(
acc
, (*)
	`G‘CursÜSŒuùBufãr
(
ab_v”‹x_bufãr_æßt
), 
æßt_couÁ
);

364 
ab_v”‹x_bufãr_æßt
->
fËd_couÁ
 +ğ
æßt_couÁ
;

366 
	`PushSŒuùBufãr
(&
vbf
, 1, 
ab_v”‹x_bufãr
);

368 
cgÉf_©Œibu‹_ty³_nÜm®
: {

369 
	`As£¹
(
acc
->
compÚ’t_ty³
 =ğ
cgÉf_compÚ’t_ty³_r_32f
);

370 
	`As£¹
(
acc
->
ty³
 =ğ
cgÉf_ty³_vec3
);

372 
mesh_fÜm©
.
v”‹x_bufãr_couÁ
++;

373 
V”‹xBufãrFÜm©
 
vbf
 = {};

374 
	`¡rıy
(
vbf
.
ty³
, 
v”‹x_bufãr_Çmes
[
VERTEX_BUFFER_NORMAL
]);

375 
vbf
.
off£t_to_d©a
 = 
	`G‘Off£tSŒuùBufãr
(
ab_v”‹x_bufãr_æßt
);

377 
	`Re£rveMemÜySŒuùBufãr
(
æßt_couÁ
, 
ab_v”‹x_bufãr_æßt
);

378 
	`cgÉf_acûssÜ_uÅack_æßts
(
acc
, (*)
	`G‘CursÜSŒuùBufãr
(
ab_v”‹x_bufãr_æßt
), 
æßt_couÁ
);

379 
ab_v”‹x_bufãr_æßt
->
fËd_couÁ
 +ğ
æßt_couÁ
;

381 
	`PushSŒuùBufãr
(&
vbf
, 1, 
ab_v”‹x_bufãr
);

383 
cgÉf_©Œibu‹_ty³_‹xcoÜd
: {

384 
	`As£¹
(
acc
->
compÚ’t_ty³
 =ğ
cgÉf_compÚ’t_ty³_r_32f
);

385 
	`As£¹
(
acc
->
ty³
 =ğ
cgÉf_ty³_vec2
);

387 
mesh_fÜm©
.
v”‹x_bufãr_couÁ
++;

388 
V”‹xBufãrFÜm©
 
vbf
 = {};

389 
	`¡rıy
(
vbf
.
ty³
, 
v”‹x_bufãr_Çmes
[
VERTEX_BUFFER_TEXCOORD
]);

390 
vbf
.
off£t_to_d©a
 = 
	`G‘Off£tSŒuùBufãr
(
ab_v”‹x_bufãr_æßt
);

392 
	`Re£rveMemÜySŒuùBufãr
(
æßt_couÁ
, 
ab_v”‹x_bufãr_æßt
);

393 
	`cgÉf_acûssÜ_uÅack_æßts
(
acc
, (*)
	`G‘CursÜSŒuùBufãr
(
ab_v”‹x_bufãr_æßt
), 
æßt_couÁ
);

394 
ab_v”‹x_bufãr_æßt
->
fËd_couÁ
 +ğ
æßt_couÁ
;

396 
	`PushSŒuùBufãr
(&
vbf
, 1, 
ab_v”‹x_bufãr
);

400 
	`PushSŒuùBufãr
(&
mesh_fÜm©
, 1, 
ab_mesh
);

403 
	`PushSŒuùBufãr
(&
meshes_blob
, 1, 
ab_meshes_blob
);

404 
blob_off£ts
[
ASSET_BLOB_MESHES
] = 
	`G‘Off£tSŒuùBufãr
(
ab_meshes_blob
) +

405 
	`G‘Off£tSŒuùBufãr
(
ab_mesh
) +

406 
	`G‘Off£tSŒuùBufãr
(
ab_v”‹x_bufãr
) +

407 
	`G‘Off£tSŒuùBufãr
(
ab_v”‹x_bufãr_æßt
) +

408 
	`G‘Off£tSŒuùBufãr
(
ab_šdex_bufãr_u32
);

411 
G’”icBufãr
 
gb_fe
 = {};

414 
u32
 
off£t
 = 0;

415 
u8
 
i
=0; i<
FORMAT_TOTAL
; i++è
gb_fe
.
tÙ®_size
 +ğ
¡ruù_bufãr
[i].
–em_size
 * sŒuù_bufãr[i].
fËd_couÁ
;

416 
gb_fe
.
d©a
 = 
	`ÿÎoc
(gb_fe.
tÙ®_size
, (
u8
));

418 
off£t
 = 
	`G‘Off£tSŒuùBufãr
(&
¡ruù_bufãr
[
FORMAT_GAME_ASSET_FILE
]);

419 
u32
 
i
=0; i<
¡ruù_bufãr
[
FORMAT_GAME_ASSET_FILE
].
fËd_couÁ
; i++) {

420 
GameAs£tFe
* 
gaf
 = (GameAs£tFe*)
	`G‘EËm’tSŒuùBufãr
(&
¡ruù_bufãr
[
FORMAT_GAME_ASSET_FILE
], 
i
);

421 
gaf
->
off£t_to_blob_dœeùÜ›s
 +ğ
off£t
;

423 
	`Wr™eSŒuùBufãrToG’”icBufãr
(&
gb_fe
, &
¡ruù_bufãr
[
FORMAT_GAME_ASSET_FILE
]);

425 
off£t
 +ğ
	`G‘Off£tSŒuùBufãr
(&
¡ruù_bufãr
[
FORMAT_DIRECTORY
]);

426 
u32
 
blob_off£t
 = 0;

427 
u32
 
i
=0; i<
¡ruù_bufãr
[
FORMAT_DIRECTORY
].
fËd_couÁ
; i++) {

428 
DœeùÜy
* 
dœ
 = (DœeùÜy*)
	`G‘EËm’tSŒuùBufãr
(&
¡ruù_bufãr
[
FORMAT_DIRECTORY
], 
i
);

429 
dœ
->
off£t_to_blob
 +ğ
off£t
 + 
blob_off£t
;

430 
blob_off£t
 +ğ
blob_off£ts
[
i
];

432 
	`Wr™eSŒuùBufãrToG’”icBufãr
(&
gb_fe
, &
¡ruù_bufãr
[
FORMAT_DIRECTORY
]);

434 
off£t
 +ğ
	`G‘Off£tSŒuùBufãr
(&
¡ruù_bufãr
[
FORMAT_MESHES_BLOB
]);

435 
u32
 
i
=0; i<
¡ruù_bufãr
[
FORMAT_MESHES_BLOB
].
fËd_couÁ
; i++) {

436 
MeshesBlob
* 
mb
 = (MeshesBlob*)
	`G‘EËm’tSŒuùBufãr
(&
¡ruù_bufãr
[
FORMAT_MESHES_BLOB
], 
i
);

437 
mb
->
off£t_to_mesh_fÜm©s
 +ğ
off£t
;

439 
	`Wr™eSŒuùBufãrToG’”icBufãr
(&
gb_fe
, &
¡ruù_bufãr
[
FORMAT_MESHES_BLOB
]);

441 
off£t
 +ğ
	`G‘Off£tSŒuùBufãr
(&
¡ruù_bufãr
[
FORMAT_MESH
]);

442 
u32
 
i
=0; i<
¡ruù_bufãr
[
FORMAT_MESH
].
fËd_couÁ
; i++) {

443 
MeshFÜm©
* 
mf
 = (MeshFÜm©*)
	`G‘EËm’tSŒuùBufãr
(&
¡ruù_bufãr
[
FORMAT_MESH
], 
i
);

444 
mf
->
off£t_to_v”‹x_bufãrs
 +ğ
off£t
;

445 
u32
 
off£t_vb
 = 
	`G‘Off£tSŒuùBufãr
(&
¡ruù_bufãr
[
FORMAT_VERTEX_BUFFER
]);

446 
u32
 
off£t_vb_æßt
 = 
	`G‘Off£tSŒuùBufãr
(&
¡ruù_bufãr
[
FORMAT_VERTEX_BUFFER_FLOAT
]);

447 
mf
->
off£t_to_šdiûs
 +ğ
off£t
 + 
off£t_vb
 + 
off£t_vb_æßt
;

449 
	`Wr™eSŒuùBufãrToG’”icBufãr
(&
gb_fe
, &
¡ruù_bufãr
[
FORMAT_MESH
]);

451 
off£t
 +ğ
	`G‘Off£tSŒuùBufãr
(&
¡ruù_bufãr
[
FORMAT_VERTEX_BUFFER
]);

452 
u32
 
i
=0; i<
¡ruù_bufãr
[
FORMAT_VERTEX_BUFFER
].
fËd_couÁ
; i++) {

453 
V”‹xBufãrFÜm©
* 
vbf
 = (V”‹xBufãrFÜm©*)
	`G‘EËm’tSŒuùBufãr
(&
¡ruù_bufãr
[
FORMAT_VERTEX_BUFFER
], 
i
);

454 
vbf
->
off£t_to_d©a
 +ğ
off£t
;

456 
	`Wr™eSŒuùBufãrToG’”icBufãr
(&
gb_fe
, &
¡ruù_bufãr
[
FORMAT_VERTEX_BUFFER
]);

458 
off£t
 +ğ
	`G‘Off£tSŒuùBufãr
(&
¡ruù_bufãr
[
FORMAT_VERTEX_BUFFER_FLOAT
]);

459 
	`Wr™eSŒuùBufãrToG’”icBufãr
(&
gb_fe
, &
¡ruù_bufãr
[
FORMAT_VERTEX_BUFFER_FLOAT
]);

461 
off£t
 +ğ
	`G‘Off£tSŒuùBufãr
(&
¡ruù_bufãr
[
FORMAT_INDEX_BUFFER_U32
]);

462 
	`Wr™eSŒuùBufãrToG’”icBufãr
(&
gb_fe
, &
¡ruù_bufãr
[
FORMAT_INDEX_BUFFER_U32
]);

464 
off£t
 +ğ
	`G‘Off£tSŒuùBufãr
(&
¡ruù_bufãr
[
FORMAT_TEXTURES_BLOB
]);

465 
u32
 
i
=0; i<
¡ruù_bufãr
[
FORMAT_TEXTURES_BLOB
].
fËd_couÁ
; i++) {

466 
Textu»sBlob
* 
mb
 = (Textu»sBlob*)
	`G‘EËm’tSŒuùBufãr
(&
¡ruù_bufãr
[
FORMAT_TEXTURES_BLOB
], 
i
);

467 
mb
->
off£t_to_‹xtu»_fÜm©s
 +ğ
off£t
;

469 
	`Wr™eSŒuùBufãrToG’”icBufãr
(&
gb_fe
, &
¡ruù_bufãr
[
FORMAT_TEXTURES_BLOB
]);

471 
off£t
 +ğ
	`G‘Off£tSŒuùBufãr
(&
¡ruù_bufãr
[
FORMAT_TEXTURE
]);

472 
u32
 
i
=0; i<
¡ruù_bufãr
[
FORMAT_TEXTURE
].
fËd_couÁ
; i++) {

473 
Textu»FÜm©
* 
tf
 = (Textu»FÜm©*)
	`G‘EËm’tSŒuùBufãr
(&
¡ruù_bufãr
[
FORMAT_TEXTURE
], 
i
);

474 
tf
->
off£t_to_d©a
 +ğ
off£t
;

476 
	`Wr™eSŒuùBufãrToG’”icBufãr
(&
gb_fe
, &
¡ruù_bufãr
[
FORMAT_TEXTURE
]);

478 
off£t
 +ğ
	`G‘Off£tSŒuùBufãr
(&
¡ruù_bufãr
[
FORMAT_PIXELS
]);

479 
	`Wr™eSŒuùBufãrToG’”icBufãr
(&
gb_fe
, &
¡ruù_bufãr
[
FORMAT_PIXELS
]);

481 
off£t
 +ğ
	`G‘Off£tSŒuùBufãr
(&
¡ruù_bufãr
[
FORMAT_FONTS_BLOB
]);

482 
u32
 
i
=0; i<
¡ruù_bufãr
[
FORMAT_FONTS_BLOB
].
fËd_couÁ
; i++) {

483 
FÚtsBlob
* 
mb
 = (FÚtsBlob*)
	`G‘EËm’tSŒuùBufãr
(&
¡ruù_bufãr
[
FORMAT_FONTS_BLOB
], 
i
);

484 
mb
->
off£t_to_fÚt_fÜm©s
 +ğ
off£t
;

486 
	`Wr™eSŒuùBufãrToG’”icBufãr
(&
gb_fe
, &
¡ruù_bufãr
[
FORMAT_FONTS_BLOB
]);

488 
off£t
 +ğ
	`G‘Off£tSŒuùBufãr
(&
¡ruù_bufãr
[
FORMAT_FONT
]);

489 
u32
 
i
=0; i<
¡ruù_bufãr
[
FORMAT_FONT
].
fËd_couÁ
; i++) {

490 
FÚtFÜm©
* 
tf
 = (FÚtFÜm©*)
	`G‘EËm’tSŒuùBufãr
(&
¡ruù_bufãr
[
FORMAT_FONT
], 
i
);

491 
tf
->
off£t_to_d©a
 +ğ
off£t
;

493 
	`Wr™eSŒuùBufãrToG’”icBufãr
(&
gb_fe
, &
¡ruù_bufãr
[
FORMAT_FONT
]);

495 
off£t
 +ğ
	`G‘Off£tSŒuùBufãr
(&
¡ruù_bufãr
[
FORMAT_TTF
]);

496 
	`Wr™eSŒuùBufãrToG’”icBufãr
(&
gb_fe
, &
¡ruù_bufãr
[
FORMAT_TTF
]);

502 
HANDLE
 
h
 = 
	`C»©eFeA
("d©a.gaf", 
GENERIC_WRITE
, 0, 0, 
CREATE_ALWAYS
, 
FILE_ATTRIBUTE_NORMAL
, 0);

503 
	`As£¹
(
h
 !ğ
INVALID_HANDLE_VALUE
);

505 
DWORD
 
by‹s_wr™‹n
 = 0;

506 
	`As£¹
(
	`Wr™eFe
(
h
, 
gb_fe
.
d©a
, gb_fe.
fËd_size
, &
by‹s_wr™‹n
, 0));

507 
	`As£¹
(
by‹s_wr™‹n
 =ğ
gb_fe
.
fËd_size
);

511 
	}
}

	@include/cgltf.h

92 #iâdeà
CGLTF_H_INCLUDED__


93 
	#CGLTF_H_INCLUDED__


	)

95 
	~<¡ddef.h
>

97 #ifdeà
__ılu¥lus


101 
size_t
 
	tcgÉf_size
;

102 
	tcgÉf_ssize
;

103 
	tcgÉf_æßt
;

104 
	tcgÉf_št
;

105 
	tcgÉf_ušt
;

106 
	tcgÉf_boŞ
;

108 
	ecgÉf_fe_ty³


110 
cgÉf_fe_ty³_šv®id
,

111 
cgÉf_fe_ty³_gÉf
,

112 
cgÉf_fe_ty³_glb
,

113 
cgÉf_fe_ty³_max_’um


114 } 
	tcgÉf_fe_ty³
;

116 
	ecgÉf_»suÉ


118 
cgÉf_»suÉ_sucûss
,

119 
cgÉf_»suÉ_d©a_too_shÜt
,

120 
cgÉf_»suÉ_unknown_fÜm©
,

121 
cgÉf_»suÉ_šv®id_jsÚ
,

122 
cgÉf_»suÉ_šv®id_gÉf
,

123 
cgÉf_»suÉ_šv®id_İtiÚs
,

124 
cgÉf_»suÉ_fe_nÙ_found
,

125 
cgÉf_»suÉ_io_”rÜ
,

126 
cgÉf_»suÉ_out_of_memÜy
,

127 
cgÉf_»suÉ_Ëgacy_gÉf
,

128 
cgÉf_»suÉ_max_’um


129 } 
	tcgÉf_»suÉ
;

131 
	scgÉf_memÜy_İtiÚs


133 * (*
®loc_func
)(* 
u£r
, 
cgÉf_size
 
size
);

134 (*
ä“_func
è(* 
u£r
, * 
±r
);

135 * 
u£r_d©a
;

136 } 
	tcgÉf_memÜy_İtiÚs
;

138 
	scgÉf_fe_İtiÚs


140 
cgÉf_»suÉ
(*
»ad
)(cÚ¡ 
cgÉf_memÜy_İtiÚs
* 
memÜy_İtiÚs
, cÚ¡ 
cgÉf_fe_İtiÚs
* 
fe_İtiÚs
, cÚ¡ * 
·th
, 
cgÉf_size
* 
size
, ** 
d©a
);

141 (*
»Ëa£
)(cÚ¡ 
cgÉf_memÜy_İtiÚs
* 
memÜy_İtiÚs
, cÚ¡ 
cgÉf_fe_İtiÚs
* 
fe_İtiÚs
, * 
d©a
);

142 * 
u£r_d©a
;

143 } 
	tcgÉf_fe_İtiÚs
;

145 
	scgÉf_İtiÚs


147 
cgÉf_fe_ty³
 
ty³
;

148 
cgÉf_size
 
jsÚ_tok’_couÁ
;

149 
cgÉf_memÜy_İtiÚs
 
memÜy
;

150 
cgÉf_fe_İtiÚs
 
fe
;

151 } 
	tcgÉf_İtiÚs
;

153 
	ecgÉf_bufãr_v›w_ty³


155 
cgÉf_bufãr_v›w_ty³_šv®id
,

156 
cgÉf_bufãr_v›w_ty³_šdiûs
,

157 
cgÉf_bufãr_v›w_ty³_v”tiûs
,

158 
cgÉf_bufãr_v›w_ty³_max_’um


159 } 
	tcgÉf_bufãr_v›w_ty³
;

161 
	ecgÉf_©Œibu‹_ty³


163 
cgÉf_©Œibu‹_ty³_šv®id
,

164 
cgÉf_©Œibu‹_ty³_pos™iÚ
,

165 
cgÉf_©Œibu‹_ty³_nÜm®
,

166 
cgÉf_©Œibu‹_ty³_ng’t
,

167 
cgÉf_©Œibu‹_ty³_‹xcoÜd
,

168 
cgÉf_©Œibu‹_ty³_cŞÜ
,

169 
cgÉf_©Œibu‹_ty³_jošts
,

170 
cgÉf_©Œibu‹_ty³_weights
,

171 
cgÉf_©Œibu‹_ty³_cu¡om
,

172 
cgÉf_©Œibu‹_ty³_max_’um


173 } 
	tcgÉf_©Œibu‹_ty³
;

175 
	ecgÉf_compÚ’t_ty³


177 
cgÉf_compÚ’t_ty³_šv®id
,

178 
cgÉf_compÚ’t_ty³_r_8
,

179 
cgÉf_compÚ’t_ty³_r_8u
,

180 
cgÉf_compÚ’t_ty³_r_16
,

181 
cgÉf_compÚ’t_ty³_r_16u
,

182 
cgÉf_compÚ’t_ty³_r_32u
,

183 
cgÉf_compÚ’t_ty³_r_32f
,

184 
cgÉf_compÚ’t_ty³_max_’um


185 } 
	tcgÉf_compÚ’t_ty³
;

187 
	ecgÉf_ty³


189 
cgÉf_ty³_šv®id
,

190 
cgÉf_ty³_sÿÏr
,

191 
cgÉf_ty³_vec2
,

192 
cgÉf_ty³_vec3
,

193 
cgÉf_ty³_vec4
,

194 
cgÉf_ty³_m©2
,

195 
cgÉf_ty³_m©3
,

196 
cgÉf_ty³_m©4
,

197 
cgÉf_ty³_max_’um


198 } 
	tcgÉf_ty³
;

200 
	ecgÉf_´im™ive_ty³


202 
cgÉf_´im™ive_ty³_pošts
,

203 
cgÉf_´im™ive_ty³_lšes
,

204 
cgÉf_´im™ive_ty³_lše_loİ
,

205 
cgÉf_´im™ive_ty³_lše_¡r
,

206 
cgÉf_´im™ive_ty³_ŒŸngËs
,

207 
cgÉf_´im™ive_ty³_ŒŸngË_¡r
,

208 
cgÉf_´im™ive_ty³_ŒŸngË_çn
,

209 
cgÉf_´im™ive_ty³_max_’um


210 } 
	tcgÉf_´im™ive_ty³
;

212 
	ecgÉf_®pha_mode


214 
cgÉf_®pha_mode_İaque
,

215 
cgÉf_®pha_mode_mask
,

216 
cgÉf_®pha_mode_bËnd
,

217 
cgÉf_®pha_mode_max_’um


218 } 
	tcgÉf_®pha_mode
;

220 
	ecgÉf_ªim©iÚ_·th_ty³
 {

221 
cgÉf_ªim©iÚ_·th_ty³_šv®id
,

222 
cgÉf_ªim©iÚ_·th_ty³_Œª¦©iÚ
,

223 
cgÉf_ªim©iÚ_·th_ty³_rÙ©iÚ
,

224 
cgÉf_ªim©iÚ_·th_ty³_sÿË
,

225 
cgÉf_ªim©iÚ_·th_ty³_weights
,

226 
cgÉf_ªim©iÚ_·th_ty³_max_’um


227 } 
	tcgÉf_ªim©iÚ_·th_ty³
;

229 
	ecgÉf_š‹½Ş©iÚ_ty³
 {

230 
cgÉf_š‹½Ş©iÚ_ty³_lš—r
,

231 
cgÉf_š‹½Ş©iÚ_ty³_¡•
,

232 
cgÉf_š‹½Ş©iÚ_ty³_cubic_¥lše
,

233 
cgÉf_š‹½Ş©iÚ_ty³_max_’um


234 } 
	tcgÉf_š‹½Ş©iÚ_ty³
;

236 
	ecgÉf_ÿm”a_ty³
 {

237 
cgÉf_ÿm”a_ty³_šv®id
,

238 
cgÉf_ÿm”a_ty³_³r¥eùive
,

239 
cgÉf_ÿm”a_ty³_Üthog¿phic
,

240 
cgÉf_ÿm”a_ty³_max_’um


241 } 
	tcgÉf_ÿm”a_ty³
;

243 
	ecgÉf_light_ty³
 {

244 
cgÉf_light_ty³_šv®id
,

245 
cgÉf_light_ty³_dœeùiÚ®
,

246 
cgÉf_light_ty³_pošt
,

247 
cgÉf_light_ty³_¥Ù
,

248 
cgÉf_light_ty³_max_’um


249 } 
	tcgÉf_light_ty³
;

251 
	ecgÉf_d©a_ä“_m‘hod
 {

252 
cgÉf_d©a_ä“_m‘hod_nÚe
,

253 
cgÉf_d©a_ä“_m‘hod_fe_»Ëa£
,

254 
cgÉf_d©a_ä“_m‘hod_memÜy_ä“
,

255 
cgÉf_d©a_ä“_m‘hod_max_’um


256 } 
	tcgÉf_d©a_ä“_m‘hod
;

258 
	scgÉf_exŒas
 {

259 
cgÉf_size
 
¡¬t_off£t
;

260 
cgÉf_size
 
’d_off£t
;

261 } 
	tcgÉf_exŒas
;

263 
	scgÉf_ex‹nsiÚ
 {

264 * 
Çme
;

265 * 
d©a
;

266 } 
	tcgÉf_ex‹nsiÚ
;

268 
	scgÉf_bufãr


270 * 
Çme
;

271 
cgÉf_size
 
size
;

272 * 
uri
;

273 * 
d©a
;

274 
cgÉf_d©a_ä“_m‘hod
 
d©a_ä“_m‘hod
;

275 
cgÉf_exŒas
 
exŒas
;

276 
cgÉf_size
 
ex‹nsiÚs_couÁ
;

277 
cgÉf_ex‹nsiÚ
* 
ex‹nsiÚs
;

278 } 
	tcgÉf_bufãr
;

280 
	ecgÉf_meshİt_com´essiÚ_mode
 {

281 
cgÉf_meshİt_com´essiÚ_mode_šv®id
,

282 
cgÉf_meshİt_com´essiÚ_mode_©Œibu‹s
,

283 
cgÉf_meshİt_com´essiÚ_mode_ŒŸngËs
,

284 
cgÉf_meshİt_com´essiÚ_mode_šdiûs
,

285 
cgÉf_meshİt_com´essiÚ_mode_max_’um


286 } 
	tcgÉf_meshİt_com´essiÚ_mode
;

288 
	ecgÉf_meshİt_com´essiÚ_f‹r
 {

289 
cgÉf_meshİt_com´essiÚ_f‹r_nÚe
,

290 
cgÉf_meshİt_com´essiÚ_f‹r_oùahed¿l
,

291 
cgÉf_meshİt_com´essiÚ_f‹r_qu©”niÚ
,

292 
cgÉf_meshİt_com´essiÚ_f‹r_expÚ’tŸl
,

293 
cgÉf_meshİt_com´essiÚ_f‹r_max_’um


294 } 
	tcgÉf_meshİt_com´essiÚ_f‹r
;

296 
	scgÉf_meshİt_com´essiÚ


298 
cgÉf_bufãr
* 
bufãr
;

299 
cgÉf_size
 
off£t
;

300 
cgÉf_size
 
size
;

301 
cgÉf_size
 
¡ride
;

302 
cgÉf_size
 
couÁ
;

303 
cgÉf_meshİt_com´essiÚ_mode
 
mode
;

304 
cgÉf_meshİt_com´essiÚ_f‹r
 
f‹r
;

305 } 
	tcgÉf_meshİt_com´essiÚ
;

307 
	scgÉf_bufãr_v›w


309 *
Çme
;

310 
cgÉf_bufãr
* 
bufãr
;

311 
cgÉf_size
 
off£t
;

312 
cgÉf_size
 
size
;

313 
cgÉf_size
 
¡ride
;

314 
cgÉf_bufãr_v›w_ty³
 
ty³
;

315 * 
d©a
;

316 
cgÉf_boŞ
 
has_meshİt_com´essiÚ
;

317 
cgÉf_meshİt_com´essiÚ
 
meshİt_com´essiÚ
;

318 
cgÉf_exŒas
 
exŒas
;

319 
cgÉf_size
 
ex‹nsiÚs_couÁ
;

320 
cgÉf_ex‹nsiÚ
* 
ex‹nsiÚs
;

321 } 
	tcgÉf_bufãr_v›w
;

323 
	scgÉf_acûssÜ_¥¬£


325 
cgÉf_size
 
couÁ
;

326 
cgÉf_bufãr_v›w
* 
šdiûs_bufãr_v›w
;

327 
cgÉf_size
 
šdiûs_by‹_off£t
;

328 
cgÉf_compÚ’t_ty³
 
šdiûs_compÚ’t_ty³
;

329 
cgÉf_bufãr_v›w
* 
v®ues_bufãr_v›w
;

330 
cgÉf_size
 
v®ues_by‹_off£t
;

331 
cgÉf_exŒas
 
exŒas
;

332 
cgÉf_exŒas
 
šdiûs_exŒas
;

333 
cgÉf_exŒas
 
v®ues_exŒas
;

334 
cgÉf_size
 
ex‹nsiÚs_couÁ
;

335 
cgÉf_ex‹nsiÚ
* 
ex‹nsiÚs
;

336 
cgÉf_size
 
šdiûs_ex‹nsiÚs_couÁ
;

337 
cgÉf_ex‹nsiÚ
* 
šdiûs_ex‹nsiÚs
;

338 
cgÉf_size
 
v®ues_ex‹nsiÚs_couÁ
;

339 
cgÉf_ex‹nsiÚ
* 
v®ues_ex‹nsiÚs
;

340 } 
	tcgÉf_acûssÜ_¥¬£
;

342 
	scgÉf_acûssÜ


344 * 
Çme
;

345 
cgÉf_compÚ’t_ty³
 
compÚ’t_ty³
;

346 
cgÉf_boŞ
 
nÜm®ized
;

347 
cgÉf_ty³
 
ty³
;

348 
cgÉf_size
 
off£t
;

349 
cgÉf_size
 
couÁ
;

350 
cgÉf_size
 
¡ride
;

351 
cgÉf_bufãr_v›w
* 
bufãr_v›w
;

352 
cgÉf_boŞ
 
has_mš
;

353 
cgÉf_æßt
 
mš
[16];

354 
cgÉf_boŞ
 
has_max
;

355 
cgÉf_æßt
 
max
[16];

356 
cgÉf_boŞ
 
is_¥¬£
;

357 
cgÉf_acûssÜ_¥¬£
 
¥¬£
;

358 
cgÉf_exŒas
 
exŒas
;

359 
cgÉf_size
 
ex‹nsiÚs_couÁ
;

360 
cgÉf_ex‹nsiÚ
* 
ex‹nsiÚs
;

361 } 
	tcgÉf_acûssÜ
;

363 
	scgÉf_©Œibu‹


365 * 
Çme
;

366 
cgÉf_©Œibu‹_ty³
 
ty³
;

367 
cgÉf_št
 
šdex
;

368 
cgÉf_acûssÜ
* 
d©a
;

369 } 
	tcgÉf_©Œibu‹
;

371 
	scgÉf_image


373 * 
Çme
;

374 * 
uri
;

375 
cgÉf_bufãr_v›w
* 
bufãr_v›w
;

376 * 
mime_ty³
;

377 
cgÉf_exŒas
 
exŒas
;

378 
cgÉf_size
 
ex‹nsiÚs_couÁ
;

379 
cgÉf_ex‹nsiÚ
* 
ex‹nsiÚs
;

380 } 
	tcgÉf_image
;

382 
	scgÉf_§m¶”


384 * 
Çme
;

385 
cgÉf_št
 
mag_f‹r
;

386 
cgÉf_št
 
mš_f‹r
;

387 
cgÉf_št
 
w¿p_s
;

388 
cgÉf_št
 
w¿p_t
;

389 
cgÉf_exŒas
 
exŒas
;

390 
cgÉf_size
 
ex‹nsiÚs_couÁ
;

391 
cgÉf_ex‹nsiÚ
* 
ex‹nsiÚs
;

392 } 
	tcgÉf_§m¶”
;

394 
	scgÉf_‹xtu»


396 * 
Çme
;

397 
cgÉf_image
* 
image
;

398 
cgÉf_§m¶”
* 
§m¶”
;

399 
cgÉf_boŞ
 
has_basisu
;

400 
cgÉf_image
* 
basisu_image
;

401 
cgÉf_exŒas
 
exŒas
;

402 
cgÉf_size
 
ex‹nsiÚs_couÁ
;

403 
cgÉf_ex‹nsiÚ
* 
ex‹nsiÚs
;

404 } 
	tcgÉf_‹xtu»
;

406 
	scgÉf_‹xtu»_ŒªsfÜm


408 
cgÉf_æßt
 
off£t
[2];

409 
cgÉf_æßt
 
rÙ©iÚ
;

410 
cgÉf_æßt
 
sÿË
[2];

411 
cgÉf_boŞ
 
has_‹xcoÜd
;

412 
cgÉf_št
 
‹xcoÜd
;

413 } 
	tcgÉf_‹xtu»_ŒªsfÜm
;

415 
	scgÉf_‹xtu»_v›w


417 
cgÉf_‹xtu»
* 
‹xtu»
;

418 
cgÉf_št
 
‹xcoÜd
;

419 
cgÉf_æßt
 
sÿË
;

420 
cgÉf_boŞ
 
has_ŒªsfÜm
;

421 
cgÉf_‹xtu»_ŒªsfÜm
 
ŒªsfÜm
;

422 
cgÉf_exŒas
 
exŒas
;

423 
cgÉf_size
 
ex‹nsiÚs_couÁ
;

424 
cgÉf_ex‹nsiÚ
* 
ex‹nsiÚs
;

425 } 
	tcgÉf_‹xtu»_v›w
;

427 
	scgÉf_pbr_m‘®lic_roughÃss


429 
cgÉf_‹xtu»_v›w
 
ba£_cŞÜ_‹xtu»
;

430 
cgÉf_‹xtu»_v›w
 
m‘®lic_roughÃss_‹xtu»
;

432 
cgÉf_æßt
 
ba£_cŞÜ_çùÜ
[4];

433 
cgÉf_æßt
 
m‘®lic_çùÜ
;

434 
cgÉf_æßt
 
roughÃss_çùÜ
;

436 
cgÉf_exŒas
 
exŒas
;

437 } 
	tcgÉf_pbr_m‘®lic_roughÃss
;

439 
	scgÉf_pbr_¥ecuÏr_glossšess


441 
cgÉf_‹xtu»_v›w
 
diffu£_‹xtu»
;

442 
cgÉf_‹xtu»_v›w
 
¥ecuÏr_glossšess_‹xtu»
;

444 
cgÉf_æßt
 
diffu£_çùÜ
[4];

445 
cgÉf_æßt
 
¥ecuÏr_çùÜ
[3];

446 
cgÉf_æßt
 
glossšess_çùÜ
;

447 } 
	tcgÉf_pbr_¥ecuÏr_glossšess
;

449 
	scgÉf_ş—rcßt


451 
cgÉf_‹xtu»_v›w
 
ş—rcßt_‹xtu»
;

452 
cgÉf_‹xtu»_v›w
 
ş—rcßt_roughÃss_‹xtu»
;

453 
cgÉf_‹xtu»_v›w
 
ş—rcßt_nÜm®_‹xtu»
;

455 
cgÉf_æßt
 
ş—rcßt_çùÜ
;

456 
cgÉf_æßt
 
ş—rcßt_roughÃss_çùÜ
;

457 } 
	tcgÉf_ş—rcßt
;

459 
	scgÉf_ŒªsmissiÚ


461 
cgÉf_‹xtu»_v›w
 
ŒªsmissiÚ_‹xtu»
;

462 
cgÉf_æßt
 
ŒªsmissiÚ_çùÜ
;

463 } 
	tcgÉf_ŒªsmissiÚ
;

465 
	scgÉf_iÜ


467 
cgÉf_æßt
 
iÜ
;

468 } 
	tcgÉf_iÜ
;

470 
	scgÉf_¥ecuÏr


472 
cgÉf_‹xtu»_v›w
 
¥ecuÏr_‹xtu»
;

473 
cgÉf_‹xtu»_v›w
 
¥ecuÏr_cŞÜ_‹xtu»
;

474 
cgÉf_æßt
 
¥ecuÏr_cŞÜ_çùÜ
[3];

475 
cgÉf_æßt
 
¥ecuÏr_çùÜ
;

476 } 
	tcgÉf_¥ecuÏr
;

478 
	scgÉf_vŞume


480 
cgÉf_‹xtu»_v›w
 
thickÃss_‹xtu»
;

481 
cgÉf_æßt
 
thickÃss_çùÜ
;

482 
cgÉf_æßt
 
©‹nu©iÚ_cŞÜ
[3];

483 
cgÉf_æßt
 
©‹nu©iÚ_di¡ªû
;

484 } 
	tcgÉf_vŞume
;

486 
	scgÉf_sh“n


488 
cgÉf_‹xtu»_v›w
 
sh“n_cŞÜ_‹xtu»
;

489 
cgÉf_æßt
 
sh“n_cŞÜ_çùÜ
[3];

490 
cgÉf_‹xtu»_v›w
 
sh“n_roughÃss_‹xtu»
;

491 
cgÉf_æßt
 
sh“n_roughÃss_çùÜ
;

492 } 
	tcgÉf_sh“n
;

494 
	scgÉf_emissive_¡»ngth


496 
cgÉf_æßt
 
emissive_¡»ngth
;

497 } 
	tcgÉf_emissive_¡»ngth
;

499 
	scgÉf_œidesûnû


501 
cgÉf_æßt
 
œidesûnû_çùÜ
;

502 
cgÉf_‹xtu»_v›w
 
œidesûnû_‹xtu»
;

503 
cgÉf_æßt
 
œidesûnû_iÜ
;

504 
cgÉf_æßt
 
œidesûnû_thickÃss_mš
;

505 
cgÉf_æßt
 
œidesûnû_thickÃss_max
;

506 
cgÉf_‹xtu»_v›w
 
œidesûnû_thickÃss_‹xtu»
;

507 } 
	tcgÉf_œidesûnû
;

509 
	scgÉf_m©”Ÿl


511 * 
Çme
;

512 
cgÉf_boŞ
 
has_pbr_m‘®lic_roughÃss
;

513 
cgÉf_boŞ
 
has_pbr_¥ecuÏr_glossšess
;

514 
cgÉf_boŞ
 
has_ş—rcßt
;

515 
cgÉf_boŞ
 
has_ŒªsmissiÚ
;

516 
cgÉf_boŞ
 
has_vŞume
;

517 
cgÉf_boŞ
 
has_iÜ
;

518 
cgÉf_boŞ
 
has_¥ecuÏr
;

519 
cgÉf_boŞ
 
has_sh“n
;

520 
cgÉf_boŞ
 
has_emissive_¡»ngth
;

521 
cgÉf_boŞ
 
has_œidesûnû
;

522 
cgÉf_pbr_m‘®lic_roughÃss
 
pbr_m‘®lic_roughÃss
;

523 
cgÉf_pbr_¥ecuÏr_glossšess
 
pbr_¥ecuÏr_glossšess
;

524 
cgÉf_ş—rcßt
 
ş—rcßt
;

525 
cgÉf_iÜ
 
iÜ
;

526 
cgÉf_¥ecuÏr
 
¥ecuÏr
;

527 
cgÉf_sh“n
 
sh“n
;

528 
cgÉf_ŒªsmissiÚ
 
ŒªsmissiÚ
;

529 
cgÉf_vŞume
 
vŞume
;

530 
cgÉf_emissive_¡»ngth
 
emissive_¡»ngth
;

531 
cgÉf_œidesûnû
 
œidesûnû
;

532 
cgÉf_‹xtu»_v›w
 
nÜm®_‹xtu»
;

533 
cgÉf_‹xtu»_v›w
 
ocşusiÚ_‹xtu»
;

534 
cgÉf_‹xtu»_v›w
 
emissive_‹xtu»
;

535 
cgÉf_æßt
 
emissive_çùÜ
[3];

536 
cgÉf_®pha_mode
 
®pha_mode
;

537 
cgÉf_æßt
 
®pha_cutoff
;

538 
cgÉf_boŞ
 
doubË_sided
;

539 
cgÉf_boŞ
 
uÆ™
;

540 
cgÉf_exŒas
 
exŒas
;

541 
cgÉf_size
 
ex‹nsiÚs_couÁ
;

542 
cgÉf_ex‹nsiÚ
* 
ex‹nsiÚs
;

543 } 
	tcgÉf_m©”Ÿl
;

545 
	scgÉf_m©”Ÿl_m­pšg


547 
cgÉf_size
 
v¬ŸÁ
;

548 
cgÉf_m©”Ÿl
* 
m©”Ÿl
;

549 
cgÉf_exŒas
 
exŒas
;

550 } 
	tcgÉf_m©”Ÿl_m­pšg
;

552 
	scgÉf_mÜph_rg‘
 {

553 
cgÉf_©Œibu‹
* 
©Œibu‹s
;

554 
cgÉf_size
 
©Œibu‹s_couÁ
;

555 } 
	tcgÉf_mÜph_rg‘
;

557 
	scgÉf_d¿co_mesh_com´essiÚ
 {

558 
cgÉf_bufãr_v›w
* 
bufãr_v›w
;

559 
cgÉf_©Œibu‹
* 
©Œibu‹s
;

560 
cgÉf_size
 
©Œibu‹s_couÁ
;

561 } 
	tcgÉf_d¿co_mesh_com´essiÚ
;

563 
	scgÉf_mesh_gpu_š¡ªcšg
 {

564 
cgÉf_bufãr_v›w
* 
bufãr_v›w
;

565 
cgÉf_©Œibu‹
* 
©Œibu‹s
;

566 
cgÉf_size
 
©Œibu‹s_couÁ
;

567 } 
	tcgÉf_mesh_gpu_š¡ªcšg
;

569 
	scgÉf_´im™ive
 {

570 
cgÉf_´im™ive_ty³
 
ty³
;

571 
cgÉf_acûssÜ
* 
šdiûs
;

572 
cgÉf_m©”Ÿl
* 
m©”Ÿl
;

573 
cgÉf_©Œibu‹
* 
©Œibu‹s
;

574 
cgÉf_size
 
©Œibu‹s_couÁ
;

575 
cgÉf_mÜph_rg‘
* 
rg‘s
;

576 
cgÉf_size
 
rg‘s_couÁ
;

577 
cgÉf_exŒas
 
exŒas
;

578 
cgÉf_boŞ
 
has_d¿co_mesh_com´essiÚ
;

579 
cgÉf_d¿co_mesh_com´essiÚ
 
d¿co_mesh_com´essiÚ
;

580 
cgÉf_m©”Ÿl_m­pšg
* 
m­pšgs
;

581 
cgÉf_size
 
m­pšgs_couÁ
;

582 
cgÉf_size
 
ex‹nsiÚs_couÁ
;

583 
cgÉf_ex‹nsiÚ
* 
ex‹nsiÚs
;

584 } 
	tcgÉf_´im™ive
;

586 
	scgÉf_mesh
 {

587 * 
Çme
;

588 
cgÉf_´im™ive
* 
´im™ives
;

589 
cgÉf_size
 
´im™ives_couÁ
;

590 
cgÉf_æßt
* 
weights
;

591 
cgÉf_size
 
weights_couÁ
;

592 ** 
rg‘_Çmes
;

593 
cgÉf_size
 
rg‘_Çmes_couÁ
;

594 
cgÉf_exŒas
 
exŒas
;

595 
cgÉf_size
 
ex‹nsiÚs_couÁ
;

596 
cgÉf_ex‹nsiÚ
* 
ex‹nsiÚs
;

597 } 
	tcgÉf_mesh
;

599 
cgÉf_node
 
	tcgÉf_node
;

601 
	scgÉf_skš
 {

602 * 
Çme
;

603 
cgÉf_node
** 
jošts
;

604 
cgÉf_size
 
jošts_couÁ
;

605 
cgÉf_node
* 
sk–‘Ú
;

606 
cgÉf_acûssÜ
* 
šv”£_bšd_m©riûs
;

607 
cgÉf_exŒas
 
exŒas
;

608 
cgÉf_size
 
ex‹nsiÚs_couÁ
;

609 
cgÉf_ex‹nsiÚ
* 
ex‹nsiÚs
;

610 } 
	tcgÉf_skš
;

612 
	scgÉf_ÿm”a_³r¥eùive
 {

613 
cgÉf_boŞ
 
has_a¥eù_¿tio
;

614 
cgÉf_æßt
 
a¥eù_¿tio
;

615 
cgÉf_æßt
 
yfov
;

616 
cgÉf_boŞ
 
has_zçr
;

617 
cgÉf_æßt
 
zçr
;

618 
cgÉf_æßt
 
zÃ¬
;

619 
cgÉf_exŒas
 
exŒas
;

620 } 
	tcgÉf_ÿm”a_³r¥eùive
;

622 
	scgÉf_ÿm”a_Üthog¿phic
 {

623 
cgÉf_æßt
 
xmag
;

624 
cgÉf_æßt
 
ymag
;

625 
cgÉf_æßt
 
zçr
;

626 
cgÉf_æßt
 
zÃ¬
;

627 
cgÉf_exŒas
 
exŒas
;

628 } 
	tcgÉf_ÿm”a_Üthog¿phic
;

630 
	scgÉf_ÿm”a
 {

631 * 
Çme
;

632 
cgÉf_ÿm”a_ty³
 
ty³
;

634 
cgÉf_ÿm”a_³r¥eùive
 
³r¥eùive
;

635 
cgÉf_ÿm”a_Üthog¿phic
 
Üthog¿phic
;

636 } 
d©a
;

637 
cgÉf_exŒas
 
exŒas
;

638 
cgÉf_size
 
ex‹nsiÚs_couÁ
;

639 
cgÉf_ex‹nsiÚ
* 
ex‹nsiÚs
;

640 } 
	tcgÉf_ÿm”a
;

642 
	scgÉf_light
 {

643 * 
Çme
;

644 
cgÉf_æßt
 
cŞÜ
[3];

645 
cgÉf_æßt
 
š‹ns™y
;

646 
cgÉf_light_ty³
 
ty³
;

647 
cgÉf_æßt
 
¿nge
;

648 
cgÉf_æßt
 
¥Ù_šÃr_cÚe_ªgË
;

649 
cgÉf_æßt
 
¥Ù_ou‹r_cÚe_ªgË
;

650 
cgÉf_exŒas
 
exŒas
;

651 } 
	tcgÉf_light
;

653 
	scgÉf_node
 {

654 * 
Çme
;

655 
cgÉf_node
* 
·»Á
;

656 
cgÉf_node
** 
chd»n
;

657 
cgÉf_size
 
chd»n_couÁ
;

658 
cgÉf_skš
* 
skš
;

659 
cgÉf_mesh
* 
mesh
;

660 
cgÉf_ÿm”a
* 
ÿm”a
;

661 
cgÉf_light
* 
light
;

662 
cgÉf_æßt
* 
weights
;

663 
cgÉf_size
 
weights_couÁ
;

664 
cgÉf_boŞ
 
has_Œª¦©iÚ
;

665 
cgÉf_boŞ
 
has_rÙ©iÚ
;

666 
cgÉf_boŞ
 
has_sÿË
;

667 
cgÉf_boŞ
 
has_m©rix
;

668 
cgÉf_æßt
 
Œª¦©iÚ
[3];

669 
cgÉf_æßt
 
rÙ©iÚ
[4];

670 
cgÉf_æßt
 
sÿË
[3];

671 
cgÉf_æßt
 
m©rix
[16];

672 
cgÉf_exŒas
 
exŒas
;

673 
cgÉf_boŞ
 
has_mesh_gpu_š¡ªcšg
;

674 
cgÉf_mesh_gpu_š¡ªcšg
 
mesh_gpu_š¡ªcšg
;

675 
cgÉf_size
 
ex‹nsiÚs_couÁ
;

676 
cgÉf_ex‹nsiÚ
* 
ex‹nsiÚs
;

679 
	scgÉf_sûÃ
 {

680 * 
Çme
;

681 
cgÉf_node
** 
nodes
;

682 
cgÉf_size
 
nodes_couÁ
;

683 
cgÉf_exŒas
 
exŒas
;

684 
cgÉf_size
 
ex‹nsiÚs_couÁ
;

685 
cgÉf_ex‹nsiÚ
* 
ex‹nsiÚs
;

686 } 
	tcgÉf_sûÃ
;

688 
	scgÉf_ªim©iÚ_§m¶”
 {

689 
cgÉf_acûssÜ
* 
šput
;

690 
cgÉf_acûssÜ
* 
ouut
;

691 
cgÉf_š‹½Ş©iÚ_ty³
 
š‹½Ş©iÚ
;

692 
cgÉf_exŒas
 
exŒas
;

693 
cgÉf_size
 
ex‹nsiÚs_couÁ
;

694 
cgÉf_ex‹nsiÚ
* 
ex‹nsiÚs
;

695 } 
	tcgÉf_ªim©iÚ_§m¶”
;

697 
	scgÉf_ªim©iÚ_chªÃl
 {

698 
cgÉf_ªim©iÚ_§m¶”
* 
§m¶”
;

699 
cgÉf_node
* 
rg‘_node
;

700 
cgÉf_ªim©iÚ_·th_ty³
 
rg‘_·th
;

701 
cgÉf_exŒas
 
exŒas
;

702 
cgÉf_size
 
ex‹nsiÚs_couÁ
;

703 
cgÉf_ex‹nsiÚ
* 
ex‹nsiÚs
;

704 } 
	tcgÉf_ªim©iÚ_chªÃl
;

706 
	scgÉf_ªim©iÚ
 {

707 * 
Çme
;

708 
cgÉf_ªim©iÚ_§m¶”
* 
§m¶”s
;

709 
cgÉf_size
 
§m¶”s_couÁ
;

710 
cgÉf_ªim©iÚ_chªÃl
* 
chªÃls
;

711 
cgÉf_size
 
chªÃls_couÁ
;

712 
cgÉf_exŒas
 
exŒas
;

713 
cgÉf_size
 
ex‹nsiÚs_couÁ
;

714 
cgÉf_ex‹nsiÚ
* 
ex‹nsiÚs
;

715 } 
	tcgÉf_ªim©iÚ
;

717 
	scgÉf_m©”Ÿl_v¬ŸÁ


719 * 
Çme
;

720 
cgÉf_exŒas
 
exŒas
;

721 } 
	tcgÉf_m©”Ÿl_v¬ŸÁ
;

723 
	scgÉf_as£t
 {

724 * 
cİyright
;

725 * 
g’”©Ü
;

726 * 
v”siÚ
;

727 * 
mš_v”siÚ
;

728 
cgÉf_exŒas
 
exŒas
;

729 
cgÉf_size
 
ex‹nsiÚs_couÁ
;

730 
cgÉf_ex‹nsiÚ
* 
ex‹nsiÚs
;

731 } 
	tcgÉf_as£t
;

733 
	scgÉf_d©a


735 
cgÉf_fe_ty³
 
fe_ty³
;

736 * 
fe_d©a
;

738 
cgÉf_as£t
 
as£t
;

740 
cgÉf_mesh
* 
meshes
;

741 
cgÉf_size
 
meshes_couÁ
;

743 
cgÉf_m©”Ÿl
* 
m©”Ÿls
;

744 
cgÉf_size
 
m©”Ÿls_couÁ
;

746 
cgÉf_acûssÜ
* 
acûssÜs
;

747 
cgÉf_size
 
acûssÜs_couÁ
;

749 
cgÉf_bufãr_v›w
* 
bufãr_v›ws
;

750 
cgÉf_size
 
bufãr_v›ws_couÁ
;

752 
cgÉf_bufãr
* 
bufãrs
;

753 
cgÉf_size
 
bufãrs_couÁ
;

755 
cgÉf_image
* 
images
;

756 
cgÉf_size
 
images_couÁ
;

758 
cgÉf_‹xtu»
* 
‹xtu»s
;

759 
cgÉf_size
 
‹xtu»s_couÁ
;

761 
cgÉf_§m¶”
* 
§m¶”s
;

762 
cgÉf_size
 
§m¶”s_couÁ
;

764 
cgÉf_skš
* 
skšs
;

765 
cgÉf_size
 
skšs_couÁ
;

767 
cgÉf_ÿm”a
* 
ÿm”as
;

768 
cgÉf_size
 
ÿm”as_couÁ
;

770 
cgÉf_light
* 
lights
;

771 
cgÉf_size
 
lights_couÁ
;

773 
cgÉf_node
* 
nodes
;

774 
cgÉf_size
 
nodes_couÁ
;

776 
cgÉf_sûÃ
* 
sûÃs
;

777 
cgÉf_size
 
sûÃs_couÁ
;

779 
cgÉf_sûÃ
* 
sûÃ
;

781 
cgÉf_ªim©iÚ
* 
ªim©iÚs
;

782 
cgÉf_size
 
ªim©iÚs_couÁ
;

784 
cgÉf_m©”Ÿl_v¬ŸÁ
* 
v¬ŸÁs
;

785 
cgÉf_size
 
v¬ŸÁs_couÁ
;

787 
cgÉf_exŒas
 
exŒas
;

789 
cgÉf_size
 
d©a_ex‹nsiÚs_couÁ
;

790 
cgÉf_ex‹nsiÚ
* 
d©a_ex‹nsiÚs
;

792 ** 
ex‹nsiÚs_u£d
;

793 
cgÉf_size
 
ex‹nsiÚs_u£d_couÁ
;

795 ** 
ex‹nsiÚs_»quœed
;

796 
cgÉf_size
 
ex‹nsiÚs_»quœed_couÁ
;

798 cÚ¡ * 
jsÚ
;

799 
cgÉf_size
 
jsÚ_size
;

801 cÚ¡ * 
bš
;

802 
cgÉf_size
 
bš_size
;

804 
cgÉf_memÜy_İtiÚs
 
memÜy
;

805 
cgÉf_fe_İtiÚs
 
fe
;

806 } 
	tcgÉf_d©a
;

808 
cgÉf_»suÉ
 
cgÉf_·r£
(

809 cÚ¡ 
cgÉf_İtiÚs
* 
İtiÚs
,

810 cÚ¡ * 
d©a
,

811 
cgÉf_size
 
size
,

812 
cgÉf_d©a
** 
out_d©a
);

814 
cgÉf_»suÉ
 
cgÉf_·r£_fe
(

815 cÚ¡ 
cgÉf_İtiÚs
* 
İtiÚs
,

816 cÚ¡ * 
·th
,

817 
cgÉf_d©a
** 
out_d©a
);

819 
cgÉf_»suÉ
 
cgÉf_lßd_bufãrs
(

820 cÚ¡ 
cgÉf_İtiÚs
* 
İtiÚs
,

821 
cgÉf_d©a
* 
d©a
,

822 cÚ¡ * 
gÉf_·th
);

824 
cgÉf_»suÉ
 
cgÉf_lßd_bufãr_ba£64
(cÚ¡ 
cgÉf_İtiÚs
* 
İtiÚs
, 
cgÉf_size
 
size
, cÚ¡ * 
ba£64
, ** 
out_d©a
);

826 
cgÉf_size
 
cgÉf_decode_¡ršg
(* 
¡ršg
);

827 
cgÉf_size
 
cgÉf_decode_uri
(* 
uri
);

829 
cgÉf_»suÉ
 
cgÉf_v®id©e
(
cgÉf_d©a
* 
d©a
);

831 
cgÉf_ä“
(
cgÉf_d©a
* 
d©a
);

833 
cgÉf_node_ŒªsfÜm_loÿl
(cÚ¡ 
cgÉf_node
* 
node
, 
cgÉf_æßt
* 
out_m©rix
);

834 
cgÉf_node_ŒªsfÜm_wÜld
(cÚ¡ 
cgÉf_node
* 
node
, 
cgÉf_æßt
* 
out_m©rix
);

836 
cgÉf_boŞ
 
cgÉf_acûssÜ_»ad_æßt
(cÚ¡ 
cgÉf_acûssÜ
* 
acûssÜ
, 
cgÉf_size
 
šdex
, 
cgÉf_æßt
* 
out
, cgÉf_siz
–em’t_size
);

837 
cgÉf_boŞ
 
cgÉf_acûssÜ_»ad_ušt
(cÚ¡ 
cgÉf_acûssÜ
* 
acûssÜ
, 
cgÉf_size
 
šdex
, 
cgÉf_ušt
* 
out
, cgÉf_siz
–em’t_size
);

838 
cgÉf_size
 
cgÉf_acûssÜ_»ad_šdex
(cÚ¡ 
cgÉf_acûssÜ
* 
acûssÜ
, cgÉf_siz
šdex
);

840 
cgÉf_size
 
cgÉf_num_compÚ’ts
(
cgÉf_ty³
 
ty³
);

842 
cgÉf_size
 
cgÉf_acûssÜ_uÅack_æßts
(cÚ¡ 
cgÉf_acûssÜ
* 
acûssÜ
, 
cgÉf_æßt
* 
out
, cgÉf_siz
æßt_couÁ
);

844 
cgÉf_»suÉ
 
cgÉf_cİy_exŒas_jsÚ
(cÚ¡ 
cgÉf_d©a
* 
d©a
, cÚ¡ 
cgÉf_exŒas
* 
exŒas
, * 
de¡
, 
cgÉf_size
* 
de¡_size
);

846 #ifdeà
__ılu¥lus


859 #ià
defšed
(
__INTELLISENSE__
è|| defšed(
__JETBRAINS_IDE__
)

861 
	#CGLTF_IMPLEMENTATION


	)

864 #ifdeà
CGLTF_IMPLEMENTATION


866 
	~<¡dšt.h
>

867 
	~<¡ršg.h
>

868 
	~<¡dio.h
>

869 
	~<lim™s.h
>

870 
	~<æßt.h
>

872 #ià!
defšed
(
CGLTF_MALLOC
è|| !defšed(
CGLTF_FREE
è|| !defšed(
CGLTF_ATOI
è|| !defšed(
CGLTF_ATOF
è|| !defšed(
CGLTF_ATOLL
)

873 
	~<¡dlib.h
>

876 #ià
CGLTF_VALIDATE_ENABLE_ASSERTS


877 
	~<as£¹.h
>

881 
	#JSMN_PARENT_LINKS


	)

884 
	#JSMN_STRICT


	)

892 
JSMN_UNDEFINED
 = 0,

893 
JSMN_OBJECT
 = 1,

894 
JSMN_ARRAY
 = 2,

895 
JSMN_STRING
 = 3,

896 
JSMN_PRIMITIVE
 = 4

897 } 
	tjsmÁy³_t
;

898 
	ejsmÃ¼
 {

900 
	mJSMN_ERROR_NOMEM
 = -1,

902 
	mJSMN_ERROR_INVAL
 = -2,

904 
	mJSMN_ERROR_PART
 = -3

907 
jsmÁy³_t
 
	mty³
;

908 
	m¡¬t
;

909 
	m’d
;

910 
	msize
;

911 #ifdeà
JSMN_PARENT_LINKS


912 
	m·»Á
;

914 } 
	tjsmÁok_t
;

916 
	mpos
;

917 
	mtokÃxt
;

918 
	mtoksu³r
;

919 } 
	tjsmn_·r£r
;

920 
jsmn_š™
(
jsmn_·r£r
 *
·r£r
);

921 
jsmn_·r£
(
jsmn_·r£r
 *
·r£r
, cÚ¡ *
js
, 
size_t
 
Ën
, 
jsmÁok_t
 *
tok’s
, size_ˆ
num_tok’s
);

927 cÚ¡ 
cgÉf_size
 
	gGlbH—d”Size
 = 12;

928 cÚ¡ 
cgÉf_size
 
	gGlbChunkH—d”Size
 = 8;

929 cÚ¡ 
ušt32_t
 
	gGlbV”siÚ
 = 2;

930 cÚ¡ 
ušt32_t
 
	gGlbMagic
 = 0x46546C67;

931 cÚ¡ 
ušt32_t
 
	gGlbMagicJsÚChunk
 = 0x4E4F534A;

932 cÚ¡ 
ušt32_t
 
	gGlbMagicBšChunk
 = 0x004E4942;

934 #iâdeà
CGLTF_MALLOC


935 
	#CGLTF_MALLOC
(
size
è
	`m®loc
(size)

	)

937 #iâdeà
CGLTF_FREE


938 
	#CGLTF_FREE
(
±r
è
	`ä“
ÕŒ)

	)

940 #iâdeà
CGLTF_ATOI


941 
	#CGLTF_ATOI
(
¡r
è
	`©oi
(¡r)

	)

943 #iâdeà
CGLTF_ATOF


944 
	#CGLTF_ATOF
(
¡r
è
	`©of
(¡r)

	)

946 #iâdeà
CGLTF_ATOLL


947 
	#CGLTF_ATOLL
(
¡r
è
	`©Şl
(¡r)

	)

949 #iâdeà
CGLTF_VALIDATE_ENABLE_ASSERTS


950 
	#CGLTF_VALIDATE_ENABLE_ASSERTS
 0

	)

953 * 
	$cgÉf_deçuÉ_®loc
(* 
u£r
, 
cgÉf_size
 
size
)

955 ()
u£r
;

956  
	`CGLTF_MALLOC
(
size
);

957 
	}
}

959 
	$cgÉf_deçuÉ_ä“
(* 
u£r
, * 
±r
)

961 ()
u£r
;

962 
	`CGLTF_FREE
(
±r
);

963 
	}
}

965 * 
	$cgÉf_ÿÎoc
(
cgÉf_İtiÚs
* 
İtiÚs
, 
size_t
 
–em’t_size
, 
cgÉf_size
 
couÁ
)

967 ià(
SIZE_MAX
 / 
–em’t_size
 < 
couÁ
)

969  
NULL
;

971 * 
»suÉ
 = 
İtiÚs
->
memÜy
.
	`®loc_func
(İtiÚs->memÜy.
u£r_d©a
, 
–em’t_size
 * 
couÁ
);

972 ià(!
»suÉ
)

974  
NULL
;

976 
	`mem£t
(
»suÉ
, 0, 
–em’t_size
 * 
couÁ
);

977  
»suÉ
;

978 
	}
}

980 
cgÉf_»suÉ
 
	$cgÉf_deçuÉ_fe_»ad
(cÚ¡ 
cgÉf_memÜy_İtiÚs
* 
memÜy_İtiÚs
, cÚ¡ 
cgÉf_fe_İtiÚs
* 
fe_İtiÚs
, cÚ¡ * 
·th
, 
cgÉf_size
* 
size
, ** 
d©a
)

982 ()
fe_İtiÚs
;

983 * (*
memÜy_®loc
)(*, 
cgÉf_size
èğ
memÜy_İtiÚs
->
®loc_func
 ? memÜy_İtiÚs->®loc_funø: &
cgÉf_deçuÉ_®loc
;

984 (*
memÜy_ä“
)(*, *èğ
memÜy_İtiÚs
->
ä“_func
 ? memÜy_İtiÚs->ä“_funø: &
cgÉf_deçuÉ_ä“
;

986 
FILE
* 
fe
 = 
	`fİ’
(
·th
, "rb");

987 ià(!
fe
)

989  
cgÉf_»suÉ_fe_nÙ_found
;

992 
cgÉf_size
 
fe_size
 = 
size
 ? *size : 0;

994 ià(
fe_size
 == 0)

996 
	`f£ek
(
fe
, 0, 
SEEK_END
);

998 #ifdeà
_WIN32


999 
__št64
 
Ëngth
 = 
	`_á–li64
(
fe
);

1001 
Ëngth
 = 
	`á–l
(
fe
);

1004 ià(
Ëngth
 < 0)

1006 
	`fşo£
(
fe
);

1007  
cgÉf_»suÉ_io_”rÜ
;

1010 
	`f£ek
(
fe
, 0, 
SEEK_SET
);

1011 
fe_size
 = (
cgÉf_size
)
Ëngth
;

1014 * 
fe_d©a
 = (*)
	`memÜy_®loc
(
memÜy_İtiÚs
->
u£r_d©a
, 
fe_size
);

1015 ià(!
fe_d©a
)

1017 
	`fşo£
(
fe
);

1018  
cgÉf_»suÉ_out_of_memÜy
;

1021 
cgÉf_size
 
»ad_size
 = 
	`ä—d
(
fe_d©a
, 1, 
fe_size
, 
fe
);

1023 
	`fşo£
(
fe
);

1025 ià(
»ad_size
 !ğ
fe_size
)

1027 
	`memÜy_ä“
(
memÜy_İtiÚs
->
u£r_d©a
, 
fe_d©a
);

1028  
cgÉf_»suÉ_io_”rÜ
;

1031 ià(
size
)

1033 *
size
 = 
fe_size
;

1035 ià(
d©a
)

1037 *
d©a
 = 
fe_d©a
;

1040  
cgÉf_»suÉ_sucûss
;

1041 
	}
}

1043 
	$cgÉf_deçuÉ_fe_»Ëa£
(cÚ¡ 
cgÉf_memÜy_İtiÚs
* 
memÜy_İtiÚs
, cÚ¡ 
cgÉf_fe_İtiÚs
* 
fe_İtiÚs
, * 
d©a
)

1045 ()
fe_İtiÚs
;

1046 (*
memä“
)(*, *èğ
memÜy_İtiÚs
->
ä“_func
 ? memÜy_İtiÚs->ä“_funø: &
cgÉf_deçuÉ_ä“
;

1047 
	`memä“
(
memÜy_İtiÚs
->
u£r_d©a
, 
d©a
);

1048 
	}
}

1050 
cgÉf_»suÉ
 
cgÉf_·r£_jsÚ
(
cgÉf_İtiÚs
* 
İtiÚs
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_size
 
size
, 
cgÉf_d©a
** 
out_d©a
);

1052 
cgÉf_»suÉ
 
	$cgÉf_·r£
(cÚ¡ 
cgÉf_İtiÚs
* 
İtiÚs
, cÚ¡ * 
d©a
, 
cgÉf_size
 
size
, 
cgÉf_d©a
** 
out_d©a
)

1054 ià(
size
 < 
GlbH—d”Size
)

1056  
cgÉf_»suÉ_d©a_too_shÜt
;

1059 ià(
İtiÚs
 =ğ
NULL
)

1061  
cgÉf_»suÉ_šv®id_İtiÚs
;

1064 
cgÉf_İtiÚs
 
fixed_İtiÚs
 = *
İtiÚs
;

1065 ià(
fixed_İtiÚs
.
memÜy
.
®loc_func
 =ğ
NULL
)

1067 
fixed_İtiÚs
.
memÜy
.
®loc_func
 = &
cgÉf_deçuÉ_®loc
;

1069 ià(
fixed_İtiÚs
.
memÜy
.
ä“_func
 =ğ
NULL
)

1071 
fixed_İtiÚs
.
memÜy
.
ä“_func
 = &
cgÉf_deçuÉ_ä“
;

1074 
ušt32_t
 
tmp
;

1076 
	`memıy
(&
tmp
, 
d©a
, 4);

1077 ià(
tmp
 !ğ
GlbMagic
)

1079 ià(
fixed_İtiÚs
.
ty³
 =ğ
cgÉf_fe_ty³_šv®id
)

1081 
fixed_İtiÚs
.
ty³
 = 
cgÉf_fe_ty³_gÉf
;

1083 ià(
fixed_İtiÚs
.
ty³
 =ğ
cgÉf_fe_ty³_glb
)

1085  
cgÉf_»suÉ_unknown_fÜm©
;

1089 ià(
fixed_İtiÚs
.
ty³
 =ğ
cgÉf_fe_ty³_gÉf
)

1091 
cgÉf_»suÉ
 
jsÚ_»suÉ
 = 
	`cgÉf_·r£_jsÚ
(&
fixed_İtiÚs
, (cÚ¡ 
ušt8_t
*)
d©a
, 
size
, 
out_d©a
);

1092 ià(
jsÚ_»suÉ
 !ğ
cgÉf_»suÉ_sucûss
)

1094  
jsÚ_»suÉ
;

1097 (*
out_d©a
)->
fe_ty³
 = 
cgÉf_fe_ty³_gÉf
;

1099  
cgÉf_»suÉ_sucûss
;

1102 cÚ¡ 
ušt8_t
* 
±r
 = (cÚ¡ ušt8_t*)
d©a
;

1104 
	`memıy
(&
tmp
, 
±r
 + 4, 4);

1105 
ušt32_t
 
v”siÚ
 = 
tmp
;

1106 ià(
v”siÚ
 !ğ
GlbV”siÚ
)

1108  
v”siÚ
 < 
GlbV”siÚ
 ? 
cgÉf_»suÉ_Ëgacy_gÉf
 : 
cgÉf_»suÉ_unknown_fÜm©
;

1112 
	`memıy
(&
tmp
, 
±r
 + 8, 4);

1113 ià(
tmp
 > 
size
)

1115  
cgÉf_»suÉ_d©a_too_shÜt
;

1118 cÚ¡ 
ušt8_t
* 
jsÚ_chunk
 = 
±r
 + 
GlbH—d”Size
;

1120 ià(
GlbH—d”Size
 + 
GlbChunkH—d”Size
 > 
size
)

1122  
cgÉf_»suÉ_d©a_too_shÜt
;

1126 
ušt32_t
 
jsÚ_Ëngth
;

1127 
	`memıy
(&
jsÚ_Ëngth
, 
jsÚ_chunk
, 4);

1128 ià(
GlbH—d”Size
 + 
GlbChunkH—d”Size
 + 
jsÚ_Ëngth
 > 
size
)

1130  
cgÉf_»suÉ_d©a_too_shÜt
;

1134 
	`memıy
(&
tmp
, 
jsÚ_chunk
 + 4, 4);

1135 ià(
tmp
 !ğ
GlbMagicJsÚChunk
)

1137  
cgÉf_»suÉ_unknown_fÜm©
;

1140 
jsÚ_chunk
 +ğ
GlbChunkH—d”Size
;

1142 cÚ¡ * 
bš
 = 0;

1143 
cgÉf_size
 
bš_size
 = 0;

1145 ià(
GlbH—d”Size
 + 
GlbChunkH—d”Size
 + 
jsÚ_Ëngth
 + GlbChunkH—d”Siz<ğ
size
)

1148 cÚ¡ 
ušt8_t
* 
bš_chunk
 = 
jsÚ_chunk
 + 
jsÚ_Ëngth
;

1151 
ušt32_t
 
bš_Ëngth
;

1152 
	`memıy
(&
bš_Ëngth
, 
bš_chunk
, 4);

1153 ià(
GlbH—d”Size
 + 
GlbChunkH—d”Size
 + 
jsÚ_Ëngth
 + GlbChunkH—d”Siz+ 
bš_Ëngth
 > 
size
)

1155  
cgÉf_»suÉ_d©a_too_shÜt
;

1159 
	`memıy
(&
tmp
, 
bš_chunk
 + 4, 4);

1160 ià(
tmp
 !ğ
GlbMagicBšChunk
)

1162  
cgÉf_»suÉ_unknown_fÜm©
;

1165 
bš_chunk
 +ğ
GlbChunkH—d”Size
;

1167 
bš
 = 
bš_chunk
;

1168 
bš_size
 = 
bš_Ëngth
;

1171 
cgÉf_»suÉ
 
jsÚ_»suÉ
 = 
	`cgÉf_·r£_jsÚ
(&
fixed_İtiÚs
, 
jsÚ_chunk
, 
jsÚ_Ëngth
, 
out_d©a
);

1172 ià(
jsÚ_»suÉ
 !ğ
cgÉf_»suÉ_sucûss
)

1174  
jsÚ_»suÉ
;

1177 (*
out_d©a
)->
fe_ty³
 = 
cgÉf_fe_ty³_glb
;

1178 (*
out_d©a
)->
bš
 = bin;

1179 (*
out_d©a
)->
bš_size
 = bin_size;

1181  
cgÉf_»suÉ_sucûss
;

1182 
	}
}

1184 
cgÉf_»suÉ
 
	$cgÉf_·r£_fe
(cÚ¡ 
cgÉf_İtiÚs
* 
İtiÚs
, cÚ¡ * 
·th
, 
cgÉf_d©a
** 
out_d©a
)

1186 ià(
İtiÚs
 =ğ
NULL
)

1188  
cgÉf_»suÉ_šv®id_İtiÚs
;

1191 
	`cgÉf_»suÉ
 (*
fe_»ad
)(cÚ¡ 
cgÉf_memÜy_İtiÚs
*, cÚ¡ 
cgÉf_fe_İtiÚs
*, cÚ¡ *, 
cgÉf_size
*, **èğ
İtiÚs
->
fe
.
»ad
 ? o±iÚs->fe.»ad : &
cgÉf_deçuÉ_fe_»ad
;

1192 (*
fe_»Ëa£
)(cÚ¡ 
cgÉf_memÜy_İtiÚs
*, cÚ¡ 
cgÉf_fe_İtiÚs
*, * 
d©a
èğ
İtiÚs
->
fe
.
»Ëa£
 ? o±iÚs->fe.»Ëa£ : 
cgÉf_deçuÉ_fe_»Ëa£
;

1194 * 
fe_d©a
 = 
NULL
;

1195 
cgÉf_size
 
fe_size
 = 0;

1196 
cgÉf_»suÉ
 
»suÉ
 = 
	`fe_»ad
(&
İtiÚs
->
memÜy
, &İtiÚs->
fe
, 
·th
, &
fe_size
, &
fe_d©a
);

1197 ià(
»suÉ
 !ğ
cgÉf_»suÉ_sucûss
)

1199  
»suÉ
;

1202 
»suÉ
 = 
	`cgÉf_·r£
(
İtiÚs
, 
fe_d©a
, 
fe_size
, 
out_d©a
);

1204 ià(
»suÉ
 !ğ
cgÉf_»suÉ_sucûss
)

1206 
	`fe_»Ëa£
(&
İtiÚs
->
memÜy
, &İtiÚs->
fe
, 
fe_d©a
);

1207  
»suÉ
;

1210 (*
out_d©a
)->
fe_d©a
 = file_data;

1212  
cgÉf_»suÉ_sucûss
;

1213 
	}
}

1215 
	$cgÉf_combše_·ths
(* 
·th
, cÚ¡ * 
ba£
, cÚ¡ * 
uri
)

1217 cÚ¡ * 
s0
 = 
	`¡¼chr
(
ba£
, '/');

1218 cÚ¡ * 
s1
 = 
	`¡¼chr
(
ba£
, '\\');

1219 cÚ¡ * 
¦ash
 = 
s0
 ? (
s1
 && s1 > s0 ? s1 : s0) : s1;

1221 ià(
¦ash
)

1223 
size_t
 
´efix
 = 
¦ash
 - 
ba£
 + 1;

1225 
	`¡ºıy
(
·th
, 
ba£
, 
´efix
);

1226 
	`¡rıy
(
·th
 + 
´efix
, 
uri
);

1230 
	`¡rıy
(
·th
, 
uri
);

1232 
	}
}

1234 
cgÉf_»suÉ
 
	$cgÉf_lßd_bufãr_fe
(cÚ¡ 
cgÉf_İtiÚs
* 
İtiÚs
, 
cgÉf_size
 
size
, cÚ¡ * 
uri
, cÚ¡ * 
gÉf_·th
, ** 
out_d©a
)

1236 * (*
memÜy_®loc
)(*, 
cgÉf_size
èğ
İtiÚs
->
memÜy
.
®loc_func
 ? o±iÚs->memÜy.®loc_funø: &
cgÉf_deçuÉ_®loc
;

1237 (*
memÜy_ä“
)(*, *èğ
İtiÚs
->
memÜy
.
ä“_func
 ? o±iÚs->memÜy.ä“_funø: &
cgÉf_deçuÉ_ä“
;

1238 
	`cgÉf_»suÉ
 (*
fe_»ad
)(cÚ¡ 
cgÉf_memÜy_İtiÚs
*, cÚ¡ 
cgÉf_fe_İtiÚs
*, cÚ¡ *, 
cgÉf_size
*, **èğ
İtiÚs
->
fe
.
»ad
 ? o±iÚs->fe.»ad : &
cgÉf_deçuÉ_fe_»ad
;

1240 * 
·th
 = (*)
	`memÜy_®loc
(
İtiÚs
->
memÜy
.
u£r_d©a
, 
	`¡¾’
(
uri
è+ sŒËn(
gÉf_·th
) + 1);

1241 ià(!
·th
)

1243  
cgÉf_»suÉ_out_of_memÜy
;

1246 
	`cgÉf_combše_·ths
(
·th
, 
gÉf_·th
, 
uri
);

1249 
	`cgÉf_decode_uri
(
·th
 + 
	`¡¾’
Õ©hè- sŒËn(
uri
));

1251 * 
fe_d©a
 = 
NULL
;

1252 
cgÉf_»suÉ
 
»suÉ
 = 
	`fe_»ad
(&
İtiÚs
->
memÜy
, &İtiÚs->
fe
, 
·th
, &
size
, &
fe_d©a
);

1254 
	`memÜy_ä“
(
İtiÚs
->
memÜy
.
u£r_d©a
, 
·th
);

1256 *
out_d©a
 = (
»suÉ
 =ğ
cgÉf_»suÉ_sucûss
è? 
fe_d©a
 : 
NULL
;

1258  
»suÉ
;

1259 
	}
}

1261 
cgÉf_»suÉ
 
	$cgÉf_lßd_bufãr_ba£64
(cÚ¡ 
cgÉf_İtiÚs
* 
İtiÚs
, 
cgÉf_size
 
size
, cÚ¡ * 
ba£64
, ** 
out_d©a
)

1263 * (*
memÜy_®loc
)(*, 
cgÉf_size
èğ
İtiÚs
->
memÜy
.
®loc_func
 ? o±iÚs->memÜy.®loc_funø: &
cgÉf_deçuÉ_®loc
;

1264 (*
memÜy_ä“
)(*, *èğ
İtiÚs
->
memÜy
.
ä“_func
 ? o±iÚs->memÜy.ä“_funø: &
cgÉf_deçuÉ_ä“
;

1266 * 
d©a
 = (*)
	`memÜy_®loc
(
İtiÚs
->
memÜy
.
u£r_d©a
, 
size
);

1267 ià(!
d©a
)

1269  
cgÉf_»suÉ_out_of_memÜy
;

1272 
bufãr
 = 0;

1273 
bufãr_b™s
 = 0;

1275 
cgÉf_size
 
i
 = 0; i < 
size
; ++i)

1277 
bufãr_b™s
 < 8)

1279 
ch
 = *
ba£64
++;

1281 
šdex
 =

1282 ()(
ch
 - 'A') < 26 ? (ch - 'A') :

1283 ()(
ch
 - 'a') < 26 ? (ch - 'a') + 26 :

1284 ()(
ch
 - '0') < 10 ? (ch - '0') + 52 :

1285 
ch
 == '+' ? 62 :

1286 
ch
 == '/' ? 63 :

1289 ià(
šdex
 < 0)

1291 
	`memÜy_ä“
(
İtiÚs
->
memÜy
.
u£r_d©a
, 
d©a
);

1292  
cgÉf_»suÉ_io_”rÜ
;

1295 
bufãr
 = (bufã¸<< 6è| 
šdex
;

1296 
bufãr_b™s
 += 6;

1299 
d©a
[
i
] = ()(
bufãr
 >> (
bufãr_b™s
 - 8));

1300 
bufãr_b™s
 -= 8;

1303 *
out_d©a
 = 
d©a
;

1305  
cgÉf_»suÉ_sucûss
;

1306 
	}
}

1308 
	$cgÉf_unhex
(
ch
)

1311 ()(
ch
 - '0') < 10 ? (ch - '0') :

1312 ()(
ch
 - 'A') < 6 ? (ch - 'A') + 10 :

1313 ()(
ch
 - 'a') < 6 ? (ch - 'a') + 10 :

1315 
	}
}

1317 
cgÉf_size
 
	$cgÉf_decode_¡ršg
(* 
¡ršg
)

1319 * 
»ad
 = 
¡ršg
 + 
	`¡rc¥n
(string, "\\");

1320 ià(*
»ad
 == 0)

1322  
»ad
 - 
¡ršg
;

1324 * 
wr™e
 = 
¡ršg
;

1325 * 
Ï¡
 = 
¡ršg
;

1330 
cgÉf_size
 
wr™‹n
 = 
»ad
 - 
Ï¡
;

1331 
	`memmove
(
wr™e
, 
Ï¡
, 
wr™‹n
);

1332 
wr™e
 +ğ
wr™‹n
;

1334 ià(*
»ad
++ == 0)

1340 *
»ad
++)

1342 '\"': *
wr™e
++ = '\"'; ;

1343 '/': *
wr™e
++ = '/'; ;

1344 '\\': *
wr™e
++ = '\\'; ;

1345 'b': *
wr™e
++ = '\b'; ;

1346 'f': *
wr™e
++ = '\f'; ;

1347 'r': *
wr™e
++ = '\r'; ;

1348 'n': *
wr™e
++ = '\n'; ;

1349 't': *
wr™e
++ = '\t'; ;

1353 
ch¬aù”
 = 0;

1354 
cgÉf_size
 
i
 = 0; i < 4; ++i)

1356 
ch¬aù”
 = (ch¬aù” << 4è+ 
	`cgÉf_unhex
(*
»ad
++);

1359 ià(
ch¬aù”
 <= 0x7F)

1361 *
wr™e
++ = 
ch¬aù”
 & 0xFF;

1363 ià(
ch¬aù”
 <= 0x7FF)

1365 *
wr™e
++ = 0xC0 | ((
ch¬aù”
 >> 6) & 0xFF);

1366 *
wr™e
++ = 0x80 | (
ch¬aù”
 & 0x3F);

1370 *
wr™e
++ = 0xE0 | ((
ch¬aù”
 >> 12) & 0xFF);

1371 *
wr™e
++ = 0x80 | ((
ch¬aù”
 >> 6) & 0x3F);

1372 *
wr™e
++ = 0x80 | (
ch¬aù”
 & 0x3F);

1380 
Ï¡
 = 
»ad
;

1381 
»ad
 +ğ
	`¡rc¥n
(read, "\\");

1384 *
wr™e
 = 0;

1385  
wr™e
 - 
¡ršg
;

1386 
	}
}

1388 
cgÉf_size
 
	$cgÉf_decode_uri
(* 
uri
)

1390 * 
wr™e
 = 
uri
;

1391 * 
i
 = 
uri
;

1393 *
i
)

1395 ià(*
i
 == '%')

1397 
ch1
 = 
	`cgÉf_unhex
(
i
[1]);

1399 ià(
ch1
 >= 0)

1401 
ch2
 = 
	`cgÉf_unhex
(
i
[2]);

1403 ià(
ch2
 >= 0)

1405 *
wr™e
++ = ()(
ch1
 * 16 + 
ch2
);

1406 
i
 += 3;

1412 *
wr™e
++ = *
i
++;

1415 *
wr™e
 = 0;

1416  
wr™e
 - 
uri
;

1417 
	}
}

1419 
cgÉf_»suÉ
 
	$cgÉf_lßd_bufãrs
(cÚ¡ 
cgÉf_İtiÚs
* 
İtiÚs
, 
cgÉf_d©a
* 
d©a
, cÚ¡ * 
gÉf_·th
)

1421 ià(
İtiÚs
 =ğ
NULL
)

1423  
cgÉf_»suÉ_šv®id_İtiÚs
;

1426 ià(
d©a
->
bufãrs_couÁ
 && d©a->
bufãrs
[0].d©¨=ğ
NULL
 && d©a->bufãrs[0].
uri
 =ğNULL && d©a->
bš
)

1428 ià(
d©a
->
bš_size
 < d©a->
bufãrs
[0].
size
)

1430  
cgÉf_»suÉ_d©a_too_shÜt
;

1433 
d©a
->
bufãrs
[0].d©¨ğ(*)d©a->
bš
;

1434 
d©a
->
bufãrs
[0].
d©a_ä“_m‘hod
 = 
cgÉf_d©a_ä“_m‘hod_nÚe
;

1437 
cgÉf_size
 
i
 = 0; i < 
d©a
->
bufãrs_couÁ
; ++i)

1439 ià(
d©a
->
bufãrs
[
i
].data)

1444 cÚ¡ * 
uri
 = 
d©a
->
bufãrs
[
i
].uri;

1446 ià(
uri
 =ğ
NULL
)

1451 ià(
	`¡ºcmp
(
uri
, "data:", 5) == 0)

1453 cÚ¡ * 
comma
 = 
	`¡rchr
(
uri
, ',');

1455 ià(
comma
 && comm¨- 
uri
 >ğ7 && 
	`¡ºcmp
(comma - 7, ";base64", 7) == 0)

1457 
cgÉf_»suÉ
 
»s
 = 
	`cgÉf_lßd_bufãr_ba£64
(
İtiÚs
, 
d©a
->
bufãrs
[
i
].
size
, 
comma
 + 1, &data->buffers[i].data);

1458 
d©a
->
bufãrs
[
i
].
d©a_ä“_m‘hod
 = 
cgÉf_d©a_ä“_m‘hod_memÜy_ä“
;

1460 ià(
»s
 !ğ
cgÉf_»suÉ_sucûss
)

1462  
»s
;

1467  
cgÉf_»suÉ_unknown_fÜm©
;

1470 ià(
	`¡r¡r
(
uri
, "://"è=ğ
NULL
 && 
gÉf_·th
)

1472 
cgÉf_»suÉ
 
»s
 = 
	`cgÉf_lßd_bufãr_fe
(
İtiÚs
, 
d©a
->
bufãrs
[
i
].
size
, 
uri
, 
gÉf_·th
, &data->buffers[i].data);

1473 
d©a
->
bufãrs
[
i
].
d©a_ä“_m‘hod
 = 
cgÉf_d©a_ä“_m‘hod_fe_»Ëa£
;

1475 ià(
»s
 !ğ
cgÉf_»suÉ_sucûss
)

1477  
»s
;

1482  
cgÉf_»suÉ_unknown_fÜm©
;

1486  
cgÉf_»suÉ_sucûss
;

1487 
	}
}

1489 
cgÉf_size
 
cgÉf_ÿlc_size
(
cgÉf_ty³
 
ty³
, 
cgÉf_compÚ’t_ty³
 
compÚ’t_ty³
);

1491 
cgÉf_size
 
	$cgÉf_ÿlc_šdex_bound
(
cgÉf_bufãr_v›w
* 
bufãr_v›w
, 
cgÉf_size
 
off£t
, 
cgÉf_compÚ’t_ty³
 
compÚ’t_ty³
, cgÉf_siz
couÁ
)

1493 * 
d©a
 = (*)
bufãr_v›w
->
bufãr
->d©¨+ 
off£t
 + buffer_view->offset;

1494 
cgÉf_size
 
bound
 = 0;

1496 
compÚ’t_ty³
)

1498 
cgÉf_compÚ’t_ty³_r_8u
:

1499 
size_t
 
i
 = 0; i < 
couÁ
; ++i)

1501 
cgÉf_size
 
v
 = ((*)
d©a
)[
i
];

1502 
bound
 = bound > 
v
 ? bound : v;

1506 
cgÉf_compÚ’t_ty³_r_16u
:

1507 
size_t
 
i
 = 0; i < 
couÁ
; ++i)

1509 
cgÉf_size
 
v
 = ((*)
d©a
)[
i
];

1510 
bound
 = bound > 
v
 ? bound : v;

1514 
cgÉf_compÚ’t_ty³_r_32u
:

1515 
size_t
 
i
 = 0; i < 
couÁ
; ++i)

1517 
cgÉf_size
 
v
 = ((*)
d©a
)[
i
];

1518 
bound
 = bound > 
v
 ? bound : v;

1526  
bound
;

1527 
	}
}

1529 #ià
CGLTF_VALIDATE_ENABLE_ASSERTS


1530 
	#CGLTF_ASSERT_IF
(
cÚd
, 
»suÉ
è
	`as£¹
(!(cÚd)); ià(cÚdè„esuÉ;

	)

1532 
	#CGLTF_ASSERT_IF
(
cÚd
, 
»suÉ
èià(cÚdè„esuÉ;

	)

1535 
cgÉf_»suÉ
 
	$cgÉf_v®id©e
(
cgÉf_d©a
* 
d©a
)

1537 
cgÉf_size
 
i
 = 0; i < 
d©a
->
acûssÜs_couÁ
; ++i)

1539 
cgÉf_acûssÜ
* 
acûssÜ
 = &
d©a
->
acûssÜs
[
i
];

1541 
cgÉf_size
 
–em’t_size
 = 
	`cgÉf_ÿlc_size
(
acûssÜ
->
ty³
,‡cûssÜ->
compÚ’t_ty³
);

1543 ià(
acûssÜ
->
bufãr_v›w
)

1545 
cgÉf_size
 
»q_size
 = 
acûssÜ
->
off£t
 +‡cûssÜ->
¡ride
 * (acûssÜ->
couÁ
 - 1è+ 
–em’t_size
;

1547 
	`CGLTF_ASSERT_IF
(
acûssÜ
->
bufãr_v›w
->
size
 < 
»q_size
, 
cgÉf_»suÉ_d©a_too_shÜt
);

1550 ià(
acûssÜ
->
is_¥¬£
)

1552 
cgÉf_acûssÜ_¥¬£
* 
¥¬£
 = &
acûssÜ
->sparse;

1554 
cgÉf_size
 
šdiûs_compÚ’t_size
 = 
	`cgÉf_ÿlc_size
(
cgÉf_ty³_sÿÏr
, 
¥¬£
->
šdiûs_compÚ’t_ty³
);

1555 
cgÉf_size
 
šdiûs_»q_size
 = 
¥¬£
->
šdiûs_by‹_off£t
 + 
šdiûs_compÚ’t_size
 * s·r£->
couÁ
;

1556 
cgÉf_size
 
v®ues_»q_size
 = 
¥¬£
->
v®ues_by‹_off£t
 + 
–em’t_size
 * s·r£->
couÁ
;

1558 
	`CGLTF_ASSERT_IF
(
¥¬£
->
šdiûs_bufãr_v›w
->
size
 < 
šdiûs_»q_size
 ||

1559 
¥¬£
->
v®ues_bufãr_v›w
->
size
 < 
v®ues_»q_size
, 
cgÉf_»suÉ_d©a_too_shÜt
);

1561 
	`CGLTF_ASSERT_IF
(
¥¬£
->
šdiûs_compÚ’t_ty³
 !ğ
cgÉf_compÚ’t_ty³_r_8u
 &&

1562 
¥¬£
->
šdiûs_compÚ’t_ty³
 !ğ
cgÉf_compÚ’t_ty³_r_16u
 &&

1563 
¥¬£
->
šdiûs_compÚ’t_ty³
 !ğ
cgÉf_compÚ’t_ty³_r_32u
, 
cgÉf_»suÉ_šv®id_gÉf
);

1565 ià(
¥¬£
->
šdiûs_bufãr_v›w
->
bufãr
->
d©a
)

1567 
cgÉf_size
 
šdex_bound
 = 
	`cgÉf_ÿlc_šdex_bound
(
¥¬£
->
šdiûs_bufãr_v›w
, s·r£->
šdiûs_by‹_off£t
, s·r£->
šdiûs_compÚ’t_ty³
, s·r£->
couÁ
);

1569 
	`CGLTF_ASSERT_IF
(
šdex_bound
 >ğ
acûssÜ
->
couÁ
, 
cgÉf_»suÉ_d©a_too_shÜt
);

1574 
cgÉf_size
 
i
 = 0; i < 
d©a
->
bufãr_v›ws_couÁ
; ++i)

1576 
cgÉf_size
 
»q_size
 = 
d©a
->
bufãr_v›ws
[
i
].
off£t
 + d©a->bufãr_v›ws[i].
size
;

1578 
	`CGLTF_ASSERT_IF
(
d©a
->
bufãr_v›ws
[
i
].
bufãr
 && d©a->bufãr_v›ws[i].bufãr->
size
 < 
»q_size
, 
cgÉf_»suÉ_d©a_too_shÜt
);

1580 ià(
d©a
->
bufãr_v›ws
[
i
].
has_meshİt_com´essiÚ
)

1582 
cgÉf_meshİt_com´essiÚ
* 
mc
 = &
d©a
->
bufãr_v›ws
[
i
].
meshİt_com´essiÚ
;

1584 
	`CGLTF_ASSERT_IF
(
mc
->
bufãr
 =ğ
NULL
 || mc->bufãr->
size
 < mc->
off£t
 + mc->size, 
cgÉf_»suÉ_d©a_too_shÜt
);

1586 
	`CGLTF_ASSERT_IF
(
d©a
->
bufãr_v›ws
[
i
].
¡ride
 && 
mc
->¡rid!ğd©a->bufãr_v›ws[i].¡ride, 
cgÉf_»suÉ_šv®id_gÉf
);

1588 
	`CGLTF_ASSERT_IF
(
d©a
->
bufãr_v›ws
[
i
].
size
 !ğ
mc
->
¡ride
 * mc->
couÁ
, 
cgÉf_»suÉ_šv®id_gÉf
);

1590 
	`CGLTF_ASSERT_IF
(
mc
->
mode
 =ğ
cgÉf_meshİt_com´essiÚ_mode_šv®id
, 
cgÉf_»suÉ_šv®id_gÉf
);

1592 
	`CGLTF_ASSERT_IF
(
mc
->
mode
 =ğ
cgÉf_meshİt_com´essiÚ_mode_©Œibu‹s
 && !(mc->
¡ride
 % 4 =ğ0 && mc->¡rid<ğ256), 
cgÉf_»suÉ_šv®id_gÉf
);

1594 
	`CGLTF_ASSERT_IF
(
mc
->
mode
 =ğ
cgÉf_meshİt_com´essiÚ_mode_ŒŸngËs
 && mc->
couÁ
 % 3 !ğ0, 
cgÉf_»suÉ_šv®id_gÉf
);

1596 
	`CGLTF_ASSERT_IF
((
mc
->
mode
 =ğ
cgÉf_meshİt_com´essiÚ_mode_ŒŸngËs
 || mc->mod=ğ
cgÉf_meshİt_com´essiÚ_mode_šdiûs
è&& mc->
¡ride
 !ğ2 && mc->¡rid!ğ4, 
cgÉf_»suÉ_šv®id_gÉf
);

1598 
	`CGLTF_ASSERT_IF
((
mc
->
mode
 =ğ
cgÉf_meshİt_com´essiÚ_mode_ŒŸngËs
 || mc->mod=ğ
cgÉf_meshİt_com´essiÚ_mode_šdiûs
è&& mc->
f‹r
 !ğ
cgÉf_meshİt_com´essiÚ_f‹r_nÚe
, 
cgÉf_»suÉ_šv®id_gÉf
);

1600 
	`CGLTF_ASSERT_IF
(
mc
->
f‹r
 =ğ
cgÉf_meshİt_com´essiÚ_f‹r_oùahed¿l
 && mc->
¡ride
 !ğ4 && mc->¡rid!ğ8, 
cgÉf_»suÉ_šv®id_gÉf
);

1602 
	`CGLTF_ASSERT_IF
(
mc
->
f‹r
 =ğ
cgÉf_meshİt_com´essiÚ_f‹r_qu©”niÚ
 && mc->
¡ride
 !ğ8, 
cgÉf_»suÉ_šv®id_gÉf
);

1606 
cgÉf_size
 
i
 = 0; i < 
d©a
->
meshes_couÁ
; ++i)

1608 ià(
d©a
->
meshes
[
i
].
weights
)

1610 
	`CGLTF_ASSERT_IF
(
d©a
->
meshes
[
i
].
´im™ives_couÁ
 && d©a->meshes[i].
´im™ives
[0].
rg‘s_couÁ
 !ğd©a->meshes[i].
weights_couÁ
, 
cgÉf_»suÉ_šv®id_gÉf
);

1613 ià(
d©a
->
meshes
[
i
].
rg‘_Çmes
)

1615 
	`CGLTF_ASSERT_IF
(
d©a
->
meshes
[
i
].
´im™ives_couÁ
 && d©a->meshes[i].
´im™ives
[0].
rg‘s_couÁ
 !ğd©a->meshes[i].
rg‘_Çmes_couÁ
, 
cgÉf_»suÉ_šv®id_gÉf
);

1618 
cgÉf_size
 
j
 = 0; j < 
d©a
->
meshes
[
i
].
´im™ives_couÁ
; ++j)

1620 
	`CGLTF_ASSERT_IF
(
d©a
->
meshes
[
i
].
´im™ives
[
j
].
rg‘s_couÁ
 !ğd©a->meshes[i].´im™ives[0].rg‘s_couÁ, 
cgÉf_»suÉ_šv®id_gÉf
);

1622 ià(
d©a
->
meshes
[
i
].
´im™ives
[
j
].
©Œibu‹s_couÁ
)

1624 
cgÉf_acûssÜ
* 
fœ¡
 = 
d©a
->
meshes
[
i
].
´im™ives
[
j
].
©Œibu‹s
[0].data;

1626 
cgÉf_size
 
k
 = 0; k < 
d©a
->
meshes
[
i
].
´im™ives
[
j
].
©Œibu‹s_couÁ
; ++k)

1628 
	`CGLTF_ASSERT_IF
(
d©a
->
meshes
[
i
].
´im™ives
[
j
].
©Œibu‹s
[
k
].d©a->
couÁ
 !ğ
fœ¡
->couÁ, 
cgÉf_»suÉ_šv®id_gÉf
);

1631 
cgÉf_size
 
k
 = 0; k < 
d©a
->
meshes
[
i
].
´im™ives
[
j
].
rg‘s_couÁ
; ++k)

1633 
cgÉf_size
 
m
 = 0; m < 
d©a
->
meshes
[
i
].
´im™ives
[
j
].
rg‘s
[
k
].
©Œibu‹s_couÁ
; ++m)

1635 
	`CGLTF_ASSERT_IF
(
d©a
->
meshes
[
i
].
´im™ives
[
j
].
rg‘s
[
k
].
©Œibu‹s
[
m
].d©a->
couÁ
 !ğ
fœ¡
->couÁ, 
cgÉf_»suÉ_šv®id_gÉf
);

1639 
cgÉf_acûssÜ
* 
šdiûs
 = 
d©a
->
meshes
[
i
].
´im™ives
[
j
].indices;

1641 
	`CGLTF_ASSERT_IF
(
šdiûs
 &&

1642 
šdiûs
->
compÚ’t_ty³
 !ğ
cgÉf_compÚ’t_ty³_r_8u
 &&

1643 
šdiûs
->
compÚ’t_ty³
 !ğ
cgÉf_compÚ’t_ty³_r_16u
 &&

1644 
šdiûs
->
compÚ’t_ty³
 !ğ
cgÉf_compÚ’t_ty³_r_32u
, 
cgÉf_»suÉ_šv®id_gÉf
);

1646 ià(
šdiûs
 && indiûs->
bufãr_v›w
 && indiûs->bufãr_v›w->
bufãr
->
d©a
)

1648 
cgÉf_size
 
šdex_bound
 = 
	`cgÉf_ÿlc_šdex_bound
(
šdiûs
->
bufãr_v›w
, indiûs->
off£t
, indiûs->
compÚ’t_ty³
, indiûs->
couÁ
);

1650 
	`CGLTF_ASSERT_IF
(
šdex_bound
 >ğ
fœ¡
->
couÁ
, 
cgÉf_»suÉ_d©a_too_shÜt
);

1653 
cgÉf_size
 
k
 = 0; k < 
d©a
->
meshes
[
i
].
´im™ives
[
j
].
m­pšgs_couÁ
; ++k)

1655 
	`CGLTF_ASSERT_IF
(
d©a
->
meshes
[
i
].
´im™ives
[
j
].
m­pšgs
[
k
].
v¬ŸÁ
 >ğd©a->
v¬ŸÁs_couÁ
, 
cgÉf_»suÉ_šv®id_gÉf
);

1661 
cgÉf_size
 
i
 = 0; i < 
d©a
->
nodes_couÁ
; ++i)

1663 ià(
d©a
->
nodes
[
i
].
weights
 && d©a->nodes[i].
mesh
)

1665 
	`CGLTF_ASSERT_IF
 (
d©a
->
nodes
[
i
].
mesh
->
´im™ives_couÁ
 && d©a->nodes[i].mesh->
´im™ives
[0].
rg‘s_couÁ
 !ğd©a->nodes[i].
weights_couÁ
, 
cgÉf_»suÉ_šv®id_gÉf
);

1669 
cgÉf_size
 
i
 = 0; i < 
d©a
->
nodes_couÁ
; ++i)

1671 
cgÉf_node
* 
p1
 = 
d©a
->
nodes
[
i
].
·»Á
;

1672 
cgÉf_node
* 
p2
 = 
p1
 ?…1->
·»Á
 : 
NULL
;

1674 
p1
 && 
p2
)

1676 
	`CGLTF_ASSERT_IF
(
p1
 =ğ
p2
, 
cgÉf_»suÉ_šv®id_gÉf
);

1678 
p1
 =…1->
·»Á
;

1679 
p2
 =…2->
·»Á
 ?…2->·»Á->·»Á : 
NULL
;

1683 
cgÉf_size
 
i
 = 0; i < 
d©a
->
sûÃs_couÁ
; ++i)

1685 
cgÉf_size
 
j
 = 0; j < 
d©a
->
sûÃs
[
i
].
nodes_couÁ
; ++j)

1687 
	`CGLTF_ASSERT_IF
(
d©a
->
sûÃs
[
i
].
nodes
[
j
]->
·»Á
, 
cgÉf_»suÉ_šv®id_gÉf
);

1691 
cgÉf_size
 
i
 = 0; i < 
d©a
->
ªim©iÚs_couÁ
; ++i)

1693 
cgÉf_size
 
j
 = 0; j < 
d©a
->
ªim©iÚs
[
i
].
chªÃls_couÁ
; ++j)

1695 
cgÉf_ªim©iÚ_chªÃl
* 
chªÃl
 = &
d©a
->
ªim©iÚs
[
i
].
chªÃls
[
j
];

1697 ià(!
chªÃl
->
rg‘_node
)

1702 
cgÉf_size
 
compÚ’ts
 = 1;

1704 ià(
chªÃl
->
rg‘_·th
 =ğ
cgÉf_ªim©iÚ_·th_ty³_weights
)

1706 
	`CGLTF_ASSERT_IF
(!
chªÃl
->
rg‘_node
->
mesh
 || !chªÃl->rg‘_node->mesh->
´im™ives_couÁ
, 
cgÉf_»suÉ_šv®id_gÉf
);

1708 
compÚ’ts
 = 
chªÃl
->
rg‘_node
->
mesh
->
´im™ives
[0].
rg‘s_couÁ
;

1711 
cgÉf_size
 
v®ues
 = 
chªÃl
->
§m¶”
->
š‹½Ş©iÚ
 =ğ
cgÉf_š‹½Ş©iÚ_ty³_cubic_¥lše
 ? 3 : 1;

1713 
	`CGLTF_ASSERT_IF
(
chªÃl
->
§m¶”
->
šput
->
couÁ
 * 
compÚ’ts
 * 
v®ues
 !ğchªÃl->§m¶”->
ouut
->couÁ, 
cgÉf_»suÉ_d©a_too_shÜt
);

1717  
cgÉf_»suÉ_sucûss
;

1718 
	}
}

1720 
cgÉf_»suÉ
 
	$cgÉf_cİy_exŒas_jsÚ
(cÚ¡ 
cgÉf_d©a
* 
d©a
, cÚ¡ 
cgÉf_exŒas
* 
exŒas
, * 
de¡
, 
cgÉf_size
* 
de¡_size
)

1722 
cgÉf_size
 
jsÚ_size
 = 
exŒas
->
’d_off£t
 -ƒxŒas->
¡¬t_off£t
;

1724 ià(!
de¡
)

1726 ià(
de¡_size
)

1728 *
de¡_size
 = 
jsÚ_size
 + 1;

1729  
cgÉf_»suÉ_sucûss
;

1731  
cgÉf_»suÉ_šv®id_İtiÚs
;

1734 ià(*
de¡_size
 + 1 < 
jsÚ_size
)

1736 
	`¡ºıy
(
de¡
, 
d©a
->
jsÚ
 + 
exŒas
->
¡¬t_off£t
, *
de¡_size
 - 1);

1737 
de¡
[*
de¡_size
 - 1] = 0;

1741 
	`¡ºıy
(
de¡
, 
d©a
->
jsÚ
 + 
exŒas
->
¡¬t_off£t
, 
jsÚ_size
);

1742 
de¡
[
jsÚ_size
] = 0;

1745  
cgÉf_»suÉ_sucûss
;

1746 
	}
}

1748 
	$cgÉf_ä“_ex‹nsiÚs
(
cgÉf_d©a
* 
d©a
, 
cgÉf_ex‹nsiÚ
* 
ex‹nsiÚs
, 
cgÉf_size
 
ex‹nsiÚs_couÁ
)

1750 
cgÉf_size
 
i
 = 0; i < 
ex‹nsiÚs_couÁ
; ++i)

1752 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, 
ex‹nsiÚs
[
i
].
Çme
);

1753 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, 
ex‹nsiÚs
[
i
].data);

1755 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, 
ex‹nsiÚs
);

1756 
	}
}

1758 
	$cgÉf_ä“
(
cgÉf_d©a
* 
d©a
)

1760 ià(!
d©a
)

1765 (*
fe_»Ëa£
)(cÚ¡ 
cgÉf_memÜy_İtiÚs
*, cÚ¡ 
cgÉf_fe_İtiÚs
*, * 
d©a
èğd©a->
fe
.
»Ëa£
 ? d©a->fe.»Ëa£ : 
cgÉf_deçuÉ_fe_»Ëa£
;

1767 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
as£t
.
cİyright
);

1768 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
as£t
.
g’”©Ü
);

1769 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
as£t
.
v”siÚ
);

1770 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
as£t
.
mš_v”siÚ
);

1772 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
as£t
.
ex‹nsiÚs
, d©a->as£t.
ex‹nsiÚs_couÁ
);

1774 
cgÉf_size
 
i
 = 0; i < 
d©a
->
acûssÜs_couÁ
; ++i)

1776 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
acûssÜs
[
i
].
Çme
);

1778 if(
d©a
->
acûssÜs
[
i
].
is_¥¬£
)

1780 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
acûssÜs
[
i
].
¥¬£
.
ex‹nsiÚs
, d©a->acûssÜs[i].¥¬£.
ex‹nsiÚs_couÁ
);

1781 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
acûssÜs
[
i
].
¥¬£
.
šdiûs_ex‹nsiÚs
, d©a->acûssÜs[i].¥¬£.
šdiûs_ex‹nsiÚs_couÁ
);

1782 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
acûssÜs
[
i
].
¥¬£
.
v®ues_ex‹nsiÚs
, d©a->acûssÜs[i].¥¬£.
v®ues_ex‹nsiÚs_couÁ
);

1784 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
acûssÜs
[
i
].
ex‹nsiÚs
, d©a->acûssÜs[i].
ex‹nsiÚs_couÁ
);

1786 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
acûssÜs
);

1788 
cgÉf_size
 
i
 = 0; i < 
d©a
->
bufãr_v›ws_couÁ
; ++i)

1790 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
bufãr_v›ws
[
i
].
Çme
);

1791 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
bufãr_v›ws
[
i
].data);

1793 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
bufãr_v›ws
[
i
].
ex‹nsiÚs
, d©a->bufãr_v›ws[i].
ex‹nsiÚs_couÁ
);

1795 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
bufãr_v›ws
);

1797 
cgÉf_size
 
i
 = 0; i < 
d©a
->
bufãrs_couÁ
; ++i)

1799 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
bufãrs
[
i
].
Çme
);

1801 ià(
d©a
->
bufãrs
[
i
].
d©a_ä“_m‘hod
 =ğ
cgÉf_d©a_ä“_m‘hod_fe_»Ëa£
)

1803 
	`fe_»Ëa£
(&
d©a
->
memÜy
, &d©a->
fe
, d©a->
bufãrs
[
i
].data);

1805 ià(
d©a
->
bufãrs
[
i
].
d©a_ä“_m‘hod
 =ğ
cgÉf_d©a_ä“_m‘hod_memÜy_ä“
)

1807 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
bufãrs
[
i
].data);

1810 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
bufãrs
[
i
].
uri
);

1812 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
bufãrs
[
i
].
ex‹nsiÚs
, d©a->bufãrs[i].
ex‹nsiÚs_couÁ
);

1815 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
bufãrs
);

1817 
cgÉf_size
 
i
 = 0; i < 
d©a
->
meshes_couÁ
; ++i)

1819 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
meshes
[
i
].
Çme
);

1821 
cgÉf_size
 
j
 = 0; j < 
d©a
->
meshes
[
i
].
´im™ives_couÁ
; ++j)

1823 
cgÉf_size
 
k
 = 0; k < 
d©a
->
meshes
[
i
].
´im™ives
[
j
].
©Œibu‹s_couÁ
; ++k)

1825 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
meshes
[
i
].
´im™ives
[
j
].
©Œibu‹s
[
k
].
Çme
);

1828 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
meshes
[
i
].
´im™ives
[
j
].
©Œibu‹s
);

1830 
cgÉf_size
 
k
 = 0; k < 
d©a
->
meshes
[
i
].
´im™ives
[
j
].
rg‘s_couÁ
; ++k)

1832 
cgÉf_size
 
m
 = 0; m < 
d©a
->
meshes
[
i
].
´im™ives
[
j
].
rg‘s
[
k
].
©Œibu‹s_couÁ
; ++m)

1834 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
meshes
[
i
].
´im™ives
[
j
].
rg‘s
[
k
].
©Œibu‹s
[
m
].
Çme
);

1837 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
meshes
[
i
].
´im™ives
[
j
].
rg‘s
[
k
].
©Œibu‹s
);

1840 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
meshes
[
i
].
´im™ives
[
j
].
rg‘s
);

1842 ià(
d©a
->
meshes
[
i
].
´im™ives
[
j
].
has_d¿co_mesh_com´essiÚ
)

1844 
cgÉf_size
 
k
 = 0; k < 
d©a
->
meshes
[
i
].
´im™ives
[
j
].
d¿co_mesh_com´essiÚ
.
©Œibu‹s_couÁ
; ++k)

1846 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
meshes
[
i
].
´im™ives
[
j
].
d¿co_mesh_com´essiÚ
.
©Œibu‹s
[
k
].
Çme
);

1849 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
meshes
[
i
].
´im™ives
[
j
].
d¿co_mesh_com´essiÚ
.
©Œibu‹s
);

1852 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
meshes
[
i
].
´im™ives
[
j
].
m­pšgs
);

1854 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
meshes
[
i
].
´im™ives
[
j
].
ex‹nsiÚs
, d©a->meshes[i].´im™ives[j].
ex‹nsiÚs_couÁ
);

1857 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
meshes
[
i
].
´im™ives
);

1858 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
meshes
[
i
].
weights
);

1860 
cgÉf_size
 
j
 = 0; j < 
d©a
->
meshes
[
i
].
rg‘_Çmes_couÁ
; ++j)

1862 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
meshes
[
i
].
rg‘_Çmes
[
j
]);

1865 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
meshes
[
i
].
ex‹nsiÚs
, d©a->meshes[i].
ex‹nsiÚs_couÁ
);

1867 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
meshes
[
i
].
rg‘_Çmes
);

1870 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
meshes
);

1872 
cgÉf_size
 
i
 = 0; i < 
d©a
->
m©”Ÿls_couÁ
; ++i)

1874 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
m©”Ÿls
[
i
].
Çme
);

1876 if(
d©a
->
m©”Ÿls
[
i
].
has_pbr_m‘®lic_roughÃss
)

1878 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
m©”Ÿls
[
i
].
pbr_m‘®lic_roughÃss
.
m‘®lic_roughÃss_‹xtu»
.
ex‹nsiÚs
, d©a->m©”Ÿls[i].pbr_m‘®lic_roughÃss.m‘®lic_roughÃss_‹xtu».
ex‹nsiÚs_couÁ
);

1879 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
m©”Ÿls
[
i
].
pbr_m‘®lic_roughÃss
.
ba£_cŞÜ_‹xtu»
.
ex‹nsiÚs
, d©a->m©”Ÿls[i].pbr_m‘®lic_roughÃss.ba£_cŞÜ_‹xtu».
ex‹nsiÚs_couÁ
);

1881 if(
d©a
->
m©”Ÿls
[
i
].
has_pbr_¥ecuÏr_glossšess
)

1883 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
m©”Ÿls
[
i
].
pbr_¥ecuÏr_glossšess
.
diffu£_‹xtu»
.
ex‹nsiÚs
, d©a->m©”Ÿls[i].pbr_¥ecuÏr_glossšess.diffu£_‹xtu».
ex‹nsiÚs_couÁ
);

1884 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
m©”Ÿls
[
i
].
pbr_¥ecuÏr_glossšess
.
¥ecuÏr_glossšess_‹xtu»
.
ex‹nsiÚs
, d©a->m©”Ÿls[i].pbr_¥ecuÏr_glossšess.¥ecuÏr_glossšess_‹xtu».
ex‹nsiÚs_couÁ
);

1886 if(
d©a
->
m©”Ÿls
[
i
].
has_ş—rcßt
)

1888 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
m©”Ÿls
[
i
].
ş—rcßt
.
ş—rcßt_‹xtu»
.
ex‹nsiÚs
, d©a->m©”Ÿls[i].ş—rcßt.ş—rcßt_‹xtu».
ex‹nsiÚs_couÁ
);

1889 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
m©”Ÿls
[
i
].
ş—rcßt
.
ş—rcßt_roughÃss_‹xtu»
.
ex‹nsiÚs
, d©a->m©”Ÿls[i].ş—rcßt.ş—rcßt_roughÃss_‹xtu».
ex‹nsiÚs_couÁ
);

1890 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
m©”Ÿls
[
i
].
ş—rcßt
.
ş—rcßt_nÜm®_‹xtu»
.
ex‹nsiÚs
, d©a->m©”Ÿls[i].ş—rcßt.ş—rcßt_nÜm®_‹xtu».
ex‹nsiÚs_couÁ
);

1892 if(
d©a
->
m©”Ÿls
[
i
].
has_¥ecuÏr
)

1894 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
m©”Ÿls
[
i
].
¥ecuÏr
.
¥ecuÏr_‹xtu»
.
ex‹nsiÚs
, d©a->m©”Ÿls[i].¥ecuÏr.¥ecuÏr_‹xtu».
ex‹nsiÚs_couÁ
);

1895 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
m©”Ÿls
[
i
].
¥ecuÏr
.
¥ecuÏr_cŞÜ_‹xtu»
.
ex‹nsiÚs
, d©a->m©”Ÿls[i].¥ecuÏr.¥ecuÏr_cŞÜ_‹xtu».
ex‹nsiÚs_couÁ
);

1897 if(
d©a
->
m©”Ÿls
[
i
].
has_ŒªsmissiÚ
)

1899 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
m©”Ÿls
[
i
].
ŒªsmissiÚ
.
ŒªsmissiÚ_‹xtu»
.
ex‹nsiÚs
, d©a->m©”Ÿls[i].ŒªsmissiÚ.ŒªsmissiÚ_‹xtu».
ex‹nsiÚs_couÁ
);

1901 ià(
d©a
->
m©”Ÿls
[
i
].
has_vŞume
)

1903 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
m©”Ÿls
[
i
].
vŞume
.
thickÃss_‹xtu»
.
ex‹nsiÚs
, d©a->m©”Ÿls[i].vŞume.thickÃss_‹xtu».
ex‹nsiÚs_couÁ
);

1905 if(
d©a
->
m©”Ÿls
[
i
].
has_sh“n
)

1907 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
m©”Ÿls
[
i
].
sh“n
.
sh“n_cŞÜ_‹xtu»
.
ex‹nsiÚs
, d©a->m©”Ÿls[i].sh“n.sh“n_cŞÜ_‹xtu».
ex‹nsiÚs_couÁ
);

1908 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
m©”Ÿls
[
i
].
sh“n
.
sh“n_roughÃss_‹xtu»
.
ex‹nsiÚs
, d©a->m©”Ÿls[i].sh“n.sh“n_roughÃss_‹xtu».
ex‹nsiÚs_couÁ
);

1910 if(
d©a
->
m©”Ÿls
[
i
].
has_œidesûnû
)

1912 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
m©”Ÿls
[
i
].
œidesûnû
.
œidesûnû_‹xtu»
.
ex‹nsiÚs
, d©a->m©”Ÿls[i].œidesûnû.œidesûnû_‹xtu».
ex‹nsiÚs_couÁ
);

1913 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
m©”Ÿls
[
i
].
œidesûnû
.
œidesûnû_thickÃss_‹xtu»
.
ex‹nsiÚs
, d©a->m©”Ÿls[i].œidesûnû.œidesûnû_thickÃss_‹xtu».
ex‹nsiÚs_couÁ
);

1916 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
m©”Ÿls
[
i
].
nÜm®_‹xtu»
.
ex‹nsiÚs
, d©a->m©”Ÿls[i].nÜm®_‹xtu».
ex‹nsiÚs_couÁ
);

1917 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
m©”Ÿls
[
i
].
ocşusiÚ_‹xtu»
.
ex‹nsiÚs
, d©a->m©”Ÿls[i].ocşusiÚ_‹xtu».
ex‹nsiÚs_couÁ
);

1918 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
m©”Ÿls
[
i
].
emissive_‹xtu»
.
ex‹nsiÚs
, d©a->m©”Ÿls[i].emissive_‹xtu».
ex‹nsiÚs_couÁ
);

1920 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
m©”Ÿls
[
i
].
ex‹nsiÚs
, d©a->m©”Ÿls[i].
ex‹nsiÚs_couÁ
);

1923 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
m©”Ÿls
);

1925 
cgÉf_size
 
i
 = 0; i < 
d©a
->
images_couÁ
; ++i)

1927 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
images
[
i
].
Çme
);

1928 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
images
[
i
].
uri
);

1929 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
images
[
i
].
mime_ty³
);

1931 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
images
[
i
].
ex‹nsiÚs
, d©a->images[i].
ex‹nsiÚs_couÁ
);

1934 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
images
);

1936 
cgÉf_size
 
i
 = 0; i < 
d©a
->
‹xtu»s_couÁ
; ++i)

1938 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
‹xtu»s
[
i
].
Çme
);

1939 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
‹xtu»s
[
i
].
ex‹nsiÚs
, d©a->‹xtu»s[i].
ex‹nsiÚs_couÁ
);

1942 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
‹xtu»s
);

1944 
cgÉf_size
 
i
 = 0; i < 
d©a
->
§m¶”s_couÁ
; ++i)

1946 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
§m¶”s
[
i
].
Çme
);

1947 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
§m¶”s
[
i
].
ex‹nsiÚs
, d©a->§m¶”s[i].
ex‹nsiÚs_couÁ
);

1950 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
§m¶”s
);

1952 
cgÉf_size
 
i
 = 0; i < 
d©a
->
skšs_couÁ
; ++i)

1954 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
skšs
[
i
].
Çme
);

1955 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
skšs
[
i
].
jošts
);

1957 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
skšs
[
i
].
ex‹nsiÚs
, d©a->skšs[i].
ex‹nsiÚs_couÁ
);

1960 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
skšs
);

1962 
cgÉf_size
 
i
 = 0; i < 
d©a
->
ÿm”as_couÁ
; ++i)

1964 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
ÿm”as
[
i
].
Çme
);

1965 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
ÿm”as
[
i
].
ex‹nsiÚs
, d©a->ÿm”as[i].
ex‹nsiÚs_couÁ
);

1968 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
ÿm”as
);

1970 
cgÉf_size
 
i
 = 0; i < 
d©a
->
lights_couÁ
; ++i)

1972 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
lights
[
i
].
Çme
);

1975 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
lights
);

1977 
cgÉf_size
 
i
 = 0; i < 
d©a
->
nodes_couÁ
; ++i)

1979 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
nodes
[
i
].
Çme
);

1980 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
nodes
[
i
].
chd»n
);

1981 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
nodes
[
i
].
weights
);

1982 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
nodes
[
i
].
ex‹nsiÚs
, d©a->nodes[i].
ex‹nsiÚs_couÁ
);

1985 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
nodes
);

1987 
cgÉf_size
 
i
 = 0; i < 
d©a
->
sûÃs_couÁ
; ++i)

1989 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
sûÃs
[
i
].
Çme
);

1990 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
sûÃs
[
i
].
nodes
);

1992 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
sûÃs
[
i
].
ex‹nsiÚs
, d©a->sûÃs[i].
ex‹nsiÚs_couÁ
);

1995 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
sûÃs
);

1997 
cgÉf_size
 
i
 = 0; i < 
d©a
->
ªim©iÚs_couÁ
; ++i)

1999 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
ªim©iÚs
[
i
].
Çme
);

2000 
cgÉf_size
 
j
 = 0; j < 
d©a
->
ªim©iÚs
[
i
].
§m¶”s_couÁ
; ++j)

2002 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
ªim©iÚs
[
i
].
§m¶”s
[
j
].
ex‹nsiÚs
, d©a->ªim©iÚs[i].§m¶”s[j].
ex‹nsiÚs_couÁ
);

2004 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
ªim©iÚs
[
i
].
§m¶”s
);

2006 
cgÉf_size
 
j
 = 0; j < 
d©a
->
ªim©iÚs
[
i
].
chªÃls_couÁ
; ++j)

2008 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
ªim©iÚs
[
i
].
chªÃls
[
j
].
ex‹nsiÚs
, d©a->ªim©iÚs[i].chªÃls[j].
ex‹nsiÚs_couÁ
);

2010 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
ªim©iÚs
[
i
].
chªÃls
);

2012 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
ªim©iÚs
[
i
].
ex‹nsiÚs
, d©a->ªim©iÚs[i].
ex‹nsiÚs_couÁ
);

2015 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
ªim©iÚs
);

2017 
cgÉf_size
 
i
 = 0; i < 
d©a
->
v¬ŸÁs_couÁ
; ++i)

2019 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
v¬ŸÁs
[
i
].
Çme
);

2022 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
v¬ŸÁs
);

2024 
	`cgÉf_ä“_ex‹nsiÚs
(
d©a
, d©a->
d©a_ex‹nsiÚs
, d©a->
d©a_ex‹nsiÚs_couÁ
);

2026 
cgÉf_size
 
i
 = 0; i < 
d©a
->
ex‹nsiÚs_u£d_couÁ
; ++i)

2028 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
ex‹nsiÚs_u£d
[
i
]);

2031 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
ex‹nsiÚs_u£d
);

2033 
cgÉf_size
 
i
 = 0; i < 
d©a
->
ex‹nsiÚs_»quœed_couÁ
; ++i)

2035 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
ex‹nsiÚs_»quœed
[
i
]);

2038 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, d©a->
ex‹nsiÚs_»quœed
);

2040 
	`fe_»Ëa£
(&
d©a
->
memÜy
, &d©a->
fe
, d©a->
fe_d©a
);

2042 
d©a
->
memÜy
.
	`ä“_func
(d©a->memÜy.
u£r_d©a
, data);

2043 
	}
}

2045 
	$cgÉf_node_ŒªsfÜm_loÿl
(cÚ¡ 
cgÉf_node
* 
node
, 
cgÉf_æßt
* 
out_m©rix
)

2047 
cgÉf_æßt
* 
lm
 = 
out_m©rix
;

2049 ià(
node
->
has_m©rix
)

2051 
	`memıy
(
lm
, 
node
->
m©rix
, () * 16);

2055 
tx
 = 
node
->
Œª¦©iÚ
[0];

2056 
ty
 = 
node
->
Œª¦©iÚ
[1];

2057 
tz
 = 
node
->
Œª¦©iÚ
[2];

2059 
qx
 = 
node
->
rÙ©iÚ
[0];

2060 
qy
 = 
node
->
rÙ©iÚ
[1];

2061 
qz
 = 
node
->
rÙ©iÚ
[2];

2062 
qw
 = 
node
->
rÙ©iÚ
[3];

2064 
sx
 = 
node
->
sÿË
[0];

2065 
sy
 = 
node
->
sÿË
[1];

2066 
sz
 = 
node
->
sÿË
[2];

2068 
lm
[0] = (1 - 2 * 
qy
*qy - 2 * 
qz
*qzè* 
sx
;

2069 
lm
[1] = (2 * 
qx
*
qy
 + 2 * 
qz
*
qw
è* 
sx
;

2070 
lm
[2] = (2 * 
qx
*
qz
 - 2 * 
qy
*
qw
è* 
sx
;

2071 
lm
[3] = 0.f;

2073 
lm
[4] = (2 * 
qx
*
qy
 - 2 * 
qz
*
qw
è* 
sy
;

2074 
lm
[5] = (1 - 2 * 
qx
*qx - 2 * 
qz
*qzè* 
sy
;

2075 
lm
[6] = (2 * 
qy
*
qz
 + 2 * 
qx
*
qw
è* 
sy
;

2076 
lm
[7] = 0.f;

2078 
lm
[8] = (2 * 
qx
*
qz
 + 2 * 
qy
*
qw
è* 
sz
;

2079 
lm
[9] = (2 * 
qy
*
qz
 - 2 * 
qx
*
qw
è* 
sz
;

2080 
lm
[10] = (1 - 2 * 
qx
*qx - 2 * 
qy
*qyè* 
sz
;

2081 
lm
[11] = 0.f;

2083 
lm
[12] = 
tx
;

2084 
lm
[13] = 
ty
;

2085 
lm
[14] = 
tz
;

2086 
lm
[15] = 1.f;

2088 
	}
}

2090 
	$cgÉf_node_ŒªsfÜm_wÜld
(cÚ¡ 
cgÉf_node
* 
node
, 
cgÉf_æßt
* 
out_m©rix
)

2092 
cgÉf_æßt
* 
lm
 = 
out_m©rix
;

2093 
	`cgÉf_node_ŒªsfÜm_loÿl
(
node
, 
lm
);

2095 cÚ¡ 
cgÉf_node
* 
·»Á
 = 
node
->parent;

2097 
·»Á
)

2099 
pm
[16];

2100 
	`cgÉf_node_ŒªsfÜm_loÿl
(
·»Á
, 
pm
);

2102 
i
 = 0; i < 4; ++i)

2104 
l0
 = 
lm
[
i
 * 4 + 0];

2105 
l1
 = 
lm
[
i
 * 4 + 1];

2106 
l2
 = 
lm
[
i
 * 4 + 2];

2108 
r0
 = 
l0
 * 
pm
[0] + 
l1
 *…m[4] + 
l2
 *…m[8];

2109 
r1
 = 
l0
 * 
pm
[1] + 
l1
 *…m[5] + 
l2
 *…m[9];

2110 
r2
 = 
l0
 * 
pm
[2] + 
l1
 *…m[6] + 
l2
 *…m[10];

2112 
lm
[
i
 * 4 + 0] = 
r0
;

2113 
lm
[
i
 * 4 + 1] = 
r1
;

2114 
lm
[
i
 * 4 + 2] = 
r2
;

2117 
lm
[12] +ğ
pm
[12];

2118 
lm
[13] +ğ
pm
[13];

2119 
lm
[14] +ğ
pm
[14];

2121 
·»Á
 =…arent->parent;

2123 
	}
}

2125 
cgÉf_ssize
 
	$cgÉf_compÚ’t_»ad_š‹g”
(cÚ¡ * 
š
, 
cgÉf_compÚ’t_ty³
 
compÚ’t_ty³
)

2127 
compÚ’t_ty³
)

2129 
cgÉf_compÚ’t_ty³_r_16
:

2130  *((cÚ¡ 
št16_t
*è
š
);

2131 
cgÉf_compÚ’t_ty³_r_16u
:

2132  *((cÚ¡ 
ušt16_t
*è
š
);

2133 
cgÉf_compÚ’t_ty³_r_32u
:

2134  *((cÚ¡ 
ušt32_t
*è
š
);

2135 
cgÉf_compÚ’t_ty³_r_32f
:

2136  (
cgÉf_ssize
)*((cÚ¡ *è
š
);

2137 
cgÉf_compÚ’t_ty³_r_8
:

2138  *((cÚ¡ 
št8_t
*è
š
);

2139 
cgÉf_compÚ’t_ty³_r_8u
:

2140  *((cÚ¡ 
ušt8_t
*è
š
);

2144 
	}
}

2146 
cgÉf_size
 
	$cgÉf_compÚ’t_»ad_šdex
(cÚ¡ * 
š
, 
cgÉf_compÚ’t_ty³
 
compÚ’t_ty³
)

2148 
compÚ’t_ty³
)

2150 
cgÉf_compÚ’t_ty³_r_16u
:

2151  *((cÚ¡ 
ušt16_t
*è
š
);

2152 
cgÉf_compÚ’t_ty³_r_32u
:

2153  *((cÚ¡ 
ušt32_t
*è
š
);

2154 
cgÉf_compÚ’t_ty³_r_32f
:

2155  (
cgÉf_size
)*((cÚ¡ *è
š
);

2156 
cgÉf_compÚ’t_ty³_r_8u
:

2157  *((cÚ¡ 
ušt8_t
*è
š
);

2161 
	}
}

2163 
cgÉf_æßt
 
	$cgÉf_compÚ’t_»ad_æßt
(cÚ¡ * 
š
, 
cgÉf_compÚ’t_ty³
 
compÚ’t_ty³
, 
cgÉf_boŞ
 
nÜm®ized
)

2165 ià(
compÚ’t_ty³
 =ğ
cgÉf_compÚ’t_ty³_r_32f
)

2167  *((cÚ¡ *è
š
);

2170 ià(
nÜm®ized
)

2172 
compÚ’t_ty³
)

2175 
cgÉf_compÚ’t_ty³_r_16
:

2176  *((cÚ¡ 
št16_t
*è
š
è/ (
cgÉf_æßt
)32767;

2177 
cgÉf_compÚ’t_ty³_r_16u
:

2178  *((cÚ¡ 
ušt16_t
*è
š
è/ (
cgÉf_æßt
)65535;

2179 
cgÉf_compÚ’t_ty³_r_8
:

2180  *((cÚ¡ 
št8_t
*è
š
è/ (
cgÉf_æßt
)127;

2181 
cgÉf_compÚ’t_ty³_r_8u
:

2182  *((cÚ¡ 
ušt8_t
*è
š
è/ (
cgÉf_æßt
)255;

2188  (
cgÉf_æßt
)
	`cgÉf_compÚ’t_»ad_š‹g”
(
š
, 
compÚ’t_ty³
);

2189 
	}
}

2191 
cgÉf_size
 
cgÉf_compÚ’t_size
(
cgÉf_compÚ’t_ty³
 
compÚ’t_ty³
);

2193 
cgÉf_boŞ
 
	$cgÉf_–em’t_»ad_æßt
(cÚ¡ 
ušt8_t
* 
–em’t
, 
cgÉf_ty³
 
ty³
, 
cgÉf_compÚ’t_ty³
 
compÚ’t_ty³
, 
cgÉf_boŞ
 
nÜm®ized
, 
cgÉf_æßt
* 
out
, 
cgÉf_size
 
–em’t_size
)

2195 
cgÉf_size
 
num_compÚ’ts
 = 
	`cgÉf_num_compÚ’ts
(
ty³
);

2197 ià(
–em’t_size
 < 
num_compÚ’ts
) {

2203 
cgÉf_size
 
compÚ’t_size
 = 
	`cgÉf_compÚ’t_size
(
compÚ’t_ty³
);

2205 ià(
ty³
 =ğ
cgÉf_ty³_m©2
 && 
compÚ’t_size
 == 1)

2207 
out
[0] = 
	`cgÉf_compÚ’t_»ad_æßt
(
–em’t
, 
compÚ’t_ty³
, 
nÜm®ized
);

2208 
out
[1] = 
	`cgÉf_compÚ’t_»ad_æßt
(
–em’t
 + 1, 
compÚ’t_ty³
, 
nÜm®ized
);

2209 
out
[2] = 
	`cgÉf_compÚ’t_»ad_æßt
(
–em’t
 + 4, 
compÚ’t_ty³
, 
nÜm®ized
);

2210 
out
[3] = 
	`cgÉf_compÚ’t_»ad_æßt
(
–em’t
 + 5, 
compÚ’t_ty³
, 
nÜm®ized
);

2214 ià(
ty³
 =ğ
cgÉf_ty³_m©3
 && 
compÚ’t_size
 == 1)

2216 
out
[0] = 
	`cgÉf_compÚ’t_»ad_æßt
(
–em’t
, 
compÚ’t_ty³
, 
nÜm®ized
);

2217 
out
[1] = 
	`cgÉf_compÚ’t_»ad_æßt
(
–em’t
 + 1, 
compÚ’t_ty³
, 
nÜm®ized
);

2218 
out
[2] = 
	`cgÉf_compÚ’t_»ad_æßt
(
–em’t
 + 2, 
compÚ’t_ty³
, 
nÜm®ized
);

2219 
out
[3] = 
	`cgÉf_compÚ’t_»ad_æßt
(
–em’t
 + 4, 
compÚ’t_ty³
, 
nÜm®ized
);

2220 
out
[4] = 
	`cgÉf_compÚ’t_»ad_æßt
(
–em’t
 + 5, 
compÚ’t_ty³
, 
nÜm®ized
);

2221 
out
[5] = 
	`cgÉf_compÚ’t_»ad_æßt
(
–em’t
 + 6, 
compÚ’t_ty³
, 
nÜm®ized
);

2222 
out
[6] = 
	`cgÉf_compÚ’t_»ad_æßt
(
–em’t
 + 8, 
compÚ’t_ty³
, 
nÜm®ized
);

2223 
out
[7] = 
	`cgÉf_compÚ’t_»ad_æßt
(
–em’t
 + 9, 
compÚ’t_ty³
, 
nÜm®ized
);

2224 
out
[8] = 
	`cgÉf_compÚ’t_»ad_æßt
(
–em’t
 + 10, 
compÚ’t_ty³
, 
nÜm®ized
);

2228 ià(
ty³
 =ğ
cgÉf_ty³_m©3
 && 
compÚ’t_size
 == 2)

2230 
out
[0] = 
	`cgÉf_compÚ’t_»ad_æßt
(
–em’t
, 
compÚ’t_ty³
, 
nÜm®ized
);

2231 
out
[1] = 
	`cgÉf_compÚ’t_»ad_æßt
(
–em’t
 + 2, 
compÚ’t_ty³
, 
nÜm®ized
);

2232 
out
[2] = 
	`cgÉf_compÚ’t_»ad_æßt
(
–em’t
 + 4, 
compÚ’t_ty³
, 
nÜm®ized
);

2233 
out
[3] = 
	`cgÉf_compÚ’t_»ad_æßt
(
–em’t
 + 8, 
compÚ’t_ty³
, 
nÜm®ized
);

2234 
out
[4] = 
	`cgÉf_compÚ’t_»ad_æßt
(
–em’t
 + 10, 
compÚ’t_ty³
, 
nÜm®ized
);

2235 
out
[5] = 
	`cgÉf_compÚ’t_»ad_æßt
(
–em’t
 + 12, 
compÚ’t_ty³
, 
nÜm®ized
);

2236 
out
[6] = 
	`cgÉf_compÚ’t_»ad_æßt
(
–em’t
 + 16, 
compÚ’t_ty³
, 
nÜm®ized
);

2237 
out
[7] = 
	`cgÉf_compÚ’t_»ad_æßt
(
–em’t
 + 18, 
compÚ’t_ty³
, 
nÜm®ized
);

2238 
out
[8] = 
	`cgÉf_compÚ’t_»ad_æßt
(
–em’t
 + 20, 
compÚ’t_ty³
, 
nÜm®ized
);

2242 
cgÉf_size
 
i
 = 0; i < 
num_compÚ’ts
; ++i)

2244 
out
[
i
] = 
	`cgÉf_compÚ’t_»ad_æßt
(
–em’t
 + 
compÚ’t_size
 * i, 
compÚ’t_ty³
, 
nÜm®ized
);

2247 
	}
}

2249 cÚ¡ 
ušt8_t
* 
	$cgÉf_bufãr_v›w_d©a
(cÚ¡ 
cgÉf_bufãr_v›w
* 
v›w
)

2251 ià(
v›w
->
d©a
)

2252  (cÚ¡ 
ušt8_t
*)
v›w
->
d©a
;

2254 ià(!
v›w
->
bufãr
->
d©a
)

2255  
NULL
;

2257 cÚ¡ 
ušt8_t
* 
»suÉ
 = (cÚ¡ ušt8_t*)
v›w
->
bufãr
->
d©a
;

2258 
»suÉ
 +ğ
v›w
->
off£t
;

2259  
»suÉ
;

2260 
	}
}

2262 
cgÉf_boŞ
 
	$cgÉf_acûssÜ_»ad_æßt
(cÚ¡ 
cgÉf_acûssÜ
* 
acûssÜ
, 
cgÉf_size
 
šdex
, 
cgÉf_æßt
* 
out
, cgÉf_siz
–em’t_size
)

2264 ià(
acûssÜ
->
is_¥¬£
)

2268 ià(
acûssÜ
->
bufãr_v›w
 =ğ
NULL
)

2270 
	`mem£t
(
out
, 0, 
–em’t_size
 * (
cgÉf_æßt
));

2273 cÚ¡ 
ušt8_t
* 
–em’t
 = 
	`cgÉf_bufãr_v›w_d©a
(
acûssÜ
->
bufãr_v›w
);

2274 ià(
–em’t
 =ğ
NULL
)

2278 
–em’t
 +ğ
acûssÜ
->
off£t
 +‡cûssÜ->
¡ride
 * 
šdex
;

2279  
	`cgÉf_–em’t_»ad_æßt
(
–em’t
, 
acûssÜ
->
ty³
,‡cûssÜ->
compÚ’t_ty³
,‡cûssÜ->
nÜm®ized
, 
out
, 
–em’t_size
);

2280 
	}
}

2282 
cgÉf_size
 
	$cgÉf_acûssÜ_uÅack_æßts
(cÚ¡ 
cgÉf_acûssÜ
* 
acûssÜ
, 
cgÉf_æßt
* 
out
, 
cgÉf_size
 
æßt_couÁ
)

2284 
cgÉf_size
 
æßts_³r_–em’t
 = 
	`cgÉf_num_compÚ’ts
(
acûssÜ
->
ty³
);

2285 
cgÉf_size
 
avaabË_æßts
 = 
acûssÜ
->
couÁ
 * 
æßts_³r_–em’t
;

2286 ià(
out
 =ğ
NULL
)

2288  
avaabË_æßts
;

2291 
æßt_couÁ
 = 
avaabË_æßts
 < float_count ?‡vailable_floats : float_count;

2292 
cgÉf_size
 
–em’t_couÁ
 = 
æßt_couÁ
 / 
æßts_³r_–em’t
;

2295 
cgÉf_æßt
* 
de¡
 = 
out
;

2296 
cgÉf_acûssÜ
 
d’£
 = *
acûssÜ
;

2297 
d’£
.
is_¥¬£
 = 0;

2298 
cgÉf_size
 
šdex
 = 0; index < 
–em’t_couÁ
; index++, 
de¡
 +ğ
æßts_³r_–em’t
)

2300 ià(!
	`cgÉf_acûssÜ_»ad_æßt
(&
d’£
, 
šdex
, 
de¡
, 
æßts_³r_–em’t
))

2307 ià(
acûssÜ
->
is_¥¬£
)

2309 cÚ¡ 
cgÉf_acûssÜ_¥¬£
* 
¥¬£
 = &
d’£
.sparse;

2311 cÚ¡ 
ušt8_t
* 
šdex_d©a
 = 
	`cgÉf_bufãr_v›w_d©a
(
¥¬£
->
šdiûs_bufãr_v›w
);

2312 cÚ¡ 
ušt8_t
* 
»ad”_h—d
 = 
	`cgÉf_bufãr_v›w_d©a
(
¥¬£
->
v®ues_bufãr_v›w
);

2314 ià(
šdex_d©a
 =ğ
NULL
 || 
»ad”_h—d
 == NULL)

2319 
šdex_d©a
 +ğ
¥¬£
->
šdiûs_by‹_off£t
;

2320 
»ad”_h—d
 +ğ
¥¬£
->
v®ues_by‹_off£t
;

2322 
cgÉf_size
 
šdex_¡ride
 = 
	`cgÉf_compÚ’t_size
(
¥¬£
->
šdiûs_compÚ’t_ty³
);

2323 
cgÉf_size
 
»ad”_šdex
 = 0;„—d”_šdex < 
¥¬£
->
couÁ
;„—d”_šdex++, 
šdex_d©a
 +ğ
šdex_¡ride
)

2325 
size_t
 
wr™”_šdex
 = 
	`cgÉf_compÚ’t_»ad_šdex
(
šdex_d©a
, 
¥¬£
->
šdiûs_compÚ’t_ty³
);

2326 * 
wr™”_h—d
 = 
out
 + 
wr™”_šdex
 * 
æßts_³r_–em’t
;

2328 ià(!
	`cgÉf_–em’t_»ad_æßt
(
»ad”_h—d
, 
d’£
.
ty³
, d’£.
compÚ’t_ty³
, d’£.
nÜm®ized
, 
wr™”_h—d
, 
æßts_³r_–em’t
))

2333 
»ad”_h—d
 +ğ
d’£
.
¡ride
;

2337  
–em’t_couÁ
 * 
æßts_³r_–em’t
;

2338 
	}
}

2340 
cgÉf_ušt
 
	$cgÉf_compÚ’t_»ad_ušt
(cÚ¡ * 
š
, 
cgÉf_compÚ’t_ty³
 
compÚ’t_ty³
)

2342 
compÚ’t_ty³
)

2344 
cgÉf_compÚ’t_ty³_r_8
:

2345  *((cÚ¡ 
št8_t
*è
š
);

2347 
cgÉf_compÚ’t_ty³_r_8u
:

2348  *((cÚ¡ 
ušt8_t
*è
š
);

2350 
cgÉf_compÚ’t_ty³_r_16
:

2351  *((cÚ¡ 
št16_t
*è
š
);

2353 
cgÉf_compÚ’t_ty³_r_16u
:

2354  *((cÚ¡ 
ušt16_t
*è
š
);

2356 
cgÉf_compÚ’t_ty³_r_32u
:

2357  *((cÚ¡ 
ušt32_t
*è
š
);

2362 
	}
}

2364 
cgÉf_boŞ
 
	$cgÉf_–em’t_»ad_ušt
(cÚ¡ 
ušt8_t
* 
–em’t
, 
cgÉf_ty³
 
ty³
, 
cgÉf_compÚ’t_ty³
 
compÚ’t_ty³
, 
cgÉf_ušt
* 
out
, 
cgÉf_size
 
–em’t_size
)

2366 
cgÉf_size
 
num_compÚ’ts
 = 
	`cgÉf_num_compÚ’ts
(
ty³
);

2368 ià(
–em’t_size
 < 
num_compÚ’ts
)

2374 ià(
ty³
 =ğ
cgÉf_ty³_m©2
 ||y³ =ğ
cgÉf_ty³_m©3
 ||y³ =ğ
cgÉf_ty³_m©4
)

2379 
cgÉf_size
 
compÚ’t_size
 = 
	`cgÉf_compÚ’t_size
(
compÚ’t_ty³
);

2381 
cgÉf_size
 
i
 = 0; i < 
num_compÚ’ts
; ++i)

2383 
out
[
i
] = 
	`cgÉf_compÚ’t_»ad_ušt
(
–em’t
 + 
compÚ’t_size
 * i, 
compÚ’t_ty³
);

2386 
	}
}

2388 
cgÉf_boŞ
 
	$cgÉf_acûssÜ_»ad_ušt
(cÚ¡ 
cgÉf_acûssÜ
* 
acûssÜ
, 
cgÉf_size
 
šdex
, 
cgÉf_ušt
* 
out
, cgÉf_siz
–em’t_size
)

2390 ià(
acûssÜ
->
is_¥¬£
)

2394 ià(
acûssÜ
->
bufãr_v›w
 =ğ
NULL
)

2396 
	`mem£t
(
out
, 0, 
–em’t_size
 * Ğ
cgÉf_ušt
 ));

2399 cÚ¡ 
ušt8_t
* 
–em’t
 = 
	`cgÉf_bufãr_v›w_d©a
(
acûssÜ
->
bufãr_v›w
);

2400 ià(
–em’t
 =ğ
NULL
)

2404 
–em’t
 +ğ
acûssÜ
->
off£t
 +‡cûssÜ->
¡ride
 * 
šdex
;

2405  
	`cgÉf_–em’t_»ad_ušt
(
–em’t
, 
acûssÜ
->
ty³
,‡cûssÜ->
compÚ’t_ty³
, 
out
, 
–em’t_size
);

2406 
	}
}

2408 
cgÉf_size
 
	$cgÉf_acûssÜ_»ad_šdex
(cÚ¡ 
cgÉf_acûssÜ
* 
acûssÜ
, 
cgÉf_size
 
šdex
)

2410 ià(
acûssÜ
->
is_¥¬£
)

2414 ià(
acûssÜ
->
bufãr_v›w
 =ğ
NULL
)

2418 cÚ¡ 
ušt8_t
* 
–em’t
 = 
	`cgÉf_bufãr_v›w_d©a
(
acûssÜ
->
bufãr_v›w
);

2419 ià(
–em’t
 =ğ
NULL
)

2423 
–em’t
 +ğ
acûssÜ
->
off£t
 +‡cûssÜ->
¡ride
 * 
šdex
;

2424  
	`cgÉf_compÚ’t_»ad_šdex
(
–em’t
, 
acûssÜ
->
compÚ’t_ty³
);

2425 
	}
}

2427 
	#CGLTF_ERROR_JSON
 -1

	)

2428 
	#CGLTF_ERROR_NOMEM
 -2

	)

2429 
	#CGLTF_ERROR_LEGACY
 -3

	)

2431 
	#CGLTF_CHECK_TOKTYPE
(
tok_
, 
ty³_
èià(Ñok_).
ty³
 !ğÑy³_)è{  
CGLTF_ERROR_JSON
; }

	)

2432 
	#CGLTF_CHECK_TOKTYPE_RETTYPE
(
tok_
, 
ty³_
, 
»t_
èià(Ñok_).
ty³
 !ğÑy³_)è{  (»t_)
CGLTF_ERROR_JSON
; }

	)

2433 
	#CGLTF_CHECK_KEY
(
tok_
èià(Ñok_).
ty³
 !ğ
JSMN_STRING
 || (tok_).
size
 =ğ0è{  
CGLTF_ERROR_JSON
; }

	)

2435 
	#CGLTF_PTRINDEX
(
ty³
, 
idx
èÑy³*)((
cgÉf_size
)idx + 1)

	)

2436 
	#CGLTF_PTRFIXUP
(
v¬
, 
d©a
, 
size
èià(v¬è{ ià((
cgÉf_size
)v¬ > sizeè{  
CGLTF_ERROR_JSON
; } v¬ = &d©a[(cgÉf_size)v¬-1]; }

	)

2437 
	#CGLTF_PTRFIXUP_REQ
(
v¬
, 
d©a
, 
size
èià(!v¬ || (
cgÉf_size
)v¬ > sizeè{  
CGLTF_ERROR_JSON
; } v¬ = &d©a[(cgÉf_size)v¬-1];

	)

2439 
	$cgÉf_jsÚ_¡rcmp
(
jsmÁok_t
 cÚ¡* 
tok
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, cÚ¡ * 
¡r
)

2441 
	`CGLTF_CHECK_TOKTYPE
(*
tok
, 
JSMN_STRING
);

2442 
size_t
 cÚ¡ 
¡r_Ën
 = 
	`¡¾’
(
¡r
);

2443 
size_t
 cÚ¡ 
Çme_Ëngth
 = 
tok
->
’d
 -ok->
¡¬t
;

2444  (
¡r_Ën
 =ğ
Çme_Ëngth
è? 
	`¡ºcmp
((cÚ¡ *)
jsÚ_chunk
 + 
tok
->
¡¬t
, 
¡r
, str_len) : 128;

2445 
	}
}

2447 
	$cgÉf_jsÚ_to_št
(
jsmÁok_t
 cÚ¡* 
tok
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
)

2449 
	`CGLTF_CHECK_TOKTYPE
(*
tok
, 
JSMN_PRIMITIVE
);

2450 
tmp
[128];

2451 
size
 = (
cgÉf_size
)(
tok
->
’d
 -ok->
¡¬t
è< (
tmp
) ?ok->end -ok->start : ()((tmp) - 1);

2452 
	`¡ºıy
(
tmp
, (cÚ¡ *)
jsÚ_chunk
 + 
tok
->
¡¬t
, 
size
);

2453 
tmp
[
size
] = 0;

2454  
	`CGLTF_ATOI
(
tmp
);

2455 
	}
}

2457 
cgÉf_size
 
	$cgÉf_jsÚ_to_size
(
jsmÁok_t
 cÚ¡* 
tok
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
)

2459 
	`CGLTF_CHECK_TOKTYPE_RETTYPE
(*
tok
, 
JSMN_PRIMITIVE
, 
cgÉf_size
);

2460 
tmp
[128];

2461 
size
 = (
cgÉf_size
)(
tok
->
’d
 -ok->
¡¬t
è< (
tmp
) ?ok->end -ok->start : ()((tmp) - 1);

2462 
	`¡ºıy
(
tmp
, (cÚ¡ *)
jsÚ_chunk
 + 
tok
->
¡¬t
, 
size
);

2463 
tmp
[
size
] = 0;

2464  (
cgÉf_size
)
	`CGLTF_ATOLL
(
tmp
);

2465 
	}
}

2467 
cgÉf_æßt
 
	$cgÉf_jsÚ_to_æßt
(
jsmÁok_t
 cÚ¡* 
tok
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
)

2469 
	`CGLTF_CHECK_TOKTYPE
(*
tok
, 
JSMN_PRIMITIVE
);

2470 
tmp
[128];

2471 
size
 = (
cgÉf_size
)(
tok
->
’d
 -ok->
¡¬t
è< (
tmp
) ?ok->end -ok->start : ()((tmp) - 1);

2472 
	`¡ºıy
(
tmp
, (cÚ¡ *)
jsÚ_chunk
 + 
tok
->
¡¬t
, 
size
);

2473 
tmp
[
size
] = 0;

2474  (
cgÉf_æßt
)
	`CGLTF_ATOF
(
tmp
);

2475 
	}
}

2477 
cgÉf_boŞ
 
	$cgÉf_jsÚ_to_boŞ
(
jsmÁok_t
 cÚ¡* 
tok
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
)

2479 
size
 = 
tok
->
’d
 -ok->
¡¬t
;

2480  
size
 =ğ4 && 
	`memcmp
(
jsÚ_chunk
 + 
tok
->
¡¬t
, "true", 4) == 0;

2481 
	}
}

2483 
	$cgÉf_sk_jsÚ
(
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
)

2485 
’d
 = 
i
 + 1;

2487 
i
 < 
’d
)

2489 
tok’s
[
i
].
ty³
)

2491 
JSMN_OBJECT
:

2492 
’d
 +ğ
tok’s
[
i
].
size
 * 2;

2495 
JSMN_ARRAY
:

2496 
’d
 +ğ
tok’s
[
i
].
size
;

2499 
JSMN_PRIMITIVE
:

2500 
JSMN_STRING
:

2507 
i
++;

2510  
i
;

2511 
	}
}

2513 
	$cgÉf_fl_æßt_¬¿y
(* 
out_¬¿y
, 
size
, 
v®ue
)

2515 
j
 = 0; j < 
size
; ++j)

2517 
out_¬¿y
[
j
] = 
v®ue
;

2519 
	}
}

2521 
	$cgÉf_·r£_jsÚ_æßt_¬¿y
(
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, * 
out_¬¿y
, 
size
)

2523 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_ARRAY
);

2524 ià(
tok’s
[
i
].
size
 != size)

2526  
CGLTF_ERROR_JSON
;

2528 ++
i
;

2529 
j
 = 0; j < 
size
; ++j)

2531 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_PRIMITIVE
);

2532 
out_¬¿y
[
j
] = 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

2533 ++
i
;

2535  
i
;

2536 
	}
}

2538 
	$cgÉf_·r£_jsÚ_¡ršg
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, ** 
out_¡ršg
)

2540 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_STRING
);

2541 ià(*
out_¡ršg
)

2543  
CGLTF_ERROR_JSON
;

2545 
size
 = 
tok’s
[
i
].
’d
 -ok’s[i].
¡¬t
;

2546 * 
»suÉ
 = (*)
İtiÚs
->
memÜy
.
	`®loc_func
(İtiÚs->memÜy.
u£r_d©a
, 
size
 + 1);

2547 ià(!
»suÉ
)

2549  
CGLTF_ERROR_NOMEM
;

2551 
	`¡ºıy
(
»suÉ
, (cÚ¡ *)
jsÚ_chunk
 + 
tok’s
[
i
].
¡¬t
, 
size
);

2552 
»suÉ
[
size
] = 0;

2553 *
out_¡ršg
 = 
»suÉ
;

2554  
i
 + 1;

2555 
	}
}

2557 
	$cgÉf_·r£_jsÚ_¬¿y
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
size_t
 
–em’t_size
, ** 
out_¬¿y
, 
cgÉf_size
* 
out_size
)

2559 ()
jsÚ_chunk
;

2560 ià(
tok’s
[
i
].
ty³
 !ğ
JSMN_ARRAY
)

2562  
tok’s
[
i
].
ty³
 =ğ
JSMN_OBJECT
 ? 
CGLTF_ERROR_LEGACY
 : 
CGLTF_ERROR_JSON
;

2564 ià(*
out_¬¿y
)

2566  
CGLTF_ERROR_JSON
;

2568 
size
 = 
tok’s
[
i
].size;

2569 * 
»suÉ
 = 
	`cgÉf_ÿÎoc
(
İtiÚs
, 
–em’t_size
, 
size
);

2570 ià(!
»suÉ
)

2572  
CGLTF_ERROR_NOMEM
;

2574 *
out_¬¿y
 = 
»suÉ
;

2575 *
out_size
 = 
size
;

2576  
i
 + 1;

2577 
	}
}

2579 
	$cgÉf_·r£_jsÚ_¡ršg_¬¿y
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, *** 
out_¬¿y
, 
cgÉf_size
* 
out_size
)

2581 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_ARRAY
);

2582 
i
 = 
	`cgÉf_·r£_jsÚ_¬¿y
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, (*), (**)
out_¬¿y
, 
out_size
);

2583 ià(
i
 < 0)

2585  
i
;

2588 
cgÉf_size
 
j
 = 0; j < *
out_size
; ++j)

2590 
i
 = 
	`cgÉf_·r£_jsÚ_¡ršg
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, 
j
 + (*
out_¬¿y
));

2591 ià(
i
 < 0)

2593  
i
;

2596  
i
;

2597 
	}
}

2599 
	$cgÉf_·r£_©Œibu‹_ty³
(cÚ¡ * 
Çme
, 
cgÉf_©Œibu‹_ty³
* 
out_ty³
, * 
out_šdex
)

2601 ià(*
Çme
 == '_')

2603 *
out_ty³
 = 
cgÉf_©Œibu‹_ty³_cu¡om
;

2607 cÚ¡ * 
us
 = 
	`¡rchr
(
Çme
, '_');

2608 
size_t
 
Ën
 = 
us
 ? (size_t)(u - 
Çme
è: 
	`¡¾’
(name);

2610 ià(
Ën
 =ğ8 && 
	`¡ºcmp
(
Çme
, "POSITION", 8) == 0)

2612 *
out_ty³
 = 
cgÉf_©Œibu‹_ty³_pos™iÚ
;

2614 ià(
Ën
 =ğ6 && 
	`¡ºcmp
(
Çme
, "NORMAL", 6) == 0)

2616 *
out_ty³
 = 
cgÉf_©Œibu‹_ty³_nÜm®
;

2618 ià(
Ën
 =ğ7 && 
	`¡ºcmp
(
Çme
, "TANGENT", 7) == 0)

2620 *
out_ty³
 = 
cgÉf_©Œibu‹_ty³_ng’t
;

2622 ià(
Ën
 =ğ8 && 
	`¡ºcmp
(
Çme
, "TEXCOORD", 8) == 0)

2624 *
out_ty³
 = 
cgÉf_©Œibu‹_ty³_‹xcoÜd
;

2626 ià(
Ën
 =ğ5 && 
	`¡ºcmp
(
Çme
, "COLOR", 5) == 0)

2628 *
out_ty³
 = 
cgÉf_©Œibu‹_ty³_cŞÜ
;

2630 ià(
Ën
 =ğ6 && 
	`¡ºcmp
(
Çme
, "JOINTS", 6) == 0)

2632 *
out_ty³
 = 
cgÉf_©Œibu‹_ty³_jošts
;

2634 ià(
Ën
 =ğ7 && 
	`¡ºcmp
(
Çme
, "WEIGHTS", 7) == 0)

2636 *
out_ty³
 = 
cgÉf_©Œibu‹_ty³_weights
;

2640 *
out_ty³
 = 
cgÉf_©Œibu‹_ty³_šv®id
;

2643 ià(
us
 && *
out_ty³
 !ğ
cgÉf_©Œibu‹_ty³_šv®id
)

2645 *
out_šdex
 = 
	`CGLTF_ATOI
(
us
 + 1);

2647 
	}
}

2649 
	$cgÉf_·r£_jsÚ_©Œibu‹_li¡
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_©Œibu‹
** 
out_©Œibu‹s
, 
cgÉf_size
* 
out_©Œibu‹s_couÁ
)

2651 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

2653 ià(*
out_©Œibu‹s
)

2655  
CGLTF_ERROR_JSON
;

2658 *
out_©Œibu‹s_couÁ
 = 
tok’s
[
i
].
size
;

2659 *
out_©Œibu‹s
 = (
cgÉf_©Œibu‹
*)
	`cgÉf_ÿÎoc
(
İtiÚs
, (cgÉf_©Œibu‹), *
out_©Œibu‹s_couÁ
);

2660 ++
i
;

2662 ià(!*
out_©Œibu‹s
)

2664  
CGLTF_ERROR_NOMEM
;

2667 
cgÉf_size
 
j
 = 0; j < *
out_©Œibu‹s_couÁ
; ++j)

2669 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

2671 
i
 = 
	`cgÉf_·r£_jsÚ_¡ršg
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &(*
out_©Œibu‹s
)[
j
].
Çme
);

2672 ià(
i
 < 0)

2674  
CGLTF_ERROR_JSON
;

2677 
	`cgÉf_·r£_©Œibu‹_ty³
((*
out_©Œibu‹s
)[
j
].
Çme
, &(*out_©Œibu‹s)[j].
ty³
, &(*out_©Œibu‹s)[j].
šdex
);

2679 (*
out_©Œibu‹s
)[
j
].
d©a
 = 
	`CGLTF_PTRINDEX
(
cgÉf_acûssÜ
, 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
));

2680 ++
i
;

2683  
i
;

2684 
	}
}

2686 
	$cgÉf_·r£_jsÚ_exŒas
(
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_exŒas
* 
out_exŒas
)

2688 ()
jsÚ_chunk
;

2689 
out_exŒas
->
¡¬t_off£t
 = 
tok’s
[
i
].
¡¬t
;

2690 
out_exŒas
->
’d_off£t
 = 
tok’s
[
i
].
’d
;

2691 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i);

2692  
i
;

2693 
	}
}

2695 
	$cgÉf_·r£_jsÚ_uÅroûs£d_ex‹nsiÚ
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_ex‹nsiÚ
* 
out_ex‹nsiÚ
)

2697 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_STRING
);

2698 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
+1], 
JSMN_OBJECT
);

2699 ià(
out_ex‹nsiÚ
->
Çme
)

2701  
CGLTF_ERROR_JSON
;

2704 
cgÉf_size
 
Çme_Ëngth
 = 
tok’s
[
i
].
’d
 -ok’s[i].
¡¬t
;

2705 
out_ex‹nsiÚ
->
Çme
 = (*)
İtiÚs
->
memÜy
.
	`®loc_func
(İtiÚs->memÜy.
u£r_d©a
, 
Çme_Ëngth
 + 1);

2706 ià(!
out_ex‹nsiÚ
->
Çme
)

2708  
CGLTF_ERROR_NOMEM
;

2710 
	`¡ºıy
(
out_ex‹nsiÚ
->
Çme
, (cÚ¡ *)
jsÚ_chunk
 + 
tok’s
[
i
].
¡¬t
, 
Çme_Ëngth
);

2711 
out_ex‹nsiÚ
->
Çme
[
Çme_Ëngth
] = 0;

2712 
i
++;

2714 
size_t
 
¡¬t
 = 
tok’s
[
i
].start;

2715 
size_t
 
size
 = 
tok’s
[
i
].
’d
 - 
¡¬t
;

2716 
out_ex‹nsiÚ
->
d©a
 = (*)
İtiÚs
->
memÜy
.
	`®loc_func
(İtiÚs->memÜy.
u£r_d©a
, 
size
 + 1);

2717 ià(!
out_ex‹nsiÚ
->
d©a
)

2719  
CGLTF_ERROR_NOMEM
;

2721 
	`¡ºıy
(
out_ex‹nsiÚ
->
d©a
, (cÚ¡ *)
jsÚ_chunk
 + 
¡¬t
, 
size
);

2722 
out_ex‹nsiÚ
->
d©a
[
size
] = '\0';

2724 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i);

2726  
i
;

2727 
	}
}

2729 
	$cgÉf_·r£_jsÚ_uÅroûs£d_ex‹nsiÚs
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_size
* 
out_ex‹nsiÚs_couÁ
, 
cgÉf_ex‹nsiÚ
** 
out_ex‹nsiÚs
)

2731 ++
i
;

2733 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

2734 if(*
out_ex‹nsiÚs
)

2736  
CGLTF_ERROR_JSON
;

2739 
ex‹nsiÚs_size
 = 
tok’s
[
i
].
size
;

2740 *
out_ex‹nsiÚs_couÁ
 = 0;

2741 *
out_ex‹nsiÚs
 = (
cgÉf_ex‹nsiÚ
*)
	`cgÉf_ÿÎoc
(
İtiÚs
, (cgÉf_ex‹nsiÚ), 
ex‹nsiÚs_size
);

2743 ià(!*
out_ex‹nsiÚs
)

2745  
CGLTF_ERROR_NOMEM
;

2748 ++
i
;

2750 
j
 = 0; j < 
ex‹nsiÚs_size
; ++j)

2752 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

2754 
cgÉf_size
 
ex‹nsiÚ_šdex
 = (*
out_ex‹nsiÚs_couÁ
)++;

2755 
cgÉf_ex‹nsiÚ
* 
ex‹nsiÚ
 = &((*
out_ex‹nsiÚs
)[
ex‹nsiÚ_šdex
]);

2756 
i
 = 
	`cgÉf_·r£_jsÚ_uÅroûs£d_ex‹nsiÚ
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, 
ex‹nsiÚ
);

2758 ià(
i
 < 0)

2760  
i
;

2763  
i
;

2764 
	}
}

2766 
	$cgÉf_·r£_jsÚ_d¿co_mesh_com´essiÚ
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_d¿co_mesh_com´essiÚ
* 
out_d¿co_mesh_com´essiÚ
)

2768 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

2770 
size
 = 
tok’s
[
i
].size;

2771 ++
i
;

2773 
j
 = 0; j < 
size
; ++j)

2775 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

2777 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "attributes") == 0)

2779 
i
 = 
	`cgÉf_·r£_jsÚ_©Œibu‹_li¡
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_d¿co_mesh_com´essiÚ
->
©Œibu‹s
, &out_d¿co_mesh_com´essiÚ->
©Œibu‹s_couÁ
);

2781 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "bufferView") == 0)

2783 ++
i
;

2784 
out_d¿co_mesh_com´essiÚ
->
bufãr_v›w
 = 
	`CGLTF_PTRINDEX
(
cgÉf_bufãr_v›w
, 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
));

2785 ++
i
;

2788 ià(
i
 < 0)

2790  
i
;

2794  
i
;

2795 
	}
}

2797 
	$cgÉf_·r£_jsÚ_mesh_gpu_š¡ªcšg
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_mesh_gpu_š¡ªcšg
* 
out_mesh_gpu_š¡ªcšg
)

2799 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

2801 
size
 = 
tok’s
[
i
].size;

2802 ++
i
;

2804 
j
 = 0; j < 
size
; ++j)

2806 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

2808 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "attributes") == 0)

2810 
i
 = 
	`cgÉf_·r£_jsÚ_©Œibu‹_li¡
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_mesh_gpu_š¡ªcšg
->
©Œibu‹s
, &out_mesh_gpu_š¡ªcšg->
©Œibu‹s_couÁ
);

2812 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "bufferView") == 0)

2814 ++
i
;

2815 
out_mesh_gpu_š¡ªcšg
->
bufãr_v›w
 = 
	`CGLTF_PTRINDEX
(
cgÉf_bufãr_v›w
, 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
));

2816 ++
i
;

2819 ià(
i
 < 0)

2821  
i
;

2825  
i
;

2826 
	}
}

2828 
	$cgÉf_·r£_jsÚ_m©”Ÿl_m­pšg_d©a
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_m©”Ÿl_m­pšg
* 
out_m­pšgs
, 
cgÉf_size
* 
off£t
)

2830 ()
İtiÚs
;

2831 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_ARRAY
);

2833 
size
 = 
tok’s
[
i
].size;

2834 ++
i
;

2836 
j
 = 0; j < 
size
; ++j)

2838 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

2840 
obj_size
 = 
tok’s
[
i
].
size
;

2841 ++
i
;

2843 
m©”Ÿl
 = -1;

2844 
v¬ŸÁs_tok
 = -1;

2845 
cgÉf_exŒas
 
exŒas
 = {0, 0};

2847 
k
 = 0; k < 
obj_size
; ++k)

2849 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

2851 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "material") == 0)

2853 ++
i
;

2854 
m©”Ÿl
 = 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
);

2855 ++
i
;

2857 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "variants") == 0)

2859 
v¬ŸÁs_tok
 = 
i
+1;

2860 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
v¬ŸÁs_tok
], 
JSMN_ARRAY
);

2862 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

2864 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extras") == 0)

2866 
i
 = 
	`cgÉf_·r£_jsÚ_exŒas
(
tok’s
, i + 1, 
jsÚ_chunk
, &
exŒas
);

2870 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

2873 ià(
i
 < 0)

2875  
i
;

2879 ià(
m©”Ÿl
 < 0 || 
v¬ŸÁs_tok
 < 0)

2881  
CGLTF_ERROR_JSON
;

2884 ià(
out_m­pšgs
)

2886 
k
 = 0; k < 
tok’s
[
v¬ŸÁs_tok
].
size
; ++k)

2888 
v¬ŸÁ
 = 
	`cgÉf_jsÚ_to_št
(&
tok’s
[
v¬ŸÁs_tok
 + 1 + 
k
], 
jsÚ_chunk
);

2889 ià(
v¬ŸÁ
 < 0)

2890  
v¬ŸÁ
;

2892 
out_m­pšgs
[*
off£t
].
m©”Ÿl
 = 
	`CGLTF_PTRINDEX
(
cgÉf_m©”Ÿl
, material);

2893 
out_m­pšgs
[*
off£t
].
v¬ŸÁ
 = variant;

2894 
out_m­pšgs
[*
off£t
].
exŒas
 =ƒxtras;

2896 (*
off£t
)++;

2901 (*
off£t
è+ğ
tok’s
[
v¬ŸÁs_tok
].
size
;

2905  
i
;

2906 
	}
}

2908 
	$cgÉf_·r£_jsÚ_m©”Ÿl_m­pšgs
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_´im™ive
* 
out_´im
)

2910 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

2912 
size
 = 
tok’s
[
i
].size;

2913 ++
i
;

2915 
j
 = 0; j < 
size
; ++j)

2917 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

2919 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "mappings") == 0)

2921 ià(
out_´im
->
m­pšgs
)

2923  
CGLTF_ERROR_JSON
;

2926 
cgÉf_size
 
m­pšgs_off£t
 = 0;

2927 
k
 = 
	`cgÉf_·r£_jsÚ_m©”Ÿl_m­pšg_d©a
(
İtiÚs
, 
tok’s
, 
i
 + 1, 
jsÚ_chunk
, 
NULL
, &
m­pšgs_off£t
);

2928 ià(
k
 < 0)

2930  
k
;

2933 
out_´im
->
m­pšgs_couÁ
 = 
m­pšgs_off£t
;

2934 
out_´im
->
m­pšgs
 = (
cgÉf_m©”Ÿl_m­pšg
*)
	`cgÉf_ÿÎoc
(
İtiÚs
, (cgÉf_m©”Ÿl_m­pšg), out_´im->
m­pšgs_couÁ
);

2936 
m­pšgs_off£t
 = 0;

2937 
i
 = 
	`cgÉf_·r£_jsÚ_m©”Ÿl_m­pšg_d©a
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, 
out_´im
->
m­pšgs
, &
m­pšgs_off£t
);

2941 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

2944 ià(
i
 < 0)

2946  
i
;

2950  
i
;

2951 
	}
}

2953 
	$cgÉf_·r£_jsÚ_´im™ive
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_´im™ive
* 
out_´im
)

2955 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

2957 
out_´im
->
ty³
 = 
cgÉf_´im™ive_ty³_ŒŸngËs
;

2959 
size
 = 
tok’s
[
i
].size;

2960 ++
i
;

2962 
j
 = 0; j < 
size
; ++j)

2964 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

2966 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "mode") == 0)

2968 ++
i
;

2969 
out_´im
->
ty³


2970 ğ(
cgÉf_´im™ive_ty³
)

2971 
	`cgÉf_jsÚ_to_št
(
tok’s
+
i
, 
jsÚ_chunk
);

2972 ++
i
;

2974 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "indices") == 0)

2976 ++
i
;

2977 
out_´im
->
šdiûs
 = 
	`CGLTF_PTRINDEX
(
cgÉf_acûssÜ
, 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
));

2978 ++
i
;

2980 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "material") == 0)

2982 ++
i
;

2983 
out_´im
->
m©”Ÿl
 = 
	`CGLTF_PTRINDEX
(
cgÉf_m©”Ÿl
, 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
));

2984 ++
i
;

2986 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "attributes") == 0)

2988 
i
 = 
	`cgÉf_·r£_jsÚ_©Œibu‹_li¡
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_´im
->
©Œibu‹s
, &out_´im->
©Œibu‹s_couÁ
);

2990 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "targets") == 0)

2992 
i
 = 
	`cgÉf_·r£_jsÚ_¬¿y
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, (
cgÉf_mÜph_rg‘
), (**)&
out_´im
->
rg‘s
, &out_´im->
rg‘s_couÁ
);

2993 ià(
i
 < 0)

2995  
i
;

2998 
cgÉf_size
 
k
 = 0; k < 
out_´im
->
rg‘s_couÁ
; ++k)

3000 
i
 = 
	`cgÉf_·r£_jsÚ_©Œibu‹_li¡
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_´im
->
rg‘s
[
k
].
©Œibu‹s
, &out_´im->rg‘s[k].
©Œibu‹s_couÁ
);

3001 ià(
i
 < 0)

3003  
i
;

3007 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extras") == 0)

3009 
i
 = 
	`cgÉf_·r£_jsÚ_exŒas
(
tok’s
, i + 1, 
jsÚ_chunk
, &
out_´im
->
exŒas
);

3011 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extensions") == 0)

3013 ++
i
;

3015 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

3016 if(
out_´im
->
ex‹nsiÚs
)

3018  
CGLTF_ERROR_JSON
;

3021 
ex‹nsiÚs_size
 = 
tok’s
[
i
].
size
;

3022 
out_´im
->
ex‹nsiÚs_couÁ
 = 0;

3023 
out_´im
->
ex‹nsiÚs
 = (
cgÉf_ex‹nsiÚ
*)
	`cgÉf_ÿÎoc
(
İtiÚs
, (cgÉf_ex‹nsiÚ), 
ex‹nsiÚs_size
);

3025 ià(!
out_´im
->
ex‹nsiÚs
)

3027  
CGLTF_ERROR_NOMEM
;

3030 ++
i
;

3031 
k
 = 0; k < 
ex‹nsiÚs_size
; ++k)

3033 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

3035 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "KHR_draco_mesh_compression") == 0)

3037 
out_´im
->
has_d¿co_mesh_com´essiÚ
 = 1;

3038 
i
 = 
	`cgÉf_·r£_jsÚ_d¿co_mesh_com´essiÚ
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_´im
->
d¿co_mesh_com´essiÚ
);

3040 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "KHR_materials_variants") == 0)

3042 
i
 = 
	`cgÉf_·r£_jsÚ_m©”Ÿl_m­pšgs
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, 
out_´im
);

3046 
i
 = 
	`cgÉf_·r£_jsÚ_uÅroûs£d_ex‹nsiÚ
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &(
out_´im
->
ex‹nsiÚs
[out_´im->
ex‹nsiÚs_couÁ
++]));

3049 ià(
i
 < 0)

3051  
i
;

3057 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

3060 ià(
i
 < 0)

3062  
i
;

3066  
i
;

3067 
	}
}

3069 
	$cgÉf_·r£_jsÚ_mesh
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_mesh
* 
out_mesh
)

3071 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

3073 
size
 = 
tok’s
[
i
].size;

3074 ++
i
;

3076 
j
 = 0; j < 
size
; ++j)

3078 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

3080 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "name") == 0)

3082 
i
 = 
	`cgÉf_·r£_jsÚ_¡ršg
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_mesh
->
Çme
);

3084 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "primitives") == 0)

3086 
i
 = 
	`cgÉf_·r£_jsÚ_¬¿y
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, (
cgÉf_´im™ive
), (**)&
out_mesh
->
´im™ives
, &out_mesh->
´im™ives_couÁ
);

3087 ià(
i
 < 0)

3089  
i
;

3092 
cgÉf_size
 
´im_šdex
 = 0;…rim_šdex < 
out_mesh
->
´im™ives_couÁ
; ++prim_index)

3094 
i
 = 
	`cgÉf_·r£_jsÚ_´im™ive
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_mesh
->
´im™ives
[
´im_šdex
]);

3095 ià(
i
 < 0)

3097  
i
;

3101 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "weights") == 0)

3103 
i
 = 
	`cgÉf_·r£_jsÚ_¬¿y
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, (
cgÉf_æßt
), (**)&
out_mesh
->
weights
, &out_mesh->
weights_couÁ
);

3104 ià(
i
 < 0)

3106  
i
;

3109 
i
 = 
	`cgÉf_·r£_jsÚ_æßt_¬¿y
(
tok’s
, i - 1, 
jsÚ_chunk
, 
out_mesh
->
weights
, ()out_mesh->
weights_couÁ
);

3111 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extras") == 0)

3113 ++
i
;

3115 
out_mesh
->
exŒas
.
¡¬t_off£t
 = 
tok’s
[
i
].
¡¬t
;

3116 
out_mesh
->
exŒas
.
’d_off£t
 = 
tok’s
[
i
].
’d
;

3118 ià(
tok’s
[
i
].
ty³
 =ğ
JSMN_OBJECT
)

3120 
exŒas_size
 = 
tok’s
[
i
].
size
;

3121 ++
i
;

3123 
k
 = 0; k < 
exŒas_size
; ++k)

3125 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

3127 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "rg‘Names"è=ğ0 &&ok’s[i+1].
ty³
 =ğ
JSMN_ARRAY
)

3129 
i
 = 
	`cgÉf_·r£_jsÚ_¡ršg_¬¿y
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_mesh
->
rg‘_Çmes
, &out_mesh->
rg‘_Çmes_couÁ
);

3133 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

3136 ià(
i
 < 0)

3138  
i
;

3144 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i);

3147 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extensions") == 0)

3149 
i
 = 
	`cgÉf_·r£_jsÚ_uÅroûs£d_ex‹nsiÚs
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_mesh
->
ex‹nsiÚs_couÁ
, &out_mesh->
ex‹nsiÚs
);

3153 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

3156 ià(
i
 < 0)

3158  
i
;

3162  
i
;

3163 
	}
}

3165 
	$cgÉf_·r£_jsÚ_meshes
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_d©a
* 
out_d©a
)

3167 
i
 = 
	`cgÉf_·r£_jsÚ_¬¿y
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, (
cgÉf_mesh
), (**)&
out_d©a
->
meshes
, &out_d©a->
meshes_couÁ
);

3168 ià(
i
 < 0)

3170  
i
;

3173 
cgÉf_size
 
j
 = 0; j < 
out_d©a
->
meshes_couÁ
; ++j)

3175 
i
 = 
	`cgÉf_·r£_jsÚ_mesh
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_d©a
->
meshes
[
j
]);

3176 ià(
i
 < 0)

3178  
i
;

3181  
i
;

3182 
	}
}

3184 
cgÉf_compÚ’t_ty³
 
	$cgÉf_jsÚ_to_compÚ’t_ty³
(
jsmÁok_t
 cÚ¡* 
tok
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
)

3186 
ty³
 = 
	`cgÉf_jsÚ_to_št
(
tok
, 
jsÚ_chunk
);

3188 
ty³
)

3191  
cgÉf_compÚ’t_ty³_r_8
;

3193  
cgÉf_compÚ’t_ty³_r_8u
;

3195  
cgÉf_compÚ’t_ty³_r_16
;

3197  
cgÉf_compÚ’t_ty³_r_16u
;

3199  
cgÉf_compÚ’t_ty³_r_32u
;

3201  
cgÉf_compÚ’t_ty³_r_32f
;

3203  
cgÉf_compÚ’t_ty³_šv®id
;

3205 
	}
}

3207 
	$cgÉf_·r£_jsÚ_acûssÜ_¥¬£
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_acûssÜ_¥¬£
* 
out_¥¬£
)

3209 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

3211 
size
 = 
tok’s
[
i
].size;

3212 ++
i
;

3214 
j
 = 0; j < 
size
; ++j)

3216 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

3218 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "count") == 0)

3220 ++
i
;

3221 
out_¥¬£
->
couÁ
 = 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
);

3222 ++
i
;

3224 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "indices") == 0)

3226 ++
i
;

3227 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

3229 
šdiûs_size
 = 
tok’s
[
i
].
size
;

3230 ++
i
;

3232 
k
 = 0; k < 
šdiûs_size
; ++k)

3234 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

3236 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "bufferView") == 0)

3238 ++
i
;

3239 
out_¥¬£
->
šdiûs_bufãr_v›w
 = 
	`CGLTF_PTRINDEX
(
cgÉf_bufãr_v›w
, 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
));

3240 ++
i
;

3242 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "byteOffset") == 0)

3244 ++
i
;

3245 
out_¥¬£
->
šdiûs_by‹_off£t
 = 
	`cgÉf_jsÚ_to_size
(
tok’s
 + 
i
, 
jsÚ_chunk
);

3246 ++
i
;

3248 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "componentType") == 0)

3250 ++
i
;

3251 
out_¥¬£
->
šdiûs_compÚ’t_ty³
 = 
	`cgÉf_jsÚ_to_compÚ’t_ty³
(
tok’s
 + 
i
, 
jsÚ_chunk
);

3252 ++
i
;

3254 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extras") == 0)

3256 
i
 = 
	`cgÉf_·r£_jsÚ_exŒas
(
tok’s
, i + 1, 
jsÚ_chunk
, &
out_¥¬£
->
šdiûs_exŒas
);

3258 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extensions") == 0)

3260 
i
 = 
	`cgÉf_·r£_jsÚ_uÅroûs£d_ex‹nsiÚs
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_¥¬£
->
šdiûs_ex‹nsiÚs_couÁ
, &out_¥¬£->
šdiûs_ex‹nsiÚs
);

3264 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

3267 ià(
i
 < 0)

3269  
i
;

3273 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "values") == 0)

3275 ++
i
;

3276 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

3278 
v®ues_size
 = 
tok’s
[
i
].
size
;

3279 ++
i
;

3281 
k
 = 0; k < 
v®ues_size
; ++k)

3283 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

3285 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "bufferView") == 0)

3287 ++
i
;

3288 
out_¥¬£
->
v®ues_bufãr_v›w
 = 
	`CGLTF_PTRINDEX
(
cgÉf_bufãr_v›w
, 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
));

3289 ++
i
;

3291 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "byteOffset") == 0)

3293 ++
i
;

3294 
out_¥¬£
->
v®ues_by‹_off£t
 = 
	`cgÉf_jsÚ_to_size
(
tok’s
 + 
i
, 
jsÚ_chunk
);

3295 ++
i
;

3297 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extras") == 0)

3299 
i
 = 
	`cgÉf_·r£_jsÚ_exŒas
(
tok’s
, i + 1, 
jsÚ_chunk
, &
out_¥¬£
->
v®ues_exŒas
);

3301 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extensions") == 0)

3303 
i
 = 
	`cgÉf_·r£_jsÚ_uÅroûs£d_ex‹nsiÚs
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_¥¬£
->
v®ues_ex‹nsiÚs_couÁ
, &out_¥¬£->
v®ues_ex‹nsiÚs
);

3307 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

3310 ià(
i
 < 0)

3312  
i
;

3316 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extras") == 0)

3318 
i
 = 
	`cgÉf_·r£_jsÚ_exŒas
(
tok’s
, i + 1, 
jsÚ_chunk
, &
out_¥¬£
->
exŒas
);

3320 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extensions") == 0)

3322 
i
 = 
	`cgÉf_·r£_jsÚ_uÅroûs£d_ex‹nsiÚs
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_¥¬£
->
ex‹nsiÚs_couÁ
, &out_¥¬£->
ex‹nsiÚs
);

3326 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

3329 ià(
i
 < 0)

3331  
i
;

3335  
i
;

3336 
	}
}

3338 
	$cgÉf_·r£_jsÚ_acûssÜ
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_acûssÜ
* 
out_acûssÜ
)

3340 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

3342 
size
 = 
tok’s
[
i
].size;

3343 ++
i
;

3345 
j
 = 0; j < 
size
; ++j)

3347 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

3349 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "name") == 0)

3351 
i
 = 
	`cgÉf_·r£_jsÚ_¡ršg
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_acûssÜ
->
Çme
);

3353 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "bufferView") == 0)

3355 ++
i
;

3356 
out_acûssÜ
->
bufãr_v›w
 = 
	`CGLTF_PTRINDEX
(
cgÉf_bufãr_v›w
, 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
));

3357 ++
i
;

3359 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "byteOffset") == 0)

3361 ++
i
;

3362 
out_acûssÜ
->
off£t
 =

3363 
	`cgÉf_jsÚ_to_size
(
tok’s
+
i
, 
jsÚ_chunk
);

3364 ++
i
;

3366 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "componentType") == 0)

3368 ++
i
;

3369 
out_acûssÜ
->
compÚ’t_ty³
 = 
	`cgÉf_jsÚ_to_compÚ’t_ty³
(
tok’s
 + 
i
, 
jsÚ_chunk
);

3370 ++
i
;

3372 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "normalized") == 0)

3374 ++
i
;

3375 
out_acûssÜ
->
nÜm®ized
 = 
	`cgÉf_jsÚ_to_boŞ
(
tok’s
+
i
, 
jsÚ_chunk
);

3376 ++
i
;

3378 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "count") == 0)

3380 ++
i
;

3381 
out_acûssÜ
->
couÁ
 =

3382 
	`cgÉf_jsÚ_to_št
(
tok’s
+
i
, 
jsÚ_chunk
);

3383 ++
i
;

3385 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "type") == 0)

3387 ++
i
;

3388 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "SCALAR") == 0)

3390 
out_acûssÜ
->
ty³
 = 
cgÉf_ty³_sÿÏr
;

3392 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "VEC2") == 0)

3394 
out_acûssÜ
->
ty³
 = 
cgÉf_ty³_vec2
;

3396 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "VEC3") == 0)

3398 
out_acûssÜ
->
ty³
 = 
cgÉf_ty³_vec3
;

3400 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "VEC4") == 0)

3402 
out_acûssÜ
->
ty³
 = 
cgÉf_ty³_vec4
;

3404 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "MAT2") == 0)

3406 
out_acûssÜ
->
ty³
 = 
cgÉf_ty³_m©2
;

3408 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "MAT3") == 0)

3410 
out_acûssÜ
->
ty³
 = 
cgÉf_ty³_m©3
;

3412 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "MAT4") == 0)

3414 
out_acûssÜ
->
ty³
 = 
cgÉf_ty³_m©4
;

3416 ++
i
;

3418 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "min") == 0)

3420 ++
i
;

3421 
out_acûssÜ
->
has_mš
 = 1;

3423 
mš_size
 = 
tok’s
[
i
].
size
 > 16 ? 16 :okens[i].size;

3424 
i
 = 
	`cgÉf_·r£_jsÚ_æßt_¬¿y
(
tok’s
, i, 
jsÚ_chunk
, 
out_acûssÜ
->
mš
, 
mš_size
);

3426 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "max") == 0)

3428 ++
i
;

3429 
out_acûssÜ
->
has_max
 = 1;

3431 
max_size
 = 
tok’s
[
i
].
size
 > 16 ? 16 :okens[i].size;

3432 
i
 = 
	`cgÉf_·r£_jsÚ_æßt_¬¿y
(
tok’s
, i, 
jsÚ_chunk
, 
out_acûssÜ
->
max
, 
max_size
);

3434 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "sparse") == 0)

3436 
out_acûssÜ
->
is_¥¬£
 = 1;

3437 
i
 = 
	`cgÉf_·r£_jsÚ_acûssÜ_¥¬£
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_acûssÜ
->
¥¬£
);

3439 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extras") == 0)

3441 
i
 = 
	`cgÉf_·r£_jsÚ_exŒas
(
tok’s
, i + 1, 
jsÚ_chunk
, &
out_acûssÜ
->
exŒas
);

3443 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extensions") == 0)

3445 
i
 = 
	`cgÉf_·r£_jsÚ_uÅroûs£d_ex‹nsiÚs
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_acûssÜ
->
ex‹nsiÚs_couÁ
, &out_acûssÜ->
ex‹nsiÚs
);

3449 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

3452 ià(
i
 < 0)

3454  
i
;

3458  
i
;

3459 
	}
}

3461 
	$cgÉf_·r£_jsÚ_‹xtu»_ŒªsfÜm
(
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_‹xtu»_ŒªsfÜm
* 
out_‹xtu»_ŒªsfÜm
)

3463 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

3465 
size
 = 
tok’s
[
i
].size;

3466 ++
i
;

3468 
j
 = 0; j < 
size
; ++j)

3470 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

3472 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "offset") == 0)

3474 
i
 = 
	`cgÉf_·r£_jsÚ_æßt_¬¿y
(
tok’s
, i + 1, 
jsÚ_chunk
, 
out_‹xtu»_ŒªsfÜm
->
off£t
, 2);

3476 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "rotation") == 0)

3478 ++
i
;

3479 
out_‹xtu»_ŒªsfÜm
->
rÙ©iÚ
 = 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

3480 ++
i
;

3482 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "scale") == 0)

3484 
i
 = 
	`cgÉf_·r£_jsÚ_æßt_¬¿y
(
tok’s
, i + 1, 
jsÚ_chunk
, 
out_‹xtu»_ŒªsfÜm
->
sÿË
, 2);

3486 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "texCoord") == 0)

3488 ++
i
;

3489 
out_‹xtu»_ŒªsfÜm
->
has_‹xcoÜd
 = 1;

3490 
out_‹xtu»_ŒªsfÜm
->
‹xcoÜd
 = 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
);

3491 ++
i
;

3495 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i + 1);

3498 ià(
i
 < 0)

3500  
i
;

3504  
i
;

3505 
	}
}

3507 
	$cgÉf_·r£_jsÚ_‹xtu»_v›w
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_‹xtu»_v›w
* 
out_‹xtu»_v›w
)

3509 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

3511 
out_‹xtu»_v›w
->
sÿË
 = 1.0f;

3512 
	`cgÉf_fl_æßt_¬¿y
(
out_‹xtu»_v›w
->
ŒªsfÜm
.
sÿË
, 2, 1.0f);

3514 
size
 = 
tok’s
[
i
].size;

3515 ++
i
;

3517 
j
 = 0; j < 
size
; ++j)

3519 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

3521 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "index") == 0)

3523 ++
i
;

3524 
out_‹xtu»_v›w
->
‹xtu»
 = 
	`CGLTF_PTRINDEX
(
cgÉf_‹xtu»
, 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
));

3525 ++
i
;

3527 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "texCoord") == 0)

3529 ++
i
;

3530 
out_‹xtu»_v›w
->
‹xcoÜd
 = 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
);

3531 ++
i
;

3533 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "scale") == 0)

3535 ++
i
;

3536 
out_‹xtu»_v›w
->
sÿË
 = 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

3537 ++
i
;

3539 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "strength") == 0)

3541 ++
i
;

3542 
out_‹xtu»_v›w
->
sÿË
 = 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

3543 ++
i
;

3545 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extras") == 0)

3547 
i
 = 
	`cgÉf_·r£_jsÚ_exŒas
(
tok’s
, i + 1, 
jsÚ_chunk
, &
out_‹xtu»_v›w
->
exŒas
);

3549 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extensions") == 0)

3551 ++
i
;

3553 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

3554 if(
out_‹xtu»_v›w
->
ex‹nsiÚs
)

3556  
CGLTF_ERROR_JSON
;

3559 
ex‹nsiÚs_size
 = 
tok’s
[
i
].
size
;

3560 
out_‹xtu»_v›w
->
ex‹nsiÚs_couÁ
 = 0;

3561 
out_‹xtu»_v›w
->
ex‹nsiÚs
 = (
cgÉf_ex‹nsiÚ
*)
	`cgÉf_ÿÎoc
(
İtiÚs
, (cgÉf_ex‹nsiÚ), 
ex‹nsiÚs_size
);

3563 ià(!
out_‹xtu»_v›w
->
ex‹nsiÚs
)

3565  
CGLTF_ERROR_NOMEM
;

3568 ++
i
;

3570 
k
 = 0; k < 
ex‹nsiÚs_size
; ++k)

3572 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

3574 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "KHR_texture_transform") == 0)

3576 
out_‹xtu»_v›w
->
has_ŒªsfÜm
 = 1;

3577 
i
 = 
	`cgÉf_·r£_jsÚ_‹xtu»_ŒªsfÜm
(
tok’s
, i + 1, 
jsÚ_chunk
, &
out_‹xtu»_v›w
->
ŒªsfÜm
);

3581 
i
 = 
	`cgÉf_·r£_jsÚ_uÅroûs£d_ex‹nsiÚ
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &(
out_‹xtu»_v›w
->
ex‹nsiÚs
[out_‹xtu»_v›w->
ex‹nsiÚs_couÁ
++]));

3584 ià(
i
 < 0)

3586  
i
;

3592 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i + 1);

3595 ià(
i
 < 0)

3597  
i
;

3601  
i
;

3602 
	}
}

3604 
	$cgÉf_·r£_jsÚ_pbr_m‘®lic_roughÃss
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_pbr_m‘®lic_roughÃss
* 
out_pbr
)

3606 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

3608 
size
 = 
tok’s
[
i
].size;

3609 ++
i
;

3611 
j
 = 0; j < 
size
; ++j)

3613 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

3615 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "metallicFactor") == 0)

3617 ++
i
;

3618 
out_pbr
->
m‘®lic_çùÜ
 =

3619 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

3620 ++
i
;

3622 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "roughnessFactor") == 0)

3624 ++
i
;

3625 
out_pbr
->
roughÃss_çùÜ
 =

3626 
	`cgÉf_jsÚ_to_æßt
(
tok’s
+
i
, 
jsÚ_chunk
);

3627 ++
i
;

3629 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "baseColorFactor") == 0)

3631 
i
 = 
	`cgÉf_·r£_jsÚ_æßt_¬¿y
(
tok’s
, i + 1, 
jsÚ_chunk
, 
out_pbr
->
ba£_cŞÜ_çùÜ
, 4);

3633 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "baseColorTexture") == 0)

3635 
i
 = 
	`cgÉf_·r£_jsÚ_‹xtu»_v›w
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
,

3636 &
out_pbr
->
ba£_cŞÜ_‹xtu»
);

3638 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "metallicRoughnessTexture") == 0)

3640 
i
 = 
	`cgÉf_·r£_jsÚ_‹xtu»_v›w
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
,

3641 &
out_pbr
->
m‘®lic_roughÃss_‹xtu»
);

3643 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extras") == 0)

3645 
i
 = 
	`cgÉf_·r£_jsÚ_exŒas
(
tok’s
, i + 1, 
jsÚ_chunk
, &
out_pbr
->
exŒas
);

3649 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

3652 ià(
i
 < 0)

3654  
i
;

3658  
i
;

3659 
	}
}

3661 
	$cgÉf_·r£_jsÚ_pbr_¥ecuÏr_glossšess
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_pbr_¥ecuÏr_glossšess
* 
out_pbr
)

3663 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

3664 
size
 = 
tok’s
[
i
].size;

3665 ++
i
;

3667 
j
 = 0; j < 
size
; ++j)

3669 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

3671 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "diffuseFactor") == 0)

3673 
i
 = 
	`cgÉf_·r£_jsÚ_æßt_¬¿y
(
tok’s
, i + 1, 
jsÚ_chunk
, 
out_pbr
->
diffu£_çùÜ
, 4);

3675 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "specularFactor") == 0)

3677 
i
 = 
	`cgÉf_·r£_jsÚ_æßt_¬¿y
(
tok’s
, i + 1, 
jsÚ_chunk
, 
out_pbr
->
¥ecuÏr_çùÜ
, 3);

3679 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "glossinessFactor") == 0)

3681 ++
i
;

3682 
out_pbr
->
glossšess_çùÜ
 = 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

3683 ++
i
;

3685 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "diffuseTexture") == 0)

3687 
i
 = 
	`cgÉf_·r£_jsÚ_‹xtu»_v›w
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_pbr
->
diffu£_‹xtu»
);

3689 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "specularGlossinessTexture") == 0)

3691 
i
 = 
	`cgÉf_·r£_jsÚ_‹xtu»_v›w
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_pbr
->
¥ecuÏr_glossšess_‹xtu»
);

3695 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

3698 ià(
i
 < 0)

3700  
i
;

3704  
i
;

3705 
	}
}

3707 
	$cgÉf_·r£_jsÚ_ş—rcßt
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_ş—rcßt
* 
out_ş—rcßt
)

3709 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

3710 
size
 = 
tok’s
[
i
].size;

3711 ++
i
;

3713 
j
 = 0; j < 
size
; ++j)

3715 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

3717 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "clearcoatFactor") == 0)

3719 ++
i
;

3720 
out_ş—rcßt
->
ş—rcßt_çùÜ
 = 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

3721 ++
i
;

3723 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "clearcoatRoughnessFactor") == 0)

3725 ++
i
;

3726 
out_ş—rcßt
->
ş—rcßt_roughÃss_çùÜ
 = 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

3727 ++
i
;

3729 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "clearcoatTexture") == 0)

3731 
i
 = 
	`cgÉf_·r£_jsÚ_‹xtu»_v›w
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_ş—rcßt
->
ş—rcßt_‹xtu»
);

3733 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "clearcoatRoughnessTexture") == 0)

3735 
i
 = 
	`cgÉf_·r£_jsÚ_‹xtu»_v›w
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_ş—rcßt
->
ş—rcßt_roughÃss_‹xtu»
);

3737 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "clearcoatNormalTexture") == 0)

3739 
i
 = 
	`cgÉf_·r£_jsÚ_‹xtu»_v›w
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_ş—rcßt
->
ş—rcßt_nÜm®_‹xtu»
);

3743 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

3746 ià(
i
 < 0)

3748  
i
;

3752  
i
;

3753 
	}
}

3755 
	$cgÉf_·r£_jsÚ_iÜ
(
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_iÜ
* 
out_iÜ
)

3757 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

3758 
size
 = 
tok’s
[
i
].size;

3759 ++
i
;

3762 
out_iÜ
->
iÜ
 = 1.5f;

3764 
j
 = 0; j < 
size
; ++j)

3766 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

3768 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "ior") == 0)

3770 ++
i
;

3771 
out_iÜ
->
iÜ
 = 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

3772 ++
i
;

3776 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

3779 ià(
i
 < 0)

3781  
i
;

3785  
i
;

3786 
	}
}

3788 
	$cgÉf_·r£_jsÚ_¥ecuÏr
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_¥ecuÏr
* 
out_¥ecuÏr
)

3790 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

3791 
size
 = 
tok’s
[
i
].size;

3792 ++
i
;

3795 
out_¥ecuÏr
->
¥ecuÏr_çùÜ
 = 1.0f;

3796 
	`cgÉf_fl_æßt_¬¿y
(
out_¥ecuÏr
->
¥ecuÏr_cŞÜ_çùÜ
, 3, 1.0f);

3798 
j
 = 0; j < 
size
; ++j)

3800 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

3802 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "specularFactor") == 0)

3804 ++
i
;

3805 
out_¥ecuÏr
->
¥ecuÏr_çùÜ
 = 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

3806 ++
i
;

3808 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "specularColorFactor") == 0)

3810 
i
 = 
	`cgÉf_·r£_jsÚ_æßt_¬¿y
(
tok’s
, i + 1, 
jsÚ_chunk
, 
out_¥ecuÏr
->
¥ecuÏr_cŞÜ_çùÜ
, 3);

3812 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "specularTexture") == 0)

3814 
i
 = 
	`cgÉf_·r£_jsÚ_‹xtu»_v›w
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_¥ecuÏr
->
¥ecuÏr_‹xtu»
);

3816 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "specularColorTexture") == 0)

3818 
i
 = 
	`cgÉf_·r£_jsÚ_‹xtu»_v›w
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_¥ecuÏr
->
¥ecuÏr_cŞÜ_‹xtu»
);

3822 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

3825 ià(
i
 < 0)

3827  
i
;

3831  
i
;

3832 
	}
}

3834 
	$cgÉf_·r£_jsÚ_ŒªsmissiÚ
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_ŒªsmissiÚ
* 
out_ŒªsmissiÚ
)

3836 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

3837 
size
 = 
tok’s
[
i
].size;

3838 ++
i
;

3840 
j
 = 0; j < 
size
; ++j)

3842 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

3844 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "transmissionFactor") == 0)

3846 ++
i
;

3847 
out_ŒªsmissiÚ
->
ŒªsmissiÚ_çùÜ
 = 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

3848 ++
i
;

3850 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "transmissionTexture") == 0)

3852 
i
 = 
	`cgÉf_·r£_jsÚ_‹xtu»_v›w
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_ŒªsmissiÚ
->
ŒªsmissiÚ_‹xtu»
);

3856 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

3859 ià(
i
 < 0)

3861  
i
;

3865  
i
;

3866 
	}
}

3868 
	$cgÉf_·r£_jsÚ_vŞume
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_vŞume
* 
out_vŞume
)

3870 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

3871 
size
 = 
tok’s
[
i
].size;

3872 ++
i
;

3874 
j
 = 0; j < 
size
; ++j)

3876 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

3878 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "thicknessFactor") == 0)

3880 ++
i
;

3881 
out_vŞume
->
thickÃss_çùÜ
 = 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

3882 ++
i
;

3884 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "thicknessTexture") == 0)

3886 
i
 = 
	`cgÉf_·r£_jsÚ_‹xtu»_v›w
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_vŞume
->
thickÃss_‹xtu»
);

3888 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "attenuationColor") == 0)

3890 
i
 = 
	`cgÉf_·r£_jsÚ_æßt_¬¿y
(
tok’s
, i + 1, 
jsÚ_chunk
, 
out_vŞume
->
©‹nu©iÚ_cŞÜ
, 3);

3892 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "attenuationDistance") == 0)

3894 ++
i
;

3895 
out_vŞume
->
©‹nu©iÚ_di¡ªû
 = 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

3896 ++
i
;

3900 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i + 1);

3903 ià(
i
 < 0)

3905  
i
;

3909  
i
;

3910 
	}
}

3912 
	$cgÉf_·r£_jsÚ_sh“n
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_sh“n
* 
out_sh“n
)

3914 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

3915 
size
 = 
tok’s
[
i
].size;

3916 ++
i
;

3918 
j
 = 0; j < 
size
; ++j)

3920 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

3922 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "sheenColorFactor") == 0)

3924 
i
 = 
	`cgÉf_·r£_jsÚ_æßt_¬¿y
(
tok’s
, i + 1, 
jsÚ_chunk
, 
out_sh“n
->
sh“n_cŞÜ_çùÜ
, 3);

3926 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "sheenColorTexture") == 0)

3928 
i
 = 
	`cgÉf_·r£_jsÚ_‹xtu»_v›w
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_sh“n
->
sh“n_cŞÜ_‹xtu»
);

3930 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "sheenRoughnessFactor") == 0)

3932 ++
i
;

3933 
out_sh“n
->
sh“n_roughÃss_çùÜ
 = 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

3934 ++
i
;

3936 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "sheenRoughnessTexture") == 0)

3938 
i
 = 
	`cgÉf_·r£_jsÚ_‹xtu»_v›w
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_sh“n
->
sh“n_roughÃss_‹xtu»
);

3942 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

3945 ià(
i
 < 0)

3947  
i
;

3951  
i
;

3952 
	}
}

3954 
	$cgÉf_·r£_jsÚ_emissive_¡»ngth
(
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_emissive_¡»ngth
* 
out_emissive_¡»ngth
)

3956 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

3957 
size
 = 
tok’s
[
i
].size;

3958 ++
i
;

3961 
out_emissive_¡»ngth
->
emissive_¡»ngth
 = 1.f;

3963 
j
 = 0; j < 
size
; ++j)

3965 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

3967 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "emissiveStrength") == 0)

3969 ++
i
;

3970 
out_emissive_¡»ngth
->
emissive_¡»ngth
 = 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

3971 ++
i
;

3975 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i + 1);

3978 ià(
i
 < 0)

3980  
i
;

3984  
i
;

3985 
	}
}

3987 
	$cgÉf_·r£_jsÚ_œidesûnû
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_œidesûnû
* 
out_œidesûnû
)

3989 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

3990 
size
 = 
tok’s
[
i
].size;

3991 ++
i
;

3994 
out_œidesûnû
->
œidesûnû_iÜ
 = 1.3f;

3995 
out_œidesûnû
->
œidesûnû_thickÃss_mš
 = 100.f;

3996 
out_œidesûnû
->
œidesûnû_thickÃss_max
 = 400.f;

3998 
j
 = 0; j < 
size
; ++j)

4000 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

4002 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "iridescenceFactor") == 0)

4004 ++
i
;

4005 
out_œidesûnû
->
œidesûnû_çùÜ
 = 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

4006 ++
i
;

4008 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "iridescenceTexture") == 0)

4010 
i
 = 
	`cgÉf_·r£_jsÚ_‹xtu»_v›w
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_œidesûnû
->
œidesûnû_‹xtu»
);

4012 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "iridescenceIor") == 0)

4014 ++
i
;

4015 
out_œidesûnû
->
œidesûnû_iÜ
 = 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

4016 ++
i
;

4018 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "iridescenceThicknessMinimum") == 0)

4020 ++
i
;

4021 
out_œidesûnû
->
œidesûnû_thickÃss_mš
 = 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

4022 ++
i
;

4024 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "iridescenceThicknessMaximum") == 0)

4026 ++
i
;

4027 
out_œidesûnû
->
œidesûnû_thickÃss_max
 = 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

4028 ++
i
;

4030 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "iridescenceThicknessTexture") == 0)

4032 
i
 = 
	`cgÉf_·r£_jsÚ_‹xtu»_v›w
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_œidesûnû
->
œidesûnû_thickÃss_‹xtu»
);

4036 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i + 1);

4039 ià(
i
 < 0)

4041  
i
;

4045  
i
;

4046 
	}
}

4048 
	$cgÉf_·r£_jsÚ_image
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_image
* 
out_image
)

4050 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

4052 
size
 = 
tok’s
[
i
].size;

4053 ++
i
;

4055 
j
 = 0; j < 
size
; ++j)

4057 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

4059 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "uri") == 0)

4061 
i
 = 
	`cgÉf_·r£_jsÚ_¡ršg
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_image
->
uri
);

4063 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "bufferView") == 0)

4065 ++
i
;

4066 
out_image
->
bufãr_v›w
 = 
	`CGLTF_PTRINDEX
(
cgÉf_bufãr_v›w
, 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
));

4067 ++
i
;

4069 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "mimeType") == 0)

4071 
i
 = 
	`cgÉf_·r£_jsÚ_¡ršg
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_image
->
mime_ty³
);

4073 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "name") == 0)

4075 
i
 = 
	`cgÉf_·r£_jsÚ_¡ršg
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_image
->
Çme
);

4077 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extras") == 0)

4079 
i
 = 
	`cgÉf_·r£_jsÚ_exŒas
(
tok’s
, i + 1, 
jsÚ_chunk
, &
out_image
->
exŒas
);

4081 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extensions") == 0)

4083 
i
 = 
	`cgÉf_·r£_jsÚ_uÅroûs£d_ex‹nsiÚs
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_image
->
ex‹nsiÚs_couÁ
, &out_image->
ex‹nsiÚs
);

4087 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i + 1);

4090 ià(
i
 < 0)

4092  
i
;

4096  
i
;

4097 
	}
}

4099 
	$cgÉf_·r£_jsÚ_§m¶”
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_§m¶”
* 
out_§m¶”
)

4101 ()
İtiÚs
;

4102 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

4104 
out_§m¶”
->
w¿p_s
 = 10497;

4105 
out_§m¶”
->
w¿p_t
 = 10497;

4107 
size
 = 
tok’s
[
i
].size;

4108 ++
i
;

4110 
j
 = 0; j < 
size
; ++j)

4112 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

4114 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "name") == 0)

4116 
i
 = 
	`cgÉf_·r£_jsÚ_¡ršg
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_§m¶”
->
Çme
);

4118 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "magFilter") == 0)

4120 ++
i
;

4121 
out_§m¶”
->
mag_f‹r


4122 ğ
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
);

4123 ++
i
;

4125 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "minFilter") == 0)

4127 ++
i
;

4128 
out_§m¶”
->
mš_f‹r


4129 ğ
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
);

4130 ++
i
;

4132 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "wrapS") == 0)

4134 ++
i
;

4135 
out_§m¶”
->
w¿p_s


4136 ğ
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
);

4137 ++
i
;

4139 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "wrapT") == 0)

4141 ++
i
;

4142 
out_§m¶”
->
w¿p_t


4143 ğ
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
);

4144 ++
i
;

4146 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extras") == 0)

4148 
i
 = 
	`cgÉf_·r£_jsÚ_exŒas
(
tok’s
, i + 1, 
jsÚ_chunk
, &
out_§m¶”
->
exŒas
);

4150 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extensions") == 0)

4152 
i
 = 
	`cgÉf_·r£_jsÚ_uÅroûs£d_ex‹nsiÚs
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_§m¶”
->
ex‹nsiÚs_couÁ
, &out_§m¶”->
ex‹nsiÚs
);

4156 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i + 1);

4159 ià(
i
 < 0)

4161  
i
;

4165  
i
;

4166 
	}
}

4168 
	$cgÉf_·r£_jsÚ_‹xtu»
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_‹xtu»
* 
out_‹xtu»
)

4170 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

4172 
size
 = 
tok’s
[
i
].size;

4173 ++
i
;

4175 
j
 = 0; j < 
size
; ++j)

4177 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

4179 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "name") == 0)

4181 
i
 = 
	`cgÉf_·r£_jsÚ_¡ršg
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_‹xtu»
->
Çme
);

4183 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "sampler") == 0)

4185 ++
i
;

4186 
out_‹xtu»
->
§m¶”
 = 
	`CGLTF_PTRINDEX
(
cgÉf_§m¶”
, 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
));

4187 ++
i
;

4189 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "source") == 0)

4191 ++
i
;

4192 
out_‹xtu»
->
image
 = 
	`CGLTF_PTRINDEX
(
cgÉf_image
, 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
));

4193 ++
i
;

4195 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extras") == 0)

4197 
i
 = 
	`cgÉf_·r£_jsÚ_exŒas
(
tok’s
, i + 1, 
jsÚ_chunk
, &
out_‹xtu»
->
exŒas
);

4199 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extensions") == 0)

4201 ++
i
;

4203 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

4204 ià(
out_‹xtu»
->
ex‹nsiÚs
)

4206  
CGLTF_ERROR_JSON
;

4209 
ex‹nsiÚs_size
 = 
tok’s
[
i
].
size
;

4210 ++
i
;

4211 
out_‹xtu»
->
ex‹nsiÚs
 = (
cgÉf_ex‹nsiÚ
*)
	`cgÉf_ÿÎoc
(
İtiÚs
, (cgÉf_ex‹nsiÚ), 
ex‹nsiÚs_size
);

4212 
out_‹xtu»
->
ex‹nsiÚs_couÁ
 = 0;

4214 ià(!
out_‹xtu»
->
ex‹nsiÚs
)

4216  
CGLTF_ERROR_NOMEM
;

4219 
k
 = 0; k < 
ex‹nsiÚs_size
; ++k)

4221 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

4223 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "KHR_texture_basisu") == 0)

4225 
out_‹xtu»
->
has_basisu
 = 1;

4226 ++
i
;

4227 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

4228 
num_´İ”t›s
 = 
tok’s
[
i
].
size
;

4229 ++
i
;

4231 
t
 = 0; < 
num_´İ”t›s
; ++t)

4233 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

4235 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "source") == 0)

4237 ++
i
;

4238 
out_‹xtu»
->
basisu_image
 = 
	`CGLTF_PTRINDEX
(
cgÉf_image
, 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
));

4239 ++
i
;

4243 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i + 1);

4245 ià(
i
 < 0)

4247  
i
;

4253 
i
 = 
	`cgÉf_·r£_jsÚ_uÅroûs£d_ex‹nsiÚ
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &(
out_‹xtu»
->
ex‹nsiÚs
[out_‹xtu»->
ex‹nsiÚs_couÁ
++]));

4256 ià(
i
 < 0)

4258  
i
;

4264 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i + 1);

4267 ià(
i
 < 0)

4269  
i
;

4273  
i
;

4274 
	}
}

4276 
	$cgÉf_·r£_jsÚ_m©”Ÿl
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_m©”Ÿl
* 
out_m©”Ÿl
)

4278 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

4280 
	`cgÉf_fl_æßt_¬¿y
(
out_m©”Ÿl
->
pbr_m‘®lic_roughÃss
.
ba£_cŞÜ_çùÜ
, 4, 1.0f);

4281 
out_m©”Ÿl
->
pbr_m‘®lic_roughÃss
.
m‘®lic_çùÜ
 = 1.0f;

4282 
out_m©”Ÿl
->
pbr_m‘®lic_roughÃss
.
roughÃss_çùÜ
 = 1.0f;

4284 
	`cgÉf_fl_æßt_¬¿y
(
out_m©”Ÿl
->
pbr_¥ecuÏr_glossšess
.
diffu£_çùÜ
, 4, 1.0f);

4285 
	`cgÉf_fl_æßt_¬¿y
(
out_m©”Ÿl
->
pbr_¥ecuÏr_glossšess
.
¥ecuÏr_çùÜ
, 3, 1.0f);

4286 
out_m©”Ÿl
->
pbr_¥ecuÏr_glossšess
.
glossšess_çùÜ
 = 1.0f;

4288 
	`cgÉf_fl_æßt_¬¿y
(
out_m©”Ÿl
->
vŞume
.
©‹nu©iÚ_cŞÜ
, 3, 1.0f);

4289 
out_m©”Ÿl
->
vŞume
.
©‹nu©iÚ_di¡ªû
 = 
FLT_MAX
;

4291 
out_m©”Ÿl
->
®pha_cutoff
 = 0.5f;

4293 
size
 = 
tok’s
[
i
].size;

4294 ++
i
;

4296 
j
 = 0; j < 
size
; ++j)

4298 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

4300 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "name") == 0)

4302 
i
 = 
	`cgÉf_·r£_jsÚ_¡ršg
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_m©”Ÿl
->
Çme
);

4304 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "pbrMetallicRoughness") == 0)

4306 
out_m©”Ÿl
->
has_pbr_m‘®lic_roughÃss
 = 1;

4307 
i
 = 
	`cgÉf_·r£_jsÚ_pbr_m‘®lic_roughÃss
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_m©”Ÿl
->
pbr_m‘®lic_roughÃss
);

4309 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "emissiveFactor") == 0)

4311 
i
 = 
	`cgÉf_·r£_jsÚ_æßt_¬¿y
(
tok’s
, i + 1, 
jsÚ_chunk
, 
out_m©”Ÿl
->
emissive_çùÜ
, 3);

4313 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "normalTexture") == 0)

4315 
i
 = 
	`cgÉf_·r£_jsÚ_‹xtu»_v›w
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
,

4316 &
out_m©”Ÿl
->
nÜm®_‹xtu»
);

4318 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "occlusionTexture") == 0)

4320 
i
 = 
	`cgÉf_·r£_jsÚ_‹xtu»_v›w
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
,

4321 &
out_m©”Ÿl
->
ocşusiÚ_‹xtu»
);

4323 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "emissiveTexture") == 0)

4325 
i
 = 
	`cgÉf_·r£_jsÚ_‹xtu»_v›w
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
,

4326 &
out_m©”Ÿl
->
emissive_‹xtu»
);

4328 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "alphaMode") == 0)

4330 ++
i
;

4331 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "OPAQUE") == 0)

4333 
out_m©”Ÿl
->
®pha_mode
 = 
cgÉf_®pha_mode_İaque
;

4335 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "MASK") == 0)

4337 
out_m©”Ÿl
->
®pha_mode
 = 
cgÉf_®pha_mode_mask
;

4339 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "BLEND") == 0)

4341 
out_m©”Ÿl
->
®pha_mode
 = 
cgÉf_®pha_mode_bËnd
;

4343 ++
i
;

4345 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "alphaCutoff") == 0)

4347 ++
i
;

4348 
out_m©”Ÿl
->
®pha_cutoff
 = 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

4349 ++
i
;

4351 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "doubleSided") == 0)

4353 ++
i
;

4354 
out_m©”Ÿl
->
doubË_sided
 =

4355 
	`cgÉf_jsÚ_to_boŞ
(
tok’s
 + 
i
, 
jsÚ_chunk
);

4356 ++
i
;

4358 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extras") == 0)

4360 
i
 = 
	`cgÉf_·r£_jsÚ_exŒas
(
tok’s
, i + 1, 
jsÚ_chunk
, &
out_m©”Ÿl
->
exŒas
);

4362 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extensions") == 0)

4364 ++
i
;

4366 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

4367 if(
out_m©”Ÿl
->
ex‹nsiÚs
)

4369  
CGLTF_ERROR_JSON
;

4372 
ex‹nsiÚs_size
 = 
tok’s
[
i
].
size
;

4373 ++
i
;

4374 
out_m©”Ÿl
->
ex‹nsiÚs
 = (
cgÉf_ex‹nsiÚ
*)
	`cgÉf_ÿÎoc
(
İtiÚs
, (cgÉf_ex‹nsiÚ), 
ex‹nsiÚs_size
);

4375 
out_m©”Ÿl
->
ex‹nsiÚs_couÁ
= 0;

4377 ià(!
out_m©”Ÿl
->
ex‹nsiÚs
)

4379  
CGLTF_ERROR_NOMEM
;

4382 
k
 = 0; k < 
ex‹nsiÚs_size
; ++k)

4384 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

4386 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "KHR_materials_pbrSpecularGlossiness") == 0)

4388 
out_m©”Ÿl
->
has_pbr_¥ecuÏr_glossšess
 = 1;

4389 
i
 = 
	`cgÉf_·r£_jsÚ_pbr_¥ecuÏr_glossšess
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_m©”Ÿl
->
pbr_¥ecuÏr_glossšess
);

4391 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "KHR_materials_unlit") == 0)

4393 
out_m©”Ÿl
->
uÆ™
 = 1;

4394 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

4396 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "KHR_materials_clearcoat") == 0)

4398 
out_m©”Ÿl
->
has_ş—rcßt
 = 1;

4399 
i
 = 
	`cgÉf_·r£_jsÚ_ş—rcßt
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_m©”Ÿl
->
ş—rcßt
);

4401 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "KHR_materials_ior") == 0)

4403 
out_m©”Ÿl
->
has_iÜ
 = 1;

4404 
i
 = 
	`cgÉf_·r£_jsÚ_iÜ
(
tok’s
, i + 1, 
jsÚ_chunk
, &
out_m©”Ÿl
->
iÜ
);

4406 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "KHR_materials_specular") == 0)

4408 
out_m©”Ÿl
->
has_¥ecuÏr
 = 1;

4409 
i
 = 
	`cgÉf_·r£_jsÚ_¥ecuÏr
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_m©”Ÿl
->
¥ecuÏr
);

4411 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "KHR_materials_transmission") == 0)

4413 
out_m©”Ÿl
->
has_ŒªsmissiÚ
 = 1;

4414 
i
 = 
	`cgÉf_·r£_jsÚ_ŒªsmissiÚ
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_m©”Ÿl
->
ŒªsmissiÚ
);

4416 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "KHR_materials_volume") == 0)

4418 
out_m©”Ÿl
->
has_vŞume
 = 1;

4419 
i
 = 
	`cgÉf_·r£_jsÚ_vŞume
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_m©”Ÿl
->
vŞume
);

4421 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "KHR_materials_sheen") == 0)

4423 
out_m©”Ÿl
->
has_sh“n
 = 1;

4424 
i
 = 
	`cgÉf_·r£_jsÚ_sh“n
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_m©”Ÿl
->
sh“n
);

4426 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "KHR_materials_emissive_strength") == 0)

4428 
out_m©”Ÿl
->
has_emissive_¡»ngth
 = 1;

4429 
i
 = 
	`cgÉf_·r£_jsÚ_emissive_¡»ngth
(
tok’s
, i + 1, 
jsÚ_chunk
, &
out_m©”Ÿl
->
emissive_¡»ngth
);

4431 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "KHR_materials_iridescence") == 0)

4433 
out_m©”Ÿl
->
has_œidesûnû
 = 1;

4434 
i
 = 
	`cgÉf_·r£_jsÚ_œidesûnû
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_m©”Ÿl
->
œidesûnû
);

4438 
i
 = 
	`cgÉf_·r£_jsÚ_uÅroûs£d_ex‹nsiÚ
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &(
out_m©”Ÿl
->
ex‹nsiÚs
[out_m©”Ÿl->
ex‹nsiÚs_couÁ
++]));

4441 ià(
i
 < 0)

4443  
i
;

4449 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

4452 ià(
i
 < 0)

4454  
i
;

4458  
i
;

4459 
	}
}

4461 
	$cgÉf_·r£_jsÚ_acûssÜs
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_d©a
* 
out_d©a
)

4463 
i
 = 
	`cgÉf_·r£_jsÚ_¬¿y
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, (
cgÉf_acûssÜ
), (**)&
out_d©a
->
acûssÜs
, &out_d©a->
acûssÜs_couÁ
);

4464 ià(
i
 < 0)

4466  
i
;

4469 
cgÉf_size
 
j
 = 0; j < 
out_d©a
->
acûssÜs_couÁ
; ++j)

4471 
i
 = 
	`cgÉf_·r£_jsÚ_acûssÜ
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_d©a
->
acûssÜs
[
j
]);

4472 ià(
i
 < 0)

4474  
i
;

4477  
i
;

4478 
	}
}

4480 
	$cgÉf_·r£_jsÚ_m©”Ÿls
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_d©a
* 
out_d©a
)

4482 
i
 = 
	`cgÉf_·r£_jsÚ_¬¿y
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, (
cgÉf_m©”Ÿl
), (**)&
out_d©a
->
m©”Ÿls
, &out_d©a->
m©”Ÿls_couÁ
);

4483 ià(
i
 < 0)

4485  
i
;

4488 
cgÉf_size
 
j
 = 0; j < 
out_d©a
->
m©”Ÿls_couÁ
; ++j)

4490 
i
 = 
	`cgÉf_·r£_jsÚ_m©”Ÿl
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_d©a
->
m©”Ÿls
[
j
]);

4491 ià(
i
 < 0)

4493  
i
;

4496  
i
;

4497 
	}
}

4499 
	$cgÉf_·r£_jsÚ_images
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_d©a
* 
out_d©a
)

4501 
i
 = 
	`cgÉf_·r£_jsÚ_¬¿y
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, (
cgÉf_image
), (**)&
out_d©a
->
images
, &out_d©a->
images_couÁ
);

4502 ià(
i
 < 0)

4504  
i
;

4507 
cgÉf_size
 
j
 = 0; j < 
out_d©a
->
images_couÁ
; ++j)

4509 
i
 = 
	`cgÉf_·r£_jsÚ_image
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_d©a
->
images
[
j
]);

4510 ià(
i
 < 0)

4512  
i
;

4515  
i
;

4516 
	}
}

4518 
	$cgÉf_·r£_jsÚ_‹xtu»s
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_d©a
* 
out_d©a
)

4520 
i
 = 
	`cgÉf_·r£_jsÚ_¬¿y
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, (
cgÉf_‹xtu»
), (**)&
out_d©a
->
‹xtu»s
, &out_d©a->
‹xtu»s_couÁ
);

4521 ià(
i
 < 0)

4523  
i
;

4526 
cgÉf_size
 
j
 = 0; j < 
out_d©a
->
‹xtu»s_couÁ
; ++j)

4528 
i
 = 
	`cgÉf_·r£_jsÚ_‹xtu»
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_d©a
->
‹xtu»s
[
j
]);

4529 ià(
i
 < 0)

4531  
i
;

4534  
i
;

4535 
	}
}

4537 
	$cgÉf_·r£_jsÚ_§m¶”s
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_d©a
* 
out_d©a
)

4539 
i
 = 
	`cgÉf_·r£_jsÚ_¬¿y
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, (
cgÉf_§m¶”
), (**)&
out_d©a
->
§m¶”s
, &out_d©a->
§m¶”s_couÁ
);

4540 ià(
i
 < 0)

4542  
i
;

4545 
cgÉf_size
 
j
 = 0; j < 
out_d©a
->
§m¶”s_couÁ
; ++j)

4547 
i
 = 
	`cgÉf_·r£_jsÚ_§m¶”
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_d©a
->
§m¶”s
[
j
]);

4548 ià(
i
 < 0)

4550  
i
;

4553  
i
;

4554 
	}
}

4556 
	$cgÉf_·r£_jsÚ_meshİt_com´essiÚ
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_meshİt_com´essiÚ
* 
out_meshİt_com´essiÚ
)

4558 ()
İtiÚs
;

4559 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

4561 
size
 = 
tok’s
[
i
].size;

4562 ++
i
;

4564 
j
 = 0; j < 
size
; ++j)

4566 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

4568 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "buffer") == 0)

4570 ++
i
;

4571 
out_meshİt_com´essiÚ
->
bufãr
 = 
	`CGLTF_PTRINDEX
(
cgÉf_bufãr
, 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
));

4572 ++
i
;

4574 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "byteOffset") == 0)

4576 ++
i
;

4577 
out_meshİt_com´essiÚ
->
off£t
 = 
	`cgÉf_jsÚ_to_size
(
tok’s
+
i
, 
jsÚ_chunk
);

4578 ++
i
;

4580 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "byteLength") == 0)

4582 ++
i
;

4583 
out_meshİt_com´essiÚ
->
size
 = 
	`cgÉf_jsÚ_to_size
(
tok’s
+
i
, 
jsÚ_chunk
);

4584 ++
i
;

4586 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "byteStride") == 0)

4588 ++
i
;

4589 
out_meshİt_com´essiÚ
->
¡ride
 = 
	`cgÉf_jsÚ_to_size
(
tok’s
+
i
, 
jsÚ_chunk
);

4590 ++
i
;

4592 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "count") == 0)

4594 ++
i
;

4595 
out_meshİt_com´essiÚ
->
couÁ
 = 
	`cgÉf_jsÚ_to_št
(
tok’s
+
i
, 
jsÚ_chunk
);

4596 ++
i
;

4598 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "mode") == 0)

4600 ++
i
;

4601 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "ATTRIBUTES") == 0)

4603 
out_meshİt_com´essiÚ
->
mode
 = 
cgÉf_meshİt_com´essiÚ_mode_©Œibu‹s
;

4605 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "TRIANGLES") == 0)

4607 
out_meshİt_com´essiÚ
->
mode
 = 
cgÉf_meshİt_com´essiÚ_mode_ŒŸngËs
;

4609 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "INDICES") == 0)

4611 
out_meshİt_com´essiÚ
->
mode
 = 
cgÉf_meshİt_com´essiÚ_mode_šdiûs
;

4613 ++
i
;

4615 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "filter") == 0)

4617 ++
i
;

4618 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "NONE") == 0)

4620 
out_meshİt_com´essiÚ
->
f‹r
 = 
cgÉf_meshİt_com´essiÚ_f‹r_nÚe
;

4622 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "OCTAHEDRAL") == 0)

4624 
out_meshİt_com´essiÚ
->
f‹r
 = 
cgÉf_meshİt_com´essiÚ_f‹r_oùahed¿l
;

4626 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "QUATERNION") == 0)

4628 
out_meshİt_com´essiÚ
->
f‹r
 = 
cgÉf_meshİt_com´essiÚ_f‹r_qu©”niÚ
;

4630 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "EXPONENTIAL") == 0)

4632 
out_meshİt_com´essiÚ
->
f‹r
 = 
cgÉf_meshİt_com´essiÚ_f‹r_expÚ’tŸl
;

4634 ++
i
;

4638 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

4641 ià(
i
 < 0)

4643  
i
;

4647  
i
;

4648 
	}
}

4650 
	$cgÉf_·r£_jsÚ_bufãr_v›w
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_bufãr_v›w
* 
out_bufãr_v›w
)

4652 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

4654 
size
 = 
tok’s
[
i
].size;

4655 ++
i
;

4657 
j
 = 0; j < 
size
; ++j)

4659 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

4661 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "name") == 0)

4663 
i
 = 
	`cgÉf_·r£_jsÚ_¡ršg
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_bufãr_v›w
->
Çme
);

4665 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "buffer") == 0)

4667 ++
i
;

4668 
out_bufãr_v›w
->
bufãr
 = 
	`CGLTF_PTRINDEX
(
cgÉf_bufãr
, 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
));

4669 ++
i
;

4671 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "byteOffset") == 0)

4673 ++
i
;

4674 
out_bufãr_v›w
->
off£t
 =

4675 
	`cgÉf_jsÚ_to_size
(
tok’s
+
i
, 
jsÚ_chunk
);

4676 ++
i
;

4678 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "byteLength") == 0)

4680 ++
i
;

4681 
out_bufãr_v›w
->
size
 =

4682 
	`cgÉf_jsÚ_to_size
(
tok’s
+
i
, 
jsÚ_chunk
);

4683 ++
i
;

4685 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "byteStride") == 0)

4687 ++
i
;

4688 
out_bufãr_v›w
->
¡ride
 =

4689 
	`cgÉf_jsÚ_to_size
(
tok’s
+
i
, 
jsÚ_chunk
);

4690 ++
i
;

4692 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "target") == 0)

4694 ++
i
;

4695 
ty³
 = 
	`cgÉf_jsÚ_to_št
(
tok’s
+
i
, 
jsÚ_chunk
);

4696 
ty³
)

4699 
ty³
 = 
cgÉf_bufãr_v›w_ty³_v”tiûs
;

4702 
ty³
 = 
cgÉf_bufãr_v›w_ty³_šdiûs
;

4705 
ty³
 = 
cgÉf_bufãr_v›w_ty³_šv®id
;

4708 
out_bufãr_v›w
->
ty³
 = (
cgÉf_bufãr_v›w_ty³
)type;

4709 ++
i
;

4711 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extras") == 0)

4713 
i
 = 
	`cgÉf_·r£_jsÚ_exŒas
(
tok’s
, i + 1, 
jsÚ_chunk
, &
out_bufãr_v›w
->
exŒas
);

4715 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extensions") == 0)

4717 ++
i
;

4719 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

4720 if(
out_bufãr_v›w
->
ex‹nsiÚs
)

4722  
CGLTF_ERROR_JSON
;

4725 
ex‹nsiÚs_size
 = 
tok’s
[
i
].
size
;

4726 
out_bufãr_v›w
->
ex‹nsiÚs_couÁ
 = 0;

4727 
out_bufãr_v›w
->
ex‹nsiÚs
 = (
cgÉf_ex‹nsiÚ
*)
	`cgÉf_ÿÎoc
(
İtiÚs
, (cgÉf_ex‹nsiÚ), 
ex‹nsiÚs_size
);

4729 ià(!
out_bufãr_v›w
->
ex‹nsiÚs
)

4731  
CGLTF_ERROR_NOMEM
;

4734 ++
i
;

4735 
k
 = 0; k < 
ex‹nsiÚs_size
; ++k)

4737 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

4739 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "EXT_meshopt_compression") == 0)

4741 
out_bufãr_v›w
->
has_meshİt_com´essiÚ
 = 1;

4742 
i
 = 
	`cgÉf_·r£_jsÚ_meshİt_com´essiÚ
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_bufãr_v›w
->
meshİt_com´essiÚ
);

4746 
i
 = 
	`cgÉf_·r£_jsÚ_uÅroûs£d_ex‹nsiÚ
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &(
out_bufãr_v›w
->
ex‹nsiÚs
[out_bufãr_v›w->
ex‹nsiÚs_couÁ
++]));

4749 ià(
i
 < 0)

4751  
i
;

4757 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

4760 ià(
i
 < 0)

4762  
i
;

4766  
i
;

4767 
	}
}

4769 
	$cgÉf_·r£_jsÚ_bufãr_v›ws
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_d©a
* 
out_d©a
)

4771 
i
 = 
	`cgÉf_·r£_jsÚ_¬¿y
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, (
cgÉf_bufãr_v›w
), (**)&
out_d©a
->
bufãr_v›ws
, &out_d©a->
bufãr_v›ws_couÁ
);

4772 ià(
i
 < 0)

4774  
i
;

4777 
cgÉf_size
 
j
 = 0; j < 
out_d©a
->
bufãr_v›ws_couÁ
; ++j)

4779 
i
 = 
	`cgÉf_·r£_jsÚ_bufãr_v›w
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_d©a
->
bufãr_v›ws
[
j
]);

4780 ià(
i
 < 0)

4782  
i
;

4785  
i
;

4786 
	}
}

4788 
	$cgÉf_·r£_jsÚ_bufãr
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_bufãr
* 
out_bufãr
)

4790 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

4792 
size
 = 
tok’s
[
i
].size;

4793 ++
i
;

4795 
j
 = 0; j < 
size
; ++j)

4797 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

4799 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "name") == 0)

4801 
i
 = 
	`cgÉf_·r£_jsÚ_¡ršg
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_bufãr
->
Çme
);

4803 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "byteLength") == 0)

4805 ++
i
;

4806 
out_bufãr
->
size
 =

4807 
	`cgÉf_jsÚ_to_size
(
tok’s
+
i
, 
jsÚ_chunk
);

4808 ++
i
;

4810 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "uri") == 0)

4812 
i
 = 
	`cgÉf_·r£_jsÚ_¡ršg
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_bufãr
->
uri
);

4814 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extras") == 0)

4816 
i
 = 
	`cgÉf_·r£_jsÚ_exŒas
(
tok’s
, i + 1, 
jsÚ_chunk
, &
out_bufãr
->
exŒas
);

4818 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extensions") == 0)

4820 
i
 = 
	`cgÉf_·r£_jsÚ_uÅroûs£d_ex‹nsiÚs
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_bufãr
->
ex‹nsiÚs_couÁ
, &out_bufãr->
ex‹nsiÚs
);

4824 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

4827 ià(
i
 < 0)

4829  
i
;

4833  
i
;

4834 
	}
}

4836 
	$cgÉf_·r£_jsÚ_bufãrs
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_d©a
* 
out_d©a
)

4838 
i
 = 
	`cgÉf_·r£_jsÚ_¬¿y
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, (
cgÉf_bufãr
), (**)&
out_d©a
->
bufãrs
, &out_d©a->
bufãrs_couÁ
);

4839 ià(
i
 < 0)

4841  
i
;

4844 
cgÉf_size
 
j
 = 0; j < 
out_d©a
->
bufãrs_couÁ
; ++j)

4846 
i
 = 
	`cgÉf_·r£_jsÚ_bufãr
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_d©a
->
bufãrs
[
j
]);

4847 ià(
i
 < 0)

4849  
i
;

4852  
i
;

4853 
	}
}

4855 
	$cgÉf_·r£_jsÚ_skš
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_skš
* 
out_skš
)

4857 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

4859 
size
 = 
tok’s
[
i
].size;

4860 ++
i
;

4862 
j
 = 0; j < 
size
; ++j)

4864 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

4866 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "name") == 0)

4868 
i
 = 
	`cgÉf_·r£_jsÚ_¡ršg
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_skš
->
Çme
);

4870 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "joints") == 0)

4872 
i
 = 
	`cgÉf_·r£_jsÚ_¬¿y
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, (
cgÉf_node
*), (**)&
out_skš
->
jošts
, &out_skš->
jošts_couÁ
);

4873 ià(
i
 < 0)

4875  
i
;

4878 
cgÉf_size
 
k
 = 0; k < 
out_skš
->
jošts_couÁ
; ++k)

4880 
out_skš
->
jošts
[
k
] = 
	`CGLTF_PTRINDEX
(
cgÉf_node
, 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
));

4881 ++
i
;

4884 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "skeleton") == 0)

4886 ++
i
;

4887 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_PRIMITIVE
);

4888 
out_skš
->
sk–‘Ú
 = 
	`CGLTF_PTRINDEX
(
cgÉf_node
, 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
));

4889 ++
i
;

4891 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "inverseBindMatrices") == 0)

4893 ++
i
;

4894 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_PRIMITIVE
);

4895 
out_skš
->
šv”£_bšd_m©riûs
 = 
	`CGLTF_PTRINDEX
(
cgÉf_acûssÜ
, 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
));

4896 ++
i
;

4898 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extras") == 0)

4900 
i
 = 
	`cgÉf_·r£_jsÚ_exŒas
(
tok’s
, i + 1, 
jsÚ_chunk
, &
out_skš
->
exŒas
);

4902 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extensions") == 0)

4904 
i
 = 
	`cgÉf_·r£_jsÚ_uÅroûs£d_ex‹nsiÚs
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_skš
->
ex‹nsiÚs_couÁ
, &out_skš->
ex‹nsiÚs
);

4908 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

4911 ià(
i
 < 0)

4913  
i
;

4917  
i
;

4918 
	}
}

4920 
	$cgÉf_·r£_jsÚ_skšs
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_d©a
* 
out_d©a
)

4922 
i
 = 
	`cgÉf_·r£_jsÚ_¬¿y
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, (
cgÉf_skš
), (**)&
out_d©a
->
skšs
, &out_d©a->
skšs_couÁ
);

4923 ià(
i
 < 0)

4925  
i
;

4928 
cgÉf_size
 
j
 = 0; j < 
out_d©a
->
skšs_couÁ
; ++j)

4930 
i
 = 
	`cgÉf_·r£_jsÚ_skš
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_d©a
->
skšs
[
j
]);

4931 ià(
i
 < 0)

4933  
i
;

4936  
i
;

4937 
	}
}

4939 
	$cgÉf_·r£_jsÚ_ÿm”a
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_ÿm”a
* 
out_ÿm”a
)

4941 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

4943 
size
 = 
tok’s
[
i
].size;

4944 ++
i
;

4946 
j
 = 0; j < 
size
; ++j)

4948 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

4950 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "name") == 0)

4952 
i
 = 
	`cgÉf_·r£_jsÚ_¡ršg
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_ÿm”a
->
Çme
);

4954 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "type") == 0)

4956 ++
i
;

4957 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "perspective") == 0)

4959 
out_ÿm”a
->
ty³
 = 
cgÉf_ÿm”a_ty³_³r¥eùive
;

4961 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "orthographic") == 0)

4963 
out_ÿm”a
->
ty³
 = 
cgÉf_ÿm”a_ty³_Üthog¿phic
;

4965 ++
i
;

4967 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "perspective") == 0)

4969 ++
i
;

4971 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

4973 
d©a_size
 = 
tok’s
[
i
].
size
;

4974 ++
i
;

4976 
out_ÿm”a
->
ty³
 = 
cgÉf_ÿm”a_ty³_³r¥eùive
;

4978 
k
 = 0; k < 
d©a_size
; ++k)

4980 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

4982 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "aspectRatio") == 0)

4984 ++
i
;

4985 
out_ÿm”a
->
d©a
.
³r¥eùive
.
has_a¥eù_¿tio
 = 1;

4986 
out_ÿm”a
->
d©a
.
³r¥eùive
.
a¥eù_¿tio
 = 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

4987 ++
i
;

4989 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "yfov") == 0)

4991 ++
i
;

4992 
out_ÿm”a
->
d©a
.
³r¥eùive
.
yfov
 = 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

4993 ++
i
;

4995 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "zfar") == 0)

4997 ++
i
;

4998 
out_ÿm”a
->
d©a
.
³r¥eùive
.
has_zçr
 = 1;

4999 
out_ÿm”a
->
d©a
.
³r¥eùive
.
zçr
 = 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

5000 ++
i
;

5002 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "znear") == 0)

5004 ++
i
;

5005 
out_ÿm”a
->
d©a
.
³r¥eùive
.
zÃ¬
 = 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

5006 ++
i
;

5008 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extras") == 0)

5010 
i
 = 
	`cgÉf_·r£_jsÚ_exŒas
(
tok’s
, i + 1, 
jsÚ_chunk
, &
out_ÿm”a
->
d©a
.
³r¥eùive
.
exŒas
);

5014 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

5017 ià(
i
 < 0)

5019  
i
;

5023 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "orthographic") == 0)

5025 ++
i
;

5027 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

5029 
d©a_size
 = 
tok’s
[
i
].
size
;

5030 ++
i
;

5032 
out_ÿm”a
->
ty³
 = 
cgÉf_ÿm”a_ty³_Üthog¿phic
;

5034 
k
 = 0; k < 
d©a_size
; ++k)

5036 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

5038 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "xmag") == 0)

5040 ++
i
;

5041 
out_ÿm”a
->
d©a
.
Üthog¿phic
.
xmag
 = 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

5042 ++
i
;

5044 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "ymag") == 0)

5046 ++
i
;

5047 
out_ÿm”a
->
d©a
.
Üthog¿phic
.
ymag
 = 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

5048 ++
i
;

5050 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "zfar") == 0)

5052 ++
i
;

5053 
out_ÿm”a
->
d©a
.
Üthog¿phic
.
zçr
 = 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

5054 ++
i
;

5056 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "znear") == 0)

5058 ++
i
;

5059 
out_ÿm”a
->
d©a
.
Üthog¿phic
.
zÃ¬
 = 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

5060 ++
i
;

5062 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extras") == 0)

5064 
i
 = 
	`cgÉf_·r£_jsÚ_exŒas
(
tok’s
, i + 1, 
jsÚ_chunk
, &
out_ÿm”a
->
d©a
.
Üthog¿phic
.
exŒas
);

5068 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

5071 ià(
i
 < 0)

5073  
i
;

5077 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extras") == 0)

5079 
i
 = 
	`cgÉf_·r£_jsÚ_exŒas
(
tok’s
, i + 1, 
jsÚ_chunk
, &
out_ÿm”a
->
exŒas
);

5081 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extensions") == 0)

5083 
i
 = 
	`cgÉf_·r£_jsÚ_uÅroûs£d_ex‹nsiÚs
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_ÿm”a
->
ex‹nsiÚs_couÁ
, &out_ÿm”a->
ex‹nsiÚs
);

5087 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

5090 ià(
i
 < 0)

5092  
i
;

5096  
i
;

5097 
	}
}

5099 
	$cgÉf_·r£_jsÚ_ÿm”as
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_d©a
* 
out_d©a
)

5101 
i
 = 
	`cgÉf_·r£_jsÚ_¬¿y
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, (
cgÉf_ÿm”a
), (**)&
out_d©a
->
ÿm”as
, &out_d©a->
ÿm”as_couÁ
);

5102 ià(
i
 < 0)

5104  
i
;

5107 
cgÉf_size
 
j
 = 0; j < 
out_d©a
->
ÿm”as_couÁ
; ++j)

5109 
i
 = 
	`cgÉf_·r£_jsÚ_ÿm”a
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_d©a
->
ÿm”as
[
j
]);

5110 ià(
i
 < 0)

5112  
i
;

5115  
i
;

5116 
	}
}

5118 
	$cgÉf_·r£_jsÚ_light
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_light
* 
out_light
)

5120 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

5122 
out_light
->
cŞÜ
[0] = 1.f;

5123 
out_light
->
cŞÜ
[1] = 1.f;

5124 
out_light
->
cŞÜ
[2] = 1.f;

5125 
out_light
->
š‹ns™y
 = 1.f;

5127 
out_light
->
¥Ù_šÃr_cÚe_ªgË
 = 0.f;

5128 
out_light
->
¥Ù_ou‹r_cÚe_ªgË
 = 3.1415926535f / 4.0f;

5130 
size
 = 
tok’s
[
i
].size;

5131 ++
i
;

5133 
j
 = 0; j < 
size
; ++j)

5135 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

5137 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "name") == 0)

5139 
i
 = 
	`cgÉf_·r£_jsÚ_¡ršg
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_light
->
Çme
);

5141 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "color") == 0)

5143 
i
 = 
	`cgÉf_·r£_jsÚ_æßt_¬¿y
(
tok’s
, i + 1, 
jsÚ_chunk
, 
out_light
->
cŞÜ
, 3);

5145 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "intensity") == 0)

5147 ++
i
;

5148 
out_light
->
š‹ns™y
 = 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

5149 ++
i
;

5151 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "type") == 0)

5153 ++
i
;

5154 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "directional") == 0)

5156 
out_light
->
ty³
 = 
cgÉf_light_ty³_dœeùiÚ®
;

5158 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "point") == 0)

5160 
out_light
->
ty³
 = 
cgÉf_light_ty³_pošt
;

5162 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "spot") == 0)

5164 
out_light
->
ty³
 = 
cgÉf_light_ty³_¥Ù
;

5166 ++
i
;

5168 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "range") == 0)

5170 ++
i
;

5171 
out_light
->
¿nge
 = 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

5172 ++
i
;

5174 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "spot") == 0)

5176 ++
i
;

5178 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

5180 
d©a_size
 = 
tok’s
[
i
].
size
;

5181 ++
i
;

5183 
k
 = 0; k < 
d©a_size
; ++k)

5185 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

5187 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "innerConeAngle") == 0)

5189 ++
i
;

5190 
out_light
->
¥Ù_šÃr_cÚe_ªgË
 = 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

5191 ++
i
;

5193 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "outerConeAngle") == 0)

5195 ++
i
;

5196 
out_light
->
¥Ù_ou‹r_cÚe_ªgË
 = 
	`cgÉf_jsÚ_to_æßt
(
tok’s
 + 
i
, 
jsÚ_chunk
);

5197 ++
i
;

5201 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

5204 ià(
i
 < 0)

5206  
i
;

5210 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extras") == 0)

5212 
i
 = 
	`cgÉf_·r£_jsÚ_exŒas
(
tok’s
, i + 1, 
jsÚ_chunk
, &
out_light
->
exŒas
);

5216 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

5219 ià(
i
 < 0)

5221  
i
;

5225  
i
;

5226 
	}
}

5228 
	$cgÉf_·r£_jsÚ_lights
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_d©a
* 
out_d©a
)

5230 
i
 = 
	`cgÉf_·r£_jsÚ_¬¿y
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, (
cgÉf_light
), (**)&
out_d©a
->
lights
, &out_d©a->
lights_couÁ
);

5231 ià(
i
 < 0)

5233  
i
;

5236 
cgÉf_size
 
j
 = 0; j < 
out_d©a
->
lights_couÁ
; ++j)

5238 
i
 = 
	`cgÉf_·r£_jsÚ_light
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_d©a
->
lights
[
j
]);

5239 ià(
i
 < 0)

5241  
i
;

5244  
i
;

5245 
	}
}

5247 
	$cgÉf_·r£_jsÚ_node
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_node
* 
out_node
)

5249 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

5251 
out_node
->
rÙ©iÚ
[3] = 1.0f;

5252 
out_node
->
sÿË
[0] = 1.0f;

5253 
out_node
->
sÿË
[1] = 1.0f;

5254 
out_node
->
sÿË
[2] = 1.0f;

5255 
out_node
->
m©rix
[0] = 1.0f;

5256 
out_node
->
m©rix
[5] = 1.0f;

5257 
out_node
->
m©rix
[10] = 1.0f;

5258 
out_node
->
m©rix
[15] = 1.0f;

5260 
size
 = 
tok’s
[
i
].size;

5261 ++
i
;

5263 
j
 = 0; j < 
size
; ++j)

5265 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

5267 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "name") == 0)

5269 
i
 = 
	`cgÉf_·r£_jsÚ_¡ršg
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_node
->
Çme
);

5271 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "children") == 0)

5273 
i
 = 
	`cgÉf_·r£_jsÚ_¬¿y
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, (
cgÉf_node
*), (**)&
out_node
->
chd»n
, &out_node->
chd»n_couÁ
);

5274 ià(
i
 < 0)

5276  
i
;

5279 
cgÉf_size
 
k
 = 0; k < 
out_node
->
chd»n_couÁ
; ++k)

5281 
out_node
->
chd»n
[
k
] = 
	`CGLTF_PTRINDEX
(
cgÉf_node
, 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
));

5282 ++
i
;

5285 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "mesh") == 0)

5287 ++
i
;

5288 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_PRIMITIVE
);

5289 
out_node
->
mesh
 = 
	`CGLTF_PTRINDEX
(
cgÉf_mesh
, 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
));

5290 ++
i
;

5292 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "skin") == 0)

5294 ++
i
;

5295 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_PRIMITIVE
);

5296 
out_node
->
skš
 = 
	`CGLTF_PTRINDEX
(
cgÉf_skš
, 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
));

5297 ++
i
;

5299 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "camera") == 0)

5301 ++
i
;

5302 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_PRIMITIVE
);

5303 
out_node
->
ÿm”a
 = 
	`CGLTF_PTRINDEX
(
cgÉf_ÿm”a
, 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
));

5304 ++
i
;

5306 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "translation") == 0)

5308 
out_node
->
has_Œª¦©iÚ
 = 1;

5309 
i
 = 
	`cgÉf_·r£_jsÚ_æßt_¬¿y
(
tok’s
, i + 1, 
jsÚ_chunk
, 
out_node
->
Œª¦©iÚ
, 3);

5311 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "rotation") == 0)

5313 
out_node
->
has_rÙ©iÚ
 = 1;

5314 
i
 = 
	`cgÉf_·r£_jsÚ_æßt_¬¿y
(
tok’s
, i + 1, 
jsÚ_chunk
, 
out_node
->
rÙ©iÚ
, 4);

5316 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "scale") == 0)

5318 
out_node
->
has_sÿË
 = 1;

5319 
i
 = 
	`cgÉf_·r£_jsÚ_æßt_¬¿y
(
tok’s
, i + 1, 
jsÚ_chunk
, 
out_node
->
sÿË
, 3);

5321 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "matrix") == 0)

5323 
out_node
->
has_m©rix
 = 1;

5324 
i
 = 
	`cgÉf_·r£_jsÚ_æßt_¬¿y
(
tok’s
, i + 1, 
jsÚ_chunk
, 
out_node
->
m©rix
, 16);

5326 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "weights") == 0)

5328 
i
 = 
	`cgÉf_·r£_jsÚ_¬¿y
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, (
cgÉf_æßt
), (**)&
out_node
->
weights
, &out_node->
weights_couÁ
);

5329 ià(
i
 < 0)

5331  
i
;

5334 
i
 = 
	`cgÉf_·r£_jsÚ_æßt_¬¿y
(
tok’s
, i - 1, 
jsÚ_chunk
, 
out_node
->
weights
, ()out_node->
weights_couÁ
);

5336 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extras") == 0)

5338 
i
 = 
	`cgÉf_·r£_jsÚ_exŒas
(
tok’s
, i + 1, 
jsÚ_chunk
, &
out_node
->
exŒas
);

5340 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extensions") == 0)

5342 ++
i
;

5344 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

5345 if(
out_node
->
ex‹nsiÚs
)

5347  
CGLTF_ERROR_JSON
;

5350 
ex‹nsiÚs_size
 = 
tok’s
[
i
].
size
;

5351 
out_node
->
ex‹nsiÚs_couÁ
= 0;

5352 
out_node
->
ex‹nsiÚs
 = (
cgÉf_ex‹nsiÚ
*)
	`cgÉf_ÿÎoc
(
İtiÚs
, (cgÉf_ex‹nsiÚ), 
ex‹nsiÚs_size
);

5354 ià(!
out_node
->
ex‹nsiÚs
)

5356  
CGLTF_ERROR_NOMEM
;

5359 ++
i
;

5361 
k
 = 0; k < 
ex‹nsiÚs_size
; ++k)

5363 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

5365 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "KHR_lights_punctual") == 0)

5367 ++
i
;

5369 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

5371 
d©a_size
 = 
tok’s
[
i
].
size
;

5372 ++
i
;

5374 
m
 = 0; m < 
d©a_size
; ++m)

5376 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

5378 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "light") == 0)

5380 ++
i
;

5381 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_PRIMITIVE
);

5382 
out_node
->
light
 = 
	`CGLTF_PTRINDEX
(
cgÉf_light
, 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
));

5383 ++
i
;

5387 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i + 1);

5390 ià(
i
 < 0)

5392  
i
;

5396 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "EXT_mesh_gpu_instancing") == 0)

5398 
out_node
->
has_mesh_gpu_š¡ªcšg
 = 1;

5399 
i
 = 
	`cgÉf_·r£_jsÚ_mesh_gpu_š¡ªcšg
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_node
->
mesh_gpu_š¡ªcšg
);

5403 
i
 = 
	`cgÉf_·r£_jsÚ_uÅroûs£d_ex‹nsiÚ
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &(
out_node
->
ex‹nsiÚs
[out_node->
ex‹nsiÚs_couÁ
++]));

5406 ià(
i
 < 0)

5408  
i
;

5414 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

5417 ià(
i
 < 0)

5419  
i
;

5423  
i
;

5424 
	}
}

5426 
	$cgÉf_·r£_jsÚ_nodes
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_d©a
* 
out_d©a
)

5428 
i
 = 
	`cgÉf_·r£_jsÚ_¬¿y
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, (
cgÉf_node
), (**)&
out_d©a
->
nodes
, &out_d©a->
nodes_couÁ
);

5429 ià(
i
 < 0)

5431  
i
;

5434 
cgÉf_size
 
j
 = 0; j < 
out_d©a
->
nodes_couÁ
; ++j)

5436 
i
 = 
	`cgÉf_·r£_jsÚ_node
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_d©a
->
nodes
[
j
]);

5437 ià(
i
 < 0)

5439  
i
;

5442  
i
;

5443 
	}
}

5445 
	$cgÉf_·r£_jsÚ_sûÃ
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_sûÃ
* 
out_sûÃ
)

5447 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

5449 
size
 = 
tok’s
[
i
].size;

5450 ++
i
;

5452 
j
 = 0; j < 
size
; ++j)

5454 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

5456 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "name") == 0)

5458 
i
 = 
	`cgÉf_·r£_jsÚ_¡ršg
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_sûÃ
->
Çme
);

5460 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "nodes") == 0)

5462 
i
 = 
	`cgÉf_·r£_jsÚ_¬¿y
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, (
cgÉf_node
*), (**)&
out_sûÃ
->
nodes
, &out_sûÃ->
nodes_couÁ
);

5463 ià(
i
 < 0)

5465  
i
;

5468 
cgÉf_size
 
k
 = 0; k < 
out_sûÃ
->
nodes_couÁ
; ++k)

5470 
out_sûÃ
->
nodes
[
k
] = 
	`CGLTF_PTRINDEX
(
cgÉf_node
, 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
));

5471 ++
i
;

5474 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extras") == 0)

5476 
i
 = 
	`cgÉf_·r£_jsÚ_exŒas
(
tok’s
, i + 1, 
jsÚ_chunk
, &
out_sûÃ
->
exŒas
);

5478 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extensions") == 0)

5480 
i
 = 
	`cgÉf_·r£_jsÚ_uÅroûs£d_ex‹nsiÚs
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_sûÃ
->
ex‹nsiÚs_couÁ
, &out_sûÃ->
ex‹nsiÚs
);

5484 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

5487 ià(
i
 < 0)

5489  
i
;

5493  
i
;

5494 
	}
}

5496 
	$cgÉf_·r£_jsÚ_sûÃs
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_d©a
* 
out_d©a
)

5498 
i
 = 
	`cgÉf_·r£_jsÚ_¬¿y
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, (
cgÉf_sûÃ
), (**)&
out_d©a
->
sûÃs
, &out_d©a->
sûÃs_couÁ
);

5499 ià(
i
 < 0)

5501  
i
;

5504 
cgÉf_size
 
j
 = 0; j < 
out_d©a
->
sûÃs_couÁ
; ++j)

5506 
i
 = 
	`cgÉf_·r£_jsÚ_sûÃ
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_d©a
->
sûÃs
[
j
]);

5507 ià(
i
 < 0)

5509  
i
;

5512  
i
;

5513 
	}
}

5515 
	$cgÉf_·r£_jsÚ_ªim©iÚ_§m¶”
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_ªim©iÚ_§m¶”
* 
out_§m¶”
)

5517 ()
İtiÚs
;

5518 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

5520 
size
 = 
tok’s
[
i
].size;

5521 ++
i
;

5523 
j
 = 0; j < 
size
; ++j)

5525 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

5527 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "input") == 0)

5529 ++
i
;

5530 
out_§m¶”
->
šput
 = 
	`CGLTF_PTRINDEX
(
cgÉf_acûssÜ
, 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
));

5531 ++
i
;

5533 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "output") == 0)

5535 ++
i
;

5536 
out_§m¶”
->
ouut
 = 
	`CGLTF_PTRINDEX
(
cgÉf_acûssÜ
, 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
));

5537 ++
i
;

5539 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "interpolation") == 0)

5541 ++
i
;

5542 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "LINEAR") == 0)

5544 
out_§m¶”
->
š‹½Ş©iÚ
 = 
cgÉf_š‹½Ş©iÚ_ty³_lš—r
;

5546 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "STEP") == 0)

5548 
out_§m¶”
->
š‹½Ş©iÚ
 = 
cgÉf_š‹½Ş©iÚ_ty³_¡•
;

5550 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "CUBICSPLINE") == 0)

5552 
out_§m¶”
->
š‹½Ş©iÚ
 = 
cgÉf_š‹½Ş©iÚ_ty³_cubic_¥lše
;

5554 ++
i
;

5556 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extras") == 0)

5558 
i
 = 
	`cgÉf_·r£_jsÚ_exŒas
(
tok’s
, i + 1, 
jsÚ_chunk
, &
out_§m¶”
->
exŒas
);

5560 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extensions") == 0)

5562 
i
 = 
	`cgÉf_·r£_jsÚ_uÅroûs£d_ex‹nsiÚs
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_§m¶”
->
ex‹nsiÚs_couÁ
, &out_§m¶”->
ex‹nsiÚs
);

5566 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

5569 ià(
i
 < 0)

5571  
i
;

5575  
i
;

5576 
	}
}

5578 
	$cgÉf_·r£_jsÚ_ªim©iÚ_chªÃl
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_ªim©iÚ_chªÃl
* 
out_chªÃl
)

5580 ()
İtiÚs
;

5581 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

5583 
size
 = 
tok’s
[
i
].size;

5584 ++
i
;

5586 
j
 = 0; j < 
size
; ++j)

5588 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

5590 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "sampler") == 0)

5592 ++
i
;

5593 
out_chªÃl
->
§m¶”
 = 
	`CGLTF_PTRINDEX
(
cgÉf_ªim©iÚ_§m¶”
, 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
));

5594 ++
i
;

5596 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "target") == 0)

5598 ++
i
;

5600 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

5602 
rg‘_size
 = 
tok’s
[
i
].
size
;

5603 ++
i
;

5605 
k
 = 0; k < 
rg‘_size
; ++k)

5607 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

5609 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "node") == 0)

5611 ++
i
;

5612 
out_chªÃl
->
rg‘_node
 = 
	`CGLTF_PTRINDEX
(
cgÉf_node
, 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
));

5613 ++
i
;

5615 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "path") == 0)

5617 ++
i
;

5618 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "translation") == 0)

5620 
out_chªÃl
->
rg‘_·th
 = 
cgÉf_ªim©iÚ_·th_ty³_Œª¦©iÚ
;

5622 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "rotation") == 0)

5624 
out_chªÃl
->
rg‘_·th
 = 
cgÉf_ªim©iÚ_·th_ty³_rÙ©iÚ
;

5626 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "scale") == 0)

5628 
out_chªÃl
->
rg‘_·th
 = 
cgÉf_ªim©iÚ_·th_ty³_sÿË
;

5630 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "weights") == 0)

5632 
out_chªÃl
->
rg‘_·th
 = 
cgÉf_ªim©iÚ_·th_ty³_weights
;

5634 ++
i
;

5636 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extras") == 0)

5638 
i
 = 
	`cgÉf_·r£_jsÚ_exŒas
(
tok’s
, i + 1, 
jsÚ_chunk
, &
out_chªÃl
->
exŒas
);

5640 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extensions") == 0)

5642 
i
 = 
	`cgÉf_·r£_jsÚ_uÅroûs£d_ex‹nsiÚs
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_chªÃl
->
ex‹nsiÚs_couÁ
, &out_chªÃl->
ex‹nsiÚs
);

5646 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

5649 ià(
i
 < 0)

5651  
i
;

5657 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

5660 ià(
i
 < 0)

5662  
i
;

5666  
i
;

5667 
	}
}

5669 
	$cgÉf_·r£_jsÚ_ªim©iÚ
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_ªim©iÚ
* 
out_ªim©iÚ
)

5671 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

5673 
size
 = 
tok’s
[
i
].size;

5674 ++
i
;

5676 
j
 = 0; j < 
size
; ++j)

5678 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

5680 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "name") == 0)

5682 
i
 = 
	`cgÉf_·r£_jsÚ_¡ršg
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_ªim©iÚ
->
Çme
);

5684 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "samplers") == 0)

5686 
i
 = 
	`cgÉf_·r£_jsÚ_¬¿y
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, (
cgÉf_ªim©iÚ_§m¶”
), (**)&
out_ªim©iÚ
->
§m¶”s
, &out_ªim©iÚ->
§m¶”s_couÁ
);

5687 ià(
i
 < 0)

5689  
i
;

5692 
cgÉf_size
 
k
 = 0; k < 
out_ªim©iÚ
->
§m¶”s_couÁ
; ++k)

5694 
i
 = 
	`cgÉf_·r£_jsÚ_ªim©iÚ_§m¶”
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_ªim©iÚ
->
§m¶”s
[
k
]);

5695 ià(
i
 < 0)

5697  
i
;

5701 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "channels") == 0)

5703 
i
 = 
	`cgÉf_·r£_jsÚ_¬¿y
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, (
cgÉf_ªim©iÚ_chªÃl
), (**)&
out_ªim©iÚ
->
chªÃls
, &out_ªim©iÚ->
chªÃls_couÁ
);

5704 ià(
i
 < 0)

5706  
i
;

5709 
cgÉf_size
 
k
 = 0; k < 
out_ªim©iÚ
->
chªÃls_couÁ
; ++k)

5711 
i
 = 
	`cgÉf_·r£_jsÚ_ªim©iÚ_chªÃl
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_ªim©iÚ
->
chªÃls
[
k
]);

5712 ià(
i
 < 0)

5714  
i
;

5718 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extras") == 0)

5720 
i
 = 
	`cgÉf_·r£_jsÚ_exŒas
(
tok’s
, i + 1, 
jsÚ_chunk
, &
out_ªim©iÚ
->
exŒas
);

5722 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extensions") == 0)

5724 
i
 = 
	`cgÉf_·r£_jsÚ_uÅroûs£d_ex‹nsiÚs
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_ªim©iÚ
->
ex‹nsiÚs_couÁ
, &out_ªim©iÚ->
ex‹nsiÚs
);

5728 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

5731 ià(
i
 < 0)

5733  
i
;

5737  
i
;

5738 
	}
}

5740 
	$cgÉf_·r£_jsÚ_ªim©iÚs
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_d©a
* 
out_d©a
)

5742 
i
 = 
	`cgÉf_·r£_jsÚ_¬¿y
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, (
cgÉf_ªim©iÚ
), (**)&
out_d©a
->
ªim©iÚs
, &out_d©a->
ªim©iÚs_couÁ
);

5743 ià(
i
 < 0)

5745  
i
;

5748 
cgÉf_size
 
j
 = 0; j < 
out_d©a
->
ªim©iÚs_couÁ
; ++j)

5750 
i
 = 
	`cgÉf_·r£_jsÚ_ªim©iÚ
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_d©a
->
ªim©iÚs
[
j
]);

5751 ià(
i
 < 0)

5753  
i
;

5756  
i
;

5757 
	}
}

5759 
	$cgÉf_·r£_jsÚ_v¬ŸÁ
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_m©”Ÿl_v¬ŸÁ
* 
out_v¬ŸÁ
)

5761 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

5763 
size
 = 
tok’s
[
i
].size;

5764 ++
i
;

5766 
j
 = 0; j < 
size
; ++j)

5768 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

5770 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "name") == 0)

5772 
i
 = 
	`cgÉf_·r£_jsÚ_¡ršg
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_v¬ŸÁ
->
Çme
);

5774 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extras") == 0)

5776 
i
 = 
	`cgÉf_·r£_jsÚ_exŒas
(
tok’s
, i + 1, 
jsÚ_chunk
, &
out_v¬ŸÁ
->
exŒas
);

5780 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

5783 ià(
i
 < 0)

5785  
i
;

5789  
i
;

5790 
	}
}

5792 
	$cgÉf_·r£_jsÚ_v¬ŸÁs
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_d©a
* 
out_d©a
)

5794 
i
 = 
	`cgÉf_·r£_jsÚ_¬¿y
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, (
cgÉf_m©”Ÿl_v¬ŸÁ
), (**)&
out_d©a
->
v¬ŸÁs
, &out_d©a->
v¬ŸÁs_couÁ
);

5795 ià(
i
 < 0)

5797  
i
;

5800 
cgÉf_size
 
j
 = 0; j < 
out_d©a
->
v¬ŸÁs_couÁ
; ++j)

5802 
i
 = 
	`cgÉf_·r£_jsÚ_v¬ŸÁ
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_d©a
->
v¬ŸÁs
[
j
]);

5803 ià(
i
 < 0)

5805  
i
;

5808  
i
;

5809 
	}
}

5811 
	$cgÉf_·r£_jsÚ_as£t
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_as£t
* 
out_as£t
)

5813 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

5815 
size
 = 
tok’s
[
i
].size;

5816 ++
i
;

5818 
j
 = 0; j < 
size
; ++j)

5820 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

5822 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "copyright") == 0)

5824 
i
 = 
	`cgÉf_·r£_jsÚ_¡ršg
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_as£t
->
cİyright
);

5826 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "generator") == 0)

5828 
i
 = 
	`cgÉf_·r£_jsÚ_¡ršg
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_as£t
->
g’”©Ü
);

5830 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "version") == 0)

5832 
i
 = 
	`cgÉf_·r£_jsÚ_¡ršg
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_as£t
->
v”siÚ
);

5834 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "minVersion") == 0)

5836 
i
 = 
	`cgÉf_·r£_jsÚ_¡ršg
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_as£t
->
mš_v”siÚ
);

5838 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extras") == 0)

5840 
i
 = 
	`cgÉf_·r£_jsÚ_exŒas
(
tok’s
, i + 1, 
jsÚ_chunk
, &
out_as£t
->
exŒas
);

5842 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extensions") == 0)

5844 
i
 = 
	`cgÉf_·r£_jsÚ_uÅroûs£d_ex‹nsiÚs
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &
out_as£t
->
ex‹nsiÚs_couÁ
, &out_as£t->
ex‹nsiÚs
);

5848 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i+1);

5851 ià(
i
 < 0)

5853  
i
;

5857 ià(
out_as£t
->
v”siÚ
 && 
	`CGLTF_ATOF
(out_asset->version) < 2)

5859  
CGLTF_ERROR_LEGACY
;

5862  
i
;

5863 
	}
}

5865 
cgÉf_size
 
	$cgÉf_num_compÚ’ts
(
cgÉf_ty³
 
ty³
) {

5866 
ty³
)

5868 
cgÉf_ty³_vec2
:

5870 
cgÉf_ty³_vec3
:

5872 
cgÉf_ty³_vec4
:

5874 
cgÉf_ty³_m©2
:

5876 
cgÉf_ty³_m©3
:

5878 
cgÉf_ty³_m©4
:

5880 
cgÉf_ty³_šv®id
:

5881 
cgÉf_ty³_sÿÏr
:

5885 
	}
}

5887 
cgÉf_size
 
	$cgÉf_compÚ’t_size
(
cgÉf_compÚ’t_ty³
 
compÚ’t_ty³
) {

5888 
compÚ’t_ty³
)

5890 
cgÉf_compÚ’t_ty³_r_8
:

5891 
cgÉf_compÚ’t_ty³_r_8u
:

5893 
cgÉf_compÚ’t_ty³_r_16
:

5894 
cgÉf_compÚ’t_ty³_r_16u
:

5896 
cgÉf_compÚ’t_ty³_r_32u
:

5897 
cgÉf_compÚ’t_ty³_r_32f
:

5899 
cgÉf_compÚ’t_ty³_šv®id
:

5903 
	}
}

5905 
cgÉf_size
 
	$cgÉf_ÿlc_size
(
cgÉf_ty³
 
ty³
, 
cgÉf_compÚ’t_ty³
 
compÚ’t_ty³
)

5907 
cgÉf_size
 
compÚ’t_size
 = 
	`cgÉf_compÚ’t_size
(
compÚ’t_ty³
);

5908 ià(
ty³
 =ğ
cgÉf_ty³_m©2
 && 
compÚ’t_size
 == 1)

5910  8 * 
compÚ’t_size
;

5912 ià(
ty³
 =ğ
cgÉf_ty³_m©3
 && (
compÚ’t_size
 == 1 || component_size == 2))

5914  12 * 
compÚ’t_size
;

5916  
compÚ’t_size
 * 
	`cgÉf_num_compÚ’ts
(
ty³
);

5917 
	}
}

5919 
cgÉf_fixup_poš‹rs
(
cgÉf_d©a
* 
out_d©a
);

5921 
	$cgÉf_·r£_jsÚ_roÙ
(
cgÉf_İtiÚs
* 
İtiÚs
, 
jsmÁok_t
 cÚ¡* 
tok’s
, 
i
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_d©a
* 
out_d©a
)

5923 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

5925 
size
 = 
tok’s
[
i
].size;

5926 ++
i
;

5928 
j
 = 0; j < 
size
; ++j)

5930 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

5932 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "asset") == 0)

5934 
i
 = 
	`cgÉf_·r£_jsÚ_as£t
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_d©a
->
as£t
);

5936 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "meshes") == 0)

5938 
i
 = 
	`cgÉf_·r£_jsÚ_meshes
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, 
out_d©a
);

5940 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "accessors") == 0)

5942 
i
 = 
	`cgÉf_·r£_jsÚ_acûssÜs
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, 
out_d©a
);

5944 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "bufferViews") == 0)

5946 
i
 = 
	`cgÉf_·r£_jsÚ_bufãr_v›ws
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, 
out_d©a
);

5948 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "buffers") == 0)

5950 
i
 = 
	`cgÉf_·r£_jsÚ_bufãrs
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, 
out_d©a
);

5952 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "materials") == 0)

5954 
i
 = 
	`cgÉf_·r£_jsÚ_m©”Ÿls
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, 
out_d©a
);

5956 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "images") == 0)

5958 
i
 = 
	`cgÉf_·r£_jsÚ_images
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, 
out_d©a
);

5960 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "textures") == 0)

5962 
i
 = 
	`cgÉf_·r£_jsÚ_‹xtu»s
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, 
out_d©a
);

5964 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "samplers") == 0)

5966 
i
 = 
	`cgÉf_·r£_jsÚ_§m¶”s
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, 
out_d©a
);

5968 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "skins") == 0)

5970 
i
 = 
	`cgÉf_·r£_jsÚ_skšs
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, 
out_d©a
);

5972 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "cameras") == 0)

5974 
i
 = 
	`cgÉf_·r£_jsÚ_ÿm”as
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, 
out_d©a
);

5976 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "nodes") == 0)

5978 
i
 = 
	`cgÉf_·r£_jsÚ_nodes
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, 
out_d©a
);

5980 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "scenes") == 0)

5982 
i
 = 
	`cgÉf_·r£_jsÚ_sûÃs
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, 
out_d©a
);

5984 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "scene") == 0)

5986 ++
i
;

5987 
out_d©a
->
sûÃ
 = 
	`CGLTF_PTRINDEX
(
cgÉf_sûÃ
, 
	`cgÉf_jsÚ_to_št
(
tok’s
 + 
i
, 
jsÚ_chunk
));

5988 ++
i
;

5990 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "animations") == 0)

5992 
i
 = 
	`cgÉf_·r£_jsÚ_ªim©iÚs
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, 
out_d©a
);

5994 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "extras") == 0)

5996 
i
 = 
	`cgÉf_·r£_jsÚ_exŒas
(
tok’s
, i + 1, 
jsÚ_chunk
, &
out_d©a
->
exŒas
);

5998 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extensions") == 0)

6000 ++
i
;

6002 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

6003 if(
out_d©a
->
d©a_ex‹nsiÚs
)

6005  
CGLTF_ERROR_JSON
;

6008 
ex‹nsiÚs_size
 = 
tok’s
[
i
].
size
;

6009 
out_d©a
->
d©a_ex‹nsiÚs_couÁ
 = 0;

6010 
out_d©a
->
d©a_ex‹nsiÚs
 = (
cgÉf_ex‹nsiÚ
*)
	`cgÉf_ÿÎoc
(
İtiÚs
, (cgÉf_ex‹nsiÚ), 
ex‹nsiÚs_size
);

6012 ià(!
out_d©a
->
d©a_ex‹nsiÚs
)

6014  
CGLTF_ERROR_NOMEM
;

6017 ++
i
;

6019 
k
 = 0; k < 
ex‹nsiÚs_size
; ++k)

6021 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

6023 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "KHR_lights_punctual") == 0)

6025 ++
i
;

6027 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

6029 
d©a_size
 = 
tok’s
[
i
].
size
;

6030 ++
i
;

6032 
m
 = 0; m < 
d©a_size
; ++m)

6034 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

6036 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "lights") == 0)

6038 
i
 = 
	`cgÉf_·r£_jsÚ_lights
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, 
out_d©a
);

6042 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i + 1);

6045 ià(
i
 < 0)

6047  
i
;

6051 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
+
i
, 
jsÚ_chunk
, "KHR_materials_variants") == 0)

6053 ++
i
;

6055 
	`CGLTF_CHECK_TOKTYPE
(
tok’s
[
i
], 
JSMN_OBJECT
);

6057 
d©a_size
 = 
tok’s
[
i
].
size
;

6058 ++
i
;

6060 
m
 = 0; m < 
d©a_size
; ++m)

6062 
	`CGLTF_CHECK_KEY
(
tok’s
[
i
]);

6064 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "variants") == 0)

6066 
i
 = 
	`cgÉf_·r£_jsÚ_v¬ŸÁs
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, 
out_d©a
);

6070 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i + 1);

6073 ià(
i
 < 0)

6075  
i
;

6081 
i
 = 
	`cgÉf_·r£_jsÚ_uÅroûs£d_ex‹nsiÚ
(
İtiÚs
, 
tok’s
, i, 
jsÚ_chunk
, &(
out_d©a
->
d©a_ex‹nsiÚs
[out_d©a->
d©a_ex‹nsiÚs_couÁ
++]));

6084 ià(
i
 < 0)

6086  
i
;

6090 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extensionsUsed") == 0)

6092 
i
 = 
	`cgÉf_·r£_jsÚ_¡ršg_¬¿y
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_d©a
->
ex‹nsiÚs_u£d
, &out_d©a->
ex‹nsiÚs_u£d_couÁ
);

6094 ià(
	`cgÉf_jsÚ_¡rcmp
(
tok’s
 + 
i
, 
jsÚ_chunk
, "extensionsRequired") == 0)

6096 
i
 = 
	`cgÉf_·r£_jsÚ_¡ršg_¬¿y
(
İtiÚs
, 
tok’s
, i + 1, 
jsÚ_chunk
, &
out_d©a
->
ex‹nsiÚs_»quœed
, &out_d©a->
ex‹nsiÚs_»quœed_couÁ
);

6100 
i
 = 
	`cgÉf_sk_jsÚ
(
tok’s
, i + 1);

6103 ià(
i
 < 0)

6105  
i
;

6109  
i
;

6110 
	}
}

6112 
cgÉf_»suÉ
 
	$cgÉf_·r£_jsÚ
(
cgÉf_İtiÚs
* 
İtiÚs
, cÚ¡ 
ušt8_t
* 
jsÚ_chunk
, 
cgÉf_size
 
size
, 
cgÉf_d©a
** 
out_d©a
)

6114 
jsmn_·r£r
 
·r£r
 = { 0, 0, 0 };

6116 ià(
İtiÚs
->
jsÚ_tok’_couÁ
 == 0)

6118 
tok’_couÁ
 = 
	`jsmn_·r£
(&
·r£r
, (cÚ¡ *)
jsÚ_chunk
, 
size
, 
NULL
, 0);

6120 ià(
tok’_couÁ
 <= 0)

6122  
cgÉf_»suÉ_šv®id_jsÚ
;

6125 
İtiÚs
->
jsÚ_tok’_couÁ
 = 
tok’_couÁ
;

6128 
jsmÁok_t
* 
tok’s
 = (jsmÁok_t*)
İtiÚs
->
memÜy
.
	`®loc_func
(İtiÚs->memÜy.
u£r_d©a
, (jsmÁok_tè* (İtiÚs->
jsÚ_tok’_couÁ
 + 1));

6130 ià(!
tok’s
)

6132  
cgÉf_»suÉ_out_of_memÜy
;

6135 
	`jsmn_š™
(&
·r£r
);

6137 
tok’_couÁ
 = 
	`jsmn_·r£
(&
·r£r
, (cÚ¡ *)
jsÚ_chunk
, 
size
, 
tok’s
, 
İtiÚs
->
jsÚ_tok’_couÁ
);

6139 ià(
tok’_couÁ
 <= 0)

6141 
İtiÚs
->
memÜy
.
	`ä“_func
(İtiÚs->memÜy.
u£r_d©a
, 
tok’s
);

6142  
cgÉf_»suÉ_šv®id_jsÚ
;

6147 
tok’s
[
tok’_couÁ
].
ty³
 = 
JSMN_UNDEFINED
;

6149 
cgÉf_d©a
* 
d©a
 = (cgÉf_d©a*)
İtiÚs
->
memÜy
.
	`®loc_func
(İtiÚs->memÜy.
u£r_d©a
, (cgltf_data));

6151 ià(!
d©a
)

6153 
İtiÚs
->
memÜy
.
	`ä“_func
(İtiÚs->memÜy.
u£r_d©a
, 
tok’s
);

6154  
cgÉf_»suÉ_out_of_memÜy
;

6157 
	`mem£t
(
d©a
, 0, (
cgÉf_d©a
));

6158 
d©a
->
memÜy
 = 
İtiÚs
->memory;

6159 
d©a
->
fe
 = 
İtiÚs
->file;

6161 
i
 = 
	`cgÉf_·r£_jsÚ_roÙ
(
İtiÚs
, 
tok’s
, 0, 
jsÚ_chunk
, 
d©a
);

6163 
İtiÚs
->
memÜy
.
	`ä“_func
(İtiÚs->memÜy.
u£r_d©a
, 
tok’s
);

6165 ià(
i
 < 0)

6167 
	`cgÉf_ä“
(
d©a
);

6169 
i
)

6171 
CGLTF_ERROR_NOMEM
:  
cgÉf_»suÉ_out_of_memÜy
;

6172 
CGLTF_ERROR_LEGACY
:  
cgÉf_»suÉ_Ëgacy_gÉf
;

6173 :  
cgÉf_»suÉ_šv®id_gÉf
;

6177 ià(
	`cgÉf_fixup_poš‹rs
(
d©a
) < 0)

6179 
	`cgÉf_ä“
(
d©a
);

6180  
cgÉf_»suÉ_šv®id_gÉf
;

6183 
d©a
->
jsÚ
 = (cÚ¡ *)
jsÚ_chunk
;

6184 
d©a
->
jsÚ_size
 = 
size
;

6186 *
out_d©a
 = 
d©a
;

6188  
cgÉf_»suÉ_sucûss
;

6189 
	}
}

6191 
	$cgÉf_fixup_poš‹rs
(
cgÉf_d©a
* 
d©a
)

6193 
cgÉf_size
 
i
 = 0; i < 
d©a
->
meshes_couÁ
; ++i)

6195 
cgÉf_size
 
j
 = 0; j < 
d©a
->
meshes
[
i
].
´im™ives_couÁ
; ++j)

6197 
	`CGLTF_PTRFIXUP
(
d©a
->
meshes
[
i
].
´im™ives
[
j
].
šdiûs
, d©a->
acûssÜs
, d©a->
acûssÜs_couÁ
);

6198 
	`CGLTF_PTRFIXUP
(
d©a
->
meshes
[
i
].
´im™ives
[
j
].
m©”Ÿl
, d©a->
m©”Ÿls
, d©a->
m©”Ÿls_couÁ
);

6200 
cgÉf_size
 
k
 = 0; k < 
d©a
->
meshes
[
i
].
´im™ives
[
j
].
©Œibu‹s_couÁ
; ++k)

6202 
	`CGLTF_PTRFIXUP_REQ
(
d©a
->
meshes
[
i
].
´im™ives
[
j
].
©Œibu‹s
[
k
].d©a, d©a->
acûssÜs
, d©a->
acûssÜs_couÁ
);

6205 
cgÉf_size
 
k
 = 0; k < 
d©a
->
meshes
[
i
].
´im™ives
[
j
].
rg‘s_couÁ
; ++k)

6207 
cgÉf_size
 
m
 = 0; m < 
d©a
->
meshes
[
i
].
´im™ives
[
j
].
rg‘s
[
k
].
©Œibu‹s_couÁ
; ++m)

6209 
	`CGLTF_PTRFIXUP_REQ
(
d©a
->
meshes
[
i
].
´im™ives
[
j
].
rg‘s
[
k
].
©Œibu‹s
[
m
].d©a, d©a->
acûssÜs
, d©a->
acûssÜs_couÁ
);

6213 ià(
d©a
->
meshes
[
i
].
´im™ives
[
j
].
has_d¿co_mesh_com´essiÚ
)

6215 
	`CGLTF_PTRFIXUP_REQ
(
d©a
->
meshes
[
i
].
´im™ives
[
j
].
d¿co_mesh_com´essiÚ
.
bufãr_v›w
, d©a->
bufãr_v›ws
, d©a->
bufãr_v›ws_couÁ
);

6216 
cgÉf_size
 
m
 = 0; m < 
d©a
->
meshes
[
i
].
´im™ives
[
j
].
d¿co_mesh_com´essiÚ
.
©Œibu‹s_couÁ
; ++m)

6218 
	`CGLTF_PTRFIXUP_REQ
(
d©a
->
meshes
[
i
].
´im™ives
[
j
].
d¿co_mesh_com´essiÚ
.
©Œibu‹s
[
m
].d©a, d©a->
acûssÜs
, d©a->
acûssÜs_couÁ
);

6222 
cgÉf_size
 
k
 = 0; k < 
d©a
->
meshes
[
i
].
´im™ives
[
j
].
m­pšgs_couÁ
; ++k)

6224 
	`CGLTF_PTRFIXUP_REQ
(
d©a
->
meshes
[
i
].
´im™ives
[
j
].
m­pšgs
[
k
].
m©”Ÿl
, d©a->
m©”Ÿls
, d©a->
m©”Ÿls_couÁ
);

6229 
cgÉf_size
 
i
 = 0; i < 
d©a
->
acûssÜs_couÁ
; ++i)

6231 
	`CGLTF_PTRFIXUP
(
d©a
->
acûssÜs
[
i
].
bufãr_v›w
, d©a->
bufãr_v›ws
, d©a->
bufãr_v›ws_couÁ
);

6233 ià(
d©a
->
acûssÜs
[
i
].
is_¥¬£
)

6235 
	`CGLTF_PTRFIXUP_REQ
(
d©a
->
acûssÜs
[
i
].
¥¬£
.
šdiûs_bufãr_v›w
, d©a->
bufãr_v›ws
, d©a->
bufãr_v›ws_couÁ
);

6236 
	`CGLTF_PTRFIXUP_REQ
(
d©a
->
acûssÜs
[
i
].
¥¬£
.
v®ues_bufãr_v›w
, d©a->
bufãr_v›ws
, d©a->
bufãr_v›ws_couÁ
);

6239 ià(
d©a
->
acûssÜs
[
i
].
bufãr_v›w
)

6241 
d©a
->
acûssÜs
[
i
].
¡ride
 = d©a->acûssÜs[i].
bufãr_v›w
->stride;

6244 ià(
d©a
->
acûssÜs
[
i
].
¡ride
 == 0)

6246 
d©a
->
acûssÜs
[
i
].
¡ride
 = 
	`cgÉf_ÿlc_size
(d©a->acûssÜs[i].
ty³
, d©a->acûssÜs[i].
compÚ’t_ty³
);

6250 
cgÉf_size
 
i
 = 0; i < 
d©a
->
‹xtu»s_couÁ
; ++i)

6252 
	`CGLTF_PTRFIXUP
(
d©a
->
‹xtu»s
[
i
].
image
, d©a->
images
, d©a->
images_couÁ
);

6253 
	`CGLTF_PTRFIXUP
(
d©a
->
‹xtu»s
[
i
].
basisu_image
, d©a->
images
, d©a->
images_couÁ
);

6254 
	`CGLTF_PTRFIXUP
(
d©a
->
‹xtu»s
[
i
].
§m¶”
, d©a->
§m¶”s
, d©a->
§m¶”s_couÁ
);

6257 
cgÉf_size
 
i
 = 0; i < 
d©a
->
images_couÁ
; ++i)

6259 
	`CGLTF_PTRFIXUP
(
d©a
->
images
[
i
].
bufãr_v›w
, d©a->
bufãr_v›ws
, d©a->
bufãr_v›ws_couÁ
);

6262 
cgÉf_size
 
i
 = 0; i < 
d©a
->
m©”Ÿls_couÁ
; ++i)

6264 
	`CGLTF_PTRFIXUP
(
d©a
->
m©”Ÿls
[
i
].
nÜm®_‹xtu»
.
‹xtu»
, d©a->
‹xtu»s
, d©a->
‹xtu»s_couÁ
);

6265 
	`CGLTF_PTRFIXUP
(
d©a
->
m©”Ÿls
[
i
].
emissive_‹xtu»
.
‹xtu»
, d©a->
‹xtu»s
, d©a->
‹xtu»s_couÁ
);

6266 
	`CGLTF_PTRFIXUP
(
d©a
->
m©”Ÿls
[
i
].
ocşusiÚ_‹xtu»
.
‹xtu»
, d©a->
‹xtu»s
, d©a->
‹xtu»s_couÁ
);

6268 
	`CGLTF_PTRFIXUP
(
d©a
->
m©”Ÿls
[
i
].
pbr_m‘®lic_roughÃss
.
ba£_cŞÜ_‹xtu»
.
‹xtu»
, d©a->
‹xtu»s
, d©a->
‹xtu»s_couÁ
);

6269 
	`CGLTF_PTRFIXUP
(
d©a
->
m©”Ÿls
[
i
].
pbr_m‘®lic_roughÃss
.
m‘®lic_roughÃss_‹xtu»
.
‹xtu»
, d©a->
‹xtu»s
, d©a->
‹xtu»s_couÁ
);

6271 
	`CGLTF_PTRFIXUP
(
d©a
->
m©”Ÿls
[
i
].
pbr_¥ecuÏr_glossšess
.
diffu£_‹xtu»
.
‹xtu»
, d©a->
‹xtu»s
, d©a->
‹xtu»s_couÁ
);

6272 
	`CGLTF_PTRFIXUP
(
d©a
->
m©”Ÿls
[
i
].
pbr_¥ecuÏr_glossšess
.
¥ecuÏr_glossšess_‹xtu»
.
‹xtu»
, d©a->
‹xtu»s
, d©a->
‹xtu»s_couÁ
);

6274 
	`CGLTF_PTRFIXUP
(
d©a
->
m©”Ÿls
[
i
].
ş—rcßt
.
ş—rcßt_‹xtu»
.
‹xtu»
, d©a->
‹xtu»s
, d©a->
‹xtu»s_couÁ
);

6275 
	`CGLTF_PTRFIXUP
(
d©a
->
m©”Ÿls
[
i
].
ş—rcßt
.
ş—rcßt_roughÃss_‹xtu»
.
‹xtu»
, d©a->
‹xtu»s
, d©a->
‹xtu»s_couÁ
);

6276 
	`CGLTF_PTRFIXUP
(
d©a
->
m©”Ÿls
[
i
].
ş—rcßt
.
ş—rcßt_nÜm®_‹xtu»
.
‹xtu»
, d©a->
‹xtu»s
, d©a->
‹xtu»s_couÁ
);

6278 
	`CGLTF_PTRFIXUP
(
d©a
->
m©”Ÿls
[
i
].
¥ecuÏr
.
¥ecuÏr_‹xtu»
.
‹xtu»
, d©a->
‹xtu»s
, d©a->
‹xtu»s_couÁ
);

6279 
	`CGLTF_PTRFIXUP
(
d©a
->
m©”Ÿls
[
i
].
¥ecuÏr
.
¥ecuÏr_cŞÜ_‹xtu»
.
‹xtu»
, d©a->
‹xtu»s
, d©a->
‹xtu»s_couÁ
);

6281 
	`CGLTF_PTRFIXUP
(
d©a
->
m©”Ÿls
[
i
].
ŒªsmissiÚ
.
ŒªsmissiÚ_‹xtu»
.
‹xtu»
, d©a->
‹xtu»s
, d©a->
‹xtu»s_couÁ
);

6283 
	`CGLTF_PTRFIXUP
(
d©a
->
m©”Ÿls
[
i
].
vŞume
.
thickÃss_‹xtu»
.
‹xtu»
, d©a->
‹xtu»s
, d©a->
‹xtu»s_couÁ
);

6285 
	`CGLTF_PTRFIXUP
(
d©a
->
m©”Ÿls
[
i
].
sh“n
.
sh“n_cŞÜ_‹xtu»
.
‹xtu»
, d©a->
‹xtu»s
, d©a->
‹xtu»s_couÁ
);

6286 
	`CGLTF_PTRFIXUP
(
d©a
->
m©”Ÿls
[
i
].
sh“n
.
sh“n_roughÃss_‹xtu»
.
‹xtu»
, d©a->
‹xtu»s
, d©a->
‹xtu»s_couÁ
);

6288 
	`CGLTF_PTRFIXUP
(
d©a
->
m©”Ÿls
[
i
].
œidesûnû
.
œidesûnû_‹xtu»
.
‹xtu»
, d©a->
‹xtu»s
, d©a->
‹xtu»s_couÁ
);

6289 
	`CGLTF_PTRFIXUP
(
d©a
->
m©”Ÿls
[
i
].
œidesûnû
.
œidesûnû_thickÃss_‹xtu»
.
‹xtu»
, d©a->
‹xtu»s
, d©a->
‹xtu»s_couÁ
);

6292 
cgÉf_size
 
i
 = 0; i < 
d©a
->
bufãr_v›ws_couÁ
; ++i)

6294 
	`CGLTF_PTRFIXUP_REQ
(
d©a
->
bufãr_v›ws
[
i
].
bufãr
, d©a->
bufãrs
, d©a->
bufãrs_couÁ
);

6296 ià(
d©a
->
bufãr_v›ws
[
i
].
has_meshİt_com´essiÚ
)

6298 
	`CGLTF_PTRFIXUP_REQ
(
d©a
->
bufãr_v›ws
[
i
].
meshİt_com´essiÚ
.
bufãr
, d©a->
bufãrs
, d©a->
bufãrs_couÁ
);

6302 
cgÉf_size
 
i
 = 0; i < 
d©a
->
skšs_couÁ
; ++i)

6304 
cgÉf_size
 
j
 = 0; j < 
d©a
->
skšs
[
i
].
jošts_couÁ
; ++j)

6306 
	`CGLTF_PTRFIXUP_REQ
(
d©a
->
skšs
[
i
].
jošts
[
j
], d©a->
nodes
, d©a->
nodes_couÁ
);

6309 
	`CGLTF_PTRFIXUP
(
d©a
->
skšs
[
i
].
sk–‘Ú
, d©a->
nodes
, d©a->
nodes_couÁ
);

6310 
	`CGLTF_PTRFIXUP
(
d©a
->
skšs
[
i
].
šv”£_bšd_m©riûs
, d©a->
acûssÜs
, d©a->
acûssÜs_couÁ
);

6313 
cgÉf_size
 
i
 = 0; i < 
d©a
->
nodes_couÁ
; ++i)

6315 
cgÉf_size
 
j
 = 0; j < 
d©a
->
nodes
[
i
].
chd»n_couÁ
; ++j)

6317 
	`CGLTF_PTRFIXUP_REQ
(
d©a
->
nodes
[
i
].
chd»n
[
j
], d©a->nodes, d©a->
nodes_couÁ
);

6319 ià(
d©a
->
nodes
[
i
].
chd»n
[
j
]->
·»Á
)

6321  
CGLTF_ERROR_JSON
;

6324 
d©a
->
nodes
[
i
].
chd»n
[
j
]->
·»Á
 = &data->nodes[i];

6327 
	`CGLTF_PTRFIXUP
(
d©a
->
nodes
[
i
].
mesh
, d©a->
meshes
, d©a->
meshes_couÁ
);

6328 
	`CGLTF_PTRFIXUP
(
d©a
->
nodes
[
i
].
skš
, d©a->
skšs
, d©a->
skšs_couÁ
);

6329 
	`CGLTF_PTRFIXUP
(
d©a
->
nodes
[
i
].
ÿm”a
, d©a->
ÿm”as
, d©a->
ÿm”as_couÁ
);

6330 
	`CGLTF_PTRFIXUP
(
d©a
->
nodes
[
i
].
light
, d©a->
lights
, d©a->
lights_couÁ
);

6332 ià(
d©a
->
nodes
[
i
].
has_mesh_gpu_š¡ªcšg
)

6334 
	`CGLTF_PTRFIXUP_REQ
(
d©a
->
nodes
[
i
].
mesh_gpu_š¡ªcšg
.
bufãr_v›w
, d©a->
bufãr_v›ws
, d©a->
bufãr_v›ws_couÁ
);

6335 
cgÉf_size
 
m
 = 0; m < 
d©a
->
nodes
[
i
].
mesh_gpu_š¡ªcšg
.
©Œibu‹s_couÁ
; ++m)

6337 
	`CGLTF_PTRFIXUP_REQ
(
d©a
->
nodes
[
i
].
mesh_gpu_š¡ªcšg
.
©Œibu‹s
[
m
].d©a, d©a->
acûssÜs
, d©a->
acûssÜs_couÁ
);

6342 
cgÉf_size
 
i
 = 0; i < 
d©a
->
sûÃs_couÁ
; ++i)

6344 
cgÉf_size
 
j
 = 0; j < 
d©a
->
sûÃs
[
i
].
nodes_couÁ
; ++j)

6346 
	`CGLTF_PTRFIXUP_REQ
(
d©a
->
sûÃs
[
i
].
nodes
[
j
], d©a->nodes, d©a->
nodes_couÁ
);

6348 ià(
d©a
->
sûÃs
[
i
].
nodes
[
j
]->
·»Á
)

6350  
CGLTF_ERROR_JSON
;

6355 
	`CGLTF_PTRFIXUP
(
d©a
->
sûÃ
, d©a->
sûÃs
, d©a->
sûÃs_couÁ
);

6357 
cgÉf_size
 
i
 = 0; i < 
d©a
->
ªim©iÚs_couÁ
; ++i)

6359 
cgÉf_size
 
j
 = 0; j < 
d©a
->
ªim©iÚs
[
i
].
§m¶”s_couÁ
; ++j)

6361 
	`CGLTF_PTRFIXUP_REQ
(
d©a
->
ªim©iÚs
[
i
].
§m¶”s
[
j
].
šput
, d©a->
acûssÜs
, d©a->
acûssÜs_couÁ
);

6362 
	`CGLTF_PTRFIXUP_REQ
(
d©a
->
ªim©iÚs
[
i
].
§m¶”s
[
j
].
ouut
, d©a->
acûssÜs
, d©a->
acûssÜs_couÁ
);

6365 
cgÉf_size
 
j
 = 0; j < 
d©a
->
ªim©iÚs
[
i
].
chªÃls_couÁ
; ++j)

6367 
	`CGLTF_PTRFIXUP_REQ
(
d©a
->
ªim©iÚs
[
i
].
chªÃls
[
j
].
§m¶”
, d©a->ªim©iÚs[i].
§m¶”s
, d©a->ªim©iÚs[i].
§m¶”s_couÁ
);

6368 
	`CGLTF_PTRFIXUP
(
d©a
->
ªim©iÚs
[
i
].
chªÃls
[
j
].
rg‘_node
, d©a->
nodes
, d©a->
nodes_couÁ
);

6373 
	}
}

6404 
jsmÁok_t
 *
	$jsmn_®loc_tok’
(
jsmn_·r£r
 *
·r£r
,

6405 
jsmÁok_t
 *
tok’s
, 
size_t
 
num_tok’s
) {

6406 
jsmÁok_t
 *
tok
;

6407 ià(
·r£r
->
tokÃxt
 >ğ
num_tok’s
) {

6408  
NULL
;

6410 
tok
 = &
tok’s
[
·r£r
->
tokÃxt
++];

6411 
tok
->
¡¬t
 =ok->
’d
 = -1;

6412 
tok
->
size
 = 0;

6413 #ifdeà
JSMN_PARENT_LINKS


6414 
tok
->
·»Á
 = -1;

6416  
tok
;

6417 
	}
}

6422 
	$jsmn_fl_tok’
(
jsmÁok_t
 *
tok’
, 
jsmÁy³_t
 
ty³
,

6423 
¡¬t
, 
’d
) {

6424 
tok’
->
ty³
 =ype;

6425 
tok’
->
¡¬t
 = start;

6426 
tok’
->
’d
 =ƒnd;

6427 
tok’
->
size
 = 0;

6428 
	}
}

6433 
	$jsmn_·r£_´im™ive
(
jsmn_·r£r
 *
·r£r
, cÚ¡ *
js
,

6434 
size_t
 
Ën
, 
jsmÁok_t
 *
tok’s
, size_ˆ
num_tok’s
) {

6435 
jsmÁok_t
 *
tok’
;

6436 
¡¬t
;

6438 
¡¬t
 = 
·r£r
->
pos
;

6440 ; 
·r£r
->
pos
 < 
Ën
 && 
js
[parser->pos] != '\0';…arser->pos++) {

6441 
js
[
·r£r
->
pos
]) {

6442 #iâdeà
JSMN_STRICT


6448 
found
;

6450 ià(
js
[
·r£r
->
pos
] < 32 || js[parser->pos] >= 127) {

6451 
·r£r
->
pos
 = 
¡¬t
;

6452  
JSMN_ERROR_INVAL
;

6455 #ifdeà
JSMN_STRICT


6457 
·r£r
->
pos
 = 
¡¬t
;

6458  
JSMN_ERROR_PART
;

6461 
found
:

6462 ià(
tok’s
 =ğ
NULL
) {

6463 
·r£r
->
pos
--;

6466 
tok’
 = 
	`jsmn_®loc_tok’
(
·r£r
, 
tok’s
, 
num_tok’s
);

6467 ià(
tok’
 =ğ
NULL
) {

6468 
·r£r
->
pos
 = 
¡¬t
;

6469  
JSMN_ERROR_NOMEM
;

6471 
	`jsmn_fl_tok’
(
tok’
, 
JSMN_PRIMITIVE
, 
¡¬t
, 
·r£r
->
pos
);

6472 #ifdeà
JSMN_PARENT_LINKS


6473 
tok’
->
·»Á
 = 
·r£r
->
toksu³r
;

6475 
·r£r
->
pos
--;

6477 
	}
}

6482 
	$jsmn_·r£_¡ršg
(
jsmn_·r£r
 *
·r£r
, cÚ¡ *
js
,

6483 
size_t
 
Ën
, 
jsmÁok_t
 *
tok’s
, size_ˆ
num_tok’s
) {

6484 
jsmÁok_t
 *
tok’
;

6486 
¡¬t
 = 
·r£r
->
pos
;

6488 
·r£r
->
pos
++;

6491 ; 
·r£r
->
pos
 < 
Ën
 && 
js
[parser->pos] != '\0';…arser->pos++) {

6492 
c
 = 
js
[
·r£r
->
pos
];

6495 ià(
c
 == '\"') {

6496 ià(
tok’s
 =ğ
NULL
) {

6499 
tok’
 = 
	`jsmn_®loc_tok’
(
·r£r
, 
tok’s
, 
num_tok’s
);

6500 ià(
tok’
 =ğ
NULL
) {

6501 
·r£r
->
pos
 = 
¡¬t
;

6502  
JSMN_ERROR_NOMEM
;

6504 
	`jsmn_fl_tok’
(
tok’
, 
JSMN_STRING
, 
¡¬t
+1, 
·r£r
->
pos
);

6505 #ifdeà
JSMN_PARENT_LINKS


6506 
tok’
->
·»Á
 = 
·r£r
->
toksu³r
;

6512 ià(
c
 =ğ'\\' && 
·r£r
->
pos
 + 1 < 
Ën
) {

6513 
i
;

6514 
·r£r
->
pos
++;

6515 
js
[
·r£r
->
pos
]) {

6522 
·r£r
->
pos
++;

6523 
i
 = 0; i < 4 && 
·r£r
->
pos
 < 
Ën
 && 
js
[parser->pos] != '\0'; i++) {

6525 if(!((
js
[
·r£r
->
pos
] >= 48 && js[parser->pos] <= 57) ||

6526 (
js
[
·r£r
->
pos
] >= 65 && js[parser->pos] <= 70) ||

6527 (
js
[
·r£r
->
pos
] >= 97 && js[parser->pos] <= 102))) {

6528 
·r£r
->
pos
 = 
¡¬t
;

6529  
JSMN_ERROR_INVAL
;

6531 
·r£r
->
pos
++;

6533 
·r£r
->
pos
--;

6537 
·r£r
->
pos
 = 
¡¬t
;

6538  
JSMN_ERROR_INVAL
;

6542 
·r£r
->
pos
 = 
¡¬t
;

6543  
JSMN_ERROR_PART
;

6544 
	}
}

6549 
	$jsmn_·r£
(
jsmn_·r£r
 *
·r£r
, cÚ¡ *
js
, 
size_t
 
Ën
,

6550 
jsmÁok_t
 *
tok’s
, 
size_t
 
num_tok’s
) {

6551 
r
;

6552 
i
;

6553 
jsmÁok_t
 *
tok’
;

6554 
couÁ
 = 
·r£r
->
tokÃxt
;

6556 ; 
·r£r
->
pos
 < 
Ën
 && 
js
[parser->pos] != '\0';…arser->pos++) {

6557 
c
;

6558 
jsmÁy³_t
 
ty³
;

6560 
c
 = 
js
[
·r£r
->
pos
];

6561 
c
) {

6563 
couÁ
++;

6564 ià(
tok’s
 =ğ
NULL
) {

6567 
tok’
 = 
	`jsmn_®loc_tok’
(
·r£r
, 
tok’s
, 
num_tok’s
);

6568 ià(
tok’
 =ğ
NULL
)

6569  
JSMN_ERROR_NOMEM
;

6570 ià(
·r£r
->
toksu³r
 != -1) {

6571 
tok’s
[
·r£r
->
toksu³r
].
size
++;

6572 #ifdeà
JSMN_PARENT_LINKS


6573 
tok’
->
·»Á
 = 
·r£r
->
toksu³r
;

6576 
tok’
->
ty³
 = (
c
 =ğ'{' ? 
JSMN_OBJECT
 : 
JSMN_ARRAY
);

6577 
tok’
->
¡¬t
 = 
·r£r
->
pos
;

6578 
·r£r
->
toksu³r
 =…¬£r->
tokÃxt
 - 1;

6581 ià(
tok’s
 =ğ
NULL
)

6583 
ty³
 = (
c
 =ğ'}' ? 
JSMN_OBJECT
 : 
JSMN_ARRAY
);

6584 #ifdeà
JSMN_PARENT_LINKS


6585 ià(
·r£r
->
tokÃxt
 < 1) {

6586  
JSMN_ERROR_INVAL
;

6588 
tok’
 = &
tok’s
[
·r£r
->
tokÃxt
 - 1];

6590 ià(
tok’
->
¡¬t
 !ğ-1 &&ok’->
’d
 == -1) {

6591 ià(
tok’
->
ty³
 !=ype) {

6592  
JSMN_ERROR_INVAL
;

6594 
tok’
->
’d
 = 
·r£r
->
pos
 + 1;

6595 
·r£r
->
toksu³r
 = 
tok’
->
·»Á
;

6598 ià(
tok’
->
·»Á
 == -1) {

6599 if(
tok’
->
ty³
 !ğty³ || 
·r£r
->
toksu³r
 == -1) {

6600  
JSMN_ERROR_INVAL
;

6604 
tok’
 = &
tok’s
[tok’->
·»Á
];

6607 
i
 = 
·r£r
->
tokÃxt
 - 1; i >= 0; i--) {

6608 
tok’
 = &
tok’s
[
i
];

6609 ià(
tok’
->
¡¬t
 !ğ-1 &&ok’->
’d
 == -1) {

6610 ià(
tok’
->
ty³
 !=ype) {

6611  
JSMN_ERROR_INVAL
;

6613 
·r£r
->
toksu³r
 = -1;

6614 
tok’
->
’d
 = 
·r£r
->
pos
 + 1;

6619 ià(
i
 =ğ-1è 
JSMN_ERROR_INVAL
;

6620 ; 
i
 >= 0; i--) {

6621 
tok’
 = &
tok’s
[
i
];

6622 ià(
tok’
->
¡¬t
 !ğ-1 &&ok’->
’d
 == -1) {

6623 
·r£r
->
toksu³r
 = 
i
;

6630 
r
 = 
	`jsmn_·r£_¡ršg
(
·r£r
, 
js
, 
Ën
, 
tok’s
, 
num_tok’s
);

6631 ià(
r
 < 0) „;

6632 
couÁ
++;

6633 ià(
·r£r
->
toksu³r
 !ğ-1 && 
tok’s
 !ğ
NULL
)

6634 
tok’s
[
·r£r
->
toksu³r
].
size
++;

6639 
·r£r
->
toksu³r
 =…¬£r->
tokÃxt
 - 1;

6642 ià(
tok’s
 !ğ
NULL
 && 
·r£r
->
toksu³r
 != -1 &&

6643 
tok’s
[
·r£r
->
toksu³r
].
ty³
 !ğ
JSMN_ARRAY
 &&

6644 
tok’s
[
·r£r
->
toksu³r
].
ty³
 !ğ
JSMN_OBJECT
) {

6645 #ifdeà
JSMN_PARENT_LINKS


6646 
·r£r
->
toksu³r
 = 
tok’s
[·r£r->toksu³r].
·»Á
;

6648 
i
 = 
·r£r
->
tokÃxt
 - 1; i >= 0; i--) {

6649 ià(
tok’s
[
i
].
ty³
 =ğ
JSMN_ARRAY
 ||ok’s[i].ty³ =ğ
JSMN_OBJECT
) {

6650 ià(
tok’s
[
i
].
¡¬t
 !ğ-1 &&ok’s[i].
’d
 == -1) {

6651 
·r£r
->
toksu³r
 = 
i
;

6659 #ifdeà
JSMN_STRICT


6665 ià(
tok’s
 !ğ
NULL
 && 
·r£r
->
toksu³r
 != -1) {

6666 
jsmÁok_t
 *
t
 = &
tok’s
[
·r£r
->
toksu³r
];

6667 ià(
t
->
ty³
 =ğ
JSMN_OBJECT
 ||

6668 (
t
->
ty³
 =ğ
JSMN_STRING
 &&->
size
 != 0)) {

6669  
JSMN_ERROR_INVAL
;

6676 
r
 = 
	`jsmn_·r£_´im™ive
(
·r£r
, 
js
, 
Ën
, 
tok’s
, 
num_tok’s
);

6677 ià(
r
 < 0) „;

6678 
couÁ
++;

6679 ià(
·r£r
->
toksu³r
 !ğ-1 && 
tok’s
 !ğ
NULL
)

6680 
tok’s
[
·r£r
->
toksu³r
].
size
++;

6683 #ifdeà
JSMN_STRICT


6686  
JSMN_ERROR_INVAL
;

6691 ià(
tok’s
 !ğ
NULL
) {

6692 
i
 = 
·r£r
->
tokÃxt
 - 1; i >= 0; i--) {

6694 ià(
tok’s
[
i
].
¡¬t
 !ğ-1 &&ok’s[i].
’d
 == -1) {

6695  
JSMN_ERROR_PART
;

6700  
couÁ
;

6701 
	}
}

6707 
	$jsmn_š™
(
jsmn_·r£r
 *
·r£r
) {

6708 
·r£r
->
pos
 = 0;

6709 
·r£r
->
tokÃxt
 = 0;

6710 
·r£r
->
toksu³r
 = -1;

6711 
	}
}

	@include/stb_image.h

126 #iâdeà
STBI_INCLUDE_STB_IMAGE_H


127 
	#STBI_INCLUDE_STB_IMAGE_H


	)

367 #iâdeà
STBI_NO_STDIO


368 
	~<¡dio.h
>

371 
	#STBI_VERSION
 1

	)

375 
	mSTBI_deçuÉ
 = 0,

377 
	mSTBI_g»y
 = 1,

378 
	mSTBI_g»y_®pha
 = 2,

379 
	mSTBI_rgb
 = 3,

380 
	mSTBI_rgb_®pha
 = 4

383 
	~<¡dlib.h
>

384 
	t¡bi_uc
;

385 
	t¡bi_us
;

387 #ifdeà
__ılu¥lus


391 #iâdeà
STBIDEF


392 #ifdeà
STB_IMAGE_STATIC


393 
	#STBIDEF
 

	)

395 
	#STBIDEF
 

	)

410 (*
»ad
è(*
u£r
,*
d©a
,
size
);

411 (*
sk
è(*
u£r
,
n
);

412 (*
eof
è(*
u£r
);

413 } 
	t¡bi_io_ÿÎbacks
;

420 
STBIDEF
 
¡bi_uc
 *
¡bi_lßd_äom_memÜy
 (¡bi_uøcÚ¡ *
bufãr
, 
Ën
 , *
x
, *
y
, *
chªÃls_š_fe
, 
desœed_chªÃls
);

421 
STBIDEF
 
¡bi_uc
 *
¡bi_lßd_äom_ÿÎbacks
(
¡bi_io_ÿÎbacks
 cÚ¡ *
şbk
 , *
u£r
, *
x
, *
y
, *
chªÃls_š_fe
, 
desœed_chªÃls
);

423 #iâdeà
STBI_NO_STDIO


424 
STBIDEF
 
¡bi_uc
 *
¡bi_lßd
 (cÚ¡ *
f’ame
, *
x
, *
y
, *
chªÃls_š_fe
, 
desœed_chªÃls
);

425 
STBIDEF
 
¡bi_uc
 *
¡bi_lßd_äom_fe
 (
FILE
 *
f
, *
x
, *
y
, *
chªÃls_š_fe
, 
desœed_chªÃls
);

429 #iâdeà
STBI_NO_GIF


430 
STBIDEF
 
¡bi_uc
 *
¡bi_lßd_gif_äom_memÜy
(¡bi_uøcÚ¡ *
bufãr
, 
Ën
, **
d–ays
, *
x
, *
y
, *
z
, *
comp
, 
»q_comp
);

433 #ifdeà
STBI_WINDOWS_UTF8


434 
STBIDEF
 
¡bi_cÚv”t_wch¬_to_utf8
(*
bufãr
, 
size_t
 
bufã¾’
, cÚ¡ 
wch¬_t
* 
šput
);

442 
STBIDEF
 
¡bi_us
 *
¡bi_lßd_16_äom_memÜy
 (
¡bi_uc
 cÚ¡ *
bufãr
, 
Ën
, *
x
, *
y
, *
chªÃls_š_fe
, 
desœed_chªÃls
);

443 
STBIDEF
 
¡bi_us
 *
¡bi_lßd_16_äom_ÿÎbacks
(
¡bi_io_ÿÎbacks
 cÚ¡ *
şbk
, *
u£r
, *
x
, *
y
, *
chªÃls_š_fe
, 
desœed_chªÃls
);

445 #iâdeà
STBI_NO_STDIO


446 
STBIDEF
 
¡bi_us
 *
¡bi_lßd_16
 (cÚ¡ *
f’ame
, *
x
, *
y
, *
chªÃls_š_fe
, 
desœed_chªÃls
);

447 
STBIDEF
 
¡bi_us
 *
¡bi_lßd_äom_fe_16
(
FILE
 *
f
, *
x
, *
y
, *
chªÃls_š_fe
, 
desœed_chªÃls
);

454 #iâdeà
STBI_NO_LINEAR


455 
STBIDEF
 *
¡bi_lßdf_äom_memÜy
 (
¡bi_uc
 cÚ¡ *
bufãr
, 
Ën
, *
x
, *
y
, *
chªÃls_š_fe
, 
desœed_chªÃls
);

456 
STBIDEF
 *
¡bi_lßdf_äom_ÿÎbacks
 (
¡bi_io_ÿÎbacks
 cÚ¡ *
şbk
, *
u£r
, *
x
, *
y
, *
chªÃls_š_fe
, 
desœed_chªÃls
);

458 #iâdeà
STBI_NO_STDIO


459 
STBIDEF
 *
¡bi_lßdf
 (cÚ¡ *
f’ame
, *
x
, *
y
, *
chªÃls_š_fe
, 
desœed_chªÃls
);

460 
STBIDEF
 *
¡bi_lßdf_äom_fe
 (
FILE
 *
f
, *
x
, *
y
, *
chªÃls_š_fe
, 
desœed_chªÃls
);

464 #iâdeà
STBI_NO_HDR


465 
STBIDEF
 
¡bi_hdr_to_ldr_gamma
(
gamma
);

466 
STBIDEF
 
¡bi_hdr_to_ldr_sÿË
(
sÿË
);

469 #iâdeà
STBI_NO_LINEAR


470 
STBIDEF
 
¡bi_ldr_to_hdr_gamma
(
gamma
);

471 
STBIDEF
 
¡bi_ldr_to_hdr_sÿË
(
sÿË
);

475 
STBIDEF
 
¡bi_is_hdr_äom_ÿÎbacks
(
¡bi_io_ÿÎbacks
 cÚ¡ *
şbk
, *
u£r
);

476 
STBIDEF
 
¡bi_is_hdr_äom_memÜy
(
¡bi_uc
 cÚ¡ *
bufãr
, 
Ën
);

477 #iâdeà
STBI_NO_STDIO


478 
STBIDEF
 
¡bi_is_hdr
 (cÚ¡ *
f’ame
);

479 
STBIDEF
 
¡bi_is_hdr_äom_fe
(
FILE
 *
f
);

485 
STBIDEF
 cÚ¡ *
¡bi_çu»_»asÚ
 ();

488 
STBIDEF
 
¡bi_image_ä“
 (*
»tv®_äom_¡bi_lßd
);

491 
STBIDEF
 
¡bi_šfo_äom_memÜy
(
¡bi_uc
 cÚ¡ *
bufãr
, 
Ën
, *
x
, *
y
, *
comp
);

492 
STBIDEF
 
¡bi_šfo_äom_ÿÎbacks
(
¡bi_io_ÿÎbacks
 cÚ¡ *
şbk
, *
u£r
, *
x
, *
y
, *
comp
);

493 
STBIDEF
 
¡bi_is_16_b™_äom_memÜy
(
¡bi_uc
 cÚ¡ *
bufãr
, 
Ën
);

494 
STBIDEF
 
¡bi_is_16_b™_äom_ÿÎbacks
(
¡bi_io_ÿÎbacks
 cÚ¡ *
şbk
, *
u£r
);

496 #iâdeà
STBI_NO_STDIO


497 
STBIDEF
 
¡bi_šfo
 (cÚ¡ *
f’ame
, *
x
, *
y
, *
comp
);

498 
STBIDEF
 
¡bi_šfo_äom_fe
 (
FILE
 *
f
, *
x
, *
y
, *
comp
);

499 
STBIDEF
 
¡bi_is_16_b™
 (cÚ¡ *
f’ame
);

500 
STBIDEF
 
¡bi_is_16_b™_äom_fe
(
FILE
 *
f
);

508 
STBIDEF
 
¡bi_£t_uÅ»muÉly_Ú_lßd
(
æag_Œue_if_should_uÅ»muÉly
);

512 
STBIDEF
 
¡bi_cÚv”t_hÚe_²g_to_rgb
(
æag_Œue_if_should_cÚv”t
);

515 
STBIDEF
 
¡bi_£t_æ_v”tiÿÎy_Ú_lßd
(
æag_Œue_if_should_æ
);

520 
STBIDEF
 
¡bi_£t_uÅ»muÉly_Ú_lßd_th»ad
(
æag_Œue_if_should_uÅ»muÉly
);

521 
STBIDEF
 
¡bi_cÚv”t_hÚe_²g_to_rgb_th»ad
(
æag_Œue_if_should_cÚv”t
);

522 
STBIDEF
 
¡bi_£t_æ_v”tiÿÎy_Ú_lßd_th»ad
(
æag_Œue_if_should_æ
);

526 
STBIDEF
 *
¡bi_zlib_decode_m®loc_guesssize
(cÚ¡ *
bufãr
, 
Ën
, 
š™Ÿl_size
, *
ou’
);

527 
STBIDEF
 *
¡bi_zlib_decode_m®loc_guesssize_h—d”æag
(cÚ¡ *
bufãr
, 
Ën
, 
š™Ÿl_size
, *
ou’
, 
·r£_h—d”
);

528 
STBIDEF
 *
¡bi_zlib_decode_m®loc
(cÚ¡ *
bufãr
, 
Ën
, *
ou’
);

529 
STBIDEF
 
¡bi_zlib_decode_bufãr
(*
obufãr
, 
Ş’
, cÚ¡ *
ibufãr
, 
’
);

531 
STBIDEF
 *
¡bi_zlib_decode_noh—d”_m®loc
(cÚ¡ *
bufãr
, 
Ën
, *
ou’
);

532 
STBIDEF
 
¡bi_zlib_decode_noh—d”_bufãr
(*
obufãr
, 
Ş’
, cÚ¡ *
ibufãr
, 
’
);

535 #ifdeà
__ılu¥lus


544 #ifdeà
STB_IMAGE_IMPLEMENTATION


546 #ià
defšed
(
STBI_ONLY_JPEG
è|| defšed(
STBI_ONLY_PNG
è|| defšed(
STBI_ONLY_BMP
) \

547 || 
defšed
(
STBI_ONLY_TGA
è|| defšed(
STBI_ONLY_GIF
è|| defšed(
STBI_ONLY_PSD
) \

548 || 
defšed
(
STBI_ONLY_HDR
è|| defšed(
STBI_ONLY_PIC
è|| defšed(
STBI_ONLY_PNM
) \

549 || 
	$defšed
(
STBI_ONLY_ZLIB
)

550 #iâdeà
STBI_ONLY_JPEG


551 
	#STBI_NO_JPEG


	)

553 #iâdeà
STBI_ONLY_PNG


554 
	#STBI_NO_PNG


	)

556 #iâdeà
STBI_ONLY_BMP


557 
	#STBI_NO_BMP


	)

559 #iâdeà
STBI_ONLY_PSD


560 
	#STBI_NO_PSD


	)

562 #iâdeà
STBI_ONLY_TGA


563 
	#STBI_NO_TGA


	)

565 #iâdeà
STBI_ONLY_GIF


566 
	#STBI_NO_GIF


	)

568 #iâdeà
STBI_ONLY_HDR


569 
	#STBI_NO_HDR


	)

571 #iâdeà
STBI_ONLY_PIC


572 
	#STBI_NO_PIC


	)

574 #iâdeà
STBI_ONLY_PNM


575 
	#STBI_NO_PNM


	)

579 #ià
	`defšed
(
STBI_NO_PNG
è&& !defšed(
STBI_SUPPORT_ZLIB
è&& !defšed(
STBI_NO_ZLIB
)

580 
	#STBI_NO_ZLIB


	)

584 
	~<¡d¬g.h
>

585 
	~<¡ddef.h
>

586 
	~<¡dlib.h
>

587 
	~<¡ršg.h
>

588 
	~<lim™s.h
>

590 #ià!
	`defšed
(
STBI_NO_LINEAR
è|| !defšed(
STBI_NO_HDR
)

591 
	~<m©h.h
>

594 #iâdeà
STBI_NO_STDIO


595 
	~<¡dio.h
>

598 #iâdeà
STBI_ASSERT


599 
	~<as£¹.h
>

600 
	#STBI_ASSERT
(
x
è
	`as£¹
(x)

	)

603 #ifdeà
__ılu¥lus


604 
	#STBI_EXTERN
 "C"

	)

606 
	#STBI_EXTERN
 

	)

610 #iâdeà
_MSC_VER


611 #ifdeà
__ılu¥lus


612 
	#¡bi_šlše
 
šlše


	)

614 
	#¡bi_šlše


	)

617 
	#¡bi_šlše
 
__fÜûšlše


	)

620 #iâdeà
STBI_NO_THREAD_LOCALS


621 #ià
	`defšed
(
__ılu¥lus
) && __cplusplus >= 201103L

622 
	#STBI_THREAD_LOCAL
 
th»ad_loÿl


	)

623 #–ià
	`defšed
(
__GNUC__
) && __GNUC__ < 5

624 
	#STBI_THREAD_LOCAL
 
__th»ad


	)

625 #–ià
	`defšed
(
_MSC_VER
)

626 
	#STBI_THREAD_LOCAL
 
	`__deş¥ec
(
th»ad
)

	)

627 #–ià
	`defšed
 (
__STDC_VERSION__
è&& __STDC_VERSION__ >ğ201112L && !defšed(
__STDC_NO_THREADS__
)

628 
	#STBI_THREAD_LOCAL
 
_Th»ad_loÿl


	)

631 #iâdeà
STBI_THREAD_LOCAL


632 #ià
	`defšed
(
__GNUC__
)

633 
	#STBI_THREAD_LOCAL
 
__th»ad


	)

638 #ifdeà
_MSC_VER


639 
	t¡bi__ušt16
;

640 sigÃd 
	t¡bi__št16
;

641 
	t¡bi__ušt32
;

642 sigÃd 
	t¡bi__št32
;

644 
	~<¡dšt.h
>

645 
ušt16_t
 
	t¡bi__ušt16
;

646 
št16_t
 
	t¡bi__št16
;

647 
ušt32_t
 
	t¡bi__ušt32
;

648 
št32_t
 
	t¡bi__št32
;

652 
	tv®id©e_ušt32
[(
¡bi__ušt32
)==4 ? 1 : -1];

654 #ifdeà
_MSC_VER


655 
	#STBI_NOTUSED
(
v
è()(v)

	)

657 
	#STBI_NOTUSED
(
v
è()(v)

	)

660 #ifdeà
_MSC_VER


661 
	#STBI_HAS_LROTL


	)

664 #ifdeà
STBI_HAS_LROTL


665 
	#¡bi_ÌÙ
(
x
,
y
è
	`_ÌÙl
(x,y)

	)

667 
	#¡bi_ÌÙ
(
x
,
y
è(((xè<< (y)è| ((xè>> (-(yè& 31)))

	)

670 #ià
	`defšed
(
STBI_MALLOC
è&& defšed(
STBI_FREE
è&& (defšed(
STBI_REALLOC
è|| defšed(
STBI_REALLOC_SIZED
))

672 #–ià!
	`defšed
(
STBI_MALLOC
è&& !defšed(
STBI_FREE
è&& !defšed(
STBI_REALLOC
è&& !defšed(
STBI_REALLOC_SIZED
)

678 #iâdeà
STBI_MALLOC


679 
	#STBI_MALLOC
(
sz
è
	`m®loc
(sz)

	)

680 
	#STBI_REALLOC
(
p
,
Ãwsz
è
	`»®loc
Õ,Ãwsz)

	)

681 
	#STBI_FREE
(
p
è
	`ä“
Õ)

	)

684 #iâdeà
STBI_REALLOC_SIZED


685 
	#STBI_REALLOC_SIZED
(
p
,
Şdsz
,
Ãwsz
è
	`STBI_REALLOC
Õ,Ãwsz)

	)

689 #ià
	`defšed
(
__x86_64__
è|| defšed(
_M_X64
)

690 
	#STBI__X64_TARGET


	)

691 #–ià
	`defšed
(
__i386
è|| defšed(
_M_IX86
)

692 
	#STBI__X86_TARGET


	)

695 #ià
	`defšed
(
__GNUC__
è&& defšed(
STBI__X86_TARGET
è&& !defšed(
__SSE2__
è&& !defšed(
STBI_NO_SIMD
)

703 
	#STBI_NO_SIMD


	)

706 #ià
	`defšed
(
__MINGW32__
è&& defšed(
STBI__X86_TARGET
è&& !defšed(
STBI_MINGW_ENABLE_SSE2
è&& !defšed(
STBI_NO_SIMD
)

718 
	#STBI_NO_SIMD


	)

721 #ià!
	`defšed
(
STBI_NO_SIMD
è&& (defšed(
STBI__X86_TARGET
è|| defšed(
STBI__X64_TARGET
))

722 
	#STBI_SSE2


	)

723 
	~<emmšŒš.h
>

725 #ifdeà
_MSC_VER


727 #ià
_MSC_VER
 >= 1400

728 
	~<šŒš.h
>

729 
	$¡bi__ıuid3
()

731 
šfo
[4];

732 
	`__ıuid
(
šfo
,1);

733  
šfo
[3];

734 
	}
}

736 
	$¡bi__ıuid3
()

738 
»s
;

739 
__asm
 {

740 
mov
 
—x
,1

741 
ıuid


742 
mov
 
»s
,
edx


744  
»s
;

745 
	}
}

748 
	#STBI_SIMD_ALIGN
(
ty³
, 
Çme
è
	`__deş¥ec
(
	`®ign
(16)èty³ 
	)
name

750 #ià!
defšed
(
STBI_NO_JPEG
è&& defšed(
STBI_SSE2
)

751 
	$¡bi__s£2_avaabË
()

753 
šfo3
 = 
	`¡bi__ıuid3
();

754  ((
šfo3
 >> 26) & 1) != 0;

755 
	}
}

759 
	#STBI_SIMD_ALIGN
(
ty³
, 
Çme
èty³‚am
	`__©Œibu‹__
((
	`®igÃd
(16)))

	)

761 #ià!
defšed
(
STBI_NO_JPEG
è&& defšed(
STBI_SSE2
)

762 
	$¡bi__s£2_avaabË
()

768 
	}
}

775 #ià
defšed
(
STBI_NO_SIMD
è&& defšed(
STBI_NEON
)

776 #undeà
STBI_NEON


779 #ifdeà
STBI_NEON


780 
	~<¬m_ÃÚ.h
>

781 #ifdeà
_MSC_VER


782 
	#STBI_SIMD_ALIGN
(
ty³
, 
Çme
è
	`__deş¥ec
(
	`®ign
(16)èty³ 
	)
name

784 
	#STBI_SIMD_ALIGN
(
ty³
, 
Çme
èty³‚am
	`__©Œibu‹__
((
	`®igÃd
(16)))

	)

788 #iâdeà
STBI_SIMD_ALIGN


789 
	#STBI_SIMD_ALIGN
(
ty³
, 
Çme
èty³ 
	)
name

792 #iâdeà
STBI_MAX_DIMENSIONS


793 
	#STBI_MAX_DIMENSIONS
 (1 << 24)

	)

804 
¡bi__ušt32
 
	mimg_x
, 
	mimg_y
;

805 
	mimg_n
, 
	mimg_out_n
;

807 
¡bi_io_ÿÎbacks
 
	mio
;

808 *
	mio_u£r_d©a
;

810 
	m»ad_äom_ÿÎbacks
;

811 
	mbuæ’
;

812 
¡bi_uc
 
	mbufãr_¡¬t
[128];

813 
	mÿÎback_®»ady_»ad
;

815 
¡bi_uc
 *
	mimg_bufãr
, *
	mimg_bufãr_’d
;

816 
¡bi_uc
 *
	mimg_bufãr_Üigš®
, *
	mimg_bufãr_Üigš®_’d
;

817 } 
	t¡bi__cÚ‹xt
;

820 
¡bi__»fl_bufãr
(
¡bi__cÚ‹xt
 *
s
);

823 
	$¡bi__¡¬t_mem
(
¡bi__cÚ‹xt
 *
s
, 
¡bi_uc
 cÚ¡ *
bufãr
, 
Ën
)

825 
s
->
io
.
»ad
 = 
NULL
;

826 
s
->
»ad_äom_ÿÎbacks
 = 0;

827 
s
->
ÿÎback_®»ady_»ad
 = 0;

828 
s
->
img_bufãr
 = s->
img_bufãr_Üigš®
 = (
¡bi_uc
 *è
bufãr
;

829 
s
->
img_bufãr_’d
 = s->
img_bufãr_Üigš®_’d
 = (
¡bi_uc
 *è
bufãr
+
Ën
;

830 
	}
}

833 
	$¡bi__¡¬t_ÿÎbacks
(
¡bi__cÚ‹xt
 *
s
, 
¡bi_io_ÿÎbacks
 *
c
, *
u£r
)

835 
s
->
io
 = *
c
;

836 
s
->
io_u£r_d©a
 = 
u£r
;

837 
s
->
buæ’
 = (s->
bufãr_¡¬t
);

838 
s
->
»ad_äom_ÿÎbacks
 = 1;

839 
s
->
ÿÎback_®»ady_»ad
 = 0;

840 
s
->
img_bufãr
 = s->
img_bufãr_Üigš®
 = s->
bufãr_¡¬t
;

841 
	`¡bi__»fl_bufãr
(
s
);

842 
s
->
img_bufãr_Üigš®_’d
 = s->
img_bufãr_’d
;

843 
	}
}

845 #iâdeà
STBI_NO_STDIO


847 
	$¡bi__¡dio_»ad
(*
u£r
, *
d©a
, 
size
)

849  (è
	`ä—d
(
d©a
,1,
size
,(
FILE
*è
u£r
);

850 
	}
}

852 
	$¡bi__¡dio_sk
(*
u£r
, 
n
)

854 
ch
;

855 
	`f£ek
((
FILE
*è
u£r
, 
n
, 
SEEK_CUR
);

856 
ch
 = 
	`fg‘c
((
FILE
*è
u£r
);

857 ià(
ch
 !ğ
EOF
) {

858 
	`ung‘c
(
ch
, (
FILE
 *è
u£r
);

860 
	}
}

862 
	$¡bi__¡dio_eof
(*
u£r
)

864  
	`ãof
((
FILE
*è
u£r
è|| 
	`ã¼Ü
((FILE *) user);

865 
	}
}

867 
¡bi_io_ÿÎbacks
 
	g¡bi__¡dio_ÿÎbacks
 =

869 
¡bi__¡dio_»ad
,

870 
¡bi__¡dio_sk
,

871 
¡bi__¡dio_eof
,

874 
	$¡bi__¡¬t_fe
(
¡bi__cÚ‹xt
 *
s
, 
FILE
 *
f
)

876 
	`¡bi__¡¬t_ÿÎbacks
(
s
, &
¡bi__¡dio_ÿÎbacks
, (*è
f
);

877 
	}
}

883 
	$¡bi__»wšd
(
¡bi__cÚ‹xt
 *
s
)

888 
s
->
img_bufãr
 = s->
img_bufãr_Üigš®
;

889 
s
->
img_bufãr_’d
 = s->
img_bufãr_Üigš®_’d
;

890 
	}
}

894 
	mSTBI_ORDER_RGB
,

895 
	mSTBI_ORDER_BGR


900 
	mb™s_³r_chªÃl
;

901 
	mnum_chªÃls
;

902 
	mchªÃl_Üd”
;

903 } 
	t¡bi__»suÉ_šfo
;

905 #iâdeà
STBI_NO_JPEG


906 
¡bi__j³g_‹¡
(
¡bi__cÚ‹xt
 *
s
);

907 *
¡bi__j³g_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
);

908 
¡bi__j³g_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
);

911 #iâdeà
STBI_NO_PNG


912 
¡bi__²g_‹¡
(
¡bi__cÚ‹xt
 *
s
);

913 *
¡bi__²g_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
);

914 
¡bi__²g_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
);

915 
¡bi__²g_is16
(
¡bi__cÚ‹xt
 *
s
);

918 #iâdeà
STBI_NO_BMP


919 
¡bi__bmp_‹¡
(
¡bi__cÚ‹xt
 *
s
);

920 *
¡bi__bmp_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
);

921 
¡bi__bmp_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
);

924 #iâdeà
STBI_NO_TGA


925 
¡bi__tga_‹¡
(
¡bi__cÚ‹xt
 *
s
);

926 *
¡bi__tga_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
);

927 
¡bi__tga_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
);

930 #iâdeà
STBI_NO_PSD


931 
¡bi__psd_‹¡
(
¡bi__cÚ‹xt
 *
s
);

932 *
¡bi__psd_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
, 
bpc
);

933 
¡bi__psd_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
);

934 
¡bi__psd_is16
(
¡bi__cÚ‹xt
 *
s
);

937 #iâdeà
STBI_NO_HDR


938 
¡bi__hdr_‹¡
(
¡bi__cÚ‹xt
 *
s
);

939 *
¡bi__hdr_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
);

940 
¡bi__hdr_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
);

943 #iâdeà
STBI_NO_PIC


944 
¡bi__pic_‹¡
(
¡bi__cÚ‹xt
 *
s
);

945 *
¡bi__pic_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
);

946 
¡bi__pic_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
);

949 #iâdeà
STBI_NO_GIF


950 
¡bi__gif_‹¡
(
¡bi__cÚ‹xt
 *
s
);

951 *
¡bi__gif_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
);

952 *
¡bi__lßd_gif_maš
(
¡bi__cÚ‹xt
 *
s
, **
d–ays
, *
x
, *
y
, *
z
, *
comp
, 
»q_comp
);

953 
¡bi__gif_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
);

956 #iâdeà
STBI_NO_PNM


957 
¡bi__²m_‹¡
(
¡bi__cÚ‹xt
 *
s
);

958 *
¡bi__²m_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
);

959 
¡bi__²m_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
);

960 
¡bi__²m_is16
(
¡bi__cÚ‹xt
 *
s
);

964 #ifdeà
STBI_THREAD_LOCAL


965 
	gSTBI_THREAD_LOCAL


967 cÚ¡ *
	g¡bi__g_çu»_»asÚ
;

969 
STBIDEF
 cÚ¡ *
	$¡bi_çu»_»asÚ
()

971  
¡bi__g_çu»_»asÚ
;

972 
	}
}

974 #iâdeà
STBI_NO_FAILURE_STRINGS


975 
	$¡bi__”r
(cÚ¡ *
¡r
)

977 
¡bi__g_çu»_»asÚ
 = 
¡r
;

979 
	}
}

982 *
	$¡bi__m®loc
(
size_t
 
size
)

984  
	`STBI_MALLOC
(
size
);

985 
	}
}

999 
	$¡bi__addsizes_v®id
(
a
, 
b
)

1001 ià(
b
 < 0)  0;

1006  
a
 <ğ
INT_MAX
 - 
b
;

1007 
	}
}

1011 
	$¡bi__mul2sizes_v®id
(
a
, 
b
)

1013 ià(
a
 < 0 || 
b
 < 0)  0;

1014 ià(
b
 == 0)  1;

1016  
a
 <ğ
INT_MAX
/
b
;

1017 
	}
}

1019 #ià!
defšed
(
STBI_NO_JPEG
è|| !defšed(
STBI_NO_PNG
è|| !defšed(
STBI_NO_TGA
è|| !defšed(
STBI_NO_HDR
)

1021 
	$¡bi__mad2sizes_v®id
(
a
, 
b
, 
add
)

1023  
	`¡bi__mul2sizes_v®id
(
a
, 
b
è&& 
	`¡bi__addsizes_v®id
×*b, 
add
);

1024 
	}
}

1028 
	$¡bi__mad3sizes_v®id
(
a
, 
b
, 
c
, 
add
)

1030  
	`¡bi__mul2sizes_v®id
(
a
, 
b
è&& stbi__mul2sizes_v®id×*b, 
c
) &&

1031 
	`¡bi__addsizes_v®id
(
a
*
b
*
c
, 
add
);

1032 
	}
}

1035 #ià!
defšed
(
STBI_NO_LINEAR
è|| !defšed(
STBI_NO_HDR
è|| !defšed(
STBI_NO_PNM
)

1036 
	$¡bi__mad4sizes_v®id
(
a
, 
b
, 
c
, 
d
, 
add
)

1038  
	`¡bi__mul2sizes_v®id
(
a
, 
b
è&& stbi__mul2sizes_v®id×*b, 
c
) &&

1039 
	`¡bi__mul2sizes_v®id
(
a
*
b
*
c
, 
d
è&& 
	`¡bi__addsizes_v®id
×*b*c*d, 
add
);

1040 
	}
}

1043 #ià!
defšed
(
STBI_NO_JPEG
è|| !defšed(
STBI_NO_PNG
è|| !defšed(
STBI_NO_TGA
è|| !defšed(
STBI_NO_HDR
)

1045 *
	$¡bi__m®loc_mad2
(
a
, 
b
, 
add
)

1047 ià(!
	`¡bi__mad2sizes_v®id
(
a
, 
b
, 
add
)è 
NULL
;

1048  
	`¡bi__m®loc
(
a
*
b
 + 
add
);

1049 
	}
}

1052 *
	$¡bi__m®loc_mad3
(
a
, 
b
, 
c
, 
add
)

1054 ià(!
	`¡bi__mad3sizes_v®id
(
a
, 
b
, 
c
, 
add
)è 
NULL
;

1055  
	`¡bi__m®loc
(
a
*
b
*
c
 + 
add
);

1056 
	}
}

1058 #ià!
defšed
(
STBI_NO_LINEAR
è|| !defšed(
STBI_NO_HDR
è|| !defšed(
STBI_NO_PNM
)

1059 *
	$¡bi__m®loc_mad4
(
a
, 
b
, 
c
, 
d
, 
add
)

1061 ià(!
	`¡bi__mad4sizes_v®id
(
a
, 
b
, 
c
, 
d
, 
add
)è 
NULL
;

1062  
	`¡bi__m®loc
(
a
*
b
*
c
*
d
 + 
add
);

1063 
	}
}

1070 #ifdeà
STBI_NO_FAILURE_STRINGS


1071 
	#¡bi__”r
(
x
,
y
è0

	)

1072 #–ià
defšed
(
STBI_FAILURE_USERMSG
)

1073 
	#¡bi__”r
(
x
,
y
è
	`¡bi__”r
(y)

	)

1075 
	#¡bi__”r
(
x
,
y
è
	`¡bi__”r
(x)

	)

1078 
	#¡bi__”½f
(
x
,
y
è((*)(
size_t
è(
	`¡bi__”r
(x,y)?
NULL
:NULL))

	)

1079 
	#¡bi__”½uc
(
x
,
y
è((*)(
size_t
è(
	`¡bi__”r
(x,y)?
NULL
:NULL))

	)

1081 
STBIDEF
 
	$¡bi_image_ä“
(*
»tv®_äom_¡bi_lßd
)

1083 
	`STBI_FREE
(
»tv®_äom_¡bi_lßd
);

1084 
	}
}

1086 #iâdeà
STBI_NO_LINEAR


1087 *
¡bi__ldr_to_hdr
(
¡bi_uc
 *
d©a
, 
x
, 
y
, 
comp
);

1090 #iâdeà
STBI_NO_HDR


1091 
¡bi_uc
 *
¡bi__hdr_to_ldr
(*
d©a
, 
x
, 
y
, 
comp
);

1094 
	g¡bi__v”tiÿÎy_æ_Ú_lßd_glob®
 = 0;

1096 
STBIDEF
 
	$¡bi_£t_æ_v”tiÿÎy_Ú_lßd
(
æag_Œue_if_should_æ
)

1098 
¡bi__v”tiÿÎy_æ_Ú_lßd_glob®
 = 
æag_Œue_if_should_æ
;

1099 
	}
}

1101 #iâdeà
STBI_THREAD_LOCAL


1102 
	#¡bi__v”tiÿÎy_æ_Ú_lßd
 
¡bi__v”tiÿÎy_æ_Ú_lßd_glob®


	)

1104 
STBI_THREAD_LOCAL
 
	g¡bi__v”tiÿÎy_æ_Ú_lßd_loÿl
, 
	g¡bi__v”tiÿÎy_æ_Ú_lßd_£t
;

1106 
STBIDEF
 
	$¡bi_£t_æ_v”tiÿÎy_Ú_lßd_th»ad
(
æag_Œue_if_should_æ
)

1108 
¡bi__v”tiÿÎy_æ_Ú_lßd_loÿl
 = 
æag_Œue_if_should_æ
;

1109 
¡bi__v”tiÿÎy_æ_Ú_lßd_£t
 = 1;

1110 
	}
}

1112 
	#¡bi__v”tiÿÎy_æ_Ú_lßd
 (
¡bi__v”tiÿÎy_æ_Ú_lßd_£t
 \

1113 ? 
¡bi__v”tiÿÎy_æ_Ú_lßd_loÿl
 \

1114 : 
¡bi__v”tiÿÎy_æ_Ú_lßd_glob®
)

	)

1117 *
	$¡bi__lßd_maš
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
, 
bpc
)

1119 
	`mem£t
(
ri
, 0, (*ri));

1120 
ri
->
b™s_³r_chªÃl
 = 8;

1121 
ri
->
chªÃl_Üd”
 = 
STBI_ORDER_RGB
;

1122 
ri
->
num_chªÃls
 = 0;

1126 #iâdeà
STBI_NO_PNG


1127 ià(
	`¡bi__²g_‹¡
(
s
)è 
	`¡bi__²g_lßd
(s,
x
,
y
,
comp
,
»q_comp
, 
ri
);

1129 #iâdeà
STBI_NO_BMP


1130 ià(
	`¡bi__bmp_‹¡
(
s
)è 
	`¡bi__bmp_lßd
(s,
x
,
y
,
comp
,
»q_comp
, 
ri
);

1132 #iâdeà
STBI_NO_GIF


1133 ià(
	`¡bi__gif_‹¡
(
s
)è 
	`¡bi__gif_lßd
(s,
x
,
y
,
comp
,
»q_comp
, 
ri
);

1135 #iâdeà
STBI_NO_PSD


1136 ià(
	`¡bi__psd_‹¡
(
s
)è 
	`¡bi__psd_lßd
(s,
x
,
y
,
comp
,
»q_comp
, 
ri
, 
bpc
);

1138 
	`STBI_NOTUSED
(
bpc
);

1140 #iâdeà
STBI_NO_PIC


1141 ià(
	`¡bi__pic_‹¡
(
s
)è 
	`¡bi__pic_lßd
(s,
x
,
y
,
comp
,
»q_comp
, 
ri
);

1147 #iâdeà
STBI_NO_JPEG


1148 ià(
	`¡bi__j³g_‹¡
(
s
)è 
	`¡bi__j³g_lßd
(s,
x
,
y
,
comp
,
»q_comp
, 
ri
);

1150 #iâdeà
STBI_NO_PNM


1151 ià(
	`¡bi__²m_‹¡
(
s
)è 
	`¡bi__²m_lßd
(s,
x
,
y
,
comp
,
»q_comp
, 
ri
);

1154 #iâdeà
STBI_NO_HDR


1155 ià(
	`¡bi__hdr_‹¡
(
s
)) {

1156 *
hdr
 = 
	`¡bi__hdr_lßd
(
s
, 
x
,
y
,
comp
,
»q_comp
, 
ri
);

1157  
	`¡bi__hdr_to_ldr
(
hdr
, *
x
, *
y
, 
»q_comp
 ?„eq_com°: *
comp
);

1161 #iâdeà
STBI_NO_TGA


1163 ià(
	`¡bi__tga_‹¡
(
s
))

1164  
	`¡bi__tga_lßd
(
s
,
x
,
y
,
comp
,
»q_comp
, 
ri
);

1167  
	`¡bi__”½uc
("unknown imageype", "Image‚ot of‡ny knownype, or corrupt");

1168 
	}
}

1170 
¡bi_uc
 *
	$¡bi__cÚv”t_16_to_8
(
¡bi__ušt16
 *
Üig
, 
w
, 
h
, 
chªÃls
)

1172 
i
;

1173 
img_Ën
 = 
w
 * 
h
 * 
chªÃls
;

1174 
¡bi_uc
 *
»duûd
;

1176 
»duûd
 = (
¡bi_uc
 *è
	`¡bi__m®loc
(
img_Ën
);

1177 ià(
»duûd
 =ğ
NULL
è 
	`¡bi__”½uc
("outofmem", "Out of memory");

1179 
i
 = 0; i < 
img_Ën
; ++i)

1180 
»duûd
[
i
] = (
¡bi_uc
)((
Üig
[i] >> 8) & 0xFF);

1182 
	`STBI_FREE
(
Üig
);

1183  
»duûd
;

1184 
	}
}

1186 
¡bi__ušt16
 *
	$¡bi__cÚv”t_8_to_16
(
¡bi_uc
 *
Üig
, 
w
, 
h
, 
chªÃls
)

1188 
i
;

1189 
img_Ën
 = 
w
 * 
h
 * 
chªÃls
;

1190 
¡bi__ušt16
 *
’Ïrged
;

1192 
’Ïrged
 = (
¡bi__ušt16
 *è
	`¡bi__m®loc
(
img_Ën
*2);

1193 ià(
’Ïrged
 =ğ
NULL
è (
¡bi__ušt16
 *è
	`¡bi__”½uc
("outofmem", "Out of memory");

1195 
i
 = 0; i < 
img_Ën
; ++i)

1196 
’Ïrged
[
i
] = (
¡bi__ušt16
)((
Üig
[i] << 8) + orig[i]);

1198 
	`STBI_FREE
(
Üig
);

1199  
’Ïrged
;

1200 
	}
}

1202 
	$¡bi__v”tiÿl_æ
(*
image
, 
w
, 
h
, 
by‹s_³r_pix–
)

1204 
row
;

1205 
size_t
 
by‹s_³r_row
 = (size_t)
w
 * 
by‹s_³r_pix–
;

1206 
¡bi_uc
 
‹mp
[2048];

1207 
¡bi_uc
 *
by‹s
 = (¡bi_uø*)
image
;

1209 
row
 = 0;„ow < (
h
>>1);„ow++) {

1210 
¡bi_uc
 *
row0
 = 
by‹s
 + 
row
*
by‹s_³r_row
;

1211 
¡bi_uc
 *
row1
 = 
by‹s
 + (
h
 - 
row
 - 1)*
by‹s_³r_row
;

1213 
size_t
 
by‹s_Ëá
 = 
by‹s_³r_row
;

1214 
by‹s_Ëá
) {

1215 
size_t
 
by‹s_cİy
 = (
by‹s_Ëá
 < (
‹mp
)) ? bytes_left : (temp);

1216 
	`memıy
(
‹mp
, 
row0
, 
by‹s_cİy
);

1217 
	`memıy
(
row0
, 
row1
, 
by‹s_cİy
);

1218 
	`memıy
(
row1
, 
‹mp
, 
by‹s_cİy
);

1219 
row0
 +ğ
by‹s_cİy
;

1220 
row1
 +ğ
by‹s_cİy
;

1221 
by‹s_Ëá
 -ğ
by‹s_cİy
;

1224 
	}
}

1226 #iâdeà
STBI_NO_GIF


1227 
	$¡bi__v”tiÿl_æ_¦iûs
(*
image
, 
w
, 
h
, 
z
, 
by‹s_³r_pix–
)

1229 
¦iû
;

1230 
¦iû_size
 = 
w
 * 
h
 * 
by‹s_³r_pix–
;

1232 
¡bi_uc
 *
by‹s
 = (¡bi_uø*)
image
;

1233 
¦iû
 = 0; sliû < 
z
; ++slice) {

1234 
	`¡bi__v”tiÿl_æ
(
by‹s
, 
w
, 
h
, 
by‹s_³r_pix–
);

1235 
by‹s
 +ğ
¦iû_size
;

1237 
	}
}

1240 *
	$¡bi__lßd_ªd_po¡´oûss_8b™
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
)

1242 
¡bi__»suÉ_šfo
 
ri
;

1243 *
»suÉ
 = 
	`¡bi__lßd_maš
(
s
, 
x
, 
y
, 
comp
, 
»q_comp
, &
ri
, 8);

1245 ià(
»suÉ
 =ğ
NULL
)

1246  
NULL
;

1249 
	`STBI_ASSERT
(
ri
.
b™s_³r_chªÃl
 == 8 ||„i.bits_per_channel == 16);

1251 ià(
ri
.
b™s_³r_chªÃl
 != 8) {

1252 
»suÉ
 = 
	`¡bi__cÚv”t_16_to_8
((
¡bi__ušt16
 *è»suÉ, *
x
, *
y
, 
»q_comp
 =ğ0 ? *
comp
 :„eq_comp);

1253 
ri
.
b™s_³r_chªÃl
 = 8;

1258 ià(
¡bi__v”tiÿÎy_æ_Ú_lßd
) {

1259 
chªÃls
 = 
»q_comp
 ?„eq_com°: *
comp
;

1260 
	`¡bi__v”tiÿl_æ
(
»suÉ
, *
x
, *
y
, 
chªÃls
 * (
¡bi_uc
));

1263  (*è
»suÉ
;

1264 
	}
}

1266 
¡bi__ušt16
 *
	$¡bi__lßd_ªd_po¡´oûss_16b™
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
)

1268 
¡bi__»suÉ_šfo
 
ri
;

1269 *
»suÉ
 = 
	`¡bi__lßd_maš
(
s
, 
x
, 
y
, 
comp
, 
»q_comp
, &
ri
, 16);

1271 ià(
»suÉ
 =ğ
NULL
)

1272  
NULL
;

1275 
	`STBI_ASSERT
(
ri
.
b™s_³r_chªÃl
 == 8 ||„i.bits_per_channel == 16);

1277 ià(
ri
.
b™s_³r_chªÃl
 != 16) {

1278 
»suÉ
 = 
	`¡bi__cÚv”t_8_to_16
((
¡bi_uc
 *è»suÉ, *
x
, *
y
, 
»q_comp
 =ğ0 ? *
comp
 :„eq_comp);

1279 
ri
.
b™s_³r_chªÃl
 = 16;

1285 ià(
¡bi__v”tiÿÎy_æ_Ú_lßd
) {

1286 
chªÃls
 = 
»q_comp
 ?„eq_com°: *
comp
;

1287 
	`¡bi__v”tiÿl_æ
(
»suÉ
, *
x
, *
y
, 
chªÃls
 * (
¡bi__ušt16
));

1290  (
¡bi__ušt16
 *è
»suÉ
;

1291 
	}
}

1293 #ià!
defšed
(
STBI_NO_HDR
è&& !defšed(
STBI_NO_LINEAR
)

1294 
	$¡bi__æßt_po¡´oûss
(*
»suÉ
, *
x
, *
y
, *
comp
, 
»q_comp
)

1296 ià(
¡bi__v”tiÿÎy_æ_Ú_lßd
 && 
»suÉ
 !ğ
NULL
) {

1297 
chªÃls
 = 
»q_comp
 ?„eq_com°: *
comp
;

1298 
	`¡bi__v”tiÿl_æ
(
»suÉ
, *
x
, *
y
, 
chªÃls
 * ());

1300 
	}
}

1303 #iâdeà
STBI_NO_STDIO


1305 #ià
defšed
(
_WIN32
è&& defšed(
STBI_WINDOWS_UTF8
)

1306 
STBI_EXTERN
 
	$__deş¥ec
(
dÎimpÜt
è
__¡dÿÎ
 
	`MuÉiBy‹ToWideCh¬
(
ı
, 
æags
, cÚ¡ *
¡r
, 
cbmb
, 
wch¬_t
 *
wide¡r
, 
cchwide
);

1307 
STBI_EXTERN
 
	$__deş¥ec
(
dÎimpÜt
è
__¡dÿÎ
 
	`WideCh¬ToMuÉiBy‹
(
ı
, 
æags
, cÚ¡ 
wch¬_t
 *
wide¡r
, 
cchwide
, *
¡r
, 
cbmb
, cÚ¡ *
defch¬
, *
u£d_deçuÉ
);

1310 #ià
	`defšed
(
_WIN32
è&& defšed(
STBI_WINDOWS_UTF8
)

1311 
STBIDEF
 
	$¡bi_cÚv”t_wch¬_to_utf8
(*
bufãr
, 
size_t
 
bufã¾’
, cÚ¡ 
wch¬_t
* 
šput
)

1313  
	`WideCh¬ToMuÉiBy‹
(65001 , 0, 
šput
, -1, 
bufãr
, (è
bufã¾’
, 
NULL
, NULL);

1314 
	}
}

1317 
FILE
 *
	$¡bi__fİ’
(cÚ¡ *
f’ame
, cÚ¡ *
mode
)

1319 
FILE
 *
f
;

1320 #ià
	`defšed
(
_WIN32
è&& defšed(
STBI_WINDOWS_UTF8
)

1321 
wch¬_t
 
wMode
[64];

1322 
wch¬_t
 
wF’ame
[1024];

1323 ià(0 =ğ
	`MuÉiBy‹ToWideCh¬
(65001 , 0, 
f’ame
, -1, 
wF’ame
, (wFilename)/(*wFilename)))

1326 ià(0 =ğ
	`MuÉiBy‹ToWideCh¬
(65001 , 0, 
mode
, -1, 
wMode
, (wMode)/(*wMode)))

1329 #ià
	`defšed
(
_MSC_VER
) && _MSC_VER >= 1400

1330 ià(0 !ğ
	`_wfİ’_s
(&
f
, 
wF’ame
, 
wMode
))

1331 
f
 = 0;

1333 
f
 = 
	`_wfİ’
(
wF’ame
, 
wMode
);

1336 #–ià
	`defšed
(
_MSC_VER
) && _MSC_VER >= 1400

1337 ià(0 !ğ
	`fİ’_s
(&
f
, 
f’ame
, 
mode
))

1338 
f
=0;

1340 
f
 = 
	`fİ’
(
f’ame
, 
mode
);

1342  
f
;

1343 
	}
}

1346 
STBIDEF
 
¡bi_uc
 *
	$¡bi_lßd
(cÚ¡ *
f’ame
, *
x
, *
y
, *
comp
, 
»q_comp
)

1348 
FILE
 *
f
 = 
	`¡bi__fİ’
(
f’ame
, "rb");

1349 *
»suÉ
;

1350 ià(!
f
è 
	`¡bi__”½uc
("can't fopen", "Unableo open file");

1351 
»suÉ
 = 
	`¡bi_lßd_äom_fe
(
f
,
x
,
y
,
comp
,
»q_comp
);

1352 
	`fşo£
(
f
);

1353  
»suÉ
;

1354 
	}
}

1356 
STBIDEF
 
¡bi_uc
 *
	$¡bi_lßd_äom_fe
(
FILE
 *
f
, *
x
, *
y
, *
comp
, 
»q_comp
)

1358 *
»suÉ
;

1359 
¡bi__cÚ‹xt
 
s
;

1360 
	`¡bi__¡¬t_fe
(&
s
,
f
);

1361 
»suÉ
 = 
	`¡bi__lßd_ªd_po¡´oûss_8b™
(&
s
,
x
,
y
,
comp
,
»q_comp
);

1362 ià(
»suÉ
) {

1364 
	`f£ek
(
f
, - (è(
s
.
img_bufãr_’d
 - s.
img_bufãr
), 
SEEK_CUR
);

1366  
»suÉ
;

1367 
	}
}

1369 
STBIDEF
 
¡bi__ušt16
 *
	$¡bi_lßd_äom_fe_16
(
FILE
 *
f
, *
x
, *
y
, *
comp
, 
»q_comp
)

1371 
¡bi__ušt16
 *
»suÉ
;

1372 
¡bi__cÚ‹xt
 
s
;

1373 
	`¡bi__¡¬t_fe
(&
s
,
f
);

1374 
»suÉ
 = 
	`¡bi__lßd_ªd_po¡´oûss_16b™
(&
s
,
x
,
y
,
comp
,
»q_comp
);

1375 ià(
»suÉ
) {

1377 
	`f£ek
(
f
, - (è(
s
.
img_bufãr_’d
 - s.
img_bufãr
), 
SEEK_CUR
);

1379  
»suÉ
;

1380 
	}
}

1382 
STBIDEF
 
¡bi_us
 *
	$¡bi_lßd_16
(cÚ¡ *
f’ame
, *
x
, *
y
, *
comp
, 
»q_comp
)

1384 
FILE
 *
f
 = 
	`¡bi__fİ’
(
f’ame
, "rb");

1385 
¡bi__ušt16
 *
»suÉ
;

1386 ià(!
f
è (
¡bi_us
 *è
	`¡bi__”½uc
("can't fopen", "Unableo open file");

1387 
»suÉ
 = 
	`¡bi_lßd_äom_fe_16
(
f
,
x
,
y
,
comp
,
»q_comp
);

1388 
	`fşo£
(
f
);

1389  
»suÉ
;

1390 
	}
}

1395 
STBIDEF
 
¡bi_us
 *
	$¡bi_lßd_16_äom_memÜy
(
¡bi_uc
 cÚ¡ *
bufãr
, 
Ën
, *
x
, *
y
, *
chªÃls_š_fe
, 
desœed_chªÃls
)

1397 
¡bi__cÚ‹xt
 
s
;

1398 
	`¡bi__¡¬t_mem
(&
s
,
bufãr
,
Ën
);

1399  
	`¡bi__lßd_ªd_po¡´oûss_16b™
(&
s
,
x
,
y
,
chªÃls_š_fe
,
desœed_chªÃls
);

1400 
	}
}

1402 
STBIDEF
 
¡bi_us
 *
	$¡bi_lßd_16_äom_ÿÎbacks
(
¡bi_io_ÿÎbacks
 cÚ¡ *
şbk
, *
u£r
, *
x
, *
y
, *
chªÃls_š_fe
, 
desœed_chªÃls
)

1404 
¡bi__cÚ‹xt
 
s
;

1405 
	`¡bi__¡¬t_ÿÎbacks
(&
s
, (
¡bi_io_ÿÎbacks
 *)
şbk
, 
u£r
);

1406  
	`¡bi__lßd_ªd_po¡´oûss_16b™
(&
s
,
x
,
y
,
chªÃls_š_fe
,
desœed_chªÃls
);

1407 
	}
}

1409 
STBIDEF
 
¡bi_uc
 *
	$¡bi_lßd_äom_memÜy
(
¡bi_uc
 cÚ¡ *
bufãr
, 
Ën
, *
x
, *
y
, *
comp
, 
»q_comp
)

1411 
¡bi__cÚ‹xt
 
s
;

1412 
	`¡bi__¡¬t_mem
(&
s
,
bufãr
,
Ën
);

1413  
	`¡bi__lßd_ªd_po¡´oûss_8b™
(&
s
,
x
,
y
,
comp
,
»q_comp
);

1414 
	}
}

1416 
STBIDEF
 
¡bi_uc
 *
	$¡bi_lßd_äom_ÿÎbacks
(
¡bi_io_ÿÎbacks
 cÚ¡ *
şbk
, *
u£r
, *
x
, *
y
, *
comp
, 
»q_comp
)

1418 
¡bi__cÚ‹xt
 
s
;

1419 
	`¡bi__¡¬t_ÿÎbacks
(&
s
, (
¡bi_io_ÿÎbacks
 *è
şbk
, 
u£r
);

1420  
	`¡bi__lßd_ªd_po¡´oûss_8b™
(&
s
,
x
,
y
,
comp
,
»q_comp
);

1421 
	}
}

1423 #iâdeà
STBI_NO_GIF


1424 
STBIDEF
 
¡bi_uc
 *
	$¡bi_lßd_gif_äom_memÜy
(
¡bi_uc
 cÚ¡ *
bufãr
, 
Ën
, **
d–ays
, *
x
, *
y
, *
z
, *
comp
, 
»q_comp
)

1426 *
»suÉ
;

1427 
¡bi__cÚ‹xt
 
s
;

1428 
	`¡bi__¡¬t_mem
(&
s
,
bufãr
,
Ën
);

1430 
»suÉ
 = (*è
	`¡bi__lßd_gif_maš
(&
s
, 
d–ays
, 
x
, 
y
, 
z
, 
comp
, 
»q_comp
);

1431 ià(
¡bi__v”tiÿÎy_æ_Ú_lßd
) {

1432 
	`¡bi__v”tiÿl_æ_¦iûs
Ğ
»suÉ
, *
x
, *
y
, *
z
, *
comp
 );

1435  
»suÉ
;

1436 
	}
}

1439 #iâdeà
STBI_NO_LINEAR


1440 *
	$¡bi__lßdf_maš
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
)

1442 *
d©a
;

1443 #iâdeà
STBI_NO_HDR


1444 ià(
	`¡bi__hdr_‹¡
(
s
)) {

1445 
¡bi__»suÉ_šfo
 
ri
;

1446 *
hdr_d©a
 = 
	`¡bi__hdr_lßd
(
s
,
x
,
y
,
comp
,
»q_comp
, &
ri
);

1447 ià(
hdr_d©a
)

1448 
	`¡bi__æßt_po¡´oûss
(
hdr_d©a
,
x
,
y
,
comp
,
»q_comp
);

1449  
hdr_d©a
;

1452 
d©a
 = 
	`¡bi__lßd_ªd_po¡´oûss_8b™
(
s
, 
x
, 
y
, 
comp
, 
»q_comp
);

1453 ià(
d©a
)

1454  
	`¡bi__ldr_to_hdr
(
d©a
, *
x
, *
y
, 
»q_comp
 ?„eq_com°: *
comp
);

1455  
	`¡bi__”½f
("unknown imageype", "Image‚ot of‡ny knownype, or corrupt");

1456 
	}
}

1458 
STBIDEF
 *
	$¡bi_lßdf_äom_memÜy
(
¡bi_uc
 cÚ¡ *
bufãr
, 
Ën
, *
x
, *
y
, *
comp
, 
»q_comp
)

1460 
¡bi__cÚ‹xt
 
s
;

1461 
	`¡bi__¡¬t_mem
(&
s
,
bufãr
,
Ën
);

1462  
	`¡bi__lßdf_maš
(&
s
,
x
,
y
,
comp
,
»q_comp
);

1463 
	}
}

1465 
STBIDEF
 *
	$¡bi_lßdf_äom_ÿÎbacks
(
¡bi_io_ÿÎbacks
 cÚ¡ *
şbk
, *
u£r
, *
x
, *
y
, *
comp
, 
»q_comp
)

1467 
¡bi__cÚ‹xt
 
s
;

1468 
	`¡bi__¡¬t_ÿÎbacks
(&
s
, (
¡bi_io_ÿÎbacks
 *è
şbk
, 
u£r
);

1469  
	`¡bi__lßdf_maš
(&
s
,
x
,
y
,
comp
,
»q_comp
);

1470 
	}
}

1472 #iâdeà
STBI_NO_STDIO


1473 
STBIDEF
 *
	$¡bi_lßdf
(cÚ¡ *
f’ame
, *
x
, *
y
, *
comp
, 
»q_comp
)

1475 *
»suÉ
;

1476 
FILE
 *
f
 = 
	`¡bi__fİ’
(
f’ame
, "rb");

1477 ià(!
f
è 
	`¡bi__”½f
("can't fopen", "Unableo open file");

1478 
»suÉ
 = 
	`¡bi_lßdf_äom_fe
(
f
,
x
,
y
,
comp
,
»q_comp
);

1479 
	`fşo£
(
f
);

1480  
»suÉ
;

1481 
	}
}

1483 
STBIDEF
 *
	$¡bi_lßdf_äom_fe
(
FILE
 *
f
, *
x
, *
y
, *
comp
, 
»q_comp
)

1485 
¡bi__cÚ‹xt
 
s
;

1486 
	`¡bi__¡¬t_fe
(&
s
,
f
);

1487  
	`¡bi__lßdf_maš
(&
s
,
x
,
y
,
comp
,
»q_comp
);

1488 
	}
}

1497 
STBIDEF
 
	$¡bi_is_hdr_äom_memÜy
(
¡bi_uc
 cÚ¡ *
bufãr
, 
Ën
)

1499 #iâdeà
STBI_NO_HDR


1500 
¡bi__cÚ‹xt
 
s
;

1501 
	`¡bi__¡¬t_mem
(&
s
,
bufãr
,
Ën
);

1502  
	`¡bi__hdr_‹¡
(&
s
);

1504 
	`STBI_NOTUSED
(
bufãr
);

1505 
	`STBI_NOTUSED
(
Ën
);

1508 
	}
}

1510 #iâdeà
STBI_NO_STDIO


1511 
STBIDEF
 
	$¡bi_is_hdr
 (cÚ¡ *
f’ame
)

1513 
FILE
 *
f
 = 
	`¡bi__fİ’
(
f’ame
, "rb");

1514 
»suÉ
=0;

1515 ià(
f
) {

1516 
»suÉ
 = 
	`¡bi_is_hdr_äom_fe
(
f
);

1517 
	`fşo£
(
f
);

1519  
»suÉ
;

1520 
	}
}

1522 
STBIDEF
 
	$¡bi_is_hdr_äom_fe
(
FILE
 *
f
)

1524 #iâdeà
STBI_NO_HDR


1525 
pos
 = 
	`á–l
(
f
);

1526 
»s
;

1527 
¡bi__cÚ‹xt
 
s
;

1528 
	`¡bi__¡¬t_fe
(&
s
,
f
);

1529 
»s
 = 
	`¡bi__hdr_‹¡
(&
s
);

1530 
	`f£ek
(
f
, 
pos
, 
SEEK_SET
);

1531  
»s
;

1533 
	`STBI_NOTUSED
(
f
);

1536 
	}
}

1539 
STBIDEF
 
	$¡bi_is_hdr_äom_ÿÎbacks
(
¡bi_io_ÿÎbacks
 cÚ¡ *
şbk
, *
u£r
)

1541 #iâdeà
STBI_NO_HDR


1542 
¡bi__cÚ‹xt
 
s
;

1543 
	`¡bi__¡¬t_ÿÎbacks
(&
s
, (
¡bi_io_ÿÎbacks
 *è
şbk
, 
u£r
);

1544  
	`¡bi__hdr_‹¡
(&
s
);

1546 
	`STBI_NOTUSED
(
şbk
);

1547 
	`STBI_NOTUSED
(
u£r
);

1550 
	}
}

1552 #iâdeà
STBI_NO_LINEAR


1553 
	g¡bi__l2h_gamma
=2.2f, 
	g¡bi__l2h_sÿË
=1.0f;

1555 
STBIDEF
 
	$¡bi_ldr_to_hdr_gamma
(
gamma
è{ 
¡bi__l2h_gamma
 = gamma; 
	}
}

1556 
STBIDEF
 
	$¡bi_ldr_to_hdr_sÿË
(
sÿË
è{ 
¡bi__l2h_sÿË
 = sÿË; 
	}
}

1559 
	g¡bi__h2l_gamma_i
=1.0f/2.2f, 
	g¡bi__h2l_sÿË_i
=1.0f;

1561 
STBIDEF
 
	$¡bi_hdr_to_ldr_gamma
(
gamma
è{ 
¡bi__h2l_gamma_i
 = 1/gamma; 
	}
}

1562 
STBIDEF
 
	$¡bi_hdr_to_ldr_sÿË
(
sÿË
è{ 
¡bi__h2l_sÿË_i
 = 1/sÿË; 
	}
}

1572 
	mSTBI__SCAN_lßd
=0,

1573 
	mSTBI__SCAN_ty³
,

1574 
	mSTBI__SCAN_h—d”


1577 
	$¡bi__»fl_bufãr
(
¡bi__cÚ‹xt
 *
s
)

1579 
n
 = (
s
->
io
.
»ad
)(s->
io_u£r_d©a
,(*)s->
bufãr_¡¬t
,s->
buæ’
);

1580 
s
->
ÿÎback_®»ady_»ad
 +ğ(è(s->
img_bufãr
 - s->
img_bufãr_Üigš®
);

1581 ià(
n
 == 0) {

1584 
s
->
»ad_äom_ÿÎbacks
 = 0;

1585 
s
->
img_bufãr
 = s->
bufãr_¡¬t
;

1586 
s
->
img_bufãr_’d
 = s->
bufãr_¡¬t
+1;

1587 *
s
->
img_bufãr
 = 0;

1589 
s
->
img_bufãr
 = s->
bufãr_¡¬t
;

1590 
s
->
img_bufãr_’d
 = s->
bufãr_¡¬t
 + 
n
;

1592 
	}
}

1594 
¡bi_šlše
 
¡bi_uc
 
	$¡bi__g‘8
(
¡bi__cÚ‹xt
 *
s
)

1596 ià(
s
->
img_bufãr
 < s->
img_bufãr_’d
)

1597  *
s
->
img_bufãr
++;

1598 ià(
s
->
»ad_äom_ÿÎbacks
) {

1599 
	`¡bi__»fl_bufãr
(
s
);

1600  *
s
->
img_bufãr
++;

1603 
	}
}

1605 #ià
defšed
(
STBI_NO_JPEG
è&& defšed(
STBI_NO_HDR
è&& defšed(
STBI_NO_PIC
è&& defšed(
STBI_NO_PNM
)

1608 
¡bi_šlše
 
	$¡bi__©_eof
(
¡bi__cÚ‹xt
 *
s
)

1610 ià(
s
->
io
.
»ad
) {

1611 ià(!(
s
->
io
.
eof
)(s->
io_u£r_d©a
))  0;

1614 ià(
s
->
»ad_äom_ÿÎbacks
 == 0)  1;

1617  
s
->
img_bufãr
 >ğs->
img_bufãr_’d
;

1618 
	}
}

1621 #ià
defšed
(
STBI_NO_JPEG
è&& defšed(
STBI_NO_PNG
è&& defšed(
STBI_NO_BMP
è&& defšed(
STBI_NO_PSD
è&& defšed(
STBI_NO_TGA
è&& defšed(
STBI_NO_GIF
è&& defšed(
STBI_NO_PIC
)

1624 
	$¡bi__sk
(
¡bi__cÚ‹xt
 *
s
, 
n
)

1626 ià(
n
 == 0) ;

1627 ià(
n
 < 0) {

1628 
s
->
img_bufãr
 = s->
img_bufãr_’d
;

1631 ià(
s
->
io
.
»ad
) {

1632 
bËn
 = (è(
s
->
img_bufãr_’d
 - s->
img_bufãr
);

1633 ià(
bËn
 < 
n
) {

1634 
s
->
img_bufãr
 = s->
img_bufãr_’d
;

1635 (
s
->
io
.
sk
)(s->
io_u£r_d©a
, 
n
 - 
bËn
);

1639 
s
->
img_bufãr
 +ğ
n
;

1640 
	}
}

1643 #ià
defšed
(
STBI_NO_PNG
è&& defšed(
STBI_NO_TGA
è&& defšed(
STBI_NO_HDR
è&& defšed(
STBI_NO_PNM
)

1646 
	$¡bi__g‘n
(
¡bi__cÚ‹xt
 *
s
, 
¡bi_uc
 *
bufãr
, 
n
)

1648 ià(
s
->
io
.
»ad
) {

1649 
bËn
 = (è(
s
->
img_bufãr_’d
 - s->
img_bufãr
);

1650 ià(
bËn
 < 
n
) {

1651 
»s
, 
couÁ
;

1653 
	`memıy
(
bufãr
, 
s
->
img_bufãr
, 
bËn
);

1655 
couÁ
 = (
s
->
io
.
»ad
)(s->
io_u£r_d©a
, (*è
bufãr
 + 
bËn
, 
n
 - blen);

1656 
»s
 = (
couÁ
 =ğ(
n
-
bËn
));

1657 
s
->
img_bufãr
 = s->
img_bufãr_’d
;

1658  
»s
;

1662 ià(
s
->
img_bufãr
+
n
 <ğs->
img_bufãr_’d
) {

1663 
	`memıy
(
bufãr
, 
s
->
img_bufãr
, 
n
);

1664 
s
->
img_bufãr
 +ğ
n
;

1668 
	}
}

1671 #ià
defšed
(
STBI_NO_JPEG
è&& defšed(
STBI_NO_PNG
è&& defšed(
STBI_NO_PSD
è&& defšed(
STBI_NO_PIC
)

1674 
	$¡bi__g‘16be
(
¡bi__cÚ‹xt
 *
s
)

1676 
z
 = 
	`¡bi__g‘8
(
s
);

1677  (
z
 << 8è+ 
	`¡bi__g‘8
(
s
);

1678 
	}
}

1681 #ià
defšed
(
STBI_NO_PNG
è&& defšed(
STBI_NO_PSD
è&& defšed(
STBI_NO_PIC
)

1684 
¡bi__ušt32
 
	$¡bi__g‘32be
(
¡bi__cÚ‹xt
 *
s
)

1686 
¡bi__ušt32
 
z
 = 
	`¡bi__g‘16be
(
s
);

1687  (
z
 << 16è+ 
	`¡bi__g‘16be
(
s
);

1688 
	}
}

1691 #ià
defšed
(
STBI_NO_BMP
è&& defšed(
STBI_NO_TGA
è&& defšed(
STBI_NO_GIF
)

1694 
	$¡bi__g‘16Ë
(
¡bi__cÚ‹xt
 *
s
)

1696 
z
 = 
	`¡bi__g‘8
(
s
);

1697  
z
 + (
	`¡bi__g‘8
(
s
) << 8);

1698 
	}
}

1701 #iâdeà
STBI_NO_BMP


1702 
¡bi__ušt32
 
	$¡bi__g‘32Ë
(
¡bi__cÚ‹xt
 *
s
)

1704 
¡bi__ušt32
 
z
 = 
	`¡bi__g‘16Ë
(
s
);

1705 
z
 +ğ(
¡bi__ušt32
)
	`¡bi__g‘16Ë
(
s
) << 16;

1706  
z
;

1707 
	}
}

1710 
	#STBI__BYTECAST
(
x
è((
¡bi_uc
) ((x) & 255))

1711 

	)

1712 #ià
defšed
(
STBI_NO_JPEG
è&& defšed(
STBI_NO_PNG
è&& defšed(
STBI_NO_BMP
è&& defšed(
STBI_NO_PSD
è&& defšed(
STBI_NO_TGA
è&& defšed(
STBI_NO_GIF
è&& defšed(
STBI_NO_PIC
è&& defšed(
STBI_NO_PNM
)

1726 
¡bi_uc
 
	$¡bi__compu‹_y
(
r
, 
g
, 
b
)

1728  (
¡bi_uc
è(((
r
*77è+ (
g
*150è+ (29*
b
)) >> 8);

1729 
	}
}

1732 #ià
defšed
(
STBI_NO_PNG
è&& defšed(
STBI_NO_BMP
è&& defšed(
STBI_NO_PSD
è&& defšed(
STBI_NO_TGA
è&& defšed(
STBI_NO_GIF
è&& defšed(
STBI_NO_PIC
è&& defšed(
STBI_NO_PNM
)

1735 *
	$¡bi__cÚv”t_fÜm©
(*
d©a
, 
img_n
, 
»q_comp
, 
x
, 
y
)

1737 
i
,
j
;

1738 *
good
;

1740 ià(
»q_comp
 =ğ
img_n
è 
d©a
;

1741 
	`STBI_ASSERT
(
»q_comp
 >= 1 &&„eq_comp <= 4);

1743 
good
 = (*è
	`¡bi__m®loc_mad3
(
»q_comp
, 
x
, 
y
, 0);

1744 ià(
good
 =ğ
NULL
) {

1745 
	`STBI_FREE
(
d©a
);

1746  
	`¡bi__”½uc
("outofmem", "Out of memory");

1749 
j
=0; j < (è
y
; ++j) {

1750 *
¤c
 = 
d©a
 + 
j
 * 
x
 * 
img_n
 ;

1751 *
de¡
 = 
good
 + 
j
 * 
x
 * 
»q_comp
;

1753 
	#STBI__COMBO
(
a
,
b
è(×)*8+(b))

	)

1754 
	#STBI__CASE
(
a
,
b
è
	`STBI__COMBO
×,b): 
i
=
x
-1; i >ğ0; --i, 
¤c
 +ğa, 
de¡
 +ğb)

	)

1757 
	`STBI__COMBO
(
img_n
, 
»q_comp
)) {

1758 
	`STBI__CASE
(1,2è{ 
de¡
[0]=
¤c
[0]; dest[1]=255; } ;

1759 
	`STBI__CASE
(1,3è{ 
de¡
[0]=de¡[1]=de¡[2]=
¤c
[0]; } ;

1760 
	`STBI__CASE
(1,4è{ 
de¡
[0]=de¡[1]=de¡[2]=
¤c
[0]; dest[3]=255; } ;

1761 
	`STBI__CASE
(2,1è{ 
de¡
[0]=
¤c
[0]; } ;

1762 
	`STBI__CASE
(2,3è{ 
de¡
[0]=de¡[1]=de¡[2]=
¤c
[0]; } ;

1763 
	`STBI__CASE
(2,4è{ 
de¡
[0]=de¡[1]=de¡[2]=
¤c
[0]; dest[3]=src[1]; } ;

1764 
	`STBI__CASE
(3,4è{ 
de¡
[0]=
¤c
[0];dest[1]=src[1];dest[2]=src[2];dest[3]=255; } ;

1765 
	`STBI__CASE
(3,1è{ 
de¡
[0]=
	`¡bi__compu‹_y
(
¤c
[0],src[1],src[2]); } ;

1766 
	`STBI__CASE
(3,2è{ 
de¡
[0]=
	`¡bi__compu‹_y
(
¤c
[0],src[1],src[2]); dest[1] = 255; } ;

1767 
	`STBI__CASE
(4,1è{ 
de¡
[0]=
	`¡bi__compu‹_y
(
¤c
[0],src[1],src[2]); } ;

1768 
	`STBI__CASE
(4,2è{ 
de¡
[0]=
	`¡bi__compu‹_y
(
¤c
[0],src[1],src[2]); dest[1] = src[3]; } ;

1769 
	`STBI__CASE
(4,3è{ 
de¡
[0]=
¤c
[0];dest[1]=src[1];dest[2]=src[2]; } ;

1770 : 
	`STBI_ASSERT
(0); 
	`STBI_FREE
(
d©a
); STBI_FREE(
good
);  
	`¡bi__”½uc
("unsupported", "Unsupported format conversion");

1772 #undeà
STBI__CASE


1775 
	`STBI_FREE
(
d©a
);

1776  
good
;

1777 
	}
}

1780 #ià
defšed
(
STBI_NO_PNG
è&& defšed(
STBI_NO_PSD
)

1783 
¡bi__ušt16
 
	$¡bi__compu‹_y_16
(
r
, 
g
, 
b
)

1785  (
¡bi__ušt16
è(((
r
*77è+ (
g
*150è+ (29*
b
)) >> 8);

1786 
	}
}

1789 #ià
defšed
(
STBI_NO_PNG
è&& defšed(
STBI_NO_PSD
)

1792 
¡bi__ušt16
 *
	$¡bi__cÚv”t_fÜm©16
(
¡bi__ušt16
 *
d©a
, 
img_n
, 
»q_comp
, 
x
, 
y
)

1794 
i
,
j
;

1795 
¡bi__ušt16
 *
good
;

1797 ià(
»q_comp
 =ğ
img_n
è 
d©a
;

1798 
	`STBI_ASSERT
(
»q_comp
 >= 1 &&„eq_comp <= 4);

1800 
good
 = (
¡bi__ušt16
 *è
	`¡bi__m®loc
(
»q_comp
 * 
x
 * 
y
 * 2);

1801 ià(
good
 =ğ
NULL
) {

1802 
	`STBI_FREE
(
d©a
);

1803  (
¡bi__ušt16
 *è
	`¡bi__”½uc
("outofmem", "Out of memory");

1806 
j
=0; j < (è
y
; ++j) {

1807 
¡bi__ušt16
 *
¤c
 = 
d©a
 + 
j
 * 
x
 * 
img_n
 ;

1808 
¡bi__ušt16
 *
de¡
 = 
good
 + 
j
 * 
x
 * 
»q_comp
;

1810 
	#STBI__COMBO
(
a
,
b
è(×)*8+(b))

	)

1811 
	#STBI__CASE
(
a
,
b
è
	`STBI__COMBO
×,b): 
i
=
x
-1; i >ğ0; --i, 
¤c
 +ğa, 
de¡
 +ğb)

	)

1814 
	`STBI__COMBO
(
img_n
, 
»q_comp
)) {

1815 
	`STBI__CASE
(1,2è{ 
de¡
[0]=
¤c
[0]; dest[1]=0xffff; } ;

1816 
	`STBI__CASE
(1,3è{ 
de¡
[0]=de¡[1]=de¡[2]=
¤c
[0]; } ;

1817 
	`STBI__CASE
(1,4è{ 
de¡
[0]=de¡[1]=de¡[2]=
¤c
[0]; dest[3]=0xffff; } ;

1818 
	`STBI__CASE
(2,1è{ 
de¡
[0]=
¤c
[0]; } ;

1819 
	`STBI__CASE
(2,3è{ 
de¡
[0]=de¡[1]=de¡[2]=
¤c
[0]; } ;

1820 
	`STBI__CASE
(2,4è{ 
de¡
[0]=de¡[1]=de¡[2]=
¤c
[0]; dest[3]=src[1]; } ;

1821 
	`STBI__CASE
(3,4è{ 
de¡
[0]=
¤c
[0];dest[1]=src[1];dest[2]=src[2];dest[3]=0xffff; } ;

1822 
	`STBI__CASE
(3,1è{ 
de¡
[0]=
	`¡bi__compu‹_y_16
(
¤c
[0],src[1],src[2]); } ;

1823 
	`STBI__CASE
(3,2è{ 
de¡
[0]=
	`¡bi__compu‹_y_16
(
¤c
[0],src[1],src[2]); dest[1] = 0xffff; } ;

1824 
	`STBI__CASE
(4,1è{ 
de¡
[0]=
	`¡bi__compu‹_y_16
(
¤c
[0],src[1],src[2]); } ;

1825 
	`STBI__CASE
(4,2è{ 
de¡
[0]=
	`¡bi__compu‹_y_16
(
¤c
[0],src[1],src[2]); dest[1] = src[3]; } ;

1826 
	`STBI__CASE
(4,3è{ 
de¡
[0]=
¤c
[0];dest[1]=src[1];dest[2]=src[2]; } ;

1827 : 
	`STBI_ASSERT
(0); 
	`STBI_FREE
(
d©a
); STBI_FREE(
good
);  (
¡bi__ušt16
*è
	`¡bi__”½uc
("unsupported", "Unsupported format conversion");

1829 #undeà
STBI__CASE


1832 
	`STBI_FREE
(
d©a
);

1833  
good
;

1834 
	}
}

1837 #iâdeà
STBI_NO_LINEAR


1838 *
	$¡bi__ldr_to_hdr
(
¡bi_uc
 *
d©a
, 
x
, 
y
, 
comp
)

1840 
i
,
k
,
n
;

1841 *
ouut
;

1842 ià(!
d©a
è 
NULL
;

1843 
ouut
 = (*è
	`¡bi__m®loc_mad4
(
x
, 
y
, 
comp
, (), 0);

1844 ià(
ouut
 =ğ
NULL
è{ 
	`STBI_FREE
(
d©a
);  
	`¡bi__”½f
("outofmem", "Out of memory"); }

1846 ià(
comp
 & 1è
n
 = comp; n = comp-1;

1847 
i
=0; i < 
x
*
y
; ++i) {

1848 
k
=0; k < 
n
; ++k) {

1849 
ouut
[
i
*
comp
 + 
k
] = (è(
	`pow
(
d©a
[i*comp+k]/255.0f, 
¡bi__l2h_gamma
è* 
¡bi__l2h_sÿË
);

1852 ià(
n
 < 
comp
) {

1853 
i
=0; i < 
x
*
y
; ++i) {

1854 
ouut
[
i
*
comp
 + 
n
] = 
d©a
[i*comp +‚]/255.0f;

1857 
	`STBI_FREE
(
d©a
);

1858  
ouut
;

1859 
	}
}

1862 #iâdeà
STBI_NO_HDR


1863 
	#¡bi__æßt2št
(
x
è((è(x))

	)

1864 
¡bi_uc
 *
	$¡bi__hdr_to_ldr
(*
d©a
, 
x
, 
y
, 
comp
)

1866 
i
,
k
,
n
;

1867 
¡bi_uc
 *
ouut
;

1868 ià(!
d©a
è 
NULL
;

1869 
ouut
 = (
¡bi_uc
 *è
	`¡bi__m®loc_mad3
(
x
, 
y
, 
comp
, 0);

1870 ià(
ouut
 =ğ
NULL
è{ 
	`STBI_FREE
(
d©a
);  
	`¡bi__”½uc
("outofmem", "Out of memory"); }

1872 ià(
comp
 & 1è
n
 = comp; n = comp-1;

1873 
i
=0; i < 
x
*
y
; ++i) {

1874 
k
=0; k < 
n
; ++k) {

1875 
z
 = (è
	`pow
(
d©a
[
i
*
comp
+
k
]*
¡bi__h2l_sÿË_i
, 
¡bi__h2l_gamma_i
) * 255 + 0.5f;

1876 ià(
z
 < 0) z = 0;

1877 ià(
z
 > 255) z = 255;

1878 
ouut
[
i
*
comp
 + 
k
] = (
¡bi_uc
è
	`¡bi__æßt2št
(
z
);

1880 ià(
k
 < 
comp
) {

1881 
z
 = 
d©a
[
i
*
comp
+
k
] * 255 + 0.5f;

1882 ià(
z
 < 0) z = 0;

1883 ià(
z
 > 255) z = 255;

1884 
ouut
[
i
*
comp
 + 
k
] = (
¡bi_uc
è
	`¡bi__æßt2št
(
z
);

1887 
	`STBI_FREE
(
d©a
);

1888  
ouut
;

1889 
	}
}

1913 #iâdeà
STBI_NO_JPEG


1916 
	#FAST_BITS
 9

1917 

	)

1920 
¡bi_uc
 
	mç¡
[1 << 
FAST_BITS
];

1922 
¡bi__ušt16
 
	mcode
[256];

1923 
¡bi_uc
 
	mv®ues
[256];

1924 
¡bi_uc
 
	msize
[257];

1925 
	mmaxcode
[18];

1926 
	md–
[17];

1927 } 
	t¡bi__huffmª
;

1931 
¡bi__cÚ‹xt
 *
	ms
;

1932 
¡bi__huffmª
 
	mhuff_dc
[4];

1933 
¡bi__huffmª
 
	mhuff_ac
[4];

1934 
¡bi__ušt16
 
	mdequªt
[4][64];

1935 
¡bi__št16
 
	mç¡_ac
[4][1 << 
FAST_BITS
];

1938 
	mimg_h_max
, 
	mimg_v_max
;

1939 
	mimg_mcu_x
, 
	mimg_mcu_y
;

1940 
	mimg_mcu_w
, 
	mimg_mcu_h
;

1945 
	mid
;

1946 
	mh
,
	mv
;

1947 
	mtq
;

1948 
	mhd
,
	mha
;

1949 
	mdc_´ed
;

1951 
	mx
,
	my
,
	mw2
,
	mh2
;

1952 
¡bi_uc
 *
	md©a
;

1953 *
	m¿w_d©a
, *
	m¿w_cÛff
;

1954 
¡bi_uc
 *
	mlšebuf
;

1955 *
	mcÛff
;

1956 
	mcÛff_w
, 
	mcÛff_h
;

1957 } 
	mimg_comp
[4];

1959 
¡bi__ušt32
 
	mcode_bufãr
;

1960 
	mcode_b™s
;

1961 
	mm¬k”
;

1962 
	mnomÜe
;

1964 
	m´og»ssive
;

1965 
	m¥ec_¡¬t
;

1966 
	m¥ec_’d
;

1967 
	msucc_high
;

1968 
	msucc_low
;

1969 
	meob_run
;

1970 
	mjfif
;

1971 
	m­p14_cŞÜ_ŒªsfÜm
;

1972 
	mrgb
;

1974 
	msÿn_n
, 
	mÜd”
[4];

1975 
	m»¡¬t_š‹rv®
, 
	mtodo
;

1978 (*
	midù_block_k”Ãl
)(
¡bi_uc
 *
	mout
, 
	mout_¡ride
, 
	md©a
[64]);

1979 (*
	mYCbCr_to_RGB_k”Ãl
)(
¡bi_uc
 *
	mout
, cÚ¡ stbi_uø*
	my
, cÚ¡ stbi_uø*
	mpcb
, cÚ¡ stbi_uø*
	mpü
, 
	mcouÁ
, 
	m¡•
);

1980 
	m¡bi_uc
 *(*
	m»§m¶e_row_hv_2_k”Ãl
)(
¡bi_uc
 *
	mout
, stbi_uø*
	mš_Ã¬
, stbi_uø*
	mš_çr
, 
	mw
, 
	mhs
);

1981 } 
	t¡bi__j³g
;

1983 
	$¡bi__bud_huffmª
(
¡bi__huffmª
 *
h
, *
couÁ
)

1985 
i
,
j
,
k
=0;

1986 
code
;

1988 
i
=0; i < 16; ++i)

1989 
j
=0; j < 
couÁ
[
i
]; ++j)

1990 
h
->
size
[
k
++] = (
¡bi_uc
è(
i
+1);

1991 
h
->
size
[
k
] = 0;

1994 
code
 = 0;

1995 
k
 = 0;

1996 
j
=1; j <= 16; ++j) {

1998 
h
->
d–
[
j
] = 
k
 - 
code
;

1999 ià(
h
->
size
[
k
] =ğ
j
) {

2000 
h
->
size
[
k
] =ğ
j
)

2001 
h
->
code
[
k
++] = (
¡bi__ušt16
) (code++);

2002 ià(
code
-1 >ğ(1u << 
j
)è 
	`¡bi__”r
("bad code†engths","Corrupt JPEG");

2005 
h
->
maxcode
[
j
] = 
code
 << (16-j);

2006 
code
 <<= 1;

2008 
h
->
maxcode
[
j
] = 0xffffffff;

2011 
	`mem£t
(
h
->
ç¡
, 255, 1 << 
FAST_BITS
);

2012 
i
=0; i < 
k
; ++i) {

2013 
s
 = 
h
->
size
[
i
];

2014 ià(
s
 <ğ
FAST_BITS
) {

2015 
c
 = 
h
->
code
[
i
] << (
FAST_BITS
-
s
);

2016 
m
 = 1 << (
FAST_BITS
-
s
);

2017 
j
=0; j < 
m
; ++j) {

2018 
h
->
ç¡
[
c
+
j
] = (
¡bi_uc
è
i
;

2023 
	}
}

2027 
	$¡bi__bud_ç¡_ac
(
¡bi__št16
 *
ç¡_ac
, 
¡bi__huffmª
 *
h
)

2029 
i
;

2030 
i
=0; i < (1 << 
FAST_BITS
); ++i) {

2031 
¡bi_uc
 
ç¡
 = 
h
->ç¡[
i
];

2032 
ç¡_ac
[
i
] = 0;

2033 ià(
ç¡
 < 255) {

2034 
rs
 = 
h
->
v®ues
[
ç¡
];

2035 
run
 = (
rs
 >> 4) & 15;

2036 
magb™s
 = 
rs
 & 15;

2037 
Ën
 = 
h
->
size
[
ç¡
];

2039 ià(
magb™s
 && 
Ën
 + magb™ <ğ
FAST_BITS
) {

2041 
k
 = ((
i
 << 
Ën
è& ((1 << 
FAST_BITS
è- 1)è>> (FAST_BITS - 
magb™s
);

2042 
m
 = 1 << (
magb™s
 - 1);

2043 ià(
k
 < 
m
èk +ğ(~0U << 
magb™s
) + 1;

2045 ià(
k
 >= -128 && k <= 127)

2046 
ç¡_ac
[
i
] = (
¡bi__št16
è((
k
 * 256è+ (
run
 * 16è+ (
Ën
 + 
magb™s
));

2050 
	}
}

2052 
	$¡bi__grow_bufãr_un§ã
(
¡bi__j³g
 *
j
)

2055 
b
 = 
j
->
nomÜe
 ? 0 : 
	`¡bi__g‘8
(j->
s
);

2056 ià(
b
 == 0xff) {

2057 
c
 = 
	`¡bi__g‘8
(
j
->
s
);

2058 
c
 =ğ0xffèøğ
	`¡bi__g‘8
(
j
->
s
);

2059 ià(
c
 != 0) {

2060 
j
->
m¬k”
 = (è
c
;

2061 
j
->
nomÜe
 = 1;

2065 
j
->
code_bufãr
 |ğ
b
 << (24 - j->
code_b™s
);

2066 
j
->
code_b™s
 += 8;

2067 } 
j
->
code_b™s
 <= 24);

2068 
	}
}

2071 cÚ¡ 
¡bi__ušt32
 
	g¡bi__bmask
[17]={0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535};

2074 
¡bi_šlše
 
	$¡bi__j³g_huff_decode
(
¡bi__j³g
 *
j
, 
¡bi__huffmª
 *
h
)

2076 
‹mp
;

2077 
c
,
k
;

2079 ià(
j
->
code_b™s
 < 16è
	`¡bi__grow_bufãr_un§ã
(j);

2083 
c
 = (
j
->
code_bufãr
 >> (32 - 
FAST_BITS
)) & ((1 << FAST_BITS)-1);

2084 
k
 = 
h
->
ç¡
[
c
];

2085 ià(
k
 < 255) {

2086 
s
 = 
h
->
size
[
k
];

2087 ià(
s
 > 
j
->
code_b™s
)

2089 
j
->
code_bufãr
 <<ğ
s
;

2090 
j
->
code_b™s
 -ğ
s
;

2091  
h
->
v®ues
[
k
];

2100 
‹mp
 = 
j
->
code_bufãr
 >> 16;

2101 
k
=
FAST_BITS
+1 ; ; ++k)

2102 ià(
‹mp
 < 
h
->
maxcode
[
k
])

2104 ià(
k
 == 17) {

2106 
j
->
code_b™s
 -= 16;

2110 ià(
k
 > 
j
->
code_b™s
)

2114 
c
 = ((
j
->
code_bufãr
 >> (32 - 
k
)è& 
¡bi__bmask
[k]è+ 
h
->
d–
[k];

2115 
	`STBI_ASSERT
((((
j
->
code_bufãr
è>> (32 - 
h
->
size
[
c
])è& 
¡bi__bmask
[h->size[c]]è=ğh->
code
[c]);

2118 
j
->
code_b™s
 -ğ
k
;

2119 
j
->
code_bufãr
 <<ğ
k
;

2120  
h
->
v®ues
[
c
];

2121 
	}
}

2124 cÚ¡ 
	g¡bi__jbŸs
[16] = {0,-1,-3,-7,-15,-31,-63,-127,-255,-511,-1023,-2047,-4095,-8191,-16383,-32767};

2128 
¡bi_šlše
 
	$¡bi__ex‹nd_»ûive
(
¡bi__j³g
 *
j
, 
n
)

2130 
k
;

2131 
sgn
;

2132 ià(
j
->
code_b™s
 < 
n
è
	`¡bi__grow_bufãr_un§ã
(j);

2134 
sgn
 = 
j
->
code_bufãr
 >> 31;

2135 
k
 = 
	`¡bi_ÌÙ
(
j
->
code_bufãr
, 
n
);

2136 
j
->
code_bufãr
 = 
k
 & ~
¡bi__bmask
[
n
];

2137 
k
 &ğ
¡bi__bmask
[
n
];

2138 
j
->
code_b™s
 -ğ
n
;

2139  
k
 + (
¡bi__jbŸs
[
n
] & (
sgn
 - 1));

2140 
	}
}

2143 
¡bi_šlše
 
	$¡bi__j³g_g‘_b™s
(
¡bi__j³g
 *
j
, 
n
)

2145 
k
;

2146 ià(
j
->
code_b™s
 < 
n
è
	`¡bi__grow_bufãr_un§ã
(j);

2147 
k
 = 
	`¡bi_ÌÙ
(
j
->
code_bufãr
, 
n
);

2148 
j
->
code_bufãr
 = 
k
 & ~
¡bi__bmask
[
n
];

2149 
k
 &ğ
¡bi__bmask
[
n
];

2150 
j
->
code_b™s
 -ğ
n
;

2151  
k
;

2152 
	}
}

2154 
¡bi_šlše
 
	$¡bi__j³g_g‘_b™
(
¡bi__j³g
 *
j
)

2156 
k
;

2157 ià(
j
->
code_b™s
 < 1è
	`¡bi__grow_bufãr_un§ã
(j);

2158 
k
 = 
j
->
code_bufãr
;

2159 
j
->
code_bufãr
 <<= 1;

2160 --
j
->
code_b™s
;

2161  
k
 & 0x80000000;

2162 
	}
}

2166 cÚ¡ 
¡bi_uc
 
	g¡bi__j³g_dezigzag
[64+15] =

2182 
	$¡bi__j³g_decode_block
(
¡bi__j³g
 *
j
, 
d©a
[64], 
¡bi__huffmª
 *
hdc
, stbi__huffmª *
hac
, 
¡bi__št16
 *
çc
, 
b
, 
¡bi__ušt16
 *
dequªt
)

2184 
diff
,
dc
,
k
;

2185 
t
;

2187 ià(
j
->
code_b™s
 < 16è
	`¡bi__grow_bufãr_un§ã
(j);

2188 
t
 = 
	`¡bi__j³g_huff_decode
(
j
, 
hdc
);

2189 ià(
t
 < 0 || > 15è 
	`¡bi__”r
("bad huffman code","Corrupt JPEG");

2192 
	`mem£t
(
d©a
,0,64*(data[0]));

2194 
diff
 = 
t
 ? 
	`¡bi__ex‹nd_»ûive
(
j
,) : 0;

2195 
dc
 = 
j
->
img_comp
[
b
].
dc_´ed
 + 
diff
;

2196 
j
->
img_comp
[
b
].
dc_´ed
 = 
dc
;

2197 
d©a
[0] = (è(
dc
 * 
dequªt
[0]);

2200 
k
 = 1;

2202 
zig
;

2203 
c
,
r
,
s
;

2204 ià(
j
->
code_b™s
 < 16è
	`¡bi__grow_bufãr_un§ã
(j);

2205 
c
 = (
j
->
code_bufãr
 >> (32 - 
FAST_BITS
)) & ((1 << FAST_BITS)-1);

2206 
r
 = 
çc
[
c
];

2207 ià(
r
) {

2208 
k
 +ğ(
r
 >> 4) & 15;

2209 
s
 = 
r
 & 15;

2210 
j
->
code_bufãr
 <<ğ
s
;

2211 
j
->
code_b™s
 -ğ
s
;

2213 
zig
 = 
¡bi__j³g_dezigzag
[
k
++];

2214 
d©a
[
zig
] = (è((
r
 >> 8è* 
dequªt
[zig]);

2216 
rs
 = 
	`¡bi__j³g_huff_decode
(
j
, 
hac
);

2217 ià(
rs
 < 0è 
	`¡bi__”r
("bad huffman code","Corrupt JPEG");

2218 
s
 = 
rs
 & 15;

2219 
r
 = 
rs
 >> 4;

2220 ià(
s
 == 0) {

2221 ià(
rs
 != 0xf0) ;

2222 
k
 += 16;

2224 
k
 +ğ
r
;

2226 
zig
 = 
¡bi__j³g_dezigzag
[
k
++];

2227 
d©a
[
zig
] = (è(
	`¡bi__ex‹nd_»ûive
(
j
,
s
è* 
dequªt
[zig]);

2230 } 
k
 < 64);

2232 
	}
}

2234 
	$¡bi__j³g_decode_block_´og_dc
(
¡bi__j³g
 *
j
, 
d©a
[64], 
¡bi__huffmª
 *
hdc
, 
b
)

2236 
diff
,
dc
;

2237 
t
;

2238 ià(
j
->
¥ec_’d
 !ğ0è 
	`¡bi__”r
("can't merge dc‡nd‡c", "Corrupt JPEG");

2240 ià(
j
->
code_b™s
 < 16è
	`¡bi__grow_bufãr_un§ã
(j);

2242 ià(
j
->
succ_high
 == 0) {

2244 
	`mem£t
(
d©a
,0,64*(data[0]));

2245 
t
 = 
	`¡bi__j³g_huff_decode
(
j
, 
hdc
);

2246 ià(
t
 < 0 || > 15è 
	`¡bi__”r
("can't merge dc‡nd‡c", "Corrupt JPEG");

2247 
diff
 = 
t
 ? 
	`¡bi__ex‹nd_»ûive
(
j
,) : 0;

2249 
dc
 = 
j
->
img_comp
[
b
].
dc_´ed
 + 
diff
;

2250 
j
->
img_comp
[
b
].
dc_´ed
 = 
dc
;

2251 
d©a
[0] = (è(
dc
 * (1 << 
j
->
succ_low
));

2254 ià(
	`¡bi__j³g_g‘_b™
(
j
))

2255 
d©a
[0] +ğ(è(1 << 
j
->
succ_low
);

2258 
	}
}

2262 
	$¡bi__j³g_decode_block_´og_ac
(
¡bi__j³g
 *
j
, 
d©a
[64], 
¡bi__huffmª
 *
hac
, 
¡bi__št16
 *
çc
)

2264 
k
;

2265 ià(
j
->
¥ec_¡¬t
 =ğ0è 
	`¡bi__”r
("can't merge dc‡nd‡c", "Corrupt JPEG");

2267 ià(
j
->
succ_high
 == 0) {

2268 
shiá
 = 
j
->
succ_low
;

2270 ià(
j
->
eob_run
) {

2271 --
j
->
eob_run
;

2275 
k
 = 
j
->
¥ec_¡¬t
;

2277 
zig
;

2278 
c
,
r
,
s
;

2279 ià(
j
->
code_b™s
 < 16è
	`¡bi__grow_bufãr_un§ã
(j);

2280 
c
 = (
j
->
code_bufãr
 >> (32 - 
FAST_BITS
)) & ((1 << FAST_BITS)-1);

2281 
r
 = 
çc
[
c
];

2282 ià(
r
) {

2283 
k
 +ğ(
r
 >> 4) & 15;

2284 
s
 = 
r
 & 15;

2285 
j
->
code_bufãr
 <<ğ
s
;

2286 
j
->
code_b™s
 -ğ
s
;

2287 
zig
 = 
¡bi__j³g_dezigzag
[
k
++];

2288 
d©a
[
zig
] = (è((
r
 >> 8è* (1 << 
shiá
));

2290 
rs
 = 
	`¡bi__j³g_huff_decode
(
j
, 
hac
);

2291 ià(
rs
 < 0è 
	`¡bi__”r
("bad huffman code","Corrupt JPEG");

2292 
s
 = 
rs
 & 15;

2293 
r
 = 
rs
 >> 4;

2294 ià(
s
 == 0) {

2295 ià(
r
 < 15) {

2296 
j
->
eob_run
 = (1 << 
r
);

2297 ià(
r
)

2298 
j
->
eob_run
 +ğ
	`¡bi__j³g_g‘_b™s
(j, 
r
);

2299 --
j
->
eob_run
;

2302 
k
 += 16;

2304 
k
 +ğ
r
;

2305 
zig
 = 
¡bi__j³g_dezigzag
[
k
++];

2306 
d©a
[
zig
] = (è(
	`¡bi__ex‹nd_»ûive
(
j
,
s
è* (1 << 
shiá
));

2309 } 
k
 <ğ
j
->
¥ec_’d
);

2313 
b™
 = (è(1 << 
j
->
succ_low
);

2315 ià(
j
->
eob_run
) {

2316 --
j
->
eob_run
;

2317 
k
 = 
j
->
¥ec_¡¬t
; k <ğj->
¥ec_’d
; ++k) {

2318 *
p
 = &
d©a
[
¡bi__j³g_dezigzag
[
k
]];

2319 ià(*
p
 != 0)

2320 ià(
	`¡bi__j³g_g‘_b™
(
j
))

2321 ià((*
p
 & 
b™
)==0) {

2322 ià(*
p
 > 0)

2323 *
p
 +ğ
b™
;

2325 *
p
 -ğ
b™
;

2329 
k
 = 
j
->
¥ec_¡¬t
;

2331 
r
,
s
;

2332 
rs
 = 
	`¡bi__j³g_huff_decode
(
j
, 
hac
);

2333 ià(
rs
 < 0è 
	`¡bi__”r
("bad huffman code","Corrupt JPEG");

2334 
s
 = 
rs
 & 15;

2335 
r
 = 
rs
 >> 4;

2336 ià(
s
 == 0) {

2337 ià(
r
 < 15) {

2338 
j
->
eob_run
 = (1 << 
r
) - 1;

2339 ià(
r
)

2340 
j
->
eob_run
 +ğ
	`¡bi__j³g_g‘_b™s
(j, 
r
);

2341 
r
 = 64;

2348 ià(
s
 !ğ1è 
	`¡bi__”r
("bad huffman code", "Corrupt JPEG");

2350 ià(
	`¡bi__j³g_g‘_b™
(
j
))

2351 
s
 = 
b™
;

2353 
s
 = -
b™
;

2357 
k
 <ğ
j
->
¥ec_’d
) {

2358 *
p
 = &
d©a
[
¡bi__j³g_dezigzag
[
k
++]];

2359 ià(*
p
 != 0) {

2360 ià(
	`¡bi__j³g_g‘_b™
(
j
))

2361 ià((*
p
 & 
b™
)==0) {

2362 ià(*
p
 > 0)

2363 *
p
 +ğ
b™
;

2365 *
p
 -ğ
b™
;

2368 ià(
r
 == 0) {

2369 *
p
 = (è
s
;

2372 --
r
;

2375 } 
k
 <ğ
j
->
¥ec_’d
);

2379 
	}
}

2382 
¡bi_šlše
 
¡bi_uc
 
	$¡bi__şamp
(
x
)

2385 ià((è
x
 > 255) {

2386 ià(
x
 < 0)  0;

2387 ià(
x
 > 255)  255;

2389  (
¡bi_uc
è
x
;

2390 
	}
}

2392 
	#¡bi__f2f
(
x
è((è(((xè* 4096 + 0.5)))

	)

2393 
	#¡bi__fsh
(
x
è((xè* 4096)

	)

2396 
	#STBI__IDCT_1D
(
s0
,
s1
,
s2
,
s3
,
s4
,
s5
,
s6
,
s7
) \

2397 
t0
,
t1
,
t2
,
t3
,
p1
,
p2
,
p3
,
p4
,
p5
,
x0
,
x1
,
x2
,
x3
; \

2398 
p2
 = 
s2
; \

2399 
p3
 = 
s6
; \

2400 
p1
 = (
p2
+
p3
è* 
	`¡bi__f2f
(0.5411961f); \

2401 
t2
 = 
p1
 + 
p3
*
	`¡bi__f2f
(-1.847759065f); \

2402 
t3
 = 
p1
 + 
p2
*
	`¡bi__f2f
( 0.765366865f); \

2403 
p2
 = 
s0
; \

2404 
p3
 = 
s4
; \

2405 
t0
 = 
	`¡bi__fsh
(
p2
+
p3
); \

2406 
t1
 = 
	`¡bi__fsh
(
p2
-
p3
); \

2407 
x0
 = 
t0
+
t3
; \

2408 
x3
 = 
t0
-
t3
; \

2409 
x1
 = 
t1
+
t2
; \

2410 
x2
 = 
t1
-
t2
; \

2411 
t0
 = 
s7
; \

2412 
t1
 = 
s5
; \

2413 
t2
 = 
s3
; \

2414 
t3
 = 
s1
; \

2415 
p3
 = 
t0
+
t2
; \

2416 
p4
 = 
t1
+
t3
; \

2417 
p1
 = 
t0
+
t3
; \

2418 
p2
 = 
t1
+
t2
; \

2419 
p5
 = (
p3
+
p4
)*
	`¡bi__f2f
( 1.175875602f); \

2420 
t0
 =0*
	`¡bi__f2f
( 0.298631336f); \

2421 
t1
 =1*
	`¡bi__f2f
( 2.053119869f); \

2422 
t2
 =2*
	`¡bi__f2f
( 3.072711026f); \

2423 
t3
 =3*
	`¡bi__f2f
( 1.501321110f); \

2424 
p1
 = 
p5
 +…1*
	`¡bi__f2f
(-0.899976223f); \

2425 
p2
 = 
p5
 +…2*
	`¡bi__f2f
(-2.562915447f); \

2426 
p3
 =…3*
	`¡bi__f2f
(-1.961570560f); \

2427 
p4
 =…4*
	`¡bi__f2f
(-0.390180644f); \

2428 
t3
 +ğ
p1
+
p4
; \

2429 
t2
 +ğ
p2
+
p3
; \

2430 
t1
 +ğ
p2
+
p4
; \

2431 
t0
 +ğ
p1
+
p3
;

	)

2433 
	$¡bi__idù_block
(
¡bi_uc
 *
out
, 
out_¡ride
, 
d©a
[64])

2435 
i
,
v®
[64],*
v
=val;

2436 
¡bi_uc
 *
o
;

2437 *
d
 = 
d©a
;

2440 
i
=0; i < 8; ++i,++
d
, ++
v
) {

2442 ià(
d
[ 8]==0 && d[16]==0 && d[24]==0 && d[32]==0

2443 && 
d
[40]==0 && d[48]==0 && d[56]==0) {

2448 
dù”m
 = 
d
[0]*4;

2449 
v
[0] = v[8] = v[16] = v[24] = v[32] = v[40] = v[48] = v[56] = 
dù”m
;

2451 
	`STBI__IDCT_1D
(
d
[ 0],d[ 8],d[16],d[24],d[32],d[40],d[48],d[56])

2454 
x0
 +ğ512; 
x1
 +ğ512; 
x2
 +ğ512; 
x3
 += 512;

2455 
v
[ 0] = (
x0
+
t3
) >> 10;

2456 
v
[56] = (
x0
-
t3
) >> 10;

2457 
v
[ 8] = (
x1
+
t2
) >> 10;

2458 
v
[48] = (
x1
-
t2
) >> 10;

2459 
v
[16] = (
x2
+
t1
) >> 10;

2460 
v
[40] = (
x2
-
t1
) >> 10;

2461 
v
[24] = (
x3
+
t0
) >> 10;

2462 
v
[32] = (
x3
-
t0
) >> 10;

2466 
i
=0, 
v
=
v®
, 
o
=
out
; i < 8; ++i,v+=8,o+=
out_¡ride
) {

2468 
	`STBI__IDCT_1D
(
v
[0],v[1],v[2],v[3],v[4],v[5],v[6],v[7])

2475 
x0
 += 65536 + (128<<17);

2476 
x1
 += 65536 + (128<<17);

2477 
x2
 += 65536 + (128<<17);

2478 
x3
 += 65536 + (128<<17);

2481 
o
[0] = 
	`¡bi__şamp
((
x0
+
t3
) >> 17);

2482 
o
[7] = 
	`¡bi__şamp
((
x0
-
t3
) >> 17);

2483 
o
[1] = 
	`¡bi__şamp
((
x1
+
t2
) >> 17);

2484 
o
[6] = 
	`¡bi__şamp
((
x1
-
t2
) >> 17);

2485 
o
[2] = 
	`¡bi__şamp
((
x2
+
t1
) >> 17);

2486 
o
[5] = 
	`¡bi__şamp
((
x2
-
t1
) >> 17);

2487 
o
[3] = 
	`¡bi__şamp
((
x3
+
t0
) >> 17);

2488 
o
[4] = 
	`¡bi__şamp
((
x3
-
t0
) >> 17);

2490 
	}
}

2492 #ifdeà
STBI_SSE2


2496 
	$¡bi__idù_simd
(
¡bi_uc
 *
out
, 
out_¡ride
, 
d©a
[64])

2499 
__m128i
 
row0
, 
row1
, 
row2
, 
row3
, 
row4
, 
row5
, 
row6
, 
row7
;

2500 
__m128i
 
tmp
;

2503 
	#dù_cÚ¡
(
x
,
y
è
	`_mm_£Œ_•i16
((x),(y),(x),(y),(x),(y),(x),(y))

	)

2507 
	#dù_rÙ
(
out0
,
out1
, 
x
,
y
,
c0
,
c1
) \

2508 
__m128i
 
c0
##
lo
 = 
	`_mm_uÅacklo_•i16
((
x
),(
y
)); \

2509 
__m128i
 
c0
##
hi
 = 
	`_mm_uÅackhi_•i16
((
x
),(
y
)); \

2510 
__m128i
 
out0
##
_l
 = 
	`_mm_madd_•i16
(
c0
##
lo
, c0); \

2511 
__m128i
 
out0
##
_h
 = 
	`_mm_madd_•i16
(
c0
##
hi
, c0); \

2512 
__m128i
 
out1
##
_l
 = 
	`_mm_madd_•i16
(
c0
##
lo
, 
c1
); \

2513 
__m128i
 
out1
##
_h
 = 
	`_mm_madd_•i16
(
c0
##
hi
, 
c1
)

	)

2516 
	#dù_wid’
(
out
, 
š
) \

2517 
__m128i
 
out
##
_l
 = 
	`_mm_¤ai_•i32
(
	`_mm_uÅacklo_•i16
(
	`_mm_£tz”o_si128
(), (
š
)), 4); \

2518 
__m128i
 
out
##
_h
 = 
	`_mm_¤ai_•i32
(
	`_mm_uÅackhi_•i16
(
	`_mm_£tz”o_si128
(), (
š
)), 4)

	)

2521 
	#dù_wadd
(
out
, 
a
, 
b
) \

2522 
__m128i
 
out
##
_l
 = 
	`_mm_add_•i32
(
a
##_l, 
b
##_l); \

2523 
__m128i
 
out
##
_h
 = 
	`_mm_add_•i32
(
a
##_h, 
b
##_h)

	)

2526 
	#dù_wsub
(
out
, 
a
, 
b
) \

2527 
__m128i
 
out
##
_l
 = 
	`_mm_sub_•i32
(
a
##_l, 
b
##_l); \

2528 
__m128i
 
out
##
_h
 = 
	`_mm_sub_•i32
(
a
##_h, 
b
##_h)

	)

2531 
	#dù_bæy32o
(
out0
, 
out1
, 
a
,
b
,
bŸs
,
s
) \

2533 
__m128i
 
abŸ£d_l
 = 
	`_mm_add_•i32
(
a
##
_l
, 
bŸs
); \

2534 
__m128i
 
abŸ£d_h
 = 
	`_mm_add_•i32
(
a
##
_h
, 
bŸs
); \

2535 
	`dù_wadd
(
sum
, 
abŸ£d
, 
b
); \

2536 
	`dù_wsub
(
dif
, 
abŸ£d
, 
b
); \

2537 
out0
 = 
	`_mm_·cks_•i32
(
	`_mm_¤ai_•i32
(
sum_l
, 
s
), _mm_¤ai_•i32(
sum_h
, s)); \

2538 
out1
 = 
	`_mm_·cks_•i32
(
	`_mm_¤ai_•i32
(
dif_l
, 
s
), _mm_¤ai_•i32(
dif_h
, s)); \

2539 }

	)

2542 
	#dù_š‹¾—ve8
(
a
, 
b
) \

2543 
tmp
 = 
a
; \

2544 
a
 = 
	`_mm_uÅacklo_•i8
×, 
b
); \

2545 
b
 = 
	`_mm_uÅackhi_•i8
(
tmp
, b)

	)

2548 
	#dù_š‹¾—ve16
(
a
, 
b
) \

2549 
tmp
 = 
a
; \

2550 
a
 = 
	`_mm_uÅacklo_•i16
×, 
b
); \

2551 
b
 = 
	`_mm_uÅackhi_•i16
(
tmp
, b)

	)

2553 
	#dù_·ss
(
bŸs
,
shiá
) \

2556 
	`dù_rÙ
(
t2e
,
t3e
, 
row2
,
row6
, 
rÙ0_0
,
rÙ0_1
); \

2557 
__m128i
 
sum04
 = 
	`_mm_add_•i16
(
row0
, 
row4
); \

2558 
__m128i
 
dif04
 = 
	`_mm_sub_•i16
(
row0
, 
row4
); \

2559 
	`dù_wid’
(
t0e
, 
sum04
); \

2560 
	`dù_wid’
(
t1e
, 
dif04
); \

2561 
	`dù_wadd
(
x0
, 
t0e
, 
t3e
); \

2562 
	`dù_wsub
(
x3
, 
t0e
, 
t3e
); \

2563 
	`dù_wadd
(
x1
, 
t1e
, 
t2e
); \

2564 
	`dù_wsub
(
x2
, 
t1e
, 
t2e
); \

2566 
	`dù_rÙ
(
y0o
,
y2o
, 
row7
,
row3
, 
rÙ2_0
,
rÙ2_1
); \

2567 
	`dù_rÙ
(
y1o
,
y3o
, 
row5
,
row1
, 
rÙ3_0
,
rÙ3_1
); \

2568 
__m128i
 
sum17
 = 
	`_mm_add_•i16
(
row1
, 
row7
); \

2569 
__m128i
 
sum35
 = 
	`_mm_add_•i16
(
row3
, 
row5
); \

2570 
	`dù_rÙ
(
y4o
,
y5o
, 
sum17
,
sum35
, 
rÙ1_0
,
rÙ1_1
); \

2571 
	`dù_wadd
(
x4
, 
y0o
, 
y4o
); \

2572 
	`dù_wadd
(
x5
, 
y1o
, 
y5o
); \

2573 
	`dù_wadd
(
x6
, 
y2o
, 
y5o
); \

2574 
	`dù_wadd
(
x7
, 
y3o
, 
y4o
); \

2575 
	`dù_bæy32o
(
row0
,
row7
, 
x0
,
x7
,
bŸs
,
shiá
); \

2576 
	`dù_bæy32o
(
row1
,
row6
, 
x1
,
x6
,
bŸs
,
shiá
); \

2577 
	`dù_bæy32o
(
row2
,
row5
, 
x2
,
x5
,
bŸs
,
shiá
); \

2578 
	`dù_bæy32o
(
row3
,
row4
, 
x3
,
x4
,
bŸs
,
shiá
); \

2579 }

	)

2581 
__m128i
 
rÙ0_0
 = 
	`dù_cÚ¡
(
	`¡bi__f2f
(0.5411961f), stbi__f2f(0.5411961f) + stbi__f2f(-1.847759065f));

2582 
__m128i
 
rÙ0_1
 = 
	`dù_cÚ¡
(
	`¡bi__f2f
(0.5411961f) + stbi__f2f( 0.765366865f), stbi__f2f(0.5411961f));

2583 
__m128i
 
rÙ1_0
 = 
	`dù_cÚ¡
(
	`¡bi__f2f
(1.175875602f) + stbi__f2f(-0.899976223f), stbi__f2f(1.175875602f));

2584 
__m128i
 
rÙ1_1
 = 
	`dù_cÚ¡
(
	`¡bi__f2f
(1.175875602f), stbi__f2f(1.175875602f) + stbi__f2f(-2.562915447f));

2585 
__m128i
 
rÙ2_0
 = 
	`dù_cÚ¡
(
	`¡bi__f2f
(-1.961570560f) + stbi__f2f( 0.298631336f), stbi__f2f(-1.961570560f));

2586 
__m128i
 
rÙ2_1
 = 
	`dù_cÚ¡
(
	`¡bi__f2f
(-1.961570560f), stbi__f2f(-1.961570560f) + stbi__f2f( 3.072711026f));

2587 
__m128i
 
rÙ3_0
 = 
	`dù_cÚ¡
(
	`¡bi__f2f
(-0.390180644f) + stbi__f2f( 2.053119869f), stbi__f2f(-0.390180644f));

2588 
__m128i
 
rÙ3_1
 = 
	`dù_cÚ¡
(
	`¡bi__f2f
(-0.390180644f), stbi__f2f(-0.390180644f) + stbi__f2f( 1.501321110f));

2591 
__m128i
 
bŸs_0
 = 
	`_mm_£t1_•i32
(512);

2592 
__m128i
 
bŸs_1
 = 
	`_mm_£t1_•i32
(65536 + (128<<17));

2595 
row0
 = 
	`_mm_lßd_si128
((cÚ¡ 
__m128i
 *è(
d©a
 + 0*8));

2596 
row1
 = 
	`_mm_lßd_si128
((cÚ¡ 
__m128i
 *è(
d©a
 + 1*8));

2597 
row2
 = 
	`_mm_lßd_si128
((cÚ¡ 
__m128i
 *è(
d©a
 + 2*8));

2598 
row3
 = 
	`_mm_lßd_si128
((cÚ¡ 
__m128i
 *è(
d©a
 + 3*8));

2599 
row4
 = 
	`_mm_lßd_si128
((cÚ¡ 
__m128i
 *è(
d©a
 + 4*8));

2600 
row5
 = 
	`_mm_lßd_si128
((cÚ¡ 
__m128i
 *è(
d©a
 + 5*8));

2601 
row6
 = 
	`_mm_lßd_si128
((cÚ¡ 
__m128i
 *è(
d©a
 + 6*8));

2602 
row7
 = 
	`_mm_lßd_si128
((cÚ¡ 
__m128i
 *è(
d©a
 + 7*8));

2605 
	`dù_·ss
(
bŸs_0
, 10);

2609 
	`dù_š‹¾—ve16
(
row0
, 
row4
);

2610 
	`dù_š‹¾—ve16
(
row1
, 
row5
);

2611 
	`dù_š‹¾—ve16
(
row2
, 
row6
);

2612 
	`dù_š‹¾—ve16
(
row3
, 
row7
);

2615 
	`dù_š‹¾—ve16
(
row0
, 
row2
);

2616 
	`dù_š‹¾—ve16
(
row1
, 
row3
);

2617 
	`dù_š‹¾—ve16
(
row4
, 
row6
);

2618 
	`dù_š‹¾—ve16
(
row5
, 
row7
);

2621 
	`dù_š‹¾—ve16
(
row0
, 
row1
);

2622 
	`dù_š‹¾—ve16
(
row2
, 
row3
);

2623 
	`dù_š‹¾—ve16
(
row4
, 
row5
);

2624 
	`dù_š‹¾—ve16
(
row6
, 
row7
);

2628 
	`dù_·ss
(
bŸs_1
, 17);

2632 
__m128i
 
p0
 = 
	`_mm_·ckus_•i16
(
row0
, 
row1
);

2633 
__m128i
 
p1
 = 
	`_mm_·ckus_•i16
(
row2
, 
row3
);

2634 
__m128i
 
p2
 = 
	`_mm_·ckus_•i16
(
row4
, 
row5
);

2635 
__m128i
 
p3
 = 
	`_mm_·ckus_•i16
(
row6
, 
row7
);

2638 
	`dù_š‹¾—ve8
(
p0
, 
p2
);

2639 
	`dù_š‹¾—ve8
(
p1
, 
p3
);

2642 
	`dù_š‹¾—ve8
(
p0
, 
p1
);

2643 
	`dù_š‹¾—ve8
(
p2
, 
p3
);

2646 
	`dù_š‹¾—ve8
(
p0
, 
p2
);

2647 
	`dù_š‹¾—ve8
(
p1
, 
p3
);

2650 
	`_mm_¡Ü–_•i64
((
__m128i
 *è
out
, 
p0
); ouˆ+ğ
out_¡ride
;

2651 
	`_mm_¡Ü–_•i64
((
__m128i
 *è
out
, 
	`_mm_shufæe_•i32
(
p0
, 0x4e)); ouˆ+ğ
out_¡ride
;

2652 
	`_mm_¡Ü–_•i64
((
__m128i
 *è
out
, 
p2
); ouˆ+ğ
out_¡ride
;

2653 
	`_mm_¡Ü–_•i64
((
__m128i
 *è
out
, 
	`_mm_shufæe_•i32
(
p2
, 0x4e)); ouˆ+ğ
out_¡ride
;

2654 
	`_mm_¡Ü–_•i64
((
__m128i
 *è
out
, 
p1
); ouˆ+ğ
out_¡ride
;

2655 
	`_mm_¡Ü–_•i64
((
__m128i
 *è
out
, 
	`_mm_shufæe_•i32
(
p1
, 0x4e)); ouˆ+ğ
out_¡ride
;

2656 
	`_mm_¡Ü–_•i64
((
__m128i
 *è
out
, 
p3
); ouˆ+ğ
out_¡ride
;

2657 
	`_mm_¡Ü–_•i64
((
__m128i
 *è
out
, 
	`_mm_shufæe_•i32
(
p3
, 0x4e));

2660 #undeà
dù_cÚ¡


2661 #undeà
dù_rÙ


2662 #undeà
dù_wid’


2663 #undeà
dù_wadd


2664 #undeà
dù_wsub


2665 #undeà
dù_bæy32o


2666 #undeà
dù_š‹¾—ve8


2667 #undeà
dù_š‹¾—ve16


2668 #undeà
dù_·ss


2669 
	}
}

2673 #ifdeà
STBI_NEON


2677 
	$¡bi__idù_simd
(
¡bi_uc
 *
out
, 
out_¡ride
, 
d©a
[64])

2679 
št16x8_t
 
row0
, 
row1
, 
row2
, 
row3
, 
row4
, 
row5
, 
row6
, 
row7
;

2681 
št16x4_t
 
rÙ0_0
 = 
	`vdup_n_s16
(
	`¡bi__f2f
(0.5411961f));

2682 
št16x4_t
 
rÙ0_1
 = 
	`vdup_n_s16
(
	`¡bi__f2f
(-1.847759065f));

2683 
št16x4_t
 
rÙ0_2
 = 
	`vdup_n_s16
(
	`¡bi__f2f
( 0.765366865f));

2684 
št16x4_t
 
rÙ1_0
 = 
	`vdup_n_s16
(
	`¡bi__f2f
( 1.175875602f));

2685 
št16x4_t
 
rÙ1_1
 = 
	`vdup_n_s16
(
	`¡bi__f2f
(-0.899976223f));

2686 
št16x4_t
 
rÙ1_2
 = 
	`vdup_n_s16
(
	`¡bi__f2f
(-2.562915447f));

2687 
št16x4_t
 
rÙ2_0
 = 
	`vdup_n_s16
(
	`¡bi__f2f
(-1.961570560f));

2688 
št16x4_t
 
rÙ2_1
 = 
	`vdup_n_s16
(
	`¡bi__f2f
(-0.390180644f));

2689 
št16x4_t
 
rÙ3_0
 = 
	`vdup_n_s16
(
	`¡bi__f2f
( 0.298631336f));

2690 
št16x4_t
 
rÙ3_1
 = 
	`vdup_n_s16
(
	`¡bi__f2f
( 2.053119869f));

2691 
št16x4_t
 
rÙ3_2
 = 
	`vdup_n_s16
(
	`¡bi__f2f
( 3.072711026f));

2692 
št16x4_t
 
rÙ3_3
 = 
	`vdup_n_s16
(
	`¡bi__f2f
( 1.501321110f));

2694 
	#dù_lÚg_mul
(
out
, 
šq
, 
cÛff
) \

2695 
št32x4_t
 
out
##
_l
 = 
	`vmuÎ_s16
(
	`vg‘_low_s16
(
šq
), 
cÛff
); \

2696 
št32x4_t
 
out
##
_h
 = 
	`vmuÎ_s16
(
	`vg‘_high_s16
(
šq
), 
cÛff
)

	)

2698 
	#dù_lÚg_mac
(
out
, 
acc
, 
šq
, 
cÛff
) \

2699 
št32x4_t
 
out
##
_l
 = 
	`vmÏl_s16
(
acc
##_l, 
	`vg‘_low_s16
(
šq
), 
cÛff
); \

2700 
št32x4_t
 
out
##
_h
 = 
	`vmÏl_s16
(
acc
##_h, 
	`vg‘_high_s16
(
šq
), 
cÛff
)

	)

2702 
	#dù_wid’
(
out
, 
šq
) \

2703 
št32x4_t
 
out
##
_l
 = 
	`vshÎ_n_s16
(
	`vg‘_low_s16
(
šq
), 12); \

2704 
št32x4_t
 
out
##
_h
 = 
	`vshÎ_n_s16
(
	`vg‘_high_s16
(
šq
), 12)

	)

2707 
	#dù_wadd
(
out
, 
a
, 
b
) \

2708 
št32x4_t
 
out
##
_l
 = 
	`vaddq_s32
(
a
##_l, 
b
##_l); \

2709 
št32x4_t
 
out
##
_h
 = 
	`vaddq_s32
(
a
##_h, 
b
##_h)

	)

2712 
	#dù_wsub
(
out
, 
a
, 
b
) \

2713 
št32x4_t
 
out
##
_l
 = 
	`vsubq_s32
(
a
##_l, 
b
##_l); \

2714 
št32x4_t
 
out
##
_h
 = 
	`vsubq_s32
(
a
##_h, 
b
##_h)

	)

2717 
	#dù_bæy32o
(
out0
,
out1
, 
a
,
b
,
shiáİ
,
s
) \

2719 
	`dù_wadd
(
sum
, 
a
, 
b
); \

2720 
	`dù_wsub
(
dif
, 
a
, 
b
); \

2721 
out0
 = 
	`vcombše_s16
(
	`shiáİ
(
sum_l
, 
s
), shiáİ(
sum_h
, s)); \

2722 
out1
 = 
	`vcombše_s16
(
	`shiáİ
(
dif_l
, 
s
), shiáİ(
dif_h
, s)); \

2723 }

	)

2725 
	#dù_·ss
(
shiáİ
, 
shiá
) \

2728 
št16x8_t
 
sum26
 = 
	`vaddq_s16
(
row2
, 
row6
); \

2729 
	`dù_lÚg_mul
(
p1e
, 
sum26
, 
rÙ0_0
); \

2730 
	`dù_lÚg_mac
(
t2e
, 
p1e
, 
row6
, 
rÙ0_1
); \

2731 
	`dù_lÚg_mac
(
t3e
, 
p1e
, 
row2
, 
rÙ0_2
); \

2732 
št16x8_t
 
sum04
 = 
	`vaddq_s16
(
row0
, 
row4
); \

2733 
št16x8_t
 
dif04
 = 
	`vsubq_s16
(
row0
, 
row4
); \

2734 
	`dù_wid’
(
t0e
, 
sum04
); \

2735 
	`dù_wid’
(
t1e
, 
dif04
); \

2736 
	`dù_wadd
(
x0
, 
t0e
, 
t3e
); \

2737 
	`dù_wsub
(
x3
, 
t0e
, 
t3e
); \

2738 
	`dù_wadd
(
x1
, 
t1e
, 
t2e
); \

2739 
	`dù_wsub
(
x2
, 
t1e
, 
t2e
); \

2741 
št16x8_t
 
sum15
 = 
	`vaddq_s16
(
row1
, 
row5
); \

2742 
št16x8_t
 
sum17
 = 
	`vaddq_s16
(
row1
, 
row7
); \

2743 
št16x8_t
 
sum35
 = 
	`vaddq_s16
(
row3
, 
row5
); \

2744 
št16x8_t
 
sum37
 = 
	`vaddq_s16
(
row3
, 
row7
); \

2745 
št16x8_t
 
sumodd
 = 
	`vaddq_s16
(
sum17
, 
sum35
); \

2746 
	`dù_lÚg_mul
(
p5o
, 
sumodd
, 
rÙ1_0
); \

2747 
	`dù_lÚg_mac
(
p1o
, 
p5o
, 
sum17
, 
rÙ1_1
); \

2748 
	`dù_lÚg_mac
(
p2o
, 
p5o
, 
sum35
, 
rÙ1_2
); \

2749 
	`dù_lÚg_mul
(
p3o
, 
sum37
, 
rÙ2_0
); \

2750 
	`dù_lÚg_mul
(
p4o
, 
sum15
, 
rÙ2_1
); \

2751 
	`dù_wadd
(
sump13o
, 
p1o
, 
p3o
); \

2752 
	`dù_wadd
(
sump24o
, 
p2o
, 
p4o
); \

2753 
	`dù_wadd
(
sump23o
, 
p2o
, 
p3o
); \

2754 
	`dù_wadd
(
sump14o
, 
p1o
, 
p4o
); \

2755 
	`dù_lÚg_mac
(
x4
, 
sump13o
, 
row7
, 
rÙ3_0
); \

2756 
	`dù_lÚg_mac
(
x5
, 
sump24o
, 
row5
, 
rÙ3_1
); \

2757 
	`dù_lÚg_mac
(
x6
, 
sump23o
, 
row3
, 
rÙ3_2
); \

2758 
	`dù_lÚg_mac
(
x7
, 
sump14o
, 
row1
, 
rÙ3_3
); \

2759 
	`dù_bæy32o
(
row0
,
row7
, 
x0
,
x7
,
shiáİ
,
shiá
); \

2760 
	`dù_bæy32o
(
row1
,
row6
, 
x1
,
x6
,
shiáİ
,
shiá
); \

2761 
	`dù_bæy32o
(
row2
,
row5
, 
x2
,
x5
,
shiáİ
,
shiá
); \

2762 
	`dù_bæy32o
(
row3
,
row4
, 
x3
,
x4
,
shiáİ
,
shiá
); \

2763 }

	)

2766 
row0
 = 
	`vld1q_s16
(
d©a
 + 0*8);

2767 
row1
 = 
	`vld1q_s16
(
d©a
 + 1*8);

2768 
row2
 = 
	`vld1q_s16
(
d©a
 + 2*8);

2769 
row3
 = 
	`vld1q_s16
(
d©a
 + 3*8);

2770 
row4
 = 
	`vld1q_s16
(
d©a
 + 4*8);

2771 
row5
 = 
	`vld1q_s16
(
d©a
 + 5*8);

2772 
row6
 = 
	`vld1q_s16
(
d©a
 + 6*8);

2773 
row7
 = 
	`vld1q_s16
(
d©a
 + 7*8);

2776 
row0
 = 
	`vaddq_s16
Ôow0, 
	`v£tq_ÏÃ_s16
(1024, 
	`vdupq_n_s16
(0), 0));

2779 
	`dù_·ss
(
vrshº_n_s32
, 10);

2785 
	#dù_Œn16
(
x
, 
y
è{ 
št16x8x2_t
 
t
 = 
	`vŒnq_s16
(x, y); x =.
v®
[0]; y =.v®[1]; }

	)

2786 
	#dù_Œn32
(
x
, 
y
è{ 
št32x4x2_t
 
t
 = 
	`vŒnq_s32
(
	`v»š‹½»tq_s32_s16
(x), v»š‹½»tq_s32_s16(y)); x = 
	`v»š‹½»tq_s16_s32
Ñ.
v®
[0]); y = v»š‹½»tq_s16_s32Ñ.v®[1]); }

	)

2787 
	#dù_Œn64
(
x
, 
y
è{ 
št16x8_t
 
x0
 = x; iÁ16x8_ˆ
y0
 = y; x = 
	`vcombše_s16
(
	`vg‘_low_s16
(x0), vg‘_low_s16(y0)); y = vcombše_s16(
	`vg‘_high_s16
(x0), vg‘_high_s16(y0)); }

	)

2790 
	`dù_Œn16
(
row0
, 
row1
);

2791 
	`dù_Œn16
(
row2
, 
row3
);

2792 
	`dù_Œn16
(
row4
, 
row5
);

2793 
	`dù_Œn16
(
row6
, 
row7
);

2796 
	`dù_Œn32
(
row0
, 
row2
);

2797 
	`dù_Œn32
(
row1
, 
row3
);

2798 
	`dù_Œn32
(
row4
, 
row6
);

2799 
	`dù_Œn32
(
row5
, 
row7
);

2802 
	`dù_Œn64
(
row0
, 
row4
);

2803 
	`dù_Œn64
(
row1
, 
row5
);

2804 
	`dù_Œn64
(
row2
, 
row6
);

2805 
	`dù_Œn64
(
row3
, 
row7
);

2807 #undeà
dù_Œn16


2808 #undeà
dù_Œn32


2809 #undeà
dù_Œn64


2816 
	`dù_·ss
(
vshº_n_s32
, 16);

2820 
ušt8x8_t
 
p0
 = 
	`vqrshrun_n_s16
(
row0
, 1);

2821 
ušt8x8_t
 
p1
 = 
	`vqrshrun_n_s16
(
row1
, 1);

2822 
ušt8x8_t
 
p2
 = 
	`vqrshrun_n_s16
(
row2
, 1);

2823 
ušt8x8_t
 
p3
 = 
	`vqrshrun_n_s16
(
row3
, 1);

2824 
ušt8x8_t
 
p4
 = 
	`vqrshrun_n_s16
(
row4
, 1);

2825 
ušt8x8_t
 
p5
 = 
	`vqrshrun_n_s16
(
row5
, 1);

2826 
ušt8x8_t
 
p6
 = 
	`vqrshrun_n_s16
(
row6
, 1);

2827 
ušt8x8_t
 
p7
 = 
	`vqrshrun_n_s16
(
row7
, 1);

2830 
	#dù_Œn8_8
(
x
, 
y
è{ 
ušt8x8x2_t
 
t
 = 
	`vŒn_u8
(x, y); x =.
v®
[0]; y =.v®[1]; }

	)

2831 
	#dù_Œn8_16
(
x
, 
y
è{ 
ušt16x4x2_t
 
t
 = 
	`vŒn_u16
(
	`v»š‹½»t_u16_u8
(x), v»š‹½»t_u16_u8(y)); x = 
	`v»š‹½»t_u8_u16
Ñ.
v®
[0]); y = v»š‹½»t_u8_u16Ñ.v®[1]); }

	)

2832 
	#dù_Œn8_32
(
x
, 
y
è{ 
ušt32x2x2_t
 
t
 = 
	`vŒn_u32
(
	`v»š‹½»t_u32_u8
(x), v»š‹½»t_u32_u8(y)); x = 
	`v»š‹½»t_u8_u32
Ñ.
v®
[0]); y = v»š‹½»t_u8_u32Ñ.v®[1]); }

	)

2838 
	`dù_Œn8_8
(
p0
, 
p1
);

2839 
	`dù_Œn8_8
(
p2
, 
p3
);

2840 
	`dù_Œn8_8
(
p4
, 
p5
);

2841 
	`dù_Œn8_8
(
p6
, 
p7
);

2844 
	`dù_Œn8_16
(
p0
, 
p2
);

2845 
	`dù_Œn8_16
(
p1
, 
p3
);

2846 
	`dù_Œn8_16
(
p4
, 
p6
);

2847 
	`dù_Œn8_16
(
p5
, 
p7
);

2850 
	`dù_Œn8_32
(
p0
, 
p4
);

2851 
	`dù_Œn8_32
(
p1
, 
p5
);

2852 
	`dù_Œn8_32
(
p2
, 
p6
);

2853 
	`dù_Œn8_32
(
p3
, 
p7
);

2856 
	`v¡1_u8
(
out
, 
p0
); ouˆ+ğ
out_¡ride
;

2857 
	`v¡1_u8
(
out
, 
p1
); ouˆ+ğ
out_¡ride
;

2858 
	`v¡1_u8
(
out
, 
p2
); ouˆ+ğ
out_¡ride
;

2859 
	`v¡1_u8
(
out
, 
p3
); ouˆ+ğ
out_¡ride
;

2860 
	`v¡1_u8
(
out
, 
p4
); ouˆ+ğ
out_¡ride
;

2861 
	`v¡1_u8
(
out
, 
p5
); ouˆ+ğ
out_¡ride
;

2862 
	`v¡1_u8
(
out
, 
p6
); ouˆ+ğ
out_¡ride
;

2863 
	`v¡1_u8
(
out
, 
p7
);

2865 #undeà
dù_Œn8_8


2866 #undeà
dù_Œn8_16


2867 #undeà
dù_Œn8_32


2870 #undeà
dù_lÚg_mul


2871 #undeà
dù_lÚg_mac


2872 #undeà
dù_wid’


2873 #undeà
dù_wadd


2874 #undeà
dù_wsub


2875 #undeà
dù_bæy32o


2876 #undeà
dù_·ss


2877 
	}
}

2881 
	#STBI__MARKER_nÚe
 0xff

	)

2885 
¡bi_uc
 
	$¡bi__g‘_m¬k”
(
¡bi__j³g
 *
j
)

2887 
¡bi_uc
 
x
;

2888 ià(
j
->
m¬k”
 !ğ
STBI__MARKER_nÚe
è{ 
x
 = j->marker; j->marker = STBI__MARKER_none;  x; }

2889 
x
 = 
	`¡bi__g‘8
(
j
->
s
);

2890 ià(
x
 !ğ0xffè 
STBI__MARKER_nÚe
;

2891 
x
 == 0xff)

2892 
x
 = 
	`¡bi__g‘8
(
j
->
s
);

2893  
x
;

2894 
	}
}

2898 
	#STBI__RESTART
(
x
è((xè>ğ0xd0 && (xè<ğ0xd7)

	)

2902 
	$¡bi__j³g_»£t
(
¡bi__j³g
 *
j
)

2904 
j
->
code_b™s
 = 0;

2905 
j
->
code_bufãr
 = 0;

2906 
j
->
nomÜe
 = 0;

2907 
j
->
img_comp
[0].
dc_´ed
 = j->img_comp[1].dc_pred = j->img_comp[2].dc_pred = j->img_comp[3].dc_pred = 0;

2908 
j
->
m¬k”
 = 
STBI__MARKER_nÚe
;

2909 
j
->
todo
 = j->
»¡¬t_š‹rv®
 ? j->restart_interval : 0x7fffffff;

2910 
j
->
eob_run
 = 0;

2913 
	}
}

2915 
	$¡bi__·r£_’Œİy_coded_d©a
(
¡bi__j³g
 *
z
)

2917 
	`¡bi__j³g_»£t
(
z
);

2918 ià(!
z
->
´og»ssive
) {

2919 ià(
z
->
sÿn_n
 == 1) {

2920 
i
,
j
;

2921 
	`STBI_SIMD_ALIGN
(, 
d©a
[64]);

2922 
n
 = 
z
->
Üd”
[0];

2927 
w
 = (
z
->
img_comp
[
n
].
x
+7) >> 3;

2928 
h
 = (
z
->
img_comp
[
n
].
y
+7) >> 3;

2929 
j
=0; j < 
h
; ++j) {

2930 
i
=0; i < 
w
; ++i) {

2931 
ha
 = 
z
->
img_comp
[
n
].ha;

2932 ià(!
	`¡bi__j³g_decode_block
(
z
, 
d©a
, z->
huff_dc
+z->
img_comp
[
n
].
hd
, z->
huff_ac
+
ha
, z->
ç¡_ac
[ha],‚, z->
dequªt
[z->img_comp[n].
tq
]))  0;

2933 
z
->
	`idù_block_k”Ãl
(z->
img_comp
[
n
].
d©a
+z->img_comp[n].
w2
*
j
*8+
i
*8, z->img_comp[n].w2, data);

2935 ià(--
z
->
todo
 <= 0) {

2936 ià(
z
->
code_b™s
 < 24è
	`¡bi__grow_bufãr_un§ã
(z);

2939 ià(!
	`STBI__RESTART
(
z
->
m¬k”
))  1;

2940 
	`¡bi__j³g_»£t
(
z
);

2946 
i
,
j
,
k
,
x
,
y
;

2947 
	`STBI_SIMD_ALIGN
(, 
d©a
[64]);

2948 
j
=0; j < 
z
->
img_mcu_y
; ++j) {

2949 
i
=0; i < 
z
->
img_mcu_x
; ++i) {

2951 
k
=0; k < 
z
->
sÿn_n
; ++k) {

2952 
n
 = 
z
->
Üd”
[
k
];

2955 
y
=0; y < 
z
->
img_comp
[
n
].
v
; ++y) {

2956 
x
=0; x < 
z
->
img_comp
[
n
].
h
; ++x) {

2957 
x2
 = (
i
*
z
->
img_comp
[
n
].
h
 + 
x
)*8;

2958 
y2
 = (
j
*
z
->
img_comp
[
n
].
v
 + 
y
)*8;

2959 
ha
 = 
z
->
img_comp
[
n
].ha;

2960 ià(!
	`¡bi__j³g_decode_block
(
z
, 
d©a
, z->
huff_dc
+z->
img_comp
[
n
].
hd
, z->
huff_ac
+
ha
, z->
ç¡_ac
[ha],‚, z->
dequªt
[z->img_comp[n].
tq
]))  0;

2961 
z
->
	`idù_block_k”Ãl
(z->
img_comp
[
n
].
d©a
+z->img_comp[n].
w2
*
y2
+
x2
, z->img_comp[n].w2, data);

2967 ià(--
z
->
todo
 <= 0) {

2968 ià(
z
->
code_b™s
 < 24è
	`¡bi__grow_bufãr_un§ã
(z);

2969 ià(!
	`STBI__RESTART
(
z
->
m¬k”
))  1;

2970 
	`¡bi__j³g_»£t
(
z
);

2977 ià(
z
->
sÿn_n
 == 1) {

2978 
i
,
j
;

2979 
n
 = 
z
->
Üd”
[0];

2984 
w
 = (
z
->
img_comp
[
n
].
x
+7) >> 3;

2985 
h
 = (
z
->
img_comp
[
n
].
y
+7) >> 3;

2986 
j
=0; j < 
h
; ++j) {

2987 
i
=0; i < 
w
; ++i) {

2988 *
d©a
 = 
z
->
img_comp
[
n
].
cÛff
 + 64 * (
i
 + 
j
 * z->img_comp[n].
cÛff_w
);

2989 ià(
z
->
¥ec_¡¬t
 == 0) {

2990 ià(!
	`¡bi__j³g_decode_block_´og_dc
(
z
, 
d©a
, &z->
huff_dc
[z->
img_comp
[
n
].
hd
],‚))

2993 
ha
 = 
z
->
img_comp
[
n
].ha;

2994 ià(!
	`¡bi__j³g_decode_block_´og_ac
(
z
, 
d©a
, &z->
huff_ac
[
ha
], z->
ç¡_ac
[ha]))

2998 ià(--
z
->
todo
 <= 0) {

2999 ià(
z
->
code_b™s
 < 24è
	`¡bi__grow_bufãr_un§ã
(z);

3000 ià(!
	`STBI__RESTART
(
z
->
m¬k”
))  1;

3001 
	`¡bi__j³g_»£t
(
z
);

3007 
i
,
j
,
k
,
x
,
y
;

3008 
j
=0; j < 
z
->
img_mcu_y
; ++j) {

3009 
i
=0; i < 
z
->
img_mcu_x
; ++i) {

3011 
k
=0; k < 
z
->
sÿn_n
; ++k) {

3012 
n
 = 
z
->
Üd”
[
k
];

3015 
y
=0; y < 
z
->
img_comp
[
n
].
v
; ++y) {

3016 
x
=0; x < 
z
->
img_comp
[
n
].
h
; ++x) {

3017 
x2
 = (
i
*
z
->
img_comp
[
n
].
h
 + 
x
);

3018 
y2
 = (
j
*
z
->
img_comp
[
n
].
v
 + 
y
);

3019 *
d©a
 = 
z
->
img_comp
[
n
].
cÛff
 + 64 * (
x2
 + 
y2
 * z->img_comp[n].
cÛff_w
);

3020 ià(!
	`¡bi__j³g_decode_block_´og_dc
(
z
, 
d©a
, &z->
huff_dc
[z->
img_comp
[
n
].
hd
],‚))

3027 ià(--
z
->
todo
 <= 0) {

3028 ià(
z
->
code_b™s
 < 24è
	`¡bi__grow_bufãr_un§ã
(z);

3029 ià(!
	`STBI__RESTART
(
z
->
m¬k”
))  1;

3030 
	`¡bi__j³g_»£t
(
z
);

3037 
	}
}

3039 
	$¡bi__j³g_dequªtize
(*
d©a
, 
¡bi__ušt16
 *
dequªt
)

3041 
i
;

3042 
i
=0; i < 64; ++i)

3043 
d©a
[
i
] *ğ
dequªt
[i];

3044 
	}
}

3046 
	$¡bi__j³g_fšish
(
¡bi__j³g
 *
z
)

3048 ià(
z
->
´og»ssive
) {

3050 
i
,
j
,
n
;

3051 
n
=0;‚ < 
z
->
s
->
img_n
; ++n) {

3052 
w
 = (
z
->
img_comp
[
n
].
x
+7) >> 3;

3053 
h
 = (
z
->
img_comp
[
n
].
y
+7) >> 3;

3054 
j
=0; j < 
h
; ++j) {

3055 
i
=0; i < 
w
; ++i) {

3056 *
d©a
 = 
z
->
img_comp
[
n
].
cÛff
 + 64 * (
i
 + 
j
 * z->img_comp[n].
cÛff_w
);

3057 
	`¡bi__j³g_dequªtize
(
d©a
, 
z
->
dequªt
[z->
img_comp
[
n
].
tq
]);

3058 
z
->
	`idù_block_k”Ãl
(z->
img_comp
[
n
].
d©a
+z->img_comp[n].
w2
*
j
*8+
i
*8, z->img_comp[n].w2, data);

3063 
	}
}

3065 
	$¡bi__´oûss_m¬k”
(
¡bi__j³g
 *
z
, 
m
)

3067 
L
;

3068 
m
) {

3069 
STBI__MARKER_nÚe
:

3070  
	`¡bi__”r
("expected marker","Corrupt JPEG");

3073 ià(
	`¡bi__g‘16be
(
z
->
s
è!ğ4è 
	`¡bi__”r
("bad DRI†en","Corrupt JPEG");

3074 
z
->
»¡¬t_š‹rv®
 = 
	`¡bi__g‘16be
(z->
s
);

3078 
L
 = 
	`¡bi__g‘16be
(
z
->
s
)-2;

3079 
L
 > 0) {

3080 
q
 = 
	`¡bi__g‘8
(
z
->
s
);

3081 
p
 = 
q
 >> 4, 
six‹’
 = (p != 0);

3082 
t
 = 
q
 & 15,
i
;

3083 ià(
p
 !ğ0 &&… !ğ1è 
	`¡bi__”r
("bad DQType","Corrupt JPEG");

3084 ià(
t
 > 3è 
	`¡bi__”r
("bad DQTable","Corrupt JPEG");

3086 
i
=0; i < 64; ++i)

3087 
z
->
dequªt
[
t
][
¡bi__j³g_dezigzag
[
i
]] = (
¡bi__ušt16
)(
six‹’
 ? 
	`¡bi__g‘16be
(z->
s
è: 
	`¡bi__g‘8
(z->s));

3088 
L
 -ğ(
six‹’
 ? 129 : 65);

3090  
L
==0;

3093 
L
 = 
	`¡bi__g‘16be
(
z
->
s
)-2;

3094 
L
 > 0) {

3095 
¡bi_uc
 *
v
;

3096 
sizes
[16],
i
,
n
=0;

3097 
q
 = 
	`¡bi__g‘8
(
z
->
s
);

3098 
tc
 = 
q
 >> 4;

3099 
th
 = 
q
 & 15;

3100 ià(
tc
 > 1 || 
th
 > 3è 
	`¡bi__”r
("bad DHT header","Corrupt JPEG");

3101 
i
=0; i < 16; ++i) {

3102 
sizes
[
i
] = 
	`¡bi__g‘8
(
z
->
s
);

3103 
n
 +ğ
sizes
[
i
];

3105 
L
 -= 17;

3106 ià(
tc
 == 0) {

3107 ià(!
	`¡bi__bud_huffmª
(
z
->
huff_dc
+
th
, 
sizes
))  0;

3108 
v
 = 
z
->
huff_dc
[
th
].
v®ues
;

3110 ià(!
	`¡bi__bud_huffmª
(
z
->
huff_ac
+
th
, 
sizes
))  0;

3111 
v
 = 
z
->
huff_ac
[
th
].
v®ues
;

3113 
i
=0; i < 
n
; ++i)

3114 
v
[
i
] = 
	`¡bi__g‘8
(
z
->
s
);

3115 ià(
tc
 != 0)

3116 
	`¡bi__bud_ç¡_ac
(
z
->
ç¡_ac
[
th
], z->
huff_ac
 +h);

3117 
L
 -ğ
n
;

3119  
L
==0;

3123 ià((
m
 >= 0xE0 && m <= 0xEF) || m == 0xFE) {

3124 
L
 = 
	`¡bi__g‘16be
(
z
->
s
);

3125 ià(
L
 < 2) {

3126 ià(
m
 == 0xFE)

3127  
	`¡bi__”r
("bad COM†en","Corrupt JPEG");

3129  
	`¡bi__”r
("bad APP†en","Corrupt JPEG");

3131 
L
 -= 2;

3133 ià(
m
 =ğ0xE0 && 
L
 >= 5) {

3134 cÚ¡ 
g
[5] = {'J','F','I','F','\0'};

3135 
ok
 = 1;

3136 
i
;

3137 
i
=0; i < 5; ++i)

3138 ià(
	`¡bi__g‘8
(
z
->
s
è!ğ
g
[
i
])

3139 
ok
 = 0;

3140 
L
 -= 5;

3141 ià(
ok
)

3142 
z
->
jfif
 = 1;

3143 } ià(
m
 =ğ0xEE && 
L
 >= 12) {

3144 cÚ¡ 
g
[6] = {'A','d','o','b','e','\0'};

3145 
ok
 = 1;

3146 
i
;

3147 
i
=0; i < 6; ++i)

3148 ià(
	`¡bi__g‘8
(
z
->
s
è!ğ
g
[
i
])

3149 
ok
 = 0;

3150 
L
 -= 6;

3151 ià(
ok
) {

3152 
	`¡bi__g‘8
(
z
->
s
);

3153 
	`¡bi__g‘16be
(
z
->
s
);

3154 
	`¡bi__g‘16be
(
z
->
s
);

3155 
z
->
­p14_cŞÜ_ŒªsfÜm
 = 
	`¡bi__g‘8
(z->
s
);

3156 
L
 -= 6;

3160 
	`¡bi__sk
(
z
->
s
, 
L
);

3164  
	`¡bi__”r
("unknown marker","Corrupt JPEG");

3165 
	}
}

3168 
	$¡bi__´oûss_sÿn_h—d”
(
¡bi__j³g
 *
z
)

3170 
i
;

3171 
Ls
 = 
	`¡bi__g‘16be
(
z
->
s
);

3172 
z
->
sÿn_n
 = 
	`¡bi__g‘8
(z->
s
);

3173 ià(
z
->
sÿn_n
 < 1 || z->sÿn_À> 4 || z->sÿn_À> (èz->
s
->
img_n
è 
	`¡bi__”r
("bad SOS component count","Corrupt JPEG");

3174 ià(
Ls
 !ğ6+2*
z
->
sÿn_n
è 
	`¡bi__”r
("bad SOS†en","Corrupt JPEG");

3175 
i
=0; i < 
z
->
sÿn_n
; ++i) {

3176 
id
 = 
	`¡bi__g‘8
(
z
->
s
), 
which
;

3177 
q
 = 
	`¡bi__g‘8
(
z
->
s
);

3178 
which
 = 0; which < 
z
->
s
->
img_n
; ++which)

3179 ià(
z
->
img_comp
[
which
].
id
 == id)

3181 ià(
which
 =ğ
z
->
s
->
img_n
)  0;

3182 
z
->
img_comp
[
which
].
hd
 = 
q
 >> 4; ià(z->img_comp[which].hd > 3è 
	`¡bi__”r
("bad DC huff","Corrupt JPEG");

3183 
z
->
img_comp
[
which
].
ha
 = 
q
 & 15; ià(z->img_comp[which].h¨> 3è 
	`¡bi__”r
("bad AC huff","Corrupt JPEG");

3184 
z
->
Üd”
[
i
] = 
which
;

3188 
¯
;

3189 
z
->
¥ec_¡¬t
 = 
	`¡bi__g‘8
(z->
s
);

3190 
z
->
¥ec_’d
 = 
	`¡bi__g‘8
(z->
s
);

3191 
¯
 = 
	`¡bi__g‘8
(
z
->
s
);

3192 
z
->
succ_high
 = (
¯
 >> 4);

3193 
z
->
succ_low
 = (
¯
 & 15);

3194 ià(
z
->
´og»ssive
) {

3195 ià(
z
->
¥ec_¡¬t
 > 63 || z->
¥ec_’d
 > 63 || z->¥ec_¡¬ˆ> z->¥ec_’d || z->
succ_high
 > 13 || z->
succ_low
 > 13)

3196  
	`¡bi__”r
("bad SOS", "Corrupt JPEG");

3198 ià(
z
->
¥ec_¡¬t
 !ğ0è 
	`¡bi__”r
("bad SOS","Corrupt JPEG");

3199 ià(
z
->
succ_high
 !ğ0 || z->
succ_low
 !ğ0è 
	`¡bi__”r
("bad SOS","Corrupt JPEG");

3200 
z
->
¥ec_’d
 = 63;

3205 
	}
}

3207 
	$¡bi__ä“_j³g_compÚ’ts
(
¡bi__j³g
 *
z
, 
ncomp
, 
why
)

3209 
i
;

3210 
i
=0; i < 
ncomp
; ++i) {

3211 ià(
z
->
img_comp
[
i
].
¿w_d©a
) {

3212 
	`STBI_FREE
(
z
->
img_comp
[
i
].
¿w_d©a
);

3213 
z
->
img_comp
[
i
].
¿w_d©a
 = 
NULL
;

3214 
z
->
img_comp
[
i
].
d©a
 = 
NULL
;

3216 ià(
z
->
img_comp
[
i
].
¿w_cÛff
) {

3217 
	`STBI_FREE
(
z
->
img_comp
[
i
].
¿w_cÛff
);

3218 
z
->
img_comp
[
i
].
¿w_cÛff
 = 0;

3219 
z
->
img_comp
[
i
].
cÛff
 = 0;

3221 ià(
z
->
img_comp
[
i
].
lšebuf
) {

3222 
	`STBI_FREE
(
z
->
img_comp
[
i
].
lšebuf
);

3223 
z
->
img_comp
[
i
].
lšebuf
 = 
NULL
;

3226  
why
;

3227 
	}
}

3229 
	$¡bi__´oûss_äame_h—d”
(
¡bi__j³g
 *
z
, 
sÿn
)

3231 
¡bi__cÚ‹xt
 *
s
 = 
z
->s;

3232 
Lf
,
p
,
i
,
q
, 
h_max
=1,
v_max
=1,
c
;

3233 
Lf
 = 
	`¡bi__g‘16be
(
s
); ià(Là< 11è 
	`¡bi__”r
("bad SOF†en","Corrupt JPEG");

3234 
p
 = 
	`¡bi__g‘8
(
s
); iàÕ !ğ8è 
	`¡bi__”r
("only 8-bit","JPEG format‚ot supported: 8-bit only");

3235 
s
->
img_y
 = 
	`¡bi__g‘16be
(s); ià(s->img_y =ğ0è 
	`¡bi__”r
("no header height", "JPEG format‚ot supported: delayed height");

3236 
s
->
img_x
 = 
	`¡bi__g‘16be
(s); ià(s->img_x =ğ0è 
	`¡bi__”r
("0 width","Corrupt JPEG");

3237 ià(
s
->
img_y
 > 
STBI_MAX_DIMENSIONS
è 
	`¡bi__”r
("too†arge","Very†arge image (corrupt?)");

3238 ià(
s
->
img_x
 > 
STBI_MAX_DIMENSIONS
è 
	`¡bi__”r
("too†arge","Very†arge image (corrupt?)");

3239 
c
 = 
	`¡bi__g‘8
(
s
);

3240 ià(
c
 !ğ3 && c !ğ1 && c !ğ4è 
	`¡bi__”r
("bad component count","Corrupt JPEG");

3241 
s
->
img_n
 = 
c
;

3242 
i
=0; i < 
c
; ++i) {

3243 
z
->
img_comp
[
i
].
d©a
 = 
NULL
;

3244 
z
->
img_comp
[
i
].
lšebuf
 = 
NULL
;

3247 ià(
Lf
 !ğ8+3*
s
->
img_n
è 
	`¡bi__”r
("bad SOF†en","Corrupt JPEG");

3249 
z
->
rgb
 = 0;

3250 
i
=0; i < 
s
->
img_n
; ++i) {

3251 cÚ¡ 
rgb
[3] = { 'R', 'G', 'B' };

3252 
z
->
img_comp
[
i
].
id
 = 
	`¡bi__g‘8
(
s
);

3253 ià(
s
->
img_n
 =ğ3 && 
z
->
img_comp
[
i
].
id
 =ğ
rgb
[i])

3254 ++
z
->
rgb
;

3255 
q
 = 
	`¡bi__g‘8
(
s
);

3256 
z
->
img_comp
[
i
].
h
 = (
q
 >> 4); ià(!z->img_comp[i].h || z->img_comp[i].h > 4è 
	`¡bi__”r
("bad H","Corrupt JPEG");

3257 
z
->
img_comp
[
i
].
v
 = 
q
 & 15; ià(!z->img_comp[i].v || z->img_comp[i].v > 4è 
	`¡bi__”r
("bad V","Corrupt JPEG");

3258 
z
->
img_comp
[
i
].
tq
 = 
	`¡bi__g‘8
(
s
); ià(z->img_comp[i].tq > 3è 
	`¡bi__”r
("bad TQ","Corrupt JPEG");

3261 ià(
sÿn
 !ğ
STBI__SCAN_lßd
)  1;

3263 ià(!
	`¡bi__mad3sizes_v®id
(
s
->
img_x
, s->
img_y
, s->
img_n
, 0)è 
	`¡bi__”r
("too†arge", "Imageoo†argeo decode");

3265 
i
=0; i < 
s
->
img_n
; ++i) {

3266 ià(
z
->
img_comp
[
i
].
h
 > 
h_max
) h_max = z->img_comp[i].h;

3267 ià(
z
->
img_comp
[
i
].
v
 > 
v_max
) v_max = z->img_comp[i].v;

3272 
i
=0; i < 
s
->
img_n
; ++i) {

3273 ià(
h_max
 % 
z
->
img_comp
[
i
].
h
 !ğ0è 
	`¡bi__”r
("bad H","Corrupt JPEG");

3274 ià(
v_max
 % 
z
->
img_comp
[
i
].
v
 !ğ0è 
	`¡bi__”r
("bad V","Corrupt JPEG");

3278 
z
->
img_h_max
 = 
h_max
;

3279 
z
->
img_v_max
 = 
v_max
;

3280 
z
->
img_mcu_w
 = 
h_max
 * 8;

3281 
z
->
img_mcu_h
 = 
v_max
 * 8;

3283 
z
->
img_mcu_x
 = (
s
->
img_x
 + z->
img_mcu_w
-1) / z->img_mcu_w;

3284 
z
->
img_mcu_y
 = (
s
->
img_y
 + z->
img_mcu_h
-1) / z->img_mcu_h;

3286 
i
=0; i < 
s
->
img_n
; ++i) {

3288 
z
->
img_comp
[
i
].
x
 = (
s
->
img_x
 * z->img_comp[i].
h
 + 
h_max
-1) / h_max;

3289 
z
->
img_comp
[
i
].
y
 = (
s
->
img_y
 * z->img_comp[i].
v
 + 
v_max
-1) / v_max;

3297 
z
->
img_comp
[
i
].
w2
 = z->
img_mcu_x
 * z->img_comp[i].
h
 * 8;

3298 
z
->
img_comp
[
i
].
h2
 = z->
img_mcu_y
 * z->img_comp[i].
v
 * 8;

3299 
z
->
img_comp
[
i
].
cÛff
 = 0;

3300 
z
->
img_comp
[
i
].
¿w_cÛff
 = 0;

3301 
z
->
img_comp
[
i
].
lšebuf
 = 
NULL
;

3302 
z
->
img_comp
[
i
].
¿w_d©a
 = 
	`¡bi__m®loc_mad2
(z->img_comp[i].
w2
, z->img_comp[i].
h2
, 15);

3303 ià(
z
->
img_comp
[
i
].
¿w_d©a
 =ğ
NULL
)

3304  
	`¡bi__ä“_j³g_compÚ’ts
(
z
, 
i
+1, 
	`¡bi__”r
("outofmem", "Out of memory"));

3306 
z
->
img_comp
[
i
].
d©a
 = (
¡bi_uc
*è(((
size_t
èz->img_comp[i].
¿w_d©a
 + 15) & ~15);

3307 ià(
z
->
´og»ssive
) {

3309 
z
->
img_comp
[
i
].
cÛff_w
 = z->img_comp[i].
w2
 / 8;

3310 
z
->
img_comp
[
i
].
cÛff_h
 = z->img_comp[i].
h2
 / 8;

3311 
z
->
img_comp
[
i
].
¿w_cÛff
 = 
	`¡bi__m®loc_mad3
(z->img_comp[i].
w2
, z->img_comp[i].
h2
, (), 15);

3312 ià(
z
->
img_comp
[
i
].
¿w_cÛff
 =ğ
NULL
)

3313  
	`¡bi__ä“_j³g_compÚ’ts
(
z
, 
i
+1, 
	`¡bi__”r
("outofmem", "Out of memory"));

3314 
z
->
img_comp
[
i
].
cÛff
 = (*è(((
size_t
èz->img_comp[i].
¿w_cÛff
 + 15) & ~15);

3319 
	}
}

3322 
	#¡bi__DNL
(
x
è((xè=ğ0xdc)

	)

3323 
	#¡bi__SOI
(
x
è((xè=ğ0xd8)

	)

3324 
	#¡bi__EOI
(
x
è((xè=ğ0xd9)

	)

3325 
	#¡bi__SOF
(
x
è((xè=ğ0xc0 || (xè=ğ0xc1 || (xè=ğ0xc2)

	)

3326 
	#¡bi__SOS
(
x
è((xè=ğ0xda)

	)

3328 
	#¡bi__SOF_´og»ssive
(
x
è((xè=ğ0xc2)

	)

3330 
	$¡bi__decode_j³g_h—d”
(
¡bi__j³g
 *
z
, 
sÿn
)

3332 
m
;

3333 
z
->
jfif
 = 0;

3334 
z
->
­p14_cŞÜ_ŒªsfÜm
 = -1;

3335 
z
->
m¬k”
 = 
STBI__MARKER_nÚe
;

3336 
m
 = 
	`¡bi__g‘_m¬k”
(
z
);

3337 ià(!
	`¡bi__SOI
(
m
)è 
	`¡bi__”r
("no SOI","Corrupt JPEG");

3338 ià(
sÿn
 =ğ
STBI__SCAN_ty³
)  1;

3339 
m
 = 
	`¡bi__g‘_m¬k”
(
z
);

3340 !
	`¡bi__SOF
(
m
)) {

3341 ià(!
	`¡bi__´oûss_m¬k”
(
z
,
m
))  0;

3342 
m
 = 
	`¡bi__g‘_m¬k”
(
z
);

3343 
m
 =ğ
STBI__MARKER_nÚe
) {

3345 ià(
	`¡bi__©_eof
(
z
->
s
)è 
	`¡bi__”r
("no SOF", "Corrupt JPEG");

3346 
m
 = 
	`¡bi__g‘_m¬k”
(
z
);

3349 
z
->
´og»ssive
 = 
	`¡bi__SOF_´og»ssive
(
m
);

3350 ià(!
	`¡bi__´oûss_äame_h—d”
(
z
, 
sÿn
))  0;

3352 
	}
}

3355 
	$¡bi__decode_j³g_image
(
¡bi__j³g
 *
j
)

3357 
m
;

3358 
m
 = 0; m < 4; m++) {

3359 
j
->
img_comp
[
m
].
¿w_d©a
 = 
NULL
;

3360 
j
->
img_comp
[
m
].
¿w_cÛff
 = 
NULL
;

3362 
j
->
»¡¬t_š‹rv®
 = 0;

3363 ià(!
	`¡bi__decode_j³g_h—d”
(
j
, 
STBI__SCAN_lßd
))  0;

3364 
m
 = 
	`¡bi__g‘_m¬k”
(
j
);

3365 !
	`¡bi__EOI
(
m
)) {

3366 ià(
	`¡bi__SOS
(
m
)) {

3367 ià(!
	`¡bi__´oûss_sÿn_h—d”
(
j
))  0;

3368 ià(!
	`¡bi__·r£_’Œİy_coded_d©a
(
j
))  0;

3369 ià(
j
->
m¬k”
 =ğ
STBI__MARKER_nÚe
 ) {

3371 !
	`¡bi__©_eof
(
j
->
s
)) {

3372 
x
 = 
	`¡bi__g‘8
(
j
->
s
);

3373 ià(
x
 == 255) {

3374 
j
->
m¬k”
 = 
	`¡bi__g‘8
(j->
s
);

3380 } ià(
	`¡bi__DNL
(
m
)) {

3381 
Ld
 = 
	`¡bi__g‘16be
(
j
->
s
);

3382 
¡bi__ušt32
 
NL
 = 
	`¡bi__g‘16be
(
j
->
s
);

3383 ià(
Ld
 !ğ4è 
	`¡bi__”r
("bad DNL†en", "Corrupt JPEG");

3384 ià(
NL
 !ğ
j
->
s
->
img_y
è 
	`¡bi__”r
("bad DNL height", "Corrupt JPEG");

3386 ià(!
	`¡bi__´oûss_m¬k”
(
j
, 
m
))  0;

3388 
m
 = 
	`¡bi__g‘_m¬k”
(
j
);

3390 ià(
j
->
´og»ssive
)

3391 
	`¡bi__j³g_fšish
(
j
);

3393 
	}
}

3397 
	g¡bi_uc
 *(*
	t»§m¶e_row_func
)(
	t¡bi_uc
 *
	tout
, stbi_uø*
	tš0
, stbi_uø*
	tš1
,

3398 
	tw
, 
	ths
);

3400 
	#¡bi__div4
(
x
è((
¡bi_uc
è((xè>> 2))

	)

3402 
¡bi_uc
 *
	$»§m¶e_row_1
(
¡bi_uc
 *
out
, stbi_uø*
š_Ã¬
, stbi_uø*
š_çr
, 
w
, 
hs
)

3404 
	`STBI_NOTUSED
(
out
);

3405 
	`STBI_NOTUSED
(
š_çr
);

3406 
	`STBI_NOTUSED
(
w
);

3407 
	`STBI_NOTUSED
(
hs
);

3408  
š_Ã¬
;

3409 
	}
}

3411 
¡bi_uc
* 
	$¡bi__»§m¶e_row_v_2
(
¡bi_uc
 *
out
, stbi_uø*
š_Ã¬
, stbi_uø*
š_çr
, 
w
, 
hs
)

3414 
i
;

3415 
	`STBI_NOTUSED
(
hs
);

3416 
i
=0; i < 
w
; ++i)

3417 
out
[
i
] = 
	`¡bi__div4
(3*
š_Ã¬
[i] + 
š_çr
[i] + 2);

3418  
out
;

3419 
	}
}

3421 
¡bi_uc
* 
	$¡bi__»§m¶e_row_h_2
(
¡bi_uc
 *
out
, stbi_uø*
š_Ã¬
, stbi_uø*
š_çr
, 
w
, 
hs
)

3424 
i
;

3425 
¡bi_uc
 *
šput
 = 
š_Ã¬
;

3427 ià(
w
 == 1) {

3429 
out
[0] = out[1] = 
šput
[0];

3430  
out
;

3433 
out
[0] = 
šput
[0];

3434 
out
[1] = 
	`¡bi__div4
(
šput
[0]*3 + input[1] + 2);

3435 
i
=1; i < 
w
-1; ++i) {

3436 
n
 = 3*
šput
[
i
]+2;

3437 
out
[
i
*2+0] = 
	`¡bi__div4
(
n
+
šput
[i-1]);

3438 
out
[
i
*2+1] = 
	`¡bi__div4
(
n
+
šput
[i+1]);

3440 
out
[
i
*2+0] = 
	`¡bi__div4
(
šput
[
w
-2]*3 + input[w-1] + 2);

3441 
out
[
i
*2+1] = 
šput
[
w
-1];

3443 
	`STBI_NOTUSED
(
š_çr
);

3444 
	`STBI_NOTUSED
(
hs
);

3446  
out
;

3447 
	}
}

3449 
	#¡bi__div16
(
x
è((
¡bi_uc
è((xè>> 4))

	)

3451 
¡bi_uc
 *
	$¡bi__»§m¶e_row_hv_2
(
¡bi_uc
 *
out
, stbi_uø*
š_Ã¬
, stbi_uø*
š_çr
, 
w
, 
hs
)

3454 
i
,
t0
,
t1
;

3455 ià(
w
 == 1) {

3456 
out
[0] = out[1] = 
	`¡bi__div4
(3*
š_Ã¬
[0] + 
š_çr
[0] + 2);

3457  
out
;

3460 
t1
 = 3*
š_Ã¬
[0] + 
š_çr
[0];

3461 
out
[0] = 
	`¡bi__div4
(
t1
+2);

3462 
i
=1; i < 
w
; ++i) {

3463 
t0
 = 
t1
;

3464 
t1
 = 3*
š_Ã¬
[
i
]+
š_çr
[i];

3465 
out
[
i
*2-1] = 
	`¡bi__div16
(3*
t0
 + 
t1
 + 8);

3466 
out
[
i
*2 ] = 
	`¡bi__div16
(3*
t1
 + 
t0
 + 8);

3468 
out
[
w
*2-1] = 
	`¡bi__div4
(
t1
+2);

3470 
	`STBI_NOTUSED
(
hs
);

3472  
out
;

3473 
	}
}

3475 #ià
defšed
(
STBI_SSE2
è|| defšed(
STBI_NEON
)

3476 
¡bi_uc
 *
	$¡bi__»§m¶e_row_hv_2_simd
(
¡bi_uc
 *
out
, stbi_uø*
š_Ã¬
, stbi_uø*
š_çr
, 
w
, 
hs
)

3479 
i
=0,
t0
,
t1
;

3481 ià(
w
 == 1) {

3482 
out
[0] = out[1] = 
	`¡bi__div4
(3*
š_Ã¬
[0] + 
š_çr
[0] + 2);

3483  
out
;

3486 
t1
 = 3*
š_Ã¬
[0] + 
š_çr
[0];

3490 ; 
i
 < ((
w
-1) & ~7); i += 8) {

3491 #ià
	`defšed
(
STBI_SSE2
)

3494 
__m128i
 
z”o
 = 
	`_mm_£tz”o_si128
();

3495 
__m128i
 
çrb
 = 
	`_mm_lßdl_•i64
((__m128˜*è(
š_çr
 + 
i
));

3496 
__m128i
 
Ã¬b
 = 
	`_mm_lßdl_•i64
((__m128˜*è(
š_Ã¬
 + 
i
));

3497 
__m128i
 
çrw
 = 
	`_mm_uÅacklo_•i8
(
çrb
, 
z”o
);

3498 
__m128i
 
Ã¬w
 = 
	`_mm_uÅacklo_•i8
(
Ã¬b
, 
z”o
);

3499 
__m128i
 
diff
 = 
	`_mm_sub_•i16
(
çrw
, 
Ã¬w
);

3500 
__m128i
 
Ã¬s
 = 
	`_mm_¦li_•i16
(
Ã¬w
, 2);

3501 
__m128i
 
cu¼
 = 
	`_mm_add_•i16
(
Ã¬s
, 
diff
);

3508 
__m128i
 
´v0
 = 
	`_mm_¦li_si128
(
cu¼
, 2);

3509 
__m128i
 
nxt0
 = 
	`_mm_¤li_si128
(
cu¼
, 2);

3510 
__m128i
 
´ev
 = 
	`_mm_š£¹_•i16
(
´v0
, 
t1
, 0);

3511 
__m128i
 
Ãxt
 = 
	`_mm_š£¹_•i16
(
nxt0
, 3*
š_Ã¬
[
i
+8] + 
š_çr
[i+8], 7);

3517 
__m128i
 
bŸs
 = 
	`_mm_£t1_•i16
(8);

3518 
__m128i
 
curs
 = 
	`_mm_¦li_•i16
(
cu¼
, 2);

3519 
__m128i
 
´vd
 = 
	`_mm_sub_•i16
(
´ev
, 
cu¼
);

3520 
__m128i
 
nxtd
 = 
	`_mm_sub_•i16
(
Ãxt
, 
cu¼
);

3521 
__m128i
 
curb
 = 
	`_mm_add_•i16
(
curs
, 
bŸs
);

3522 
__m128i
 
ev’
 = 
	`_mm_add_•i16
(
´vd
, 
curb
);

3523 
__m128i
 
odd
 = 
	`_mm_add_•i16
(
nxtd
, 
curb
);

3526 
__m128i
 
št0
 = 
	`_mm_uÅacklo_•i16
(
ev’
, 
odd
);

3527 
__m128i
 
št1
 = 
	`_mm_uÅackhi_•i16
(
ev’
, 
odd
);

3528 
__m128i
 
de0
 = 
	`_mm_¤li_•i16
(
št0
, 4);

3529 
__m128i
 
de1
 = 
	`_mm_¤li_•i16
(
št1
, 4);

3532 
__m128i
 
outv
 = 
	`_mm_·ckus_•i16
(
de0
, 
de1
);

3533 
	`_mm_¡Üeu_si128
((
__m128i
 *è(
out
 + 
i
*2), 
outv
);

3534 #–ià
	`defšed
(
STBI_NEON
)

3537 
ušt8x8_t
 
çrb
 = 
	`vld1_u8
(
š_çr
 + 
i
);

3538 
ušt8x8_t
 
Ã¬b
 = 
	`vld1_u8
(
š_Ã¬
 + 
i
);

3539 
št16x8_t
 
diff
 = 
	`v»š‹½»tq_s16_u16
(
	`vsubl_u8
(
çrb
, 
Ã¬b
));

3540 
št16x8_t
 
Ã¬s
 = 
	`v»š‹½»tq_s16_u16
(
	`vshÎ_n_u8
(
Ã¬b
, 2));

3541 
št16x8_t
 
cu¼
 = 
	`vaddq_s16
(
Ã¬s
, 
diff
);

3548 
št16x8_t
 
´v0
 = 
	`vextq_s16
(
cu¼
, curr, 7);

3549 
št16x8_t
 
nxt0
 = 
	`vextq_s16
(
cu¼
, curr, 1);

3550 
št16x8_t
 
´ev
 = 
	`v£tq_ÏÃ_s16
(
t1
, 
´v0
, 0);

3551 
št16x8_t
 
Ãxt
 = 
	`v£tq_ÏÃ_s16
(3*
š_Ã¬
[
i
+8] + 
š_çr
[i+8], 
nxt0
, 7);

3557 
št16x8_t
 
curs
 = 
	`vshlq_n_s16
(
cu¼
, 2);

3558 
št16x8_t
 
´vd
 = 
	`vsubq_s16
(
´ev
, 
cu¼
);

3559 
št16x8_t
 
nxtd
 = 
	`vsubq_s16
(
Ãxt
, 
cu¼
);

3560 
št16x8_t
 
ev’
 = 
	`vaddq_s16
(
curs
, 
´vd
);

3561 
št16x8_t
 
odd
 = 
	`vaddq_s16
(
curs
, 
nxtd
);

3564 
ušt8x8x2_t
 
o
;

3565 
o
.
v®
[0] = 
	`vqrshrun_n_s16
(
ev’
, 4);

3566 
o
.
v®
[1] = 
	`vqrshrun_n_s16
(
odd
, 4);

3567 
	`v¡2_u8
(
out
 + 
i
*2, 
o
);

3571 
t1
 = 3*
š_Ã¬
[
i
+7] + 
š_çr
[i+7];

3574 
t0
 = 
t1
;

3575 
t1
 = 3*
š_Ã¬
[
i
] + 
š_çr
[i];

3576 
out
[
i
*2] = 
	`¡bi__div16
(3*
t1
 + 
t0
 + 8);

3578 ++
i
; i < 
w
; ++i) {

3579 
t0
 = 
t1
;

3580 
t1
 = 3*
š_Ã¬
[
i
]+
š_çr
[i];

3581 
out
[
i
*2-1] = 
	`¡bi__div16
(3*
t0
 + 
t1
 + 8);

3582 
out
[
i
*2 ] = 
	`¡bi__div16
(3*
t1
 + 
t0
 + 8);

3584 
out
[
w
*2-1] = 
	`¡bi__div4
(
t1
+2);

3586 
	`STBI_NOTUSED
(
hs
);

3588  
out
;

3589 
	}
}

3592 
¡bi_uc
 *
	$¡bi__»§m¶e_row_g’”ic
(
¡bi_uc
 *
out
, stbi_uø*
š_Ã¬
, stbi_uø*
š_çr
, 
w
, 
hs
)

3595 
i
,
j
;

3596 
	`STBI_NOTUSED
(
š_çr
);

3597 
i
=0; i < 
w
; ++i)

3598 
j
=0; j < 
hs
; ++j)

3599 
out
[
i
*
hs
+
j
] = 
š_Ã¬
[i];

3600  
out
;

3601 
	}
}

3605 
	#¡bi__æßt2fixed
(
x
è(((è((xè* 4096.0à+ 0.5f)è<< 8)

	)

3606 
	$¡bi__YCbCr_to_RGB_row
(
¡bi_uc
 *
out
, cÚ¡ stbi_uø*
y
, cÚ¡ stbi_uø*
pcb
, cÚ¡ stbi_uø*
pü
, 
couÁ
, 
¡•
)

3608 
i
;

3609 
i
=0; i < 
couÁ
; ++i) {

3610 
y_fixed
 = (
y
[
i
] << 20) + (1<<19);

3611 
r
,
g
,
b
;

3612 
ü
 = 
pü
[
i
] - 128;

3613 
cb
 = 
pcb
[
i
] - 128;

3614 
r
 = 
y_fixed
 + 
ü
* 
	`¡bi__æßt2fixed
(1.40200f);

3615 
g
 = 
y_fixed
 + (
ü
*-
	`¡bi__æßt2fixed
(0.71414f)è+ ((
cb
*-stbi__float2fixed(0.34414f)) & 0xffff0000);

3616 
b
 = 
y_fixed
 + 
cb
* 
	`¡bi__æßt2fixed
(1.77200f);

3617 
r
 >>= 20;

3618 
g
 >>= 20;

3619 
b
 >>= 20;

3620 ià((è
r
 > 255) { if (r < 0)„ = 0; r = 255; }

3621 ià((è
g
 > 255) { if (g < 0) g = 0; g = 255; }

3622 ià((è
b
 > 255) { if (b < 0) b = 0; b = 255; }

3623 
out
[0] = (
¡bi_uc
)
r
;

3624 
out
[1] = (
¡bi_uc
)
g
;

3625 
out
[2] = (
¡bi_uc
)
b
;

3626 
out
[3] = 255;

3627 
out
 +ğ
¡•
;

3629 
	}
}

3631 #ià
defšed
(
STBI_SSE2
è|| defšed(
STBI_NEON
)

3632 
	$¡bi__YCbCr_to_RGB_simd
(
¡bi_uc
 *
out
, stbi_uøcÚ¡ *
y
, stbi_uøcÚ¡ *
pcb
, stbi_uøcÚ¡ *
pü
, 
couÁ
, 
¡•
)

3634 
i
 = 0;

3636 #ifdeà
STBI_SSE2


3640 ià(
¡•
 == 4) {

3642 
__m128i
 
signæ
 = 
	`_mm_£t1_•i8
(-0x80);

3643 
__m128i
 
ü_cÚ¡0
 = 
	`_mm_£t1_•i16
( () ( 1.40200f*4096.0f+0.5f));

3644 
__m128i
 
ü_cÚ¡1
 = 
	`_mm_£t1_•i16
( - () ( 0.71414f*4096.0f+0.5f));

3645 
__m128i
 
cb_cÚ¡0
 = 
	`_mm_£t1_•i16
( - () ( 0.34414f*4096.0f+0.5f));

3646 
__m128i
 
cb_cÚ¡1
 = 
	`_mm_£t1_•i16
( () ( 1.77200f*4096.0f+0.5f));

3647 
__m128i
 
y_bŸs
 = 
	`_mm_£t1_•i8
(() () 128);

3648 
__m128i
 
xw
 = 
	`_mm_£t1_•i16
(255);

3650 ; 
i
+7 < 
couÁ
; i += 8) {

3652 
__m128i
 
y_by‹s
 = 
	`_mm_lßdl_•i64
((__m128˜*è(
y
+
i
));

3653 
__m128i
 
ü_by‹s
 = 
	`_mm_lßdl_•i64
((__m128˜*è(
pü
+
i
));

3654 
__m128i
 
cb_by‹s
 = 
	`_mm_lßdl_•i64
((__m128˜*è(
pcb
+
i
));

3655 
__m128i
 
ü_bŸ£d
 = 
	`_mm_xÜ_si128
(
ü_by‹s
, 
signæ
);

3656 
__m128i
 
cb_bŸ£d
 = 
	`_mm_xÜ_si128
(
cb_by‹s
, 
signæ
);

3659 
__m128i
 
yw
 = 
	`_mm_uÅacklo_•i8
(
y_bŸs
, 
y_by‹s
);

3660 
__m128i
 
üw
 = 
	`_mm_uÅacklo_•i8
(
	`_mm_£tz”o_si128
(), 
ü_bŸ£d
);

3661 
__m128i
 
cbw
 = 
	`_mm_uÅacklo_•i8
(
	`_mm_£tz”o_si128
(), 
cb_bŸ£d
);

3664 
__m128i
 
yws
 = 
	`_mm_¤li_•i16
(
yw
, 4);

3665 
__m128i
 
ü0
 = 
	`_mm_mulhi_•i16
(
ü_cÚ¡0
, 
üw
);

3666 
__m128i
 
cb0
 = 
	`_mm_mulhi_•i16
(
cb_cÚ¡0
, 
cbw
);

3667 
__m128i
 
cb1
 = 
	`_mm_mulhi_•i16
(
cbw
, 
cb_cÚ¡1
);

3668 
__m128i
 
ü1
 = 
	`_mm_mulhi_•i16
(
üw
, 
ü_cÚ¡1
);

3669 
__m128i
 
rws
 = 
	`_mm_add_•i16
(
ü0
, 
yws
);

3670 
__m128i
 
gwt
 = 
	`_mm_add_•i16
(
cb0
, 
yws
);

3671 
__m128i
 
bws
 = 
	`_mm_add_•i16
(
yws
, 
cb1
);

3672 
__m128i
 
gws
 = 
	`_mm_add_•i16
(
gwt
, 
ü1
);

3675 
__m128i
 
rw
 = 
	`_mm_¤ai_•i16
(
rws
, 4);

3676 
__m128i
 
bw
 = 
	`_mm_¤ai_•i16
(
bws
, 4);

3677 
__m128i
 
gw
 = 
	`_mm_¤ai_•i16
(
gws
, 4);

3680 
__m128i
 
brb
 = 
	`_mm_·ckus_•i16
(
rw
, 
bw
);

3681 
__m128i
 
gxb
 = 
	`_mm_·ckus_•i16
(
gw
, 
xw
);

3684 
__m128i
 
t0
 = 
	`_mm_uÅacklo_•i8
(
brb
, 
gxb
);

3685 
__m128i
 
t1
 = 
	`_mm_uÅackhi_•i8
(
brb
, 
gxb
);

3686 
__m128i
 
o0
 = 
	`_mm_uÅacklo_•i16
(
t0
, 
t1
);

3687 
__m128i
 
o1
 = 
	`_mm_uÅackhi_•i16
(
t0
, 
t1
);

3690 
	`_mm_¡Üeu_si128
((
__m128i
 *è(
out
 + 0), 
o0
);

3691 
	`_mm_¡Üeu_si128
((
__m128i
 *è(
out
 + 16), 
o1
);

3692 
out
 += 32;

3697 #ifdeà
STBI_NEON


3699 ià(
¡•
 == 4) {

3701 
ušt8x8_t
 
signæ
 = 
	`vdup_n_u8
(0x80);

3702 
št16x8_t
 
ü_cÚ¡0
 = 
	`vdupq_n_s16
( () ( 1.40200f*4096.0f+0.5f));

3703 
št16x8_t
 
ü_cÚ¡1
 = 
	`vdupq_n_s16
( - () ( 0.71414f*4096.0f+0.5f));

3704 
št16x8_t
 
cb_cÚ¡0
 = 
	`vdupq_n_s16
( - () ( 0.34414f*4096.0f+0.5f));

3705 
št16x8_t
 
cb_cÚ¡1
 = 
	`vdupq_n_s16
( () ( 1.77200f*4096.0f+0.5f));

3707 ; 
i
+7 < 
couÁ
; i += 8) {

3709 
ušt8x8_t
 
y_by‹s
 = 
	`vld1_u8
(
y
 + 
i
);

3710 
ušt8x8_t
 
ü_by‹s
 = 
	`vld1_u8
(
pü
 + 
i
);

3711 
ušt8x8_t
 
cb_by‹s
 = 
	`vld1_u8
(
pcb
 + 
i
);

3712 
št8x8_t
 
ü_bŸ£d
 = 
	`v»š‹½»t_s8_u8
(
	`vsub_u8
(
ü_by‹s
, 
signæ
));

3713 
št8x8_t
 
cb_bŸ£d
 = 
	`v»š‹½»t_s8_u8
(
	`vsub_u8
(
cb_by‹s
, 
signæ
));

3716 
št16x8_t
 
yws
 = 
	`v»š‹½»tq_s16_u16
(
	`vshÎ_n_u8
(
y_by‹s
, 4));

3717 
št16x8_t
 
üw
 = 
	`vshÎ_n_s8
(
ü_bŸ£d
, 7);

3718 
št16x8_t
 
cbw
 = 
	`vshÎ_n_s8
(
cb_bŸ£d
, 7);

3721 
št16x8_t
 
ü0
 = 
	`vqdmulhq_s16
(
üw
, 
ü_cÚ¡0
);

3722 
št16x8_t
 
cb0
 = 
	`vqdmulhq_s16
(
cbw
, 
cb_cÚ¡0
);

3723 
št16x8_t
 
ü1
 = 
	`vqdmulhq_s16
(
üw
, 
ü_cÚ¡1
);

3724 
št16x8_t
 
cb1
 = 
	`vqdmulhq_s16
(
cbw
, 
cb_cÚ¡1
);

3725 
št16x8_t
 
rws
 = 
	`vaddq_s16
(
yws
, 
ü0
);

3726 
št16x8_t
 
gws
 = 
	`vaddq_s16
(vaddq_s16(
yws
, 
cb0
), 
ü1
);

3727 
št16x8_t
 
bws
 = 
	`vaddq_s16
(
yws
, 
cb1
);

3730 
ušt8x8x4_t
 
o
;

3731 
o
.
v®
[0] = 
	`vqrshrun_n_s16
(
rws
, 4);

3732 
o
.
v®
[1] = 
	`vqrshrun_n_s16
(
gws
, 4);

3733 
o
.
v®
[2] = 
	`vqrshrun_n_s16
(
bws
, 4);

3734 
o
.
v®
[3] = 
	`vdup_n_u8
(255);

3737 
	`v¡4_u8
(
out
, 
o
);

3738 
out
 += 8*4;

3743 ; 
i
 < 
couÁ
; ++i) {

3744 
y_fixed
 = (
y
[
i
] << 20) + (1<<19);

3745 
r
,
g
,
b
;

3746 
ü
 = 
pü
[
i
] - 128;

3747 
cb
 = 
pcb
[
i
] - 128;

3748 
r
 = 
y_fixed
 + 
ü
* 
	`¡bi__æßt2fixed
(1.40200f);

3749 
g
 = 
y_fixed
 + 
ü
*-
	`¡bi__æßt2fixed
(0.71414fè+ ((
cb
*-stbi__float2fixed(0.34414f)) & 0xffff0000);

3750 
b
 = 
y_fixed
 + 
cb
* 
	`¡bi__æßt2fixed
(1.77200f);

3751 
r
 >>= 20;

3752 
g
 >>= 20;

3753 
b
 >>= 20;

3754 ià((è
r
 > 255) { if (r < 0)„ = 0; r = 255; }

3755 ià((è
g
 > 255) { if (g < 0) g = 0; g = 255; }

3756 ià((è
b
 > 255) { if (b < 0) b = 0; b = 255; }

3757 
out
[0] = (
¡bi_uc
)
r
;

3758 
out
[1] = (
¡bi_uc
)
g
;

3759 
out
[2] = (
¡bi_uc
)
b
;

3760 
out
[3] = 255;

3761 
out
 +ğ
¡•
;

3763 
	}
}

3767 
	$¡bi__£tup_j³g
(
¡bi__j³g
 *
j
)

3769 
j
->
idù_block_k”Ãl
 = 
¡bi__idù_block
;

3770 
j
->
YCbCr_to_RGB_k”Ãl
 = 
¡bi__YCbCr_to_RGB_row
;

3771 
j
->
»§m¶e_row_hv_2_k”Ãl
 = 
¡bi__»§m¶e_row_hv_2
;

3773 #ifdeà
STBI_SSE2


3774 ià(
	`¡bi__s£2_avaabË
()) {

3775 
j
->
idù_block_k”Ãl
 = 
¡bi__idù_simd
;

3776 
j
->
YCbCr_to_RGB_k”Ãl
 = 
¡bi__YCbCr_to_RGB_simd
;

3777 
j
->
»§m¶e_row_hv_2_k”Ãl
 = 
¡bi__»§m¶e_row_hv_2_simd
;

3781 #ifdeà
STBI_NEON


3782 
j
->
idù_block_k”Ãl
 = 
¡bi__idù_simd
;

3783 
j
->
YCbCr_to_RGB_k”Ãl
 = 
¡bi__YCbCr_to_RGB_simd
;

3784 
j
->
»§m¶e_row_hv_2_k”Ãl
 = 
¡bi__»§m¶e_row_hv_2_simd
;

3786 
	}
}

3789 
	$¡bi__ş—nup_j³g
(
¡bi__j³g
 *
j
)

3791 
	`¡bi__ä“_j³g_compÚ’ts
(
j
, j->
s
->
img_n
, 0);

3792 
	}
}

3796 
»§m¶e_row_func
 
	m»§m¶e
;

3797 
¡bi_uc
 *
	mlše0
,*
	mlše1
;

3798 
	mhs
,
	mvs
;

3799 
	mw_lÜes
;

3800 
	my¡•
;

3801 
	mypos
;

3802 } 
	t¡bi__»§m¶e
;

3805 
¡bi_uc
 
	$¡bi__blšn_8x8
(
¡bi_uc
 
x
, stbi_uø
y
)

3807 
t
 = 
x
*
y
 + 128;

3808  (
¡bi_uc
è((
t
 + (t >>8)) >> 8);

3809 
	}
}

3811 
¡bi_uc
 *
	$lßd_j³g_image
(
¡bi__j³g
 *
z
, *
out_x
, *
out_y
, *
comp
, 
»q_comp
)

3813 
n
, 
decode_n
, 
is_rgb
;

3814 
z
->
s
->
img_n
 = 0;

3817 ià(
»q_comp
 < 0 ||„eq_com°> 4è 
	`¡bi__”½uc
("bad„eq_comp", "Internalƒrror");

3820 ià(!
	`¡bi__decode_j³g_image
(
z
)è{ 
	`¡bi__ş—nup_j³g
(z);  
NULL
; }

3823 
n
 = 
»q_comp
 ?„eq_com°: 
z
->
s
->
img_n
 >= 3 ? 3 : 1;

3825 
is_rgb
 = 
z
->
s
->
img_n
 =ğ3 && (z->
rgb
 =ğ3 || (z->
­p14_cŞÜ_ŒªsfÜm
 =ğ0 && !z->
jfif
));

3827 ià(
z
->
s
->
img_n
 =ğ3 && 
n
 < 3 && !
is_rgb
)

3828 
decode_n
 = 1;

3830 
decode_n
 = 
z
->
s
->
img_n
;

3834 ià(
decode_n
 <ğ0è{ 
	`¡bi__ş—nup_j³g
(
z
);  
NULL
; }

3838 
k
;

3839 
i
,
j
;

3840 
¡bi_uc
 *
ouut
;

3841 
¡bi_uc
 *
couut
[4] = { 
NULL
, NULL, NULL, NULL };

3843 
¡bi__»§m¶e
 
»s_comp
[4];

3845 
k
=0; k < 
decode_n
; ++k) {

3846 
¡bi__»§m¶e
 *
r
 = &
»s_comp
[
k
];

3850 
z
->
img_comp
[
k
].
lšebuf
 = (
¡bi_uc
 *è
	`¡bi__m®loc
(z->
s
->
img_x
 + 3);

3851 ià(!
z
->
img_comp
[
k
].
lšebuf
è{ 
	`¡bi__ş—nup_j³g
(z);  
	`¡bi__”½uc
("outofmem", "Out of memory"); }

3853 
r
->
hs
 = 
z
->
img_h_max
 / z->
img_comp
[
k
].
h
;

3854 
r
->
vs
 = 
z
->
img_v_max
 / z->
img_comp
[
k
].
v
;

3855 
r
->
y¡•
 =„->
vs
 >> 1;

3856 
r
->
w_lÜes
 = (
z
->
s
->
img_x
 +„->
hs
-1) /„->hs;

3857 
r
->
ypos
 = 0;

3858 
r
->
lše0
 =„->
lše1
 = 
z
->
img_comp
[
k
].
d©a
;

3860 ià(
r
->
hs
 =ğ1 &&„->
vs
 =ğ1èr->
»§m¶e
 = 
»§m¶e_row_1
;

3861 ià(
r
->
hs
 =ğ1 &&„->
vs
 =ğ2èr->
»§m¶e
 = 
¡bi__»§m¶e_row_v_2
;

3862 ià(
r
->
hs
 =ğ2 &&„->
vs
 =ğ1èr->
»§m¶e
 = 
¡bi__»§m¶e_row_h_2
;

3863 ià(
r
->
hs
 =ğ2 &&„->
vs
 =ğ2èr->
»§m¶e
 = 
z
->
»§m¶e_row_hv_2_k”Ãl
;

3864 
r
->
»§m¶e
 = 
¡bi__»§m¶e_row_g’”ic
;

3868 
ouut
 = (
¡bi_uc
 *è
	`¡bi__m®loc_mad3
(
n
, 
z
->
s
->
img_x
, z->s->
img_y
, 1);

3869 ià(!
ouut
è{ 
	`¡bi__ş—nup_j³g
(
z
);  
	`¡bi__”½uc
("outofmem", "Out of memory"); }

3872 
j
=0; j < 
z
->
s
->
img_y
; ++j) {

3873 
¡bi_uc
 *
out
 = 
ouut
 + 
n
 * 
z
->
s
->
img_x
 * 
j
;

3874 
k
=0; k < 
decode_n
; ++k) {

3875 
¡bi__»§m¶e
 *
r
 = &
»s_comp
[
k
];

3876 
y_bÙ
 = 
r
->
y¡•
 >ğÔ->
vs
 >> 1);

3877 
couut
[
k
] = 
r
->
	`»§m¶e
(
z
->
img_comp
[k].
lšebuf
,

3878 
y_bÙ
 ? 
r
->
lše1
 :„->
lše0
,

3879 
y_bÙ
 ? 
r
->
lše0
 :„->
lše1
,

3880 
r
->
w_lÜes
,„->
hs
);

3881 ià(++
r
->
y¡•
 >ğr->
vs
) {

3882 
r
->
y¡•
 = 0;

3883 
r
->
lše0
 =„->
lše1
;

3884 ià(++
r
->
ypos
 < 
z
->
img_comp
[
k
].
y
)

3885 
r
->
lše1
 +ğ
z
->
img_comp
[
k
].
w2
;

3888 ià(
n
 >= 3) {

3889 
¡bi_uc
 *
y
 = 
couut
[0];

3890 ià(
z
->
s
->
img_n
 == 3) {

3891 ià(
is_rgb
) {

3892 
i
=0; i < 
z
->
s
->
img_x
; ++i) {

3893 
out
[0] = 
y
[
i
];

3894 
out
[1] = 
couut
[1][
i
];

3895 
out
[2] = 
couut
[2][
i
];

3896 
out
[3] = 255;

3897 
out
 +ğ
n
;

3900 
z
->
	`YCbCr_to_RGB_k”Ãl
(
out
, 
y
, 
couut
[1], couut[2], z->
s
->
img_x
, 
n
);

3902 } ià(
z
->
s
->
img_n
 == 4) {

3903 ià(
z
->
­p14_cŞÜ_ŒªsfÜm
 == 0) {

3904 
i
=0; i < 
z
->
s
->
img_x
; ++i) {

3905 
¡bi_uc
 
m
 = 
couut
[3][
i
];

3906 
out
[0] = 
	`¡bi__blšn_8x8
(
couut
[0][
i
], 
m
);

3907 
out
[1] = 
	`¡bi__blšn_8x8
(
couut
[1][
i
], 
m
);

3908 
out
[2] = 
	`¡bi__blšn_8x8
(
couut
[2][
i
], 
m
);

3909 
out
[3] = 255;

3910 
out
 +ğ
n
;

3912 } ià(
z
->
­p14_cŞÜ_ŒªsfÜm
 == 2) {

3913 
z
->
	`YCbCr_to_RGB_k”Ãl
(
out
, 
y
, 
couut
[1], couut[2], z->
s
->
img_x
, 
n
);

3914 
i
=0; i < 
z
->
s
->
img_x
; ++i) {

3915 
¡bi_uc
 
m
 = 
couut
[3][
i
];

3916 
out
[0] = 
	`¡bi__blšn_8x8
(255 - out[0], 
m
);

3917 
out
[1] = 
	`¡bi__blšn_8x8
(255 - out[1], 
m
);

3918 
out
[2] = 
	`¡bi__blšn_8x8
(255 - out[2], 
m
);

3919 
out
 +ğ
n
;

3922 
z
->
	`YCbCr_to_RGB_k”Ãl
(
out
, 
y
, 
couut
[1], couut[2], z->
s
->
img_x
, 
n
);

3925 
i
=0; i < 
z
->
s
->
img_x
; ++i) {

3926 
out
[0] = out[1] = out[2] = 
y
[
i
];

3927 
out
[3] = 255;

3928 
out
 +ğ
n
;

3931 ià(
is_rgb
) {

3932 ià(
n
 == 1)

3933 
i
=0; i < 
z
->
s
->
img_x
; ++i)

3934 *
out
++ = 
	`¡bi__compu‹_y
(
couut
[0][
i
], coutput[1][i], coutput[2][i]);

3936 
i
=0; i < 
z
->
s
->
img_x
; ++i, 
out
 += 2) {

3937 
out
[0] = 
	`¡bi__compu‹_y
(
couut
[0][
i
], coutput[1][i], coutput[2][i]);

3938 
out
[1] = 255;

3941 } ià(
z
->
s
->
img_n
 =ğ4 && z->
­p14_cŞÜ_ŒªsfÜm
 == 0) {

3942 
i
=0; i < 
z
->
s
->
img_x
; ++i) {

3943 
¡bi_uc
 
m
 = 
couut
[3][
i
];

3944 
¡bi_uc
 
r
 = 
	`¡bi__blšn_8x8
(
couut
[0][
i
], 
m
);

3945 
¡bi_uc
 
g
 = 
	`¡bi__blšn_8x8
(
couut
[1][
i
], 
m
);

3946 
¡bi_uc
 
b
 = 
	`¡bi__blšn_8x8
(
couut
[2][
i
], 
m
);

3947 
out
[0] = 
	`¡bi__compu‹_y
(
r
, 
g
, 
b
);

3948 
out
[1] = 255;

3949 
out
 +ğ
n
;

3951 } ià(
z
->
s
->
img_n
 =ğ4 && z->
­p14_cŞÜ_ŒªsfÜm
 == 2) {

3952 
i
=0; i < 
z
->
s
->
img_x
; ++i) {

3953 
out
[0] = 
	`¡bi__blšn_8x8
(255 - 
couut
[0][
i
], coutput[3][i]);

3954 
out
[1] = 255;

3955 
out
 +ğ
n
;

3958 
¡bi_uc
 *
y
 = 
couut
[0];

3959 ià(
n
 == 1)

3960 
i
=0; i < 
z
->
s
->
img_x
; ++iè
out
[i] = 
y
[i];

3962 
i
=0; i < 
z
->
s
->
img_x
; ++iè{ *
out
++ = 
y
[i]; *out++ = 255; }

3966 
	`¡bi__ş—nup_j³g
(
z
);

3967 *
out_x
 = 
z
->
s
->
img_x
;

3968 *
out_y
 = 
z
->
s
->
img_y
;

3969 ià(
comp
è*com°ğ
z
->
s
->
img_n
 >= 3 ? 3 : 1;

3970  
ouut
;

3972 
	}
}

3974 *
	$¡bi__j³g_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
)

3976 * 
»suÉ
;

3977 
¡bi__j³g
* 
j
 = (¡bi__j³g*è
	`¡bi__m®loc
((stbi__jpeg));

3978 ià(!
j
è 
	`¡bi__”½uc
("outofmem", "Out of memory");

3979 
	`STBI_NOTUSED
(
ri
);

3980 
j
->
s
 = s;

3981 
	`¡bi__£tup_j³g
(
j
);

3982 
»suÉ
 = 
	`lßd_j³g_image
(
j
, 
x
,
y
,
comp
,
»q_comp
);

3983 
	`STBI_FREE
(
j
);

3984  
»suÉ
;

3985 
	}
}

3987 
	$¡bi__j³g_‹¡
(
¡bi__cÚ‹xt
 *
s
)

3989 
r
;

3990 
¡bi__j³g
* 
j
 = (¡bi__j³g*)
	`¡bi__m®loc
((stbi__jpeg));

3991 ià(!
j
è 
	`¡bi__”r
("outofmem", "Out of memory");

3992 
j
->
s
 = s;

3993 
	`¡bi__£tup_j³g
(
j
);

3994 
r
 = 
	`¡bi__decode_j³g_h—d”
(
j
, 
STBI__SCAN_ty³
);

3995 
	`¡bi__»wšd
(
s
);

3996 
	`STBI_FREE
(
j
);

3997  
r
;

3998 
	}
}

4000 
	$¡bi__j³g_šfo_¿w
(
¡bi__j³g
 *
j
, *
x
, *
y
, *
comp
)

4002 ià(!
	`¡bi__decode_j³g_h—d”
(
j
, 
STBI__SCAN_h—d”
)) {

4003 
	`¡bi__»wšd
Ğ
j
->
s
 );

4006 ià(
x
è*x = 
j
->
s
->
img_x
;

4007 ià(
y
è*y = 
j
->
s
->
img_y
;

4008 ià(
comp
è*com°ğ
j
->
s
->
img_n
 >= 3 ? 3 : 1;

4010 
	}
}

4012 
	$¡bi__j³g_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
)

4014 
»suÉ
;

4015 
¡bi__j³g
* 
j
 = (¡bi__j³g*è(
	`¡bi__m®loc
((stbi__jpeg)));

4016 ià(!
j
è 
	`¡bi__”r
("outofmem", "Out of memory");

4017 
j
->
s
 = s;

4018 
»suÉ
 = 
	`¡bi__j³g_šfo_¿w
(
j
, 
x
, 
y
, 
comp
);

4019 
	`STBI_FREE
(
j
);

4020  
»suÉ
;

4021 
	}
}

4031 #iâdeà
STBI_NO_ZLIB


4034 
	#STBI__ZFAST_BITS
 9

4035 
	#STBI__ZFAST_MASK
 ((1 << 
STBI__ZFAST_BITS
è- 1)

	)

4036 
	#STBI__ZNSYMS
 288

4037 

	)

4042 
¡bi__ušt16
 
	mç¡
[1 << 
STBI__ZFAST_BITS
];

4043 
¡bi__ušt16
 
	mfœ¡code
[16];

4044 
	mmaxcode
[17];

4045 
¡bi__ušt16
 
	mfœ¡symbŞ
[16];

4046 
¡bi_uc
 
	msize
[
STBI__ZNSYMS
];

4047 
¡bi__ušt16
 
	mv®ue
[
STBI__ZNSYMS
];

4048 } 
	t¡bi__zhuffmª
;

4050 
¡bi_šlše
 
	$¡bi__b™»v”£16
(
n
)

4052 
n
 = ((n & 0xAAAA) >> 1) | ((n & 0x5555) << 1);

4053 
n
 = ((n & 0xCCCC) >> 2) | ((n & 0x3333) << 2);

4054 
n
 = ((n & 0xF0F0) >> 4) | ((n & 0x0F0F) << 4);

4055 
n
 = ((n & 0xFF00) >> 8) | ((n & 0x00FF) << 8);

4056  
n
;

4057 
	}
}

4059 
¡bi_šlše
 
	$¡bi__b™_»v”£
(
v
, 
b™s
)

4061 
	`STBI_ASSERT
(
b™s
 <= 16);

4064  
	`¡bi__b™»v”£16
(
v
è>> (16-
b™s
);

4065 
	}
}

4067 
	$¡bi__zbud_huffmª
(
¡bi__zhuffmª
 *
z
, cÚ¡ 
¡bi_uc
 *
siz–i¡
, 
num
)

4069 
i
,
k
=0;

4070 
code
, 
Ãxt_code
[16], 
sizes
[17];

4073 
	`mem£t
(
sizes
, 0, (sizes));

4074 
	`mem£t
(
z
->
ç¡
, 0, (z->fast));

4075 
i
=0; i < 
num
; ++i)

4076 ++
sizes
[
siz–i¡
[
i
]];

4077 
sizes
[0] = 0;

4078 
i
=1; i < 16; ++i)

4079 ià(
sizes
[
i
] > (1 << i))

4080  
	`¡bi__”r
("bad sizes", "Corrupt PNG");

4081 
code
 = 0;

4082 
i
=1; i < 16; ++i) {

4083 
Ãxt_code
[
i
] = 
code
;

4084 
z
->
fœ¡code
[
i
] = (
¡bi__ušt16
è
code
;

4085 
z
->
fœ¡symbŞ
[
i
] = (
¡bi__ušt16
è
k
;

4086 
code
 = (cod+ 
sizes
[
i
]);

4087 ià(
sizes
[
i
])

4088 ià(
code
-1 >ğ(1 << 
i
)è 
	`¡bi__”r
("bad codelengths","Corrupt PNG");

4089 
z
->
maxcode
[
i
] = 
code
 << (16-i);

4090 
code
 <<= 1;

4091 
k
 +ğ
sizes
[
i
];

4093 
z
->
maxcode
[16] = 0x10000;

4094 
i
=0; i < 
num
; ++i) {

4095 
s
 = 
siz–i¡
[
i
];

4096 ià(
s
) {

4097 
c
 = 
Ãxt_code
[
s
] - 
z
->
fœ¡code
[s] + z->
fœ¡symbŞ
[s];

4098 
¡bi__ušt16
 
ç¡v
 = (¡bi__ušt16è((
s
 << 9è| 
i
);

4099 
z
->
size
 [
c
] = (
¡bi_uc
 ) 
s
;

4100 
z
->
v®ue
[
c
] = (
¡bi__ušt16
è
i
;

4101 ià(
s
 <ğ
STBI__ZFAST_BITS
) {

4102 
j
 = 
	`¡bi__b™_»v”£
(
Ãxt_code
[
s
],s);

4103 
j
 < (1 << 
STBI__ZFAST_BITS
)) {

4104 
z
->
ç¡
[
j
] = 
ç¡v
;

4105 
j
 +ğ(1 << 
s
);

4108 ++
Ãxt_code
[
s
];

4112 
	}
}

4122 
¡bi_uc
 *
	mzbufãr
, *
	mzbufãr_’d
;

4123 
	mnum_b™s
;

4124 
¡bi__ušt32
 
	mcode_bufãr
;

4126 *
	mzout
;

4127 *
	mzout_¡¬t
;

4128 *
	mzout_’d
;

4129 
	mz_ex·ndabË
;

4131 
¡bi__zhuffmª
 
	mz_Ëngth
, 
	mz_di¡ªû
;

4132 } 
	t¡bi__zbuf
;

4134 
¡bi_šlše
 
	$¡bi__zeof
(
¡bi__zbuf
 *
z
)

4136  (
z
->
zbufãr
 >ğz->
zbufãr_’d
);

4137 
	}
}

4139 
¡bi_šlše
 
¡bi_uc
 
	$¡bi__zg‘8
(
¡bi__zbuf
 *
z
)

4141  
	`¡bi__zeof
(
z
è? 0 : *z->
zbufãr
++;

4142 
	}
}

4144 
	$¡bi__fl_b™s
(
¡bi__zbuf
 *
z
)

4147 ià(
z
->
code_bufãr
 >ğ(1U << z->
num_b™s
)) {

4148 
z
->
zbufãr
 = z->
zbufãr_’d
;

4151 
z
->
code_bufãr
 |ğ(è
	`¡bi__zg‘8
(zè<< z->
num_b™s
;

4152 
z
->
num_b™s
 += 8;

4153 } 
z
->
num_b™s
 <= 24);

4154 
	}
}

4156 
¡bi_šlše
 
	$¡bi__z»ûive
(
¡bi__zbuf
 *
z
, 
n
)

4158 
k
;

4159 ià(
z
->
num_b™s
 < 
n
è
	`¡bi__fl_b™s
(z);

4160 
k
 = 
z
->
code_bufãr
 & ((1 << 
n
) - 1);

4161 
z
->
code_bufãr
 >>ğ
n
;

4162 
z
->
num_b™s
 -ğ
n
;

4163  
k
;

4164 
	}
}

4166 
	$¡bi__zhuffmª_decode_¦ow·th
(
¡bi__zbuf
 *
a
, 
¡bi__zhuffmª
 *
z
)

4168 
b
,
s
,
k
;

4171 
k
 = 
	`¡bi__b™_»v”£
(
a
->
code_bufãr
, 16);

4172 
s
=
STBI__ZFAST_BITS
+1; ; ++s)

4173 ià(
k
 < 
z
->
maxcode
[
s
])

4175 ià(
s
 >= 16)  -1;

4177 
b
 = (
k
 >> (16-
s
)è- 
z
->
fœ¡code
[s] + z->
fœ¡symbŞ
[s];

4178 ià(
b
 >ğ
STBI__ZNSYMS
)  -1;

4179 ià(
z
->
size
[
b
] !ğ
s
)  -1;

4180 
a
->
code_bufãr
 >>ğ
s
;

4181 
a
->
num_b™s
 -ğ
s
;

4182  
z
->
v®ue
[
b
];

4183 
	}
}

4185 
¡bi_šlše
 
	$¡bi__zhuffmª_decode
(
¡bi__zbuf
 *
a
, 
¡bi__zhuffmª
 *
z
)

4187 
b
,
s
;

4188 ià(
a
->
num_b™s
 < 16) {

4189 ià(
	`¡bi__zeof
(
a
)) {

4192 
	`¡bi__fl_b™s
(
a
);

4194 
b
 = 
z
->
ç¡
[
a
->
code_bufãr
 & 
STBI__ZFAST_MASK
];

4195 ià(
b
) {

4196 
s
 = 
b
 >> 9;

4197 
a
->
code_bufãr
 >>ğ
s
;

4198 
a
->
num_b™s
 -ğ
s
;

4199  
b
 & 511;

4201  
	`¡bi__zhuffmª_decode_¦ow·th
(
a
, 
z
);

4202 
	}
}

4204 
	$¡bi__zex·nd
(
¡bi__zbuf
 *
z
, *
zout
, 
n
)

4206 *
q
;

4207 
cur
, 
lim™
, 
Şd_lim™
;

4208 
z
->
zout
 = zout;

4209 ià(!
z
->
z_ex·ndabË
è 
	`¡bi__”r
("output buffer†imit","Corrupt PNG");

4210 
cur
 = (è(
z
->
zout
 - z->
zout_¡¬t
);

4211 
lim™
 = 
Şd_lim™
 = (è(
z
->
zout_’d
 - z->
zout_¡¬t
);

4212 ià(
UINT_MAX
 - 
cur
 < (è
n
è 
	`¡bi__”r
("outofmem", "Out of memory");

4213 
cur
 + 
n
 > 
lim™
) {

4214 if(
lim™
 > 
UINT_MAX
 / 2è 
	`¡bi__”r
("outofmem", "Out of memory");

4215 
lim™
 *= 2;

4217 
q
 = (*è
	`STBI_REALLOC_SIZED
(
z
->
zout_¡¬t
, 
Şd_lim™
, 
lim™
);

4218 
	`STBI_NOTUSED
(
Şd_lim™
);

4219 ià(
q
 =ğ
NULL
è 
	`¡bi__”r
("outofmem", "Out of memory");

4220 
z
->
zout_¡¬t
 = 
q
;

4221 
z
->
zout
 = 
q
 + 
cur
;

4222 
z
->
zout_’d
 = 
q
 + 
lim™
;

4224 
	}
}

4226 cÚ¡ 
	g¡bi__zËngth_ba£
[31] = {

4231 cÚ¡ 
	g¡bi__zËngth_exŒa
[31]=

4234 cÚ¡ 
	g¡bi__zdi¡_ba£
[32] = { 1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,

4237 cÚ¡ 
	g¡bi__zdi¡_exŒa
[32] =

4240 
	$¡bi__·r£_huffmª_block
(
¡bi__zbuf
 *
a
)

4242 *
zout
 = 
a
->zout;

4244 
z
 = 
	`¡bi__zhuffmª_decode
(
a
, &a->
z_Ëngth
);

4245 ià(
z
 < 256) {

4246 ià(
z
 < 0è 
	`¡bi__”r
("bad huffman code","Corrupt PNG");

4247 ià(
zout
 >ğ
a
->
zout_’d
) {

4248 ià(!
	`¡bi__zex·nd
(
a
, 
zout
, 1))  0;

4249 
zout
 = 
a
->zout;

4251 *
zout
++ = (è
z
;

4253 
¡bi_uc
 *
p
;

4254 
Ën
,
di¡
;

4255 ià(
z
 == 256) {

4256 
a
->
zout
 = zout;

4259 
z
 -= 257;

4260 
Ën
 = 
¡bi__zËngth_ba£
[
z
];

4261 ià(
¡bi__zËngth_exŒa
[
z
]è
Ën
 +ğ
	`¡bi__z»ûive
(
a
, stbi__zlength_extra[z]);

4262 
z
 = 
	`¡bi__zhuffmª_decode
(
a
, &a->
z_di¡ªû
);

4263 ià(
z
 < 0è 
	`¡bi__”r
("bad huffman code","Corrupt PNG");

4264 
di¡
 = 
¡bi__zdi¡_ba£
[
z
];

4265 ià(
¡bi__zdi¡_exŒa
[
z
]è
di¡
 +ğ
	`¡bi__z»ûive
(
a
, stbi__zdist_extra[z]);

4266 ià(
zout
 - 
a
->
zout_¡¬t
 < 
di¡
è 
	`¡bi__”r
("bad dist","Corrupt PNG");

4267 ià(
zout
 + 
Ën
 > 
a
->
zout_’d
) {

4268 ià(!
	`¡bi__zex·nd
(
a
, 
zout
, 
Ën
))  0;

4269 
zout
 = 
a
->zout;

4271 
p
 = (
¡bi_uc
 *è(
zout
 - 
di¡
);

4272 ià(
di¡
 == 1) {

4273 
¡bi_uc
 
v
 = *
p
;

4274 ià(
Ën
è{ dØ*
zout
++ = 
v
; --len); }

4276 ià(
Ën
è{ dØ*
zout
++ = *
p
++; --len); }

4280 
	}
}

4282 
	$¡bi__compu‹_huffmª_codes
(
¡bi__zbuf
 *
a
)

4284 cÚ¡ 
¡bi_uc
 
Ëngth_dezigzag
[19] = { 16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15 };

4285 
¡bi__zhuffmª
 
z_cod–’gth
;

4286 
¡bi_uc
 
Ëncodes
[286+32+137];

4287 
¡bi_uc
 
cod–’gth_sizes
[19];

4288 
i
,
n
;

4290 
hl™
 = 
	`¡bi__z»ûive
(
a
,5) + 257;

4291 
hdi¡
 = 
	`¡bi__z»ûive
(
a
,5) + 1;

4292 
hş’
 = 
	`¡bi__z»ûive
(
a
,4) + 4;

4293 
ÁÙ
 = 
hl™
 + 
hdi¡
;

4295 
	`mem£t
(
cod–’gth_sizes
, 0, (codelength_sizes));

4296 
i
=0; i < 
hş’
; ++i) {

4297 
s
 = 
	`¡bi__z»ûive
(
a
,3);

4298 
cod–’gth_sizes
[
Ëngth_dezigzag
[
i
]] = (
¡bi_uc
è
s
;

4300 ià(!
	`¡bi__zbud_huffmª
(&
z_cod–’gth
, 
cod–’gth_sizes
, 19))  0;

4302 
n
 = 0;

4303 
n
 < 
ÁÙ
) {

4304 
c
 = 
	`¡bi__zhuffmª_decode
(
a
, &
z_cod–’gth
);

4305 ià(
c
 < 0 || c >ğ19è 
	`¡bi__”r
("bad codelengths", "Corrupt PNG");

4306 ià(
c
 < 16)

4307 
Ëncodes
[
n
++] = (
¡bi_uc
è
c
;

4309 
¡bi_uc
 
fl
 = 0;

4310 ià(
c
 == 16) {

4311 
c
 = 
	`¡bi__z»ûive
(
a
,2)+3;

4312 ià(
n
 =ğ0è 
	`¡bi__”r
("bad codelengths", "Corrupt PNG");

4313 
fl
 = 
Ëncodes
[
n
-1];

4314 } ià(
c
 == 17) {

4315 
c
 = 
	`¡bi__z»ûive
(
a
,3)+3;

4316 } ià(
c
 == 18) {

4317 
c
 = 
	`¡bi__z»ûive
(
a
,7)+11;

4319  
	`¡bi__”r
("bad codelengths", "Corrupt PNG");

4321 ià(
ÁÙ
 - 
n
 < 
c
è 
	`¡bi__”r
("bad codelengths", "Corrupt PNG");

4322 
	`mem£t
(
Ëncodes
+
n
, 
fl
, 
c
);

4323 
n
 +ğ
c
;

4326 ià(
n
 !ğ
ÁÙ
è 
	`¡bi__”r
("bad codelengths","Corrupt PNG");

4327 ià(!
	`¡bi__zbud_huffmª
(&
a
->
z_Ëngth
, 
Ëncodes
, 
hl™
))  0;

4328 ià(!
	`¡bi__zbud_huffmª
(&
a
->
z_di¡ªû
, 
Ëncodes
+
hl™
, 
hdi¡
))  0;

4330 
	}
}

4332 
	$¡bi__·r£_uncom´es£d_block
(
¡bi__zbuf
 *
a
)

4334 
¡bi_uc
 
h—d”
[4];

4335 
Ën
,
Æ’
,
k
;

4336 ià(
a
->
num_b™s
 & 7)

4337 
	`¡bi__z»ûive
(
a
,‡->
num_b™s
 & 7);

4339 
k
 = 0;

4340 
a
->
num_b™s
 > 0) {

4341 
h—d”
[
k
++] = (
¡bi_uc
è(
a
->
code_bufãr
 & 255);

4342 
a
->
code_bufãr
 >>= 8;

4343 
a
->
num_b™s
 -= 8;

4345 ià(
a
->
num_b™s
 < 0è 
	`¡bi__”r
("zlib corrupt","Corrupt PNG");

4347 
k
 < 4)

4348 
h—d”
[
k
++] = 
	`¡bi__zg‘8
(
a
);

4349 
Ën
 = 
h—d”
[1] * 256 + header[0];

4350 
Æ’
 = 
h—d”
[3] * 256 + header[2];

4351 ià(
Æ’
 !ğ(
Ën
 ^ 0xffff)è 
	`¡bi__”r
("zlib corrupt","Corrupt PNG");

4352 ià(
a
->
zbufãr
 + 
Ën
 >‡->
zbufãr_’d
è 
	`¡bi__”r
("read…ast buffer","Corrupt PNG");

4353 ià(
a
->
zout
 + 
Ën
 >‡->
zout_’d
)

4354 ià(!
	`¡bi__zex·nd
(
a
,‡->
zout
, 
Ën
))  0;

4355 
	`memıy
(
a
->
zout
,‡->
zbufãr
, 
Ën
);

4356 
a
->
zbufãr
 +ğ
Ën
;

4357 
a
->
zout
 +ğ
Ën
;

4359 
	}
}

4361 
	$¡bi__·r£_zlib_h—d”
(
¡bi__zbuf
 *
a
)

4363 
cmf
 = 
	`¡bi__zg‘8
(
a
);

4364 
cm
 = 
cmf
 & 15;

4366 
æg
 = 
	`¡bi__zg‘8
(
a
);

4367 ià(
	`¡bi__zeof
(
a
)è 
	`¡bi__”r
("bad zlib header","Corrupt PNG");

4368 ià((
cmf
*256+
æg
è% 31 !ğ0è 
	`¡bi__”r
("bad zlib header","Corrupt PNG");

4369 ià(
æg
 & 32è 
	`¡bi__”r
("no…reset dict","Corrupt PNG");

4370 ià(
cm
 !ğ8è 
	`¡bi__”r
("bad compression","Corrupt PNG");

4373 
	}
}

4375 cÚ¡ 
¡bi_uc
 
	g¡bi__zdeçuÉ_Ëngth
[
STBI__ZNSYMS
] =

4387 cÚ¡ 
¡bi_uc
 
	g¡bi__zdeçuÉ_di¡ªû
[32] =

4404 
	$¡bi__·r£_zlib
(
¡bi__zbuf
 *
a
, 
·r£_h—d”
)

4406 
fš®
, 
ty³
;

4407 ià(
·r£_h—d”
)

4408 ià(!
	`¡bi__·r£_zlib_h—d”
(
a
))  0;

4409 
a
->
num_b™s
 = 0;

4410 
a
->
code_bufãr
 = 0;

4412 
fš®
 = 
	`¡bi__z»ûive
(
a
,1);

4413 
ty³
 = 
	`¡bi__z»ûive
(
a
,2);

4414 ià(
ty³
 == 0) {

4415 ià(!
	`¡bi__·r£_uncom´es£d_block
(
a
))  0;

4416 } ià(
ty³
 == 3) {

4419 ià(
ty³
 == 1) {

4421 ià(!
	`¡bi__zbud_huffmª
(&
a
->
z_Ëngth
 , 
¡bi__zdeçuÉ_Ëngth
 , 
STBI__ZNSYMS
))  0;

4422 ià(!
	`¡bi__zbud_huffmª
(&
a
->
z_di¡ªû
, 
¡bi__zdeçuÉ_di¡ªû
, 32))  0;

4424 ià(!
	`¡bi__compu‹_huffmª_codes
(
a
))  0;

4426 ià(!
	`¡bi__·r£_huffmª_block
(
a
))  0;

4428 } !
fš®
);

4430 
	}
}

4432 
	$¡bi__do_zlib
(
¡bi__zbuf
 *
a
, *
obuf
, 
Ş’
, 
exp
, 
·r£_h—d”
)

4434 
a
->
zout_¡¬t
 = 
obuf
;

4435 
a
->
zout
 = 
obuf
;

4436 
a
->
zout_’d
 = 
obuf
 + 
Ş’
;

4437 
a
->
z_ex·ndabË
 = 
exp
;

4439  
	`¡bi__·r£_zlib
(
a
, 
·r£_h—d”
);

4440 
	}
}

4442 
STBIDEF
 *
	$¡bi_zlib_decode_m®loc_guesssize
(cÚ¡ *
bufãr
, 
Ën
, 
š™Ÿl_size
, *
ou’
)

4444 
¡bi__zbuf
 
a
;

4445 *
p
 = (*è
	`¡bi__m®loc
(
š™Ÿl_size
);

4446 ià(
p
 =ğ
NULL
)  NULL;

4447 
a
.
zbufãr
 = (
¡bi_uc
 *è
bufãr
;

4448 
a
.
zbufãr_’d
 = (
¡bi_uc
 *è
bufãr
 + 
Ën
;

4449 ià(
	`¡bi__do_zlib
(&
a
, 
p
, 
š™Ÿl_size
, 1, 1)) {

4450 ià(
ou’
è*ou’ = (è(
a
.
zout
 -‡.
zout_¡¬t
);

4451  
a
.
zout_¡¬t
;

4453 
	`STBI_FREE
(
a
.
zout_¡¬t
);

4454  
NULL
;

4456 
	}
}

4458 
STBIDEF
 *
	$¡bi_zlib_decode_m®loc
(cÚ¡ *
bufãr
, 
Ën
, *
ou’
)

4460  
	`¡bi_zlib_decode_m®loc_guesssize
(
bufãr
, 
Ën
, 16384, 
ou’
);

4461 
	}
}

4463 
STBIDEF
 *
	$¡bi_zlib_decode_m®loc_guesssize_h—d”æag
(cÚ¡ *
bufãr
, 
Ën
, 
š™Ÿl_size
, *
ou’
, 
·r£_h—d”
)

4465 
¡bi__zbuf
 
a
;

4466 *
p
 = (*è
	`¡bi__m®loc
(
š™Ÿl_size
);

4467 ià(
p
 =ğ
NULL
)  NULL;

4468 
a
.
zbufãr
 = (
¡bi_uc
 *è
bufãr
;

4469 
a
.
zbufãr_’d
 = (
¡bi_uc
 *è
bufãr
 + 
Ën
;

4470 ià(
	`¡bi__do_zlib
(&
a
, 
p
, 
š™Ÿl_size
, 1, 
·r£_h—d”
)) {

4471 ià(
ou’
è*ou’ = (è(
a
.
zout
 -‡.
zout_¡¬t
);

4472  
a
.
zout_¡¬t
;

4474 
	`STBI_FREE
(
a
.
zout_¡¬t
);

4475  
NULL
;

4477 
	}
}

4479 
STBIDEF
 
	$¡bi_zlib_decode_bufãr
(*
obufãr
, 
Ş’
, cÚ¡ *
ibufãr
, 
’
)

4481 
¡bi__zbuf
 
a
;

4482 
a
.
zbufãr
 = (
¡bi_uc
 *è
ibufãr
;

4483 
a
.
zbufãr_’d
 = (
¡bi_uc
 *è
ibufãr
 + 
’
;

4484 ià(
	`¡bi__do_zlib
(&
a
, 
obufãr
, 
Ş’
, 0, 1))

4485  (è(
a
.
zout
 -‡.
zout_¡¬t
);

4488 
	}
}

4490 
STBIDEF
 *
	$¡bi_zlib_decode_noh—d”_m®loc
(cÚ¡ *
bufãr
, 
Ën
, *
ou’
)

4492 
¡bi__zbuf
 
a
;

4493 *
p
 = (*è
	`¡bi__m®loc
(16384);

4494 ià(
p
 =ğ
NULL
)  NULL;

4495 
a
.
zbufãr
 = (
¡bi_uc
 *è
bufãr
;

4496 
a
.
zbufãr_’d
 = (
¡bi_uc
 *è
bufãr
+
Ën
;

4497 ià(
	`¡bi__do_zlib
(&
a
, 
p
, 16384, 1, 0)) {

4498 ià(
ou’
è*ou’ = (è(
a
.
zout
 -‡.
zout_¡¬t
);

4499  
a
.
zout_¡¬t
;

4501 
	`STBI_FREE
(
a
.
zout_¡¬t
);

4502  
NULL
;

4504 
	}
}

4506 
STBIDEF
 
	$¡bi_zlib_decode_noh—d”_bufãr
(*
obufãr
, 
Ş’
, cÚ¡ *
ibufãr
, 
’
)

4508 
¡bi__zbuf
 
a
;

4509 
a
.
zbufãr
 = (
¡bi_uc
 *è
ibufãr
;

4510 
a
.
zbufãr_’d
 = (
¡bi_uc
 *è
ibufãr
 + 
’
;

4511 ià(
	`¡bi__do_zlib
(&
a
, 
obufãr
, 
Ş’
, 0, 0))

4512  (è(
a
.
zout
 -‡.
zout_¡¬t
);

4515 
	}
}

4528 #iâdeà
STBI_NO_PNG


4531 
¡bi__ušt32
 
	mËngth
;

4532 
¡bi__ušt32
 
	mty³
;

4533 } 
	t¡bi__²gchunk
;

4535 
¡bi__²gchunk
 
	$¡bi__g‘_chunk_h—d”
(
¡bi__cÚ‹xt
 *
s
)

4537 
¡bi__²gchunk
 
c
;

4538 
c
.
Ëngth
 = 
	`¡bi__g‘32be
(
s
);

4539 
c
.
ty³
 = 
	`¡bi__g‘32be
(
s
);

4540  
c
;

4541 
	}
}

4543 
	$¡bi__check_²g_h—d”
(
¡bi__cÚ‹xt
 *
s
)

4545 cÚ¡ 
¡bi_uc
 
²g_sig
[8] = { 137,80,78,71,13,10,26,10 };

4546 
i
;

4547 
i
=0; i < 8; ++i)

4548 ià(
	`¡bi__g‘8
(
s
è!ğ
²g_sig
[
i
]è 
	`¡bi__”r
("bad…ng sig","Not‡ PNG");

4550 
	}
}

4554 
¡bi__cÚ‹xt
 *
	ms
;

4555 
¡bi_uc
 *
	mid©a
, *
	mex·nded
, *
	mout
;

4556 
	md•th
;

4557 } 
	t¡bi__²g
;

4561 
	mSTBI__F_nÚe
=0,

4562 
	mSTBI__F_sub
=1,

4563 
	mSTBI__F_up
=2,

4564 
	mSTBI__F_avg
=3,

4565 
	mSTBI__F_·‘h
=4,

4567 
	mSTBI__F_avg_fœ¡
,

4568 
	mSTBI__F_·‘h_fœ¡


4571 
¡bi_uc
 
	gfœ¡_row_f‹r
[5] =

4573 
STBI__F_nÚe
,

4574 
STBI__F_sub
,

4575 
STBI__F_nÚe
,

4576 
STBI__F_avg_fœ¡
,

4577 
STBI__F_·‘h_fœ¡


4580 
	$¡bi__·‘h
(
a
, 
b
, 
c
)

4582 
p
 = 
a
 + 
b
 - 
c
;

4583 
·
 = 
	`abs
(
p
-
a
);

4584 
pb
 = 
	`abs
(
p
-
b
);

4585 
pc
 = 
	`abs
(
p
-
c
);

4586 ià(
·
 <ğ
pb
 &&…¨<ğ
pc
è 
a
;

4587 ià(
pb
 <ğ
pc
è 
b
;

4588  
c
;

4589 
	}
}

4591 cÚ¡ 
¡bi_uc
 
	g¡bi__d•th_sÿË_bË
[9] = { 0, 0xff, 0x55, 0, 0x11, 0,0,0, 0x01 };

4594 
	$¡bi__ü—‹_²g_image_¿w
(
¡bi__²g
 *
a
, 
¡bi_uc
 *
¿w
, 
¡bi__ušt32
 
¿w_Ën
, 
out_n
, stbi__ušt32 
x
, stbi__ušt32 
y
, 
d•th
, 
cŞÜ
)

4596 
by‹s
 = (
d•th
 == 16? 2 : 1);

4597 
¡bi__cÚ‹xt
 *
s
 = 
a
->s;

4598 
¡bi__ušt32
 
i
,
j
,
¡ride
 = 
x
*
out_n
*
by‹s
;

4599 
¡bi__ušt32
 
img_Ën
, 
img_width_by‹s
;

4600 
k
;

4601 
img_n
 = 
s
->img_n;

4603 
ouut_by‹s
 = 
out_n
*
by‹s
;

4604 
f‹r_by‹s
 = 
img_n
*
by‹s
;

4605 
width
 = 
x
;

4607 
	`STBI_ASSERT
(
out_n
 =ğ
s
->
img_n
 || out_n == s->img_n+1);

4608 
a
->
out
 = (
¡bi_uc
 *è
	`¡bi__m®loc_mad3
(
x
, 
y
, 
ouut_by‹s
, 0);

4609 ià(!
a
->
out
è 
	`¡bi__”r
("outofmem", "Out of memory");

4611 ià(!
	`¡bi__mad3sizes_v®id
(
img_n
, 
x
, 
d•th
, 7)è 
	`¡bi__”r
("too†arge", "Corrupt PNG");

4612 
img_width_by‹s
 = (((
img_n
 * 
x
 * 
d•th
) + 7) >> 3);

4613 
img_Ën
 = (
img_width_by‹s
 + 1è* 
y
;

4618 ià(
¿w_Ën
 < 
img_Ën
è 
	`¡bi__”r
("notƒnough…ixels","Corrupt PNG");

4620 
j
=0; j < 
y
; ++j) {

4621 
¡bi_uc
 *
cur
 = 
a
->
out
 + 
¡ride
*
j
;

4622 
¡bi_uc
 *
´iÜ
;

4623 
f‹r
 = *
¿w
++;

4625 ià(
f‹r
 > 4)

4626  
	`¡bi__”r
("invalid filter","Corrupt PNG");

4628 ià(
d•th
 < 8) {

4629 ià(
img_width_by‹s
 > 
x
è 
	`¡bi__”r
("invalid width","Corrupt PNG");

4630 
cur
 +ğ
x
*
out_n
 - 
img_width_by‹s
;

4631 
f‹r_by‹s
 = 1;

4632 
width
 = 
img_width_by‹s
;

4634 
´iÜ
 = 
cur
 - 
¡ride
;

4637 ià(
j
 =ğ0è
f‹r
 = 
fœ¡_row_f‹r
[filter];

4640 
k
=0; k < 
f‹r_by‹s
; ++k) {

4641 
f‹r
) {

4642 
STBI__F_nÚe
 : 
cur
[
k
] = 
¿w
[k]; ;

4643 
STBI__F_sub
 : 
cur
[
k
] = 
¿w
[k]; ;

4644 
STBI__F_up
 : 
cur
[
k
] = 
	`STBI__BYTECAST
(
¿w
[k] + 
´iÜ
[k]); ;

4645 
STBI__F_avg
 : 
cur
[
k
] = 
	`STBI__BYTECAST
(
¿w
[k] + (
´iÜ
[k]>>1)); ;

4646 
STBI__F_·‘h
 : 
cur
[
k
] = 
	`STBI__BYTECAST
(
¿w
[k] + 
	`¡bi__·‘h
(0,
´iÜ
[k],0)); ;

4647 
STBI__F_avg_fœ¡
 : 
cur
[
k
] = 
¿w
[k]; ;

4648 
STBI__F_·‘h_fœ¡
: 
cur
[
k
] = 
¿w
[k]; ;

4652 ià(
d•th
 == 8) {

4653 ià(
img_n
 !ğ
out_n
)

4654 
cur
[
img_n
] = 255;

4655 
¿w
 +ğ
img_n
;

4656 
cur
 +ğ
out_n
;

4657 
´iÜ
 +ğ
out_n
;

4658 } ià(
d•th
 == 16) {

4659 ià(
img_n
 !ğ
out_n
) {

4660 
cur
[
f‹r_by‹s
] = 255;

4661 
cur
[
f‹r_by‹s
+1] = 255;

4663 
¿w
 +ğ
f‹r_by‹s
;

4664 
cur
 +ğ
ouut_by‹s
;

4665 
´iÜ
 +ğ
ouut_by‹s
;

4667 
¿w
 += 1;

4668 
cur
 += 1;

4669 
´iÜ
 += 1;

4673 ià(
d•th
 < 8 || 
img_n
 =ğ
out_n
) {

4674 
nk
 = (
width
 - 1)*
f‹r_by‹s
;

4675 
	#STBI__CASE
(
f
) \

4676 
f
: \

4677 
k
=0; k < 
nk
; ++k)

	)

4678 
f‹r
) {

4680 
STBI__F_nÚe
: 
	`memıy
(
cur
, 
¿w
, 
nk
); ;

4681 
	`STBI__CASE
(
STBI__F_sub
è{ 
cur
[
k
] = 
	`STBI__BYTECAST
(
¿w
[k] + cur[k-
f‹r_by‹s
]); } ;

4682 
	`STBI__CASE
(
STBI__F_up
è{ 
cur
[
k
] = 
	`STBI__BYTECAST
(
¿w
[k] + 
´iÜ
[k]); } ;

4683 
	`STBI__CASE
(
STBI__F_avg
è{ 
cur
[
k
] = 
	`STBI__BYTECAST
(
¿w
[k] + ((
´iÜ
[k] + cur[k-
f‹r_by‹s
])>>1)); } ;

4684 
	`STBI__CASE
(
STBI__F_·‘h
è{ 
cur
[
k
] = 
	`STBI__BYTECAST
(
¿w
[k] + 
	`¡bi__·‘h
(cur[k-
f‹r_by‹s
],
´iÜ
[k],prior[k-filter_bytes])); } ;

4685 
	`STBI__CASE
(
STBI__F_avg_fœ¡
è{ 
cur
[
k
] = 
	`STBI__BYTECAST
(
¿w
[k] + (cur[k-
f‹r_by‹s
] >> 1)); } ;

4686 
	`STBI__CASE
(
STBI__F_·‘h_fœ¡
è{ 
cur
[
k
] = 
	`STBI__BYTECAST
(
¿w
[k] + 
	`¡bi__·‘h
(cur[k-
f‹r_by‹s
],0,0)); } ;

4688 #undeà
STBI__CASE


4689 
¿w
 +ğ
nk
;

4691 
	`STBI_ASSERT
(
img_n
+1 =ğ
out_n
);

4692 
	#STBI__CASE
(
f
) \

4693 
f
: \

4694 
i
=
x
-1; i >ğ1; --i, 
cur
[
f‹r_by‹s
]=255,
¿w
+=f‹r_by‹s,cur+=
ouut_by‹s
,
´iÜ
+=output_bytes) \

4695 
k
=0; k < 
f‹r_by‹s
; ++k)

	)

4696 
f‹r
) {

4697 
	`STBI__CASE
(
STBI__F_nÚe
è{ 
cur
[
k
] = 
¿w
[k]; } ;

4698 
	`STBI__CASE
(
STBI__F_sub
è{ 
cur
[
k
] = 
	`STBI__BYTECAST
(
¿w
[k] + cur[k- 
ouut_by‹s
]); } ;

4699 
	`STBI__CASE
(
STBI__F_up
è{ 
cur
[
k
] = 
	`STBI__BYTECAST
(
¿w
[k] + 
´iÜ
[k]); } ;

4700 
	`STBI__CASE
(
STBI__F_avg
è{ 
cur
[
k
] = 
	`STBI__BYTECAST
(
¿w
[k] + ((
´iÜ
[k] + cur[k- 
ouut_by‹s
])>>1)); } ;

4701 
	`STBI__CASE
(
STBI__F_·‘h
è{ 
cur
[
k
] = 
	`STBI__BYTECAST
(
¿w
[k] + 
	`¡bi__·‘h
(cur[k- 
ouut_by‹s
],
´iÜ
[k],prior[k- output_bytes])); } ;

4702 
	`STBI__CASE
(
STBI__F_avg_fœ¡
è{ 
cur
[
k
] = 
	`STBI__BYTECAST
(
¿w
[k] + (cur[k- 
ouut_by‹s
] >> 1)); } ;

4703 
	`STBI__CASE
(
STBI__F_·‘h_fœ¡
è{ 
cur
[
k
] = 
	`STBI__BYTECAST
(
¿w
[k] + 
	`¡bi__·‘h
(cur[k- 
ouut_by‹s
],0,0)); } ;

4705 #undeà
STBI__CASE


4709 ià(
d•th
 == 16) {

4710 
cur
 = 
a
->
out
 + 
¡ride
*
j
;

4711 
i
=0; i < 
x
; ++i,
cur
+=
ouut_by‹s
) {

4712 
cur
[
f‹r_by‹s
+1] = 255;

4721 ià(
d•th
 < 8) {

4722 
j
=0; j < 
y
; ++j) {

4723 
¡bi_uc
 *
cur
 = 
a
->
out
 + 
¡ride
*
j
;

4724 
¡bi_uc
 *
š
 = 
a
->
out
 + 
¡ride
*
j
 + 
x
*
out_n
 - 
img_width_by‹s
;

4727 
¡bi_uc
 
sÿË
 = (
cŞÜ
 =ğ0è? 
¡bi__d•th_sÿË_bË
[
d•th
] : 1;

4735 ià(
d•th
 == 4) {

4736 
k
=
x
*
img_n
; k >ğ2; k-=2, ++
š
) {

4737 *
cur
++ = 
sÿË
 * ((*
š
 >> 4) );

4738 *
cur
++ = 
sÿË
 * ((*
š
 ) & 0x0f);

4740 ià(
k
 > 0è*
cur
++ = 
sÿË
 * ((*
š
 >> 4) );

4741 } ià(
d•th
 == 2) {

4742 
k
=
x
*
img_n
; k >ğ4; k-=4, ++
š
) {

4743 *
cur
++ = 
sÿË
 * ((*
š
 >> 6) );

4744 *
cur
++ = 
sÿË
 * ((*
š
 >> 4) & 0x03);

4745 *
cur
++ = 
sÿË
 * ((*
š
 >> 2) & 0x03);

4746 *
cur
++ = 
sÿË
 * ((*
š
 ) & 0x03);

4748 ià(
k
 > 0è*
cur
++ = 
sÿË
 * ((*
š
 >> 6) );

4749 ià(
k
 > 1è*
cur
++ = 
sÿË
 * ((*
š
 >> 4) & 0x03);

4750 ià(
k
 > 2è*
cur
++ = 
sÿË
 * ((*
š
 >> 2) & 0x03);

4751 } ià(
d•th
 == 1) {

4752 
k
=
x
*
img_n
; k >ğ8; k-=8, ++
š
) {

4753 *
cur
++ = 
sÿË
 * ((*
š
 >> 7) );

4754 *
cur
++ = 
sÿË
 * ((*
š
 >> 6) & 0x01);

4755 *
cur
++ = 
sÿË
 * ((*
š
 >> 5) & 0x01);

4756 *
cur
++ = 
sÿË
 * ((*
š
 >> 4) & 0x01);

4757 *
cur
++ = 
sÿË
 * ((*
š
 >> 3) & 0x01);

4758 *
cur
++ = 
sÿË
 * ((*
š
 >> 2) & 0x01);

4759 *
cur
++ = 
sÿË
 * ((*
š
 >> 1) & 0x01);

4760 *
cur
++ = 
sÿË
 * ((*
š
 ) & 0x01);

4762 ià(
k
 > 0è*
cur
++ = 
sÿË
 * ((*
š
 >> 7) );

4763 ià(
k
 > 1è*
cur
++ = 
sÿË
 * ((*
š
 >> 6) & 0x01);

4764 ià(
k
 > 2è*
cur
++ = 
sÿË
 * ((*
š
 >> 5) & 0x01);

4765 ià(
k
 > 3è*
cur
++ = 
sÿË
 * ((*
š
 >> 4) & 0x01);

4766 ià(
k
 > 4è*
cur
++ = 
sÿË
 * ((*
š
 >> 3) & 0x01);

4767 ià(
k
 > 5è*
cur
++ = 
sÿË
 * ((*
š
 >> 2) & 0x01);

4768 ià(
k
 > 6è*
cur
++ = 
sÿË
 * ((*
š
 >> 1) & 0x01);

4770 ià(
img_n
 !ğ
out_n
) {

4771 
q
;

4773 
cur
 = 
a
->
out
 + 
¡ride
*
j
;

4774 ià(
img_n
 == 1) {

4775 
q
=
x
-1; q >= 0; --q) {

4776 
cur
[
q
*2+1] = 255;

4777 
cur
[
q
*2+0] = cur[q];

4780 
	`STBI_ASSERT
(
img_n
 == 3);

4781 
q
=
x
-1; q >= 0; --q) {

4782 
cur
[
q
*4+3] = 255;

4783 
cur
[
q
*4+2] = cur[q*3+2];

4784 
cur
[
q
*4+1] = cur[q*3+1];

4785 
cur
[
q
*4+0] = cur[q*3+0];

4790 } ià(
d•th
 == 16) {

4795 
¡bi_uc
 *
cur
 = 
a
->
out
;

4796 
¡bi__ušt16
 *
cur16
 = (¡bi__ušt16*)
cur
;

4798 
i
=0; i < 
x
*
y
*
out_n
; ++i,
cur16
++,
cur
+=2) {

4799 *
cur16
 = (
cur
[0] << 8) | cur[1];

4804 
	}
}

4806 
	$¡bi__ü—‹_²g_image
(
¡bi__²g
 *
a
, 
¡bi_uc
 *
image_d©a
, 
¡bi__ušt32
 
image_d©a_Ën
, 
out_n
, 
d•th
, 
cŞÜ
, 
š‹¾aûd
)

4808 
by‹s
 = (
d•th
 == 16 ? 2 : 1);

4809 
out_by‹s
 = 
out_n
 * 
by‹s
;

4810 
¡bi_uc
 *
fš®
;

4811 
p
;

4812 ià(!
š‹¾aûd
)

4813  
	`¡bi__ü—‹_²g_image_¿w
(
a
, 
image_d©a
, 
image_d©a_Ën
, 
out_n
,‡->
s
->
img_x
,‡->s->
img_y
, 
d•th
, 
cŞÜ
);

4816 
fš®
 = (
¡bi_uc
 *è
	`¡bi__m®loc_mad3
(
a
->
s
->
img_x
,‡->s->
img_y
, 
out_by‹s
, 0);

4817 ià(!
fš®
è 
	`¡bi__”r
("outofmem", "Out of memory");

4818 
p
=0;… < 7; ++p) {

4819 
xÜig
[] = { 0,4,0,2,0,1,0 };

4820 
yÜig
[] = { 0,0,4,0,2,0,1 };

4821 
x¥c
[] = { 8,8,4,4,2,2,1 };

4822 
y¥c
[] = { 8,8,8,4,4,2,2 };

4823 
i
,
j
,
x
,
y
;

4825 
x
 = (
a
->
s
->
img_x
 - 
xÜig
[
p
] + 
x¥c
[p]-1) / xspc[p];

4826 
y
 = (
a
->
s
->
img_y
 - 
yÜig
[
p
] + 
y¥c
[p]-1) / yspc[p];

4827 ià(
x
 && 
y
) {

4828 
¡bi__ušt32
 
img_Ën
 = ((((
a
->
s
->
img_n
 * 
x
 * 
d•th
è+ 7è>> 3è+ 1è* 
y
;

4829 ià(!
	`¡bi__ü—‹_²g_image_¿w
(
a
, 
image_d©a
, 
image_d©a_Ën
, 
out_n
, 
x
, 
y
, 
d•th
, 
cŞÜ
)) {

4830 
	`STBI_FREE
(
fš®
);

4833 
j
=0; j < 
y
; ++j) {

4834 
i
=0; i < 
x
; ++i) {

4835 
out_y
 = 
j
*
y¥c
[
p
]+
yÜig
[p];

4836 
out_x
 = 
i
*
x¥c
[
p
]+
xÜig
[p];

4837 
	`memıy
(
fš®
 + 
out_y
*
a
->
s
->
img_x
*
out_by‹s
 + 
out_x
*out_bytes,

4838 
a
->
out
 + (
j
*
x
+
i
)*
out_by‹s
, out_bytes);

4841 
	`STBI_FREE
(
a
->
out
);

4842 
image_d©a
 +ğ
img_Ën
;

4843 
image_d©a_Ën
 -ğ
img_Ën
;

4846 
a
->
out
 = 
fš®
;

4849 
	}
}

4851 
	$¡bi__compu‹_Œª¥¬’cy
(
¡bi__²g
 *
z
, 
¡bi_uc
 
tc
[3], 
out_n
)

4853 
¡bi__cÚ‹xt
 *
s
 = 
z
->s;

4854 
¡bi__ušt32
 
i
, 
pix–_couÁ
 = 
s
->
img_x
 * s->
img_y
;

4855 
¡bi_uc
 *
p
 = 
z
->
out
;

4859 
	`STBI_ASSERT
(
out_n
 == 2 || out_n == 4);

4861 ià(
out_n
 == 2) {

4862 
i
=0; i < 
pix–_couÁ
; ++i) {

4863 
p
[1] = (p[0] =ğ
tc
[0] ? 0 : 255);

4864 
p
 += 2;

4867 
i
=0; i < 
pix–_couÁ
; ++i) {

4868 ià(
p
[0] =ğ
tc
[0] &&…[1] ==c[1] &&…[2] ==c[2])

4869 
p
[3] = 0;

4870 
p
 += 4;

4874 
	}
}

4876 
	$¡bi__compu‹_Œª¥¬’cy16
(
¡bi__²g
 *
z
, 
¡bi__ušt16
 
tc
[3], 
out_n
)

4878 
¡bi__cÚ‹xt
 *
s
 = 
z
->s;

4879 
¡bi__ušt32
 
i
, 
pix–_couÁ
 = 
s
->
img_x
 * s->
img_y
;

4880 
¡bi__ušt16
 *
p
 = (¡bi__ušt16*è
z
->
out
;

4884 
	`STBI_ASSERT
(
out_n
 == 2 || out_n == 4);

4886 ià(
out_n
 == 2) {

4887 
i
 = 0; i < 
pix–_couÁ
; ++i) {

4888 
p
[1] = (p[0] =ğ
tc
[0] ? 0 : 65535);

4889 
p
 += 2;

4892 
i
 = 0; i < 
pix–_couÁ
; ++i) {

4893 ià(
p
[0] =ğ
tc
[0] &&…[1] ==c[1] &&…[2] ==c[2])

4894 
p
[3] = 0;

4895 
p
 += 4;

4899 
	}
}

4901 
	$¡bi__ex·nd_²g_·Ë‰e
(
¡bi__²g
 *
a
, 
¡bi_uc
 *
·Ë‰e
, 
Ën
, 
·l_img_n
)

4903 
¡bi__ušt32
 
i
, 
pix–_couÁ
 = 
a
->
s
->
img_x
 *‡->s->
img_y
;

4904 
¡bi_uc
 *
p
, *
‹mp_out
, *
Üig
 = 
a
->
out
;

4906 
p
 = (
¡bi_uc
 *è
	`¡bi__m®loc_mad2
(
pix–_couÁ
, 
·l_img_n
, 0);

4907 ià(
p
 =ğ
NULL
è 
	`¡bi__”r
("outofmem", "Out of memory");

4910 
‹mp_out
 = 
p
;

4912 ià(
·l_img_n
 == 3) {

4913 
i
=0; i < 
pix–_couÁ
; ++i) {

4914 
n
 = 
Üig
[
i
]*4;

4915 
p
[0] = 
·Ë‰e
[
n
 ];

4916 
p
[1] = 
·Ë‰e
[
n
+1];

4917 
p
[2] = 
·Ë‰e
[
n
+2];

4918 
p
 += 3;

4921 
i
=0; i < 
pix–_couÁ
; ++i) {

4922 
n
 = 
Üig
[
i
]*4;

4923 
p
[0] = 
·Ë‰e
[
n
 ];

4924 
p
[1] = 
·Ë‰e
[
n
+1];

4925 
p
[2] = 
·Ë‰e
[
n
+2];

4926 
p
[3] = 
·Ë‰e
[
n
+3];

4927 
p
 += 4;

4930 
	`STBI_FREE
(
a
->
out
);

4931 
a
->
out
 = 
‹mp_out
;

4933 
	`STBI_NOTUSED
(
Ën
);

4936 
	}
}

4938 
	g¡bi__uÅ»muÉly_Ú_lßd_glob®
 = 0;

4939 
	g¡bi__de_hÚe_æag_glob®
 = 0;

4941 
STBIDEF
 
	$¡bi_£t_uÅ»muÉly_Ú_lßd
(
æag_Œue_if_should_uÅ»muÉly
)

4943 
¡bi__uÅ»muÉly_Ú_lßd_glob®
 = 
æag_Œue_if_should_uÅ»muÉly
;

4944 
	}
}

4946 
STBIDEF
 
	$¡bi_cÚv”t_hÚe_²g_to_rgb
(
æag_Œue_if_should_cÚv”t
)

4948 
¡bi__de_hÚe_æag_glob®
 = 
æag_Œue_if_should_cÚv”t
;

4949 
	}
}

4951 #iâdeà
STBI_THREAD_LOCAL


4952 
	#¡bi__uÅ»muÉly_Ú_lßd
 
¡bi__uÅ»muÉly_Ú_lßd_glob®


	)

4953 
	#¡bi__de_hÚe_æag
 
¡bi__de_hÚe_æag_glob®


	)

4955 
STBI_THREAD_LOCAL
 
	g¡bi__uÅ»muÉly_Ú_lßd_loÿl
, 
	g¡bi__uÅ»muÉly_Ú_lßd_£t
;

4956 
STBI_THREAD_LOCAL
 
	g¡bi__de_hÚe_æag_loÿl
, 
	g¡bi__de_hÚe_æag_£t
;

4958 
STBIDEF
 
	$¡bi__uÅ»muÉly_Ú_lßd_th»ad
(
æag_Œue_if_should_uÅ»muÉly
)

4960 
¡bi__uÅ»muÉly_Ú_lßd_loÿl
 = 
æag_Œue_if_should_uÅ»muÉly
;

4961 
¡bi__uÅ»muÉly_Ú_lßd_£t
 = 1;

4962 
	}
}

4964 
STBIDEF
 
	$¡bi_cÚv”t_hÚe_²g_to_rgb_th»ad
(
æag_Œue_if_should_cÚv”t
)

4966 
¡bi__de_hÚe_æag_loÿl
 = 
æag_Œue_if_should_cÚv”t
;

4967 
¡bi__de_hÚe_æag_£t
 = 1;

4968 
	}
}

4970 
	#¡bi__uÅ»muÉly_Ú_lßd
 (
¡bi__uÅ»muÉly_Ú_lßd_£t
 \

4971 ? 
¡bi__uÅ»muÉly_Ú_lßd_loÿl
 \

4972 : 
¡bi__uÅ»muÉly_Ú_lßd_glob®
)

	)

4973 
	#¡bi__de_hÚe_æag
 (
¡bi__de_hÚe_æag_£t
 \

4974 ? 
¡bi__de_hÚe_æag_loÿl
 \

4975 : 
¡bi__de_hÚe_æag_glob®
)

	)

4978 
	$¡bi__de_hÚe
(
¡bi__²g
 *
z
)

4980 
¡bi__cÚ‹xt
 *
s
 = 
z
->s;

4981 
¡bi__ušt32
 
i
, 
pix–_couÁ
 = 
s
->
img_x
 * s->
img_y
;

4982 
¡bi_uc
 *
p
 = 
z
->
out
;

4984 ià(
s
->
img_out_n
 == 3) {

4985 
i
=0; i < 
pix–_couÁ
; ++i) {

4986 
¡bi_uc
 
t
 = 
p
[0];

4987 
p
[0] =…[2];

4988 
p
[2] = 
t
;

4989 
p
 += 3;

4992 
	`STBI_ASSERT
(
s
->
img_out_n
 == 4);

4993 ià(
¡bi__uÅ»muÉly_Ú_lßd
) {

4995 
i
=0; i < 
pix–_couÁ
; ++i) {

4996 
¡bi_uc
 
a
 = 
p
[3];

4997 
¡bi_uc
 
t
 = 
p
[0];

4998 ià(
a
) {

4999 
¡bi_uc
 
h®f
 = 
a
 / 2;

5000 
p
[0] = (p[2] * 255 + 
h®f
è/ 
a
;

5001 
p
[1] = (p[1] * 255 + 
h®f
è/ 
a
;

5002 
p
[2] = ( 
t
 * 255 + 
h®f
è/ 
a
;

5004 
p
[0] =…[2];

5005 
p
[2] = 
t
;

5007 
p
 += 4;

5011 
i
=0; i < 
pix–_couÁ
; ++i) {

5012 
¡bi_uc
 
t
 = 
p
[0];

5013 
p
[0] =…[2];

5014 
p
[2] = 
t
;

5015 
p
 += 4;

5019 
	}
}

5021 
	#STBI__PNG_TYPE
(
a
,
b
,
c
,
d
è(((è×è<< 24è+ ((è(bè<< 16è+ ((è(cè<< 8è+ (è(d))

	)

5023 
	$¡bi__·r£_²g_fe
(
¡bi__²g
 *
z
, 
sÿn
, 
»q_comp
)

5025 
¡bi_uc
 
·Ë‰e
[1024], 
·l_img_n
=0;

5026 
¡bi_uc
 
has_Œªs
=0, 
tc
[3]={0};

5027 
¡bi__ušt16
 
tc16
[3];

5028 
¡bi__ušt32
 
ioff
=0, 
id©a_lim™
=0, 
i
, 
·l_Ën
=0;

5029 
fœ¡
=1,
k
,
š‹¾aû
=0, 
cŞÜ
=0, 
is_hÚe
=0;

5030 
¡bi__cÚ‹xt
 *
s
 = 
z
->s;

5032 
z
->
ex·nded
 = 
NULL
;

5033 
z
->
id©a
 = 
NULL
;

5034 
z
->
out
 = 
NULL
;

5036 ià(!
	`¡bi__check_²g_h—d”
(
s
))  0;

5038 ià(
sÿn
 =ğ
STBI__SCAN_ty³
)  1;

5041 
¡bi__²gchunk
 
c
 = 
	`¡bi__g‘_chunk_h—d”
(
s
);

5042 
c
.
ty³
) {

5043 
	`STBI__PNG_TYPE
('C','g','B','I'):

5044 
is_hÚe
 = 1;

5045 
	`¡bi__sk
(
s
, 
c
.
Ëngth
);

5047 
	`STBI__PNG_TYPE
('I','H','D','R'): {

5048 
comp
,
f‹r
;

5049 ià(!
fœ¡
è 
	`¡bi__”r
("multiple IHDR","Corrupt PNG");

5050 
fœ¡
 = 0;

5051 ià(
c
.
Ëngth
 !ğ13è 
	`¡bi__”r
("bad IHDR†en","Corrupt PNG");

5052 
s
->
img_x
 = 
	`¡bi__g‘32be
(s);

5053 
s
->
img_y
 = 
	`¡bi__g‘32be
(s);

5054 ià(
s
->
img_y
 > 
STBI_MAX_DIMENSIONS
è 
	`¡bi__”r
("too†arge","Very†arge image (corrupt?)");

5055 ià(
s
->
img_x
 > 
STBI_MAX_DIMENSIONS
è 
	`¡bi__”r
("too†arge","Very†arge image (corrupt?)");

5056 
z
->
d•th
 = 
	`¡bi__g‘8
(
s
); ià(z->d•th !ğ1 && z->d•th !ğ2 && z->d•th !ğ4 && z->d•th !ğ8 && z->d•th !ğ16è 
	`¡bi__”r
("1/2/4/8/16-bit only","PNG‚ot supported: 1/2/4/8/16-bit only");

5057 
cŞÜ
 = 
	`¡bi__g‘8
(
s
); ià(cŞÜ > 6è 
	`¡bi__”r
("bad ctype","Corrupt PNG");

5058 ià(
cŞÜ
 =ğ3 && 
z
->
d•th
 =ğ16è 
	`¡bi__”r
("bad ctype","Corrupt PNG");

5059 ià(
cŞÜ
 =ğ3è
·l_img_n
 = 3; ià(cŞÜ & 1è 
	`¡bi__”r
("bad ctype","Corrupt PNG");

5060 
comp
 = 
	`¡bi__g‘8
(
s
); ià(compè 
	`¡bi__”r
("bad comp method","Corrupt PNG");

5061 
f‹r
ğ
	`¡bi__g‘8
(
s
); ià(f‹rè 
	`¡bi__”r
("bad filter method","Corrupt PNG");

5062 
š‹¾aû
 = 
	`¡bi__g‘8
(
s
); ià(š‹¾aû>1è 
	`¡bi__”r
("bad interlace method","Corrupt PNG");

5063 ià(!
s
->
img_x
 || !s->
img_y
è 
	`¡bi__”r
("0-pixel image","Corrupt PNG");

5064 ià(!
·l_img_n
) {

5065 
s
->
img_n
 = (
cŞÜ
 & 2 ? 3 : 1) + (color & 4 ? 1 : 0);

5066 ià((1 << 30è/ 
s
->
img_x
 / s->
img_n
 < s->
img_y
è 
	`¡bi__”r
("too†arge", "Imageoo†argeo decode");

5067 ià(
sÿn
 =ğ
STBI__SCAN_h—d”
)  1;

5071 
s
->
img_n
 = 1;

5072 ià((1 << 30è/ 
s
->
img_x
 / 4 < s->
img_y
è 
	`¡bi__”r
("too†arge","Corrupt PNG");

5078 
	`STBI__PNG_TYPE
('P','L','T','E'): {

5079 ià(
fœ¡
è 
	`¡bi__”r
("first‚ot IHDR", "Corrupt PNG");

5080 ià(
c
.
Ëngth
 > 256*3è 
	`¡bi__”r
("invalid PLTE","Corrupt PNG");

5081 
·l_Ën
 = 
c
.
Ëngth
 / 3;

5082 ià(
·l_Ën
 * 3 !ğ
c
.
Ëngth
è 
	`¡bi__”r
("invalid PLTE","Corrupt PNG");

5083 
i
=0; i < 
·l_Ën
; ++i) {

5084 
·Ë‰e
[
i
*4+0] = 
	`¡bi__g‘8
(
s
);

5085 
·Ë‰e
[
i
*4+1] = 
	`¡bi__g‘8
(
s
);

5086 
·Ë‰e
[
i
*4+2] = 
	`¡bi__g‘8
(
s
);

5087 
·Ë‰e
[
i
*4+3] = 255;

5092 
	`STBI__PNG_TYPE
('t','R','N','S'): {

5093 ià(
fœ¡
è 
	`¡bi__”r
("first‚ot IHDR", "Corrupt PNG");

5094 ià(
z
->
id©a
è 
	`¡bi__”r
("tRNS‡fter IDAT","Corrupt PNG");

5095 ià(
·l_img_n
) {

5096 ià(
sÿn
 =ğ
STBI__SCAN_h—d”
è{ 
s
->
img_n
 = 4;  1; }

5097 ià(
·l_Ën
 =ğ0è 
	`¡bi__”r
("tRNS before PLTE","Corrupt PNG");

5098 ià(
c
.
Ëngth
 > 
·l_Ën
è 
	`¡bi__”r
("badRNS†en","Corrupt PNG");

5099 
·l_img_n
 = 4;

5100 
i
=0; i < 
c
.
Ëngth
; ++i)

5101 
·Ë‰e
[
i
*4+3] = 
	`¡bi__g‘8
(
s
);

5103 ià(!(
s
->
img_n
 & 1)è 
	`¡bi__”r
("tRNS with‡lpha","Corrupt PNG");

5104 ià(
c
.
Ëngth
 !ğ(
¡bi__ušt32
è
s
->
img_n
*2è 
	`¡bi__”r
("badRNS†en","Corrupt PNG");

5105 
has_Œªs
 = 1;

5106 ià(
z
->
d•th
 == 16) {

5107 
k
 = 0; k < 
s
->
img_n
; ++kè
tc16
[k] = (
¡bi__ušt16
)
	`¡bi__g‘16be
(s);

5109 
k
 = 0; k < 
s
->
img_n
; ++kè
tc
[k] = (
¡bi_uc
)(
	`¡bi__g‘16be
(sè& 255è* 
¡bi__d•th_sÿË_bË
[
z
->
d•th
];

5115 
	`STBI__PNG_TYPE
('I','D','A','T'): {

5116 ià(
fœ¡
è 
	`¡bi__”r
("first‚ot IHDR", "Corrupt PNG");

5117 ià(
·l_img_n
 && !
·l_Ën
è 
	`¡bi__”r
("no PLTE","Corrupt PNG");

5118 ià(
sÿn
 =ğ
STBI__SCAN_h—d”
è{ 
s
->
img_n
 = 
·l_img_n
;  1; }

5119 ià(()(
ioff
 + 
c
.
Ëngth
) < ()ioff)  0;

5120 ià(
ioff
 + 
c
.
Ëngth
 > 
id©a_lim™
) {

5121 
¡bi__ušt32
 
id©a_lim™_Şd
 = 
id©a_lim™
;

5122 
¡bi_uc
 *
p
;

5123 ià(
id©a_lim™
 =ğ0èid©a_lim™ = 
c
.
Ëngth
 > 4096 ? c.length : 4096;

5124 
ioff
 + 
c
.
Ëngth
 > 
id©a_lim™
)

5125 
id©a_lim™
 *= 2;

5126 
	`STBI_NOTUSED
(
id©a_lim™_Şd
);

5127 
p
 = (
¡bi_uc
 *è
	`STBI_REALLOC_SIZED
(
z
->
id©a
, 
id©a_lim™_Şd
, 
id©a_lim™
); iàÕ =ğ
NULL
è 
	`¡bi__”r
("outofmem", "Out of memory");

5128 
z
->
id©a
 = 
p
;

5130 ià(!
	`¡bi__g‘n
(
s
, 
z
->
id©a
+
ioff
,
c
.
Ëngth
)è 
	`¡bi__”r
("outofdata","Corrupt PNG");

5131 
ioff
 +ğ
c
.
Ëngth
;

5135 
	`STBI__PNG_TYPE
('I','E','N','D'): {

5136 
¡bi__ušt32
 
¿w_Ën
, 
b¶
;

5137 ià(
fœ¡
è 
	`¡bi__”r
("first‚ot IHDR", "Corrupt PNG");

5138 ià(
sÿn
 !ğ
STBI__SCAN_lßd
)  1;

5139 ià(
z
->
id©a
 =ğ
NULL
è 
	`¡bi__”r
("no IDAT","Corrupt PNG");

5141 
b¶
 = (
s
->
img_x
 * 
z
->
d•th
 + 7) / 8;

5142 
¿w_Ën
 = 
b¶
 * 
s
->
img_y
 * s->
img_n
 + s->img_y ;

5143 
z
->
ex·nded
 = (
¡bi_uc
 *è
	`¡bi_zlib_decode_m®loc_guesssize_h—d”æag
((*èz->
id©a
, 
ioff
, 
¿w_Ën
, (*è&¿w_Ën, !
is_hÚe
);

5144 ià(
z
->
ex·nded
 =ğ
NULL
)  0;

5145 
	`STBI_FREE
(
z
->
id©a
); z->id©¨ğ
NULL
;

5146 ià((
»q_comp
 =ğ
s
->
img_n
+1 &&„eq_com°!ğ3 && !
·l_img_n
è|| 
has_Œªs
)

5147 
s
->
img_out_n
 = s->
img_n
+1;

5149 
s
->
img_out_n
 = s->
img_n
;

5150 ià(!
	`¡bi__ü—‹_²g_image
(
z
, z->
ex·nded
, 
¿w_Ën
, 
s
->
img_out_n
, z->
d•th
, 
cŞÜ
, 
š‹¾aû
))  0;

5151 ià(
has_Œªs
) {

5152 ià(
z
->
d•th
 == 16) {

5153 ià(!
	`¡bi__compu‹_Œª¥¬’cy16
(
z
, 
tc16
, 
s
->
img_out_n
))  0;

5155 ià(!
	`¡bi__compu‹_Œª¥¬’cy
(
z
, 
tc
, 
s
->
img_out_n
))  0;

5158 ià(
is_hÚe
 && 
¡bi__de_hÚe_æag
 && 
s
->
img_out_n
 > 2)

5159 
	`¡bi__de_hÚe
(
z
);

5160 ià(
·l_img_n
) {

5162 
s
->
img_n
 = 
·l_img_n
;

5163 
s
->
img_out_n
 = 
·l_img_n
;

5164 ià(
»q_comp
 >ğ3è
s
->
img_out_n
 =„eq_comp;

5165 ià(!
	`¡bi__ex·nd_²g_·Ë‰e
(
z
, 
·Ë‰e
, 
·l_Ën
, 
s
->
img_out_n
))

5167 } ià(
has_Œªs
) {

5169 ++
s
->
img_n
;

5171 
	`STBI_FREE
(
z
->
ex·nded
); z->ex·nded = 
NULL
;

5173 
	`¡bi__g‘32be
(
s
);

5179 ià(
fœ¡
è 
	`¡bi__”r
("first‚ot IHDR", "Corrupt PNG");

5180 ià((
c
.
ty³
 & (1 << 29)) == 0) {

5181 #iâdeà
STBI_NO_FAILURE_STRINGS


5183 
šv®id_chunk
[] = "XXXX PNG chunk‚ot known";

5184 
šv®id_chunk
[0] = 
	`STBI__BYTECAST
(
c
.
ty³
 >> 24);

5185 
šv®id_chunk
[1] = 
	`STBI__BYTECAST
(
c
.
ty³
 >> 16);

5186 
šv®id_chunk
[2] = 
	`STBI__BYTECAST
(
c
.
ty³
 >> 8);

5187 
šv®id_chunk
[3] = 
	`STBI__BYTECAST
(
c
.
ty³
 >> 0);

5189  
	`¡bi__”r
(
šv®id_chunk
, "PNG‚ot supported: unknown PNG chunkype");

5191 
	`¡bi__sk
(
s
, 
c
.
Ëngth
);

5195 
	`¡bi__g‘32be
(
s
);

5197 
	}
}

5199 *
	$¡bi__do_²g
(
¡bi__²g
 *
p
, *
x
, *
y
, *
n
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
)

5201 *
»suÉ
=
NULL
;

5202 ià(
»q_comp
 < 0 ||„eq_com°> 4è 
	`¡bi__”½uc
("bad„eq_comp", "Internalƒrror");

5203 ià(
	`¡bi__·r£_²g_fe
(
p
, 
STBI__SCAN_lßd
, 
»q_comp
)) {

5204 ià(
p
->
d•th
 <= 8)

5205 
ri
->
b™s_³r_chªÃl
 = 8;

5206 ià(
p
->
d•th
 == 16)

5207 
ri
->
b™s_³r_chªÃl
 = 16;

5209  
	`¡bi__”½uc
("bad bits_per_channel", "PNG‚ot supported: unsupported color depth");

5210 
»suÉ
 = 
p
->
out
;

5211 
p
->
out
 = 
NULL
;

5212 ià(
»q_comp
 &&„eq_com°!ğ
p
->
s
->
img_out_n
) {

5213 ià(
ri
->
b™s_³r_chªÃl
 == 8)

5214 
»suÉ
 = 
	`¡bi__cÚv”t_fÜm©
((*è»suÉ, 
p
->
s
->
img_out_n
, 
»q_comp
,…->s->
img_x
,…->s->
img_y
);

5216 
»suÉ
 = 
	`¡bi__cÚv”t_fÜm©16
((
¡bi__ušt16
 *è»suÉ, 
p
->
s
->
img_out_n
, 
»q_comp
,…->s->
img_x
,…->s->
img_y
);

5217 
p
->
s
->
img_out_n
 = 
»q_comp
;

5218 ià(
»suÉ
 =ğ
NULL
) „esult;

5220 *
x
 = 
p
->
s
->
img_x
;

5221 *
y
 = 
p
->
s
->
img_y
;

5222 ià(
n
è*Àğ
p
->
s
->
img_n
;

5224 
	`STBI_FREE
(
p
->
out
);…->ouˆğ
NULL
;

5225 
	`STBI_FREE
(
p
->
ex·nded
);…->ex·nded = 
NULL
;

5226 
	`STBI_FREE
(
p
->
id©a
);…->id©¨ğ
NULL
;

5228  
»suÉ
;

5229 
	}
}

5231 *
	$¡bi__²g_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
)

5233 
¡bi__²g
 
p
;

5234 
p
.
s
 = s;

5235  
	`¡bi__do_²g
(&
p
, 
x
,
y
,
comp
,
»q_comp
, 
ri
);

5236 
	}
}

5238 
	$¡bi__²g_‹¡
(
¡bi__cÚ‹xt
 *
s
)

5240 
r
;

5241 
r
 = 
	`¡bi__check_²g_h—d”
(
s
);

5242 
	`¡bi__»wšd
(
s
);

5243  
r
;

5244 
	}
}

5246 
	$¡bi__²g_šfo_¿w
(
¡bi__²g
 *
p
, *
x
, *
y
, *
comp
)

5248 ià(!
	`¡bi__·r£_²g_fe
(
p
, 
STBI__SCAN_h—d”
, 0)) {

5249 
	`¡bi__»wšd
Ğ
p
->
s
 );

5252 ià(
x
è*x = 
p
->
s
->
img_x
;

5253 ià(
y
è*y = 
p
->
s
->
img_y
;

5254 ià(
comp
è*com°ğ
p
->
s
->
img_n
;

5256 
	}
}

5258 
	$¡bi__²g_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
)

5260 
¡bi__²g
 
p
;

5261 
p
.
s
 = s;

5262  
	`¡bi__²g_šfo_¿w
(&
p
, 
x
, 
y
, 
comp
);

5263 
	}
}

5265 
	$¡bi__²g_is16
(
¡bi__cÚ‹xt
 *
s
)

5267 
¡bi__²g
 
p
;

5268 
p
.
s
 = s;

5269 ià(!
	`¡bi__²g_šfo_¿w
(&
p
, 
NULL
, NULL, NULL))

5271 ià(
p
.
d•th
 != 16) {

5272 
	`¡bi__»wšd
(
p
.
s
);

5276 
	}
}

5281 #iâdeà
STBI_NO_BMP


5282 
	$¡bi__bmp_‹¡_¿w
(
¡bi__cÚ‹xt
 *
s
)

5284 
r
;

5285 
sz
;

5286 ià(
	`¡bi__g‘8
(
s
) != 'B')  0;

5287 ià(
	`¡bi__g‘8
(
s
) != 'M')  0;

5288 
	`¡bi__g‘32Ë
(
s
);

5289 
	`¡bi__g‘16Ë
(
s
);

5290 
	`¡bi__g‘16Ë
(
s
);

5291 
	`¡bi__g‘32Ë
(
s
);

5292 
sz
 = 
	`¡bi__g‘32Ë
(
s
);

5293 
r
 = (
sz
 == 12 || sz == 40 || sz == 56 || sz == 108 || sz == 124);

5294  
r
;

5295 
	}
}

5297 
	$¡bi__bmp_‹¡
(
¡bi__cÚ‹xt
 *
s
)

5299 
r
 = 
	`¡bi__bmp_‹¡_¿w
(
s
);

5300 
	`¡bi__»wšd
(
s
);

5301  
r
;

5302 
	}
}

5306 
	$¡bi__high_b™
(
z
)

5308 
n
=0;

5309 ià(
z
 == 0)  -1;

5310 ià(
z
 >ğ0x10000è{ 
n
 += 16; z >>= 16; }

5311 ià(
z
 >ğ0x00100è{ 
n
 += 8; z >>= 8; }

5312 ià(
z
 >ğ0x00010è{ 
n
 += 4; z >>= 4; }

5313 ià(
z
 >ğ0x00004è{ 
n
 += 2; z >>= 2; }

5314 ià(
z
 >ğ0x00002è{ 
n
 += 1; }

5315  
n
;

5316 
	}
}

5318 
	$¡bi__b™couÁ
(
a
)

5320 
a
 = (a & 0x55555555) + ((a >> 1) & 0x55555555);

5321 
a
 = (a & 0x33333333) + ((a >> 2) & 0x33333333);

5322 
a
 = (a + (a >> 4)) & 0x0f0f0f0f;

5323 
a
 = (a + (a >> 8));

5324 
a
 = (a + (a >> 16));

5325  
a
 & 0xff;

5326 
	}
}

5331 
	$¡bi__shiásigÃd
(
v
, 
shiá
, 
b™s
)

5333 
mul_bË
[9] = {

5338 
shiá_bË
[9] = {

5341 ià(
shiá
 < 0)

5342 
v
 <<ğ-
shiá
;

5344 
v
 >>ğ
shiá
;

5345 
	`STBI_ASSERT
(
v
 < 256);

5346 
v
 >>ğ(8-
b™s
);

5347 
	`STBI_ASSERT
(
b™s
 >= 0 && bits <= 8);

5348  (è((è
v
 * 
mul_bË
[
b™s
]è>> 
shiá_bË
[bits];

5349 
	}
}

5353 
	mbµ
, 
	moff£t
, 
	mhsz
;

5354 
	mmr
,
	mmg
,
	mmb
,
	mma
, 
	m®l_a
;

5355 
	mexŒa_»ad
;

5356 } 
	t¡bi__bmp_d©a
;

5358 
	$¡bi__bmp_£t_mask_deçuÉs
(
¡bi__bmp_d©a
 *
šfo
, 
com´ess
)

5361 ià(
com´ess
 == 3)

5364 ià(
com´ess
 == 0) {

5365 ià(
šfo
->
bµ
 == 16) {

5366 
šfo
->
mr
 = 31u << 10;

5367 
šfo
->
mg
 = 31u << 5;

5368 
šfo
->
mb
 = 31u << 0;

5369 } ià(
šfo
->
bµ
 == 32) {

5370 
šfo
->
mr
 = 0xffu << 16;

5371 
šfo
->
mg
 = 0xffu << 8;

5372 
šfo
->
mb
 = 0xffu << 0;

5373 
šfo
->
ma
 = 0xffu << 24;

5374 
šfo
->
®l_a
 = 0;

5377 
šfo
->
mr
 = info->
mg
 = info->
mb
 = info->
ma
 = 0;

5382 
	}
}

5384 *
	$¡bi__bmp_·r£_h—d”
(
¡bi__cÚ‹xt
 *
s
, 
¡bi__bmp_d©a
 *
šfo
)

5386 
hsz
;

5387 ià(
	`¡bi__g‘8
(
s
è!ğ'B' || stbi__g‘8(sè!ğ'M'è 
	`¡bi__”½uc
("not BMP", "Corrupt BMP");

5388 
	`¡bi__g‘32Ë
(
s
);

5389 
	`¡bi__g‘16Ë
(
s
);

5390 
	`¡bi__g‘16Ë
(
s
);

5391 
šfo
->
off£t
 = 
	`¡bi__g‘32Ë
(
s
);

5392 
šfo
->
hsz
 = hsz = 
	`¡bi__g‘32Ë
(
s
);

5393 
šfo
->
mr
 = info->
mg
 = info->
mb
 = info->
ma
 = 0;

5394 
šfo
->
exŒa_»ad
 = 14;

5396 ià(
šfo
->
off£t
 < 0è 
	`¡bi__”½uc
("bad BMP", "bad BMP");

5398 ià(
hsz
 !ğ12 && hsz !ğ40 && hsz !ğ56 && hsz !ğ108 && hsz !ğ124è 
	`¡bi__”½uc
("unknown BMP", "BMPype‚ot supported: unknown");

5399 ià(
hsz
 == 12) {

5400 
s
->
img_x
 = 
	`¡bi__g‘16Ë
(s);

5401 
s
->
img_y
 = 
	`¡bi__g‘16Ë
(s);

5403 
s
->
img_x
 = 
	`¡bi__g‘32Ë
(s);

5404 
s
->
img_y
 = 
	`¡bi__g‘32Ë
(s);

5406 ià(
	`¡bi__g‘16Ë
(
s
è!ğ1è 
	`¡bi__”½uc
("bad BMP", "bad BMP");

5407 
šfo
->
bµ
 = 
	`¡bi__g‘16Ë
(
s
);

5408 ià(
hsz
 != 12) {

5409 
com´ess
 = 
	`¡bi__g‘32Ë
(
s
);

5410 ià(
com´ess
 =ğ1 || com´es =ğ2è 
	`¡bi__”½uc
("BMP RLE", "BMPype‚ot supported: RLE");

5411 ià(
com´ess
 >ğ4è 
	`¡bi__”½uc
("BMP JPEG/PNG", "BMPype‚ot supported: unsupported compression");

5412 ià(
com´ess
 =ğ3 && 
šfo
->
bµ
 !ğ16 && info->bµ !ğ32è 
	`¡bi__”½uc
("bad BMP", "bad BMP");

5413 
	`¡bi__g‘32Ë
(
s
);

5414 
	`¡bi__g‘32Ë
(
s
);

5415 
	`¡bi__g‘32Ë
(
s
);

5416 
	`¡bi__g‘32Ë
(
s
);

5417 
	`¡bi__g‘32Ë
(
s
);

5418 ià(
hsz
 == 40 || hsz == 56) {

5419 ià(
hsz
 == 56) {

5420 
	`¡bi__g‘32Ë
(
s
);

5421 
	`¡bi__g‘32Ë
(
s
);

5422 
	`¡bi__g‘32Ë
(
s
);

5423 
	`¡bi__g‘32Ë
(
s
);

5425 ià(
šfo
->
bµ
 == 16 || info->bpp == 32) {

5426 ià(
com´ess
 == 0) {

5427 
	`¡bi__bmp_£t_mask_deçuÉs
(
šfo
, 
com´ess
);

5428 } ià(
com´ess
 == 3) {

5429 
šfo
->
mr
 = 
	`¡bi__g‘32Ë
(
s
);

5430 
šfo
->
mg
 = 
	`¡bi__g‘32Ë
(
s
);

5431 
šfo
->
mb
 = 
	`¡bi__g‘32Ë
(
s
);

5432 
šfo
->
exŒa_»ad
 += 12;

5434 ià(
šfo
->
mr
 =ğšfo->
mg
 && info->mg =ğšfo->
mb
) {

5436  
	`¡bi__”½uc
("bad BMP", "bad BMP");

5439  
	`¡bi__”½uc
("bad BMP", "bad BMP");

5443 
i
;

5444 ià(
hsz
 != 108 && hsz != 124)

5445  
	`¡bi__”½uc
("bad BMP", "bad BMP");

5446 
šfo
->
mr
 = 
	`¡bi__g‘32Ë
(
s
);

5447 
šfo
->
mg
 = 
	`¡bi__g‘32Ë
(
s
);

5448 
šfo
->
mb
 = 
	`¡bi__g‘32Ë
(
s
);

5449 
šfo
->
ma
 = 
	`¡bi__g‘32Ë
(
s
);

5450 ià(
com´ess
 != 3)

5451 
	`¡bi__bmp_£t_mask_deçuÉs
(
šfo
, 
com´ess
);

5452 
	`¡bi__g‘32Ë
(
s
);

5453 
i
=0; i < 12; ++i)

5454 
	`¡bi__g‘32Ë
(
s
);

5455 ià(
hsz
 == 124) {

5456 
	`¡bi__g‘32Ë
(
s
);

5457 
	`¡bi__g‘32Ë
(
s
);

5458 
	`¡bi__g‘32Ë
(
s
);

5459 
	`¡bi__g‘32Ë
(
s
);

5464 
	}
}

5467 *
	$¡bi__bmp_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
)

5469 
¡bi_uc
 *
out
;

5470 
mr
=0,
mg
=0,
mb
=0,
ma
=0, 
®l_a
;

5471 
¡bi_uc
 
·l
[256][4];

5472 
psize
=0,
i
,
j
,
width
;

5473 
æ_v”tiÿÎy
, 
·d
, 
rg‘
;

5474 
¡bi__bmp_d©a
 
šfo
;

5475 
	`STBI_NOTUSED
(
ri
);

5477 
šfo
.
®l_a
 = 255;

5478 ià(
	`¡bi__bmp_·r£_h—d”
(
s
, &
šfo
è=ğ
NULL
)

5479  
NULL
;

5481 
æ_v”tiÿÎy
 = ((è
s
->
img_y
) > 0;

5482 
s
->
img_y
 = 
	`abs
(() s->img_y);

5484 ià(
s
->
img_y
 > 
STBI_MAX_DIMENSIONS
è 
	`¡bi__”½uc
("too†arge","Very†arge image (corrupt?)");

5485 ià(
s
->
img_x
 > 
STBI_MAX_DIMENSIONS
è 
	`¡bi__”½uc
("too†arge","Very†arge image (corrupt?)");

5487 
mr
 = 
šfo
.mr;

5488 
mg
 = 
šfo
.mg;

5489 
mb
 = 
šfo
.mb;

5490 
ma
 = 
šfo
.ma;

5491 
®l_a
 = 
šfo
.all_a;

5493 ià(
šfo
.
hsz
 == 12) {

5494 ià(
šfo
.
bµ
 < 24)

5495 
psize
 = (
šfo
.
off£t
 - info.
exŒa_»ad
 - 24) / 3;

5497 ià(
šfo
.
bµ
 < 16)

5498 
psize
 = (
šfo
.
off£t
 - info.
exŒa_»ad
 - info.
hsz
) >> 2;

5500 ià(
psize
 == 0) {

5501 ià(
šfo
.
off£t
 !ğ
s
->
ÿÎback_®»ady_»ad
 + (s->
img_bufãr
 - s->
img_bufãr_Üigš®
)) {

5502  
	`¡bi__”½uc
("bad offset", "Corrupt BMP");

5506 ià(
šfo
.
bµ
 =ğ24 && 
ma
 == 0xff000000)

5507 
s
->
img_n
 = 3;

5509 
s
->
img_n
 = 
ma
 ? 4 : 3;

5510 ià(
»q_comp
 &&„eq_comp >= 3)

5511 
rg‘
 = 
»q_comp
;

5513 
rg‘
 = 
s
->
img_n
;

5516 ià(!
	`¡bi__mad3sizes_v®id
(
rg‘
, 
s
->
img_x
, s->
img_y
, 0))

5517  
	`¡bi__”½uc
("too†arge", "Corrupt BMP");

5519 
out
 = (
¡bi_uc
 *è
	`¡bi__m®loc_mad3
(
rg‘
, 
s
->
img_x
, s->
img_y
, 0);

5520 ià(!
out
è 
	`¡bi__”½uc
("outofmem", "Out of memory");

5521 ià(
šfo
.
bµ
 < 16) {

5522 
z
=0;

5523 ià(
psize
 =ğ0 ||…siz> 256è{ 
	`STBI_FREE
(
out
);  
	`¡bi__”½uc
("invalid", "Corrupt BMP"); }

5524 
i
=0; i < 
psize
; ++i) {

5525 
·l
[
i
][2] = 
	`¡bi__g‘8
(
s
);

5526 
·l
[
i
][1] = 
	`¡bi__g‘8
(
s
);

5527 
·l
[
i
][0] = 
	`¡bi__g‘8
(
s
);

5528 ià(
šfo
.
hsz
 !ğ12è
	`¡bi__g‘8
(
s
);

5529 
·l
[
i
][3] = 255;

5531 
	`¡bi__sk
(
s
, 
šfo
.
off£t
 - info.
exŒa_»ad
 - info.
hsz
 - 
psize
 * (info.hsz == 12 ? 3 : 4));

5532 ià(
šfo
.
bµ
 =ğ1è
width
 = (
s
->
img_x
 + 7) >> 3;

5533 ià(
šfo
.
bµ
 =ğ4è
width
 = (
s
->
img_x
 + 1) >> 1;

5534 ià(
šfo
.
bµ
 =ğ8è
width
 = 
s
->
img_x
;

5535 { 
	`STBI_FREE
(
out
);  
	`¡bi__”½uc
("bad bpp", "Corrupt BMP"); }

5536 
·d
 = (-
width
)&3;

5537 ià(
šfo
.
bµ
 == 1) {

5538 
j
=0; j < (è
s
->
img_y
; ++j) {

5539 
b™_off£t
 = 7, 
v
 = 
	`¡bi__g‘8
(
s
);

5540 
i
=0; i < (è
s
->
img_x
; ++i) {

5541 
cŞÜ
 = (
v
>>
b™_off£t
)&0x1;

5542 
out
[
z
++] = 
·l
[
cŞÜ
][0];

5543 
out
[
z
++] = 
·l
[
cŞÜ
][1];

5544 
out
[
z
++] = 
·l
[
cŞÜ
][2];

5545 ià(
rg‘
 =ğ4è
out
[
z
++] = 255;

5546 ià(
i
+1 =ğ(è
s
->
img_x
) ;

5547 if((--
b™_off£t
) < 0) {

5548 
b™_off£t
 = 7;

5549 
v
 = 
	`¡bi__g‘8
(
s
);

5552 
	`¡bi__sk
(
s
, 
·d
);

5555 
j
=0; j < (è
s
->
img_y
; ++j) {

5556 
i
=0; i < (è
s
->
img_x
; i += 2) {

5557 
v
=
	`¡bi__g‘8
(
s
),
v2
=0;

5558 ià(
šfo
.
bµ
 == 4) {

5559 
v2
 = 
v
 & 15;

5560 
v
 >>= 4;

5562 
out
[
z
++] = 
·l
[
v
][0];

5563 
out
[
z
++] = 
·l
[
v
][1];

5564 
out
[
z
++] = 
·l
[
v
][2];

5565 ià(
rg‘
 =ğ4è
out
[
z
++] = 255;

5566 ià(
i
+1 =ğ(è
s
->
img_x
) ;

5567 
v
 = (
šfo
.
bµ
 =ğ8è? 
	`¡bi__g‘8
(
s
è: 
v2
;

5568 
out
[
z
++] = 
·l
[
v
][0];

5569 
out
[
z
++] = 
·l
[
v
][1];

5570 
out
[
z
++] = 
·l
[
v
][2];

5571 ià(
rg‘
 =ğ4è
out
[
z
++] = 255;

5573 
	`¡bi__sk
(
s
, 
·d
);

5577 
rshiá
=0,
gshiá
=0,
bshiá
=0,
ashiá
=0,
rcouÁ
=0,
gcouÁ
=0,
bcouÁ
=0,
acouÁ
=0;

5578 
z
 = 0;

5579 
—sy
=0;

5580 
	`¡bi__sk
(
s
, 
šfo
.
off£t
 - info.
exŒa_»ad
 - info.
hsz
);

5581 ià(
šfo
.
bµ
 =ğ24è
width
 = 3 * 
s
->
img_x
;

5582 ià(
šfo
.
bµ
 =ğ16è
width
 = 2*
s
->
img_x
;

5583 
width
=0;

5584 
·d
 = (-
width
) & 3;

5585 ià(
šfo
.
bµ
 == 24) {

5586 
—sy
 = 1;

5587 } ià(
šfo
.
bµ
 == 32) {

5588 ià(
mb
 =ğ0xfà&& 
mg
 =ğ0xff00 && 
mr
 =ğ0x00ff0000 && 
ma
 == 0xff000000)

5589 
—sy
 = 2;

5591 ià(!
—sy
) {

5592 ià(!
mr
 || !
mg
 || !
mb
è{ 
	`STBI_FREE
(
out
);  
	`¡bi__”½uc
("bad masks", "Corrupt BMP"); }

5594 
rshiá
 = 
	`¡bi__high_b™
(
mr
)-7; 
rcouÁ
 = 
	`¡bi__b™couÁ
(mr);

5595 
gshiá
 = 
	`¡bi__high_b™
(
mg
)-7; 
gcouÁ
 = 
	`¡bi__b™couÁ
(mg);

5596 
bshiá
 = 
	`¡bi__high_b™
(
mb
)-7; 
bcouÁ
 = 
	`¡bi__b™couÁ
(mb);

5597 
ashiá
 = 
	`¡bi__high_b™
(
ma
)-7; 
acouÁ
 = 
	`¡bi__b™couÁ
(ma);

5598 ià(
rcouÁ
 > 8 || 
gcouÁ
 > 8 || 
bcouÁ
 > 8 || 
acouÁ
 > 8è{ 
	`STBI_FREE
(
out
);  
	`¡bi__”½uc
("bad masks", "Corrupt BMP"); }

5600 
j
=0; j < (è
s
->
img_y
; ++j) {

5601 ià(
—sy
) {

5602 
i
=0; i < (è
s
->
img_x
; ++i) {

5603 
a
;

5604 
out
[
z
+2] = 
	`¡bi__g‘8
(
s
);

5605 
out
[
z
+1] = 
	`¡bi__g‘8
(
s
);

5606 
out
[
z
+0] = 
	`¡bi__g‘8
(
s
);

5607 
z
 += 3;

5608 
a
 = (
—sy
 =ğ2 ? 
	`¡bi__g‘8
(
s
) : 255);

5609 
®l_a
 |ğ
a
;

5610 ià(
rg‘
 =ğ4è
out
[
z
++] = 
a
;

5613 
bµ
 = 
šfo
.bpp;

5614 
i
=0; i < (è
s
->
img_x
; ++i) {

5615 
¡bi__ušt32
 
v
 = (
bµ
 =ğ16 ? (¡bi__ušt32è
	`¡bi__g‘16Ë
(
s
è: 
	`¡bi__g‘32Ë
(s));

5616 
a
;

5617 
out
[
z
++] = 
	`STBI__BYTECAST
(
	`¡bi__shiásigÃd
(
v
 & 
mr
, 
rshiá
, 
rcouÁ
));

5618 
out
[
z
++] = 
	`STBI__BYTECAST
(
	`¡bi__shiásigÃd
(
v
 & 
mg
, 
gshiá
, 
gcouÁ
));

5619 
out
[
z
++] = 
	`STBI__BYTECAST
(
	`¡bi__shiásigÃd
(
v
 & 
mb
, 
bshiá
, 
bcouÁ
));

5620 
a
 = (
ma
 ? 
	`¡bi__shiásigÃd
(
v
 & ma, 
ashiá
, 
acouÁ
) : 255);

5621 
®l_a
 |ğ
a
;

5622 ià(
rg‘
 =ğ4è
out
[
z
++] = 
	`STBI__BYTECAST
(
a
);

5625 
	`¡bi__sk
(
s
, 
·d
);

5630 ià(
rg‘
 =ğ4 && 
®l_a
 == 0)

5631 
i
=4*
s
->
img_x
*s->
img_y
-1; i >= 0; i -= 4)

5632 
out
[
i
] = 255;

5634 ià(
æ_v”tiÿÎy
) {

5635 
¡bi_uc
 
t
;

5636 
j
=0; j < (è
s
->
img_y
>>1; ++j) {

5637 
¡bi_uc
 *
p1
 = 
out
 + 
j
 *
s
->
img_x
*
rg‘
;

5638 
¡bi_uc
 *
p2
 = 
out
 + (
s
->
img_y
-1-
j
)*s->
img_x
*
rg‘
;

5639 
i
=0; i < (è
s
->
img_x
*
rg‘
; ++i) {

5640 
t
 = 
p1
[
i
];…1[i] = 
p2
[i];…2[i] =;

5645 ià(
»q_comp
 &&„eq_com°!ğ
rg‘
) {

5646 
out
 = 
	`¡bi__cÚv”t_fÜm©
(out, 
rg‘
, 
»q_comp
, 
s
->
img_x
, s->
img_y
);

5647 ià(
out
 =ğ
NULL
)  out;

5650 *
x
 = 
s
->
img_x
;

5651 *
y
 = 
s
->
img_y
;

5652 ià(
comp
è*com°ğ
s
->
img_n
;

5653  
out
;

5654 
	}
}

5659 #iâdeà
STBI_NO_TGA


5661 
	$¡bi__tga_g‘_comp
(
b™s_³r_pix–
, 
is_g»y
, * 
is_rgb16
)

5664 ià(
is_rgb16
) *is_rgb16 = 0;

5665 
b™s_³r_pix–
) {

5666 8:  
STBI_g»y
;

5667 16: if(
is_g»y
è 
STBI_g»y_®pha
;

5669 15: if(
is_rgb16
) *is_rgb16 = 1;

5670  
STBI_rgb
;

5672 32:  
b™s_³r_pix–
/8;

5675 
	}
}

5677 
	$¡bi__tga_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
)

5679 
tga_w
, 
tga_h
, 
tga_comp
, 
tga_image_ty³
, 
tga_b™s_³r_pix–
, 
tga_cŞÜm­_bµ
;

5680 
sz
, 
tga_cŞÜm­_ty³
;

5681 
	`¡bi__g‘8
(
s
);

5682 
tga_cŞÜm­_ty³
 = 
	`¡bi__g‘8
(
s
);

5683 ifĞ
tga_cŞÜm­_ty³
 > 1 ) {

5684 
	`¡bi__»wšd
(
s
);

5687 
tga_image_ty³
 = 
	`¡bi__g‘8
(
s
);

5688 iàĞ
tga_cŞÜm­_ty³
 == 1 ) {

5689 ià(
tga_image_ty³
 != 1 &&ga_image_type != 9) {

5690 
	`¡bi__»wšd
(
s
);

5693 
	`¡bi__sk
(
s
,4);

5694 
sz
 = 
	`¡bi__g‘8
(
s
);

5695 iàĞ(
sz
 != 8) && (sz != 15) && (sz != 16) && (sz != 24) && (sz != 32) ) {

5696 
	`¡bi__»wšd
(
s
);

5699 
	`¡bi__sk
(
s
,4);

5700 
tga_cŞÜm­_bµ
 = 
sz
;

5702 iàĞ(
tga_image_ty³
 != 2) && (tga_image_type != 3) && (tga_image_type != 10) && (tga_image_type != 11) ) {

5703 
	`¡bi__»wšd
(
s
);

5706 
	`¡bi__sk
(
s
,9);

5707 
tga_cŞÜm­_bµ
 = 0;

5709 
tga_w
 = 
	`¡bi__g‘16Ë
(
s
);

5710 ifĞ
tga_w
 < 1 ) {

5711 
	`¡bi__»wšd
(
s
);

5714 
tga_h
 = 
	`¡bi__g‘16Ë
(
s
);

5715 ifĞ
tga_h
 < 1 ) {

5716 
	`¡bi__»wšd
(
s
);

5719 
tga_b™s_³r_pix–
 = 
	`¡bi__g‘8
(
s
);

5720 
	`¡bi__g‘8
(
s
);

5721 ià(
tga_cŞÜm­_bµ
 != 0) {

5722 if((
tga_b™s_³r_pix–
 != 8) && (tga_bits_per_pixel != 16)) {

5725 
	`¡bi__»wšd
(
s
);

5728 
tga_comp
 = 
	`¡bi__tga_g‘_comp
(
tga_cŞÜm­_bµ
, 0, 
NULL
);

5730 
tga_comp
 = 
	`¡bi__tga_g‘_comp
(
tga_b™s_³r_pix–
, (
tga_image_ty³
 =ğ3è|| (tga_image_ty³ =ğ11), 
NULL
);

5732 if(!
tga_comp
) {

5733 
	`¡bi__»wšd
(
s
);

5736 ià(
x
è*x = 
tga_w
;

5737 ià(
y
è*y = 
tga_h
;

5738 ià(
comp
è*com°ğ
tga_comp
;

5740 
	}
}

5742 
	$¡bi__tga_‹¡
(
¡bi__cÚ‹xt
 *
s
)

5744 
»s
 = 0;

5745 
sz
, 
tga_cŞÜ_ty³
;

5746 
	`¡bi__g‘8
(
s
);

5747 
tga_cŞÜ_ty³
 = 
	`¡bi__g‘8
(
s
);

5748 iàĞ
tga_cŞÜ_ty³
 > 1 ) 
”rÜEnd
;

5749 
sz
 = 
	`¡bi__g‘8
(
s
);

5750 iàĞ
tga_cŞÜ_ty³
 == 1 ) {

5751 ià(
sz
 !ğ1 && sz !ğ9è
”rÜEnd
;

5752 
	`¡bi__sk
(
s
,4);

5753 
sz
 = 
	`¡bi__g‘8
(
s
);

5754 iàĞ(
sz
 !ğ8è&& (sz !ğ15è&& (sz !ğ16è&& (sz !ğ24è&& (sz !ğ32èè
”rÜEnd
;

5755 
	`¡bi__sk
(
s
,4);

5757 iàĞ(
sz
 !ğ2è&& (sz !ğ3è&& (sz !ğ10è&& (sz !ğ11èè
”rÜEnd
;

5758 
	`¡bi__sk
(
s
,9);

5760 iàĞ
	`¡bi__g‘16Ë
(
s
è< 1 ) 
”rÜEnd
;

5761 iàĞ
	`¡bi__g‘16Ë
(
s
è< 1 ) 
”rÜEnd
;

5762 
sz
 = 
	`¡bi__g‘8
(
s
);

5763 iàĞ(
tga_cŞÜ_ty³
 =ğ1è&& (
sz
 !ğ8è&& (sz !ğ16èè
”rÜEnd
;

5764 iàĞ(
sz
 !ğ8è&& (sz !ğ15è&& (sz !ğ16è&& (sz !ğ24è&& (sz !ğ32èè
”rÜEnd
;

5766 
»s
 = 1;

5768 
”rÜEnd
:

5769 
	`¡bi__»wšd
(
s
);

5770  
»s
;

5771 
	}
}

5774 
	$¡bi__tga_»ad_rgb16
(
¡bi__cÚ‹xt
 *
s
, 
¡bi_uc
* 
out
)

5776 
¡bi__ušt16
 
px
 = (¡bi__ušt16)
	`¡bi__g‘16Ë
(
s
);

5777 
¡bi__ušt16
 
fiveB™Mask
 = 31;

5779 
r
 = (
px
 >> 10è& 
fiveB™Mask
;

5780 
g
 = (
px
 >> 5è& 
fiveB™Mask
;

5781 
b
 = 
px
 & 
fiveB™Mask
;

5783 
out
[0] = (
¡bi_uc
)((
r
 * 255)/31);

5784 
out
[1] = (
¡bi_uc
)((
g
 * 255)/31);

5785 
out
[2] = (
¡bi_uc
)((
b
 * 255)/31);

5791 
	}
}

5793 *
	$¡bi__tga_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
)

5796 
tga_off£t
 = 
	`¡bi__g‘8
(
s
);

5797 
tga_šdexed
 = 
	`¡bi__g‘8
(
s
);

5798 
tga_image_ty³
 = 
	`¡bi__g‘8
(
s
);

5799 
tga_is_RLE
 = 0;

5800 
tga_·Ë‰e_¡¬t
 = 
	`¡bi__g‘16Ë
(
s
);

5801 
tga_·Ë‰e_Ën
 = 
	`¡bi__g‘16Ë
(
s
);

5802 
tga_·Ë‰e_b™s
 = 
	`¡bi__g‘8
(
s
);

5803 
tga_x_Üigš
 = 
	`¡bi__g‘16Ë
(
s
);

5804 
tga_y_Üigš
 = 
	`¡bi__g‘16Ë
(
s
);

5805 
tga_width
 = 
	`¡bi__g‘16Ë
(
s
);

5806 
tga_height
 = 
	`¡bi__g‘16Ë
(
s
);

5807 
tga_b™s_³r_pix–
 = 
	`¡bi__g‘8
(
s
);

5808 
tga_comp
, 
tga_rgb16
=0;

5809 
tga_šv”‹d
 = 
	`¡bi__g‘8
(
s
);

5812 *
tga_d©a
;

5813 *
tga_·Ë‰e
 = 
NULL
;

5814 
i
, 
j
;

5815 
¿w_d©a
[4] = {0};

5816 
RLE_couÁ
 = 0;

5817 
RLE_»³©šg
 = 0;

5818 
»ad_Ãxt_pix–
 = 1;

5819 
	`STBI_NOTUSED
(
ri
);

5820 
	`STBI_NOTUSED
(
tga_x_Üigš
);

5821 
	`STBI_NOTUSED
(
tga_y_Üigš
);

5823 ià(
tga_height
 > 
STBI_MAX_DIMENSIONS
è 
	`¡bi__”½uc
("too†arge","Very†arge image (corrupt?)");

5824 ià(
tga_width
 > 
STBI_MAX_DIMENSIONS
è 
	`¡bi__”½uc
("too†arge","Very†arge image (corrupt?)");

5827 iàĞ
tga_image_ty³
 >= 8 )

5829 
tga_image_ty³
 -= 8;

5830 
tga_is_RLE
 = 1;

5832 
tga_šv”‹d
 = 1 - ((tga_inverted >> 5) & 1);

5835 iàĞ
tga_šdexed
 ) 
tga_comp
 = 
	`¡bi__tga_g‘_comp
(
tga_·Ë‰e_b™s
, 0, &
tga_rgb16
);

5836 
tga_comp
 = 
	`¡bi__tga_g‘_comp
(
tga_b™s_³r_pix–
, (
tga_image_ty³
 =ğ3), &
tga_rgb16
);

5838 if(!
tga_comp
)

5839  
	`¡bi__”½uc
("bad format", "Can't find out TGA…ixelformat");

5842 *
x
 = 
tga_width
;

5843 *
y
 = 
tga_height
;

5844 ià(
comp
è*com°ğ
tga_comp
;

5846 ià(!
	`¡bi__mad3sizes_v®id
(
tga_width
, 
tga_height
, 
tga_comp
, 0))

5847  
	`¡bi__”½uc
("too†arge", "Corrupt TGA");

5849 
tga_d©a
 = (*)
	`¡bi__m®loc_mad3
(
tga_width
, 
tga_height
, 
tga_comp
, 0);

5850 ià(!
tga_d©a
è 
	`¡bi__”½uc
("outofmem", "Out of memory");

5853 
	`¡bi__sk
(
s
, 
tga_off£t
 );

5855 iàĞ!
tga_šdexed
 && !
tga_is_RLE
 && !
tga_rgb16
 ) {

5856 
i
=0; i < 
tga_height
; ++i) {

5857 
row
 = 
tga_šv”‹d
 ? 
tga_height
 -
i
 - 1 : i;

5858 
¡bi_uc
 *
tga_row
 = 
tga_d©a
 + 
row
*
tga_width
*
tga_comp
;

5859 
	`¡bi__g‘n
(
s
, 
tga_row
, 
tga_width
 * 
tga_comp
);

5863 iàĞ
tga_šdexed
)

5865 ià(
tga_·Ë‰e_Ën
 == 0) {

5866 
	`STBI_FREE
(
tga_d©a
);

5867  
	`¡bi__”½uc
("bad…alette", "Corrupt TGA");

5871 
	`¡bi__sk
(
s
, 
tga_·Ë‰e_¡¬t
 );

5873 
tga_·Ë‰e
 = (*)
	`¡bi__m®loc_mad2
(
tga_·Ë‰e_Ën
, 
tga_comp
, 0);

5874 ià(!
tga_·Ë‰e
) {

5875 
	`STBI_FREE
(
tga_d©a
);

5876  
	`¡bi__”½uc
("outofmem", "Out of memory");

5878 ià(
tga_rgb16
) {

5879 
¡bi_uc
 *
·l_’Œy
 = 
tga_·Ë‰e
;

5880 
	`STBI_ASSERT
(
tga_comp
 =ğ
STBI_rgb
);

5881 
i
=0; i < 
tga_·Ë‰e_Ën
; ++i) {

5882 
	`¡bi__tga_»ad_rgb16
(
s
, 
·l_’Œy
);

5883 
·l_’Œy
 +ğ
tga_comp
;

5885 } ià(!
	`¡bi__g‘n
(
s
, 
tga_·Ë‰e
, 
tga_·Ë‰e_Ën
 * 
tga_comp
)) {

5886 
	`STBI_FREE
(
tga_d©a
);

5887 
	`STBI_FREE
(
tga_·Ë‰e
);

5888  
	`¡bi__”½uc
("bad…alette", "Corrupt TGA");

5892 
i
=0; i < 
tga_width
 * 
tga_height
; ++i)

5895 iàĞ
tga_is_RLE
 )

5897 iàĞ
RLE_couÁ
 == 0 )

5900 
RLE_cmd
 = 
	`¡bi__g‘8
(
s
);

5901 
RLE_couÁ
 = 1 + (
RLE_cmd
 & 127);

5902 
RLE_»³©šg
 = 
RLE_cmd
 >> 7;

5903 
»ad_Ãxt_pix–
 = 1;

5904 } iàĞ!
RLE_»³©šg
 )

5906 
»ad_Ãxt_pix–
 = 1;

5910 
»ad_Ãxt_pix–
 = 1;

5913 iàĞ
»ad_Ãxt_pix–
 )

5916 iàĞ
tga_šdexed
 )

5919 
·l_idx
 = (
tga_b™s_³r_pix–
 =ğ8è? 
	`¡bi__g‘8
(
s
è: 
	`¡bi__g‘16Ë
(s);

5920 iàĞ
·l_idx
 >ğ
tga_·Ë‰e_Ën
 ) {

5922 
·l_idx
 = 0;

5924 
·l_idx
 *ğ
tga_comp
;

5925 
j
 = 0; j < 
tga_comp
; ++j) {

5926 
¿w_d©a
[
j
] = 
tga_·Ë‰e
[
·l_idx
+j];

5928 } if(
tga_rgb16
) {

5929 
	`STBI_ASSERT
(
tga_comp
 =ğ
STBI_rgb
);

5930 
	`¡bi__tga_»ad_rgb16
(
s
, 
¿w_d©a
);

5933 
j
 = 0; j < 
tga_comp
; ++j) {

5934 
¿w_d©a
[
j
] = 
	`¡bi__g‘8
(
s
);

5938 
»ad_Ãxt_pix–
 = 0;

5942 
j
 = 0; j < 
tga_comp
; ++j)

5943 
tga_d©a
[
i
*
tga_comp
+
j
] = 
¿w_d©a
[j];

5946 --
RLE_couÁ
;

5949 iàĞ
tga_šv”‹d
 )

5951 
j
 = 0; j*2 < 
tga_height
; ++j)

5953 
šdex1
 = 
j
 * 
tga_width
 * 
tga_comp
;

5954 
šdex2
 = (
tga_height
 - 1 - 
j
è* 
tga_width
 * 
tga_comp
;

5955 
i
 = 
tga_width
 * 
tga_comp
; i > 0; --i)

5957 
‹mp
 = 
tga_d©a
[
šdex1
];

5958 
tga_d©a
[
šdex1
] =ga_d©a[
šdex2
];

5959 
tga_d©a
[
šdex2
] = 
‹mp
;

5960 ++
šdex1
;

5961 ++
šdex2
;

5966 iàĞ
tga_·Ë‰e
 !ğ
NULL
 )

5968 
	`STBI_FREE
Ğ
tga_·Ë‰e
 );

5973 ià(
tga_comp
 >ğ3 && !
tga_rgb16
)

5975 * 
tga_pix–
 = 
tga_d©a
;

5976 
i
=0; i < 
tga_width
 * 
tga_height
; ++i)

5978 
‹mp
 = 
tga_pix–
[0];

5979 
tga_pix–
[0] =ga_pixel[2];

5980 
tga_pix–
[2] = 
‹mp
;

5981 
tga_pix–
 +ğ
tga_comp
;

5986 ià(
»q_comp
 &&„eq_com°!ğ
tga_comp
)

5987 
tga_d©a
 = 
	`¡bi__cÚv”t_fÜm©
Ñga_d©a, 
tga_comp
, 
»q_comp
, 
tga_width
, 
tga_height
);

5991 
tga_·Ë‰e_¡¬t
 = 
tga_·Ë‰e_Ën
 = 
tga_·Ë‰e_b™s
 =

5992 
tga_x_Üigš
 = 
tga_y_Üigš
 = 0;

5993 
	`STBI_NOTUSED
(
tga_·Ë‰e_¡¬t
);

5995  
tga_d©a
;

5996 
	}
}

6002 #iâdeà
STBI_NO_PSD


6003 
	$¡bi__psd_‹¡
(
¡bi__cÚ‹xt
 *
s
)

6005 
r
 = (
	`¡bi__g‘32be
(
s
) == 0x38425053);

6006 
	`¡bi__»wšd
(
s
);

6007  
r
;

6008 
	}
}

6010 
	$¡bi__psd_decode_¾e
(
¡bi__cÚ‹xt
 *
s
, 
¡bi_uc
 *
p
, 
pix–CouÁ
)

6012 
couÁ
, 
Æeá
, 
Ën
;

6014 
couÁ
 = 0;

6015 (
Æeá
 = 
pix–CouÁ
 - 
couÁ
) > 0) {

6016 
Ën
 = 
	`¡bi__g‘8
(
s
);

6017 ià(
Ën
 == 128) {

6019 } ià(
Ën
 < 128) {

6021 
Ën
++;

6022 ià(
Ën
 > 
Æeá
)  0;

6023 
couÁ
 +ğ
Ën
;

6024 
Ën
) {

6025 *
p
 = 
	`¡bi__g‘8
(
s
);

6026 
p
 += 4;

6027 
Ën
--;

6029 } ià(
Ën
 > 128) {

6030 
¡bi_uc
 
v®
;

6033 
Ën
 = 257 -†en;

6034 ià(
Ën
 > 
Æeá
)  0;

6035 
v®
 = 
	`¡bi__g‘8
(
s
);

6036 
couÁ
 +ğ
Ën
;

6037 
Ën
) {

6038 *
p
 = 
v®
;

6039 
p
 += 4;

6040 
Ën
--;

6046 
	}
}

6048 *
	$¡bi__psd_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
, 
bpc
)

6050 
pix–CouÁ
;

6051 
chªÃlCouÁ
, 
com´essiÚ
;

6052 
chªÃl
, 
i
;

6053 
b™d•th
;

6054 
w
,
h
;

6055 
¡bi_uc
 *
out
;

6056 
	`STBI_NOTUSED
(
ri
);

6059 ià(
	`¡bi__g‘32be
(
s
) != 0x38425053)

6060  
	`¡bi__”½uc
("not PSD", "Corrupt PSD image");

6063 ià(
	`¡bi__g‘16be
(
s
) != 1)

6064  
	`¡bi__”½uc
("wrong version", "Unsupported version of PSD image");

6067 
	`¡bi__sk
(
s
, 6 );

6070 
chªÃlCouÁ
 = 
	`¡bi__g‘16be
(
s
);

6071 ià(
chªÃlCouÁ
 < 0 || channelCount > 16)

6072  
	`¡bi__”½uc
("wrong channel count", "Unsupported‚umber of channels in PSD image");

6075 
h
 = 
	`¡bi__g‘32be
(
s
);

6076 
w
 = 
	`¡bi__g‘32be
(
s
);

6078 ià(
h
 > 
STBI_MAX_DIMENSIONS
è 
	`¡bi__”½uc
("too†arge","Very†arge image (corrupt?)");

6079 ià(
w
 > 
STBI_MAX_DIMENSIONS
è 
	`¡bi__”½uc
("too†arge","Very†arge image (corrupt?)");

6082 
b™d•th
 = 
	`¡bi__g‘16be
(
s
);

6083 ià(
b™d•th
 != 8 && bitdepth != 16)

6084  
	`¡bi__”½uc
("unsupported bit depth", "PSD bit depth is‚ot 8 or 16 bit");

6096 ià(
	`¡bi__g‘16be
(
s
) != 3)

6097  
	`¡bi__”½uc
("wrong color format", "PSD is‚ot in RGB color format");

6100 
	`¡bi__sk
(
s
,
	`¡bi__g‘32be
(s) );

6103 
	`¡bi__sk
(
s
, 
	`¡bi__g‘32be
(s) );

6106 
	`¡bi__sk
(
s
, 
	`¡bi__g‘32be
(s) );

6112 
com´essiÚ
 = 
	`¡bi__g‘16be
(
s
);

6113 ià(
com´essiÚ
 > 1)

6114  
	`¡bi__”½uc
("bad compression", "PSD has‡n unknown compression format");

6117 ià(!
	`¡bi__mad3sizes_v®id
(4, 
w
, 
h
, 0))

6118  
	`¡bi__”½uc
("too†arge", "Corrupt PSD");

6122 ià(!
com´essiÚ
 && 
b™d•th
 =ğ16 && 
bpc
 == 16) {

6123 
out
 = (
¡bi_uc
 *è
	`¡bi__m®loc_mad3
(8, 
w
, 
h
, 0);

6124 
ri
->
b™s_³r_chªÃl
 = 16;

6126 
out
 = (
¡bi_uc
 *è
	`¡bi__m®loc
(4 * 
w
*
h
);

6128 ià(!
out
è 
	`¡bi__”½uc
("outofmem", "Out of memory");

6129 
pix–CouÁ
 = 
w
*
h
;

6135 ià(
com´essiÚ
) {

6146 
	`¡bi__sk
(
s
, 
h
 * 
chªÃlCouÁ
 * 2 );

6149 
chªÃl
 = 0; channel < 4; channel++) {

6150 
¡bi_uc
 *
p
;

6152 
p
 = 
out
+
chªÃl
;

6153 ià(
chªÃl
 >ğ
chªÃlCouÁ
) {

6155 
i
 = 0; i < 
pix–CouÁ
; i++, 
p
 += 4)

6156 *
p
 = (
chªÃl
 == 3 ? 255 : 0);

6159 ià(!
	`¡bi__psd_decode_¾e
(
s
, 
p
, 
pix–CouÁ
)) {

6160 
	`STBI_FREE
(
out
);

6161  
	`¡bi__”½uc
("corrupt", "bad RLE data");

6171 
chªÃl
 = 0; channel < 4; channel++) {

6172 ià(
chªÃl
 >ğ
chªÃlCouÁ
) {

6174 ià(
b™d•th
 =ğ16 && 
bpc
 == 16) {

6175 
¡bi__ušt16
 *
q
 = ((¡bi__ušt16 *è
out
è+ 
chªÃl
;

6176 
¡bi__ušt16
 
v®
 = 
chªÃl
 == 3 ? 65535 : 0;

6177 
i
 = 0; i < 
pix–CouÁ
; i++, 
q
 += 4)

6178 *
q
 = 
v®
;

6180 
¡bi_uc
 *
p
 = 
out
+
chªÃl
;

6181 
¡bi_uc
 
v®
 = 
chªÃl
 == 3 ? 255 : 0;

6182 
i
 = 0; i < 
pix–CouÁ
; i++, 
p
 += 4)

6183 *
p
 = 
v®
;

6186 ià(
ri
->
b™s_³r_chªÃl
 == 16) {

6187 
¡bi__ušt16
 *
q
 = ((¡bi__ušt16 *è
out
è+ 
chªÃl
;

6188 
i
 = 0; i < 
pix–CouÁ
; i++, 
q
 += 4)

6189 *
q
 = (
¡bi__ušt16
è
	`¡bi__g‘16be
(
s
);

6191 
¡bi_uc
 *
p
 = 
out
+
chªÃl
;

6192 ià(
b™d•th
 == 16) {

6193 
i
 = 0; i < 
pix–CouÁ
; i++, 
p
 += 4)

6194 *
p
 = (
¡bi_uc
è(
	`¡bi__g‘16be
(
s
) >> 8);

6196 
i
 = 0; i < 
pix–CouÁ
; i++, 
p
 += 4)

6197 *
p
 = 
	`¡bi__g‘8
(
s
);

6205 ià(
chªÃlCouÁ
 >= 4) {

6206 ià(
ri
->
b™s_³r_chªÃl
 == 16) {

6207 
i
=0; i < 
w
*
h
; ++i) {

6208 
¡bi__ušt16
 *
pix–
 = (¡bi__ušt16 *è
out
 + 4*
i
;

6209 ià(
pix–
[3] != 0 &&…ixel[3] != 65535) {

6210 
a
 = 
pix–
[3] / 65535.0f;

6211 
¿
 = 1.0à/ 
a
;

6212 
šv_a
 = 65535.0à* (1 - 
¿
);

6213 
pix–
[0] = (
¡bi__ušt16
èÕix–[0]*
¿
 + 
šv_a
);

6214 
pix–
[1] = (
¡bi__ušt16
èÕix–[1]*
¿
 + 
šv_a
);

6215 
pix–
[2] = (
¡bi__ušt16
èÕix–[2]*
¿
 + 
šv_a
);

6219 
i
=0; i < 
w
*
h
; ++i) {

6220 *
pix–
 = 
out
 + 4*
i
;

6221 ià(
pix–
[3] != 0 &&…ixel[3] != 255) {

6222 
a
 = 
pix–
[3] / 255.0f;

6223 
¿
 = 1.0à/ 
a
;

6224 
šv_a
 = 255.0à* (1 - 
¿
);

6225 
pix–
[0] = (èÕix–[0]*
¿
 + 
šv_a
);

6226 
pix–
[1] = (èÕix–[1]*
¿
 + 
šv_a
);

6227 
pix–
[2] = (èÕix–[2]*
¿
 + 
šv_a
);

6234 ià(
»q_comp
 &&„eq_comp != 4) {

6235 ià(
ri
->
b™s_³r_chªÃl
 == 16)

6236 
out
 = (
¡bi_uc
 *è
	`¡bi__cÚv”t_fÜm©16
((
¡bi__ušt16
 *èout, 4, 
»q_comp
, 
w
, 
h
);

6238 
out
 = 
	`¡bi__cÚv”t_fÜm©
(out, 4, 
»q_comp
, 
w
, 
h
);

6239 ià(
out
 =ğ
NULL
)  out;

6242 ià(
comp
) *comp = 4;

6243 *
y
 = 
h
;

6244 *
x
 = 
w
;

6246  
out
;

6247 
	}
}

6257 #iâdeà
STBI_NO_PIC


6258 
	$¡bi__pic_is4
(
¡bi__cÚ‹xt
 *
s
,cÚ¡ *
¡r
)

6260 
i
;

6261 
i
=0; i<4; ++i)

6262 ià(
	`¡bi__g‘8
(
s
è!ğ(
¡bi_uc
)
¡r
[
i
])

6266 
	}
}

6268 
	$¡bi__pic_‹¡_cÜe
(
¡bi__cÚ‹xt
 *
s
)

6270 
i
;

6272 ià(!
	`¡bi__pic_is4
(
s
,"\x53\x80\xF6\x34"))

6275 
i
=0;i<84;++i)

6276 
	`¡bi__g‘8
(
s
);

6278 ià(!
	`¡bi__pic_is4
(
s
,"PICT"))

6282 
	}
}

6286 
¡bi_uc
 
	msize
,
	mty³
,
	mchªÃl
;

6287 } 
	t¡bi__pic_·ck‘
;

6289 
¡bi_uc
 *
	$¡bi__»adv®
(
¡bi__cÚ‹xt
 *
s
, 
chªÃl
, 
¡bi_uc
 *
de¡
)

6291 
mask
=0x80, 
i
;

6293 
i
=0; i<4; ++i, 
mask
>>=1) {

6294 ià(
chªÃl
 & 
mask
) {

6295 ià(
	`¡bi__©_eof
(
s
)è 
	`¡bi__”½uc
("bad file","PIC fileoo short");

6296 
de¡
[
i
]=
	`¡bi__g‘8
(
s
);

6300  
de¡
;

6301 
	}
}

6303 
	$¡bi__cİyv®
(
chªÃl
,
¡bi_uc
 *
de¡
,cÚ¡ stbi_uø*
¤c
)

6305 
mask
=0x80,
i
;

6307 
i
=0;i<4; ++i, 
mask
>>=1)

6308 ià(
chªÃl
&
mask
)

6309 
de¡
[
i
]=
¤c
[i];

6310 
	}
}

6312 
¡bi_uc
 *
	$¡bi__pic_lßd_cÜe
(
¡bi__cÚ‹xt
 *
s
,
width
,
height
,*
comp
, 
¡bi_uc
 *
»suÉ
)

6314 
aù_comp
=0,
num_·ck‘s
=0,
y
,
chašed
;

6315 
¡bi__pic_·ck‘
 
·ck‘s
[10];

6320 
¡bi__pic_·ck‘
 *
·ck‘
;

6322 ià(
num_·ck‘s
==(
·ck‘s
)/(packets[0]))

6323  
	`¡bi__”½uc
("bad format","too many…ackets");

6325 
·ck‘
 = &
·ck‘s
[
num_·ck‘s
++];

6327 
chašed
 = 
	`¡bi__g‘8
(
s
);

6328 
·ck‘
->
size
 = 
	`¡bi__g‘8
(
s
);

6329 
·ck‘
->
ty³
 = 
	`¡bi__g‘8
(
s
);

6330 
·ck‘
->
chªÃl
 = 
	`¡bi__g‘8
(
s
);

6332 
aù_comp
 |ğ
·ck‘
->
chªÃl
;

6334 ià(
	`¡bi__©_eof
(
s
)è 
	`¡bi__”½uc
("bad file","fileoo short (reading…ackets)");

6335 ià(
·ck‘
->
size
 !ğ8è 
	`¡bi__”½uc
("bad format","packet isn't 8bpp");

6336 } 
chašed
);

6338 *
comp
 = (
aù_comp
 & 0x10 ? 4 : 3);

6340 
y
=0; y<
height
; ++y) {

6341 
·ck‘_idx
;

6343 
·ck‘_idx
=0;…ack‘_idx < 
num_·ck‘s
; ++packet_idx) {

6344 
¡bi__pic_·ck‘
 *
·ck‘
 = &
·ck‘s
[
·ck‘_idx
];

6345 
¡bi_uc
 *
de¡
 = 
»suÉ
+
y
*
width
*4;

6347 
·ck‘
->
ty³
) {

6349  
	`¡bi__”½uc
("bad format","packet has bad compressionype");

6352 
x
;

6354 
x
=0;x<
width
;++x, 
de¡
+=4)

6355 ià(!
	`¡bi__»adv®
(
s
,
·ck‘
->
chªÃl
,
de¡
))

6362 
Ëá
=
width
, 
i
;

6364 
Ëá
>0) {

6365 
¡bi_uc
 
couÁ
,
v®ue
[4];

6367 
couÁ
=
	`¡bi__g‘8
(
s
);

6368 ià(
	`¡bi__©_eof
(
s
)è 
	`¡bi__”½uc
("bad file","fileoo short (pure„ead count)");

6370 ià(
couÁ
 > 
Ëá
)

6371 
couÁ
 = (
¡bi_uc
è
Ëá
;

6373 ià(!
	`¡bi__»adv®
(
s
,
·ck‘
->
chªÃl
,
v®ue
))  0;

6375 
i
=0; i<
couÁ
; ++i,
de¡
+=4)

6376 
	`¡bi__cİyv®
(
·ck‘
->
chªÃl
,
de¡
,
v®ue
);

6377 
Ëá
 -ğ
couÁ
;

6383 
Ëá
=
width
;

6384 
Ëá
>0) {

6385 
couÁ
 = 
	`¡bi__g‘8
(
s
), 
i
;

6386 ià(
	`¡bi__©_eof
(
s
)è 
	`¡bi__”½uc
("bad file","fileoo short (mixed„ead count)");

6388 ià(
couÁ
 >= 128) {

6389 
¡bi_uc
 
v®ue
[4];

6391 ià(
couÁ
==128)

6392 
couÁ
 = 
	`¡bi__g‘16be
(
s
);

6394 
couÁ
 -= 127;

6395 ià(
couÁ
 > 
Ëá
)

6396  
	`¡bi__”½uc
("bad file","scanline overrun");

6398 ià(!
	`¡bi__»adv®
(
s
,
·ck‘
->
chªÃl
,
v®ue
))

6401 
i
=0;i<
couÁ
;++i, 
de¡
 += 4)

6402 
	`¡bi__cİyv®
(
·ck‘
->
chªÃl
,
de¡
,
v®ue
);

6404 ++
couÁ
;

6405 ià(
couÁ
>
Ëá
è 
	`¡bi__”½uc
("bad file","scanline overrun");

6407 
i
=0;i<
couÁ
;++i, 
de¡
+=4)

6408 ià(!
	`¡bi__»adv®
(
s
,
·ck‘
->
chªÃl
,
de¡
))

6411 
Ëá
-=
couÁ
;

6419  
»suÉ
;

6420 
	}
}

6422 *
	$¡bi__pic_lßd
(
¡bi__cÚ‹xt
 *
s
,*
px
,*
py
,*
comp
,
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
)

6424 
¡bi_uc
 *
»suÉ
;

6425 
i
, 
x
,
y
, 
š‹º®_comp
;

6426 
	`STBI_NOTUSED
(
ri
);

6428 ià(!
comp
ècom°ğ&
š‹º®_comp
;

6430 
i
=0; i<92; ++i)

6431 
	`¡bi__g‘8
(
s
);

6433 
x
 = 
	`¡bi__g‘16be
(
s
);

6434 
y
 = 
	`¡bi__g‘16be
(
s
);

6436 ià(
y
 > 
STBI_MAX_DIMENSIONS
è 
	`¡bi__”½uc
("too†arge","Very†arge image (corrupt?)");

6437 ià(
x
 > 
STBI_MAX_DIMENSIONS
è 
	`¡bi__”½uc
("too†arge","Very†arge image (corrupt?)");

6439 ià(
	`¡bi__©_eof
(
s
)è 
	`¡bi__”½uc
("bad file","fileoo short (pic header)");

6440 ià(!
	`¡bi__mad3sizes_v®id
(
x
, 
y
, 4, 0)è 
	`¡bi__”½uc
("too†arge", "PIC imageoo†argeo decode");

6442 
	`¡bi__g‘32be
(
s
);

6443 
	`¡bi__g‘16be
(
s
);

6444 
	`¡bi__g‘16be
(
s
);

6447 
»suÉ
 = (
¡bi_uc
 *è
	`¡bi__m®loc_mad3
(
x
, 
y
, 4, 0);

6448 ià(!
»suÉ
è 
	`¡bi__”½uc
("outofmem", "Out of memory");

6449 
	`mem£t
(
»suÉ
, 0xff, 
x
*
y
*4);

6451 ià(!
	`¡bi__pic_lßd_cÜe
(
s
,
x
,
y
,
comp
, 
»suÉ
)) {

6452 
	`STBI_FREE
(
»suÉ
);

6453 
»suÉ
=0;

6455 *
px
 = 
x
;

6456 *
py
 = 
y
;

6457 ià(
»q_comp
 =ğ0è»q_com°ğ*
comp
;

6458 
»suÉ
=
	`¡bi__cÚv”t_fÜm©
ÔesuÉ,4,
»q_comp
,
x
,
y
);

6460  
»suÉ
;

6461 
	}
}

6463 
	$¡bi__pic_‹¡
(
¡bi__cÚ‹xt
 *
s
)

6465 
r
 = 
	`¡bi__pic_‹¡_cÜe
(
s
);

6466 
	`¡bi__»wšd
(
s
);

6467  
r
;

6468 
	}
}

6474 #iâdeà
STBI_NO_GIF


6477 
¡bi__št16
 
	m´efix
;

6478 
¡bi_uc
 
	mfœ¡
;

6479 
¡bi_uc
 
	msuffix
;

6480 } 
	t¡bi__gif_lzw
;

6484 
	mw
,
	mh
;

6485 
¡bi_uc
 *
	mout
;

6486 
¡bi_uc
 *
	mbackground
;

6487 
¡bi_uc
 *
	mhi¡Üy
;

6488 
	mæags
, 
	mbgšdex
, 
	m¿tio
, 
	mŒª¥¬’t
, 
	meæags
;

6489 
¡bi_uc
 
	m·l
[256][4];

6490 
¡bi_uc
 
	mÍ®
[256][4];

6491 
¡bi__gif_lzw
 
	mcodes
[8192];

6492 
¡bi_uc
 *
	mcŞÜ_bË
;

6493 
	m·r£
, 
	m¡•
;

6494 
	mlæags
;

6495 
	m¡¬t_x
, 
	m¡¬t_y
;

6496 
	mmax_x
, 
	mmax_y
;

6497 
	mcur_x
, 
	mcur_y
;

6498 
	mlše_size
;

6499 
	md–ay
;

6500 } 
	t¡bi__gif
;

6502 
	$¡bi__gif_‹¡_¿w
(
¡bi__cÚ‹xt
 *
s
)

6504 
sz
;

6505 ià(
	`¡bi__g‘8
(
s
) != 'G' || stbi__get8(s) != 'I' || stbi__get8(s) != 'F' || stbi__get8(s) != '8')  0;

6506 
sz
 = 
	`¡bi__g‘8
(
s
);

6507 ià(
sz
 != '9' && sz != '7')  0;

6508 ià(
	`¡bi__g‘8
(
s
) != 'a')  0;

6510 
	}
}

6512 
	$¡bi__gif_‹¡
(
¡bi__cÚ‹xt
 *
s
)

6514 
r
 = 
	`¡bi__gif_‹¡_¿w
(
s
);

6515 
	`¡bi__»wšd
(
s
);

6516  
r
;

6517 
	}
}

6519 
	$¡bi__gif_·r£_cŞÜbË
(
¡bi__cÚ‹xt
 *
s
, 
¡bi_uc
 
·l
[256][4], 
num_’Œ›s
, 
Œª¥
)

6521 
i
;

6522 
i
=0; i < 
num_’Œ›s
; ++i) {

6523 
·l
[
i
][2] = 
	`¡bi__g‘8
(
s
);

6524 
·l
[
i
][1] = 
	`¡bi__g‘8
(
s
);

6525 
·l
[
i
][0] = 
	`¡bi__g‘8
(
s
);

6526 
·l
[
i
][3] = 
Œª¥
 == i ? 0 : 255;

6528 
	}
}

6530 
	$¡bi__gif_h—d”
(
¡bi__cÚ‹xt
 *
s
, 
¡bi__gif
 *
g
, *
comp
, 
is_šfo
)

6532 
¡bi_uc
 
v”siÚ
;

6533 ià(
	`¡bi__g‘8
(
s
) != 'G' || stbi__get8(s) != 'I' || stbi__get8(s) != 'F' || stbi__get8(s) != '8')

6534  
	`¡bi__”r
("not GIF", "Corrupt GIF");

6536 
v”siÚ
 = 
	`¡bi__g‘8
(
s
);

6537 ià(
v”siÚ
 !ğ'7' && v”siÚ !ğ'9'è 
	`¡bi__”r
("not GIF", "Corrupt GIF");

6538 ià(
	`¡bi__g‘8
(
s
è!ğ'a'è 
	`¡bi__”r
("not GIF", "Corrupt GIF");

6540 
¡bi__g_çu»_»asÚ
 = "";

6541 
g
->
w
 = 
	`¡bi__g‘16Ë
(
s
);

6542 
g
->
h
 = 
	`¡bi__g‘16Ë
(
s
);

6543 
g
->
æags
 = 
	`¡bi__g‘8
(
s
);

6544 
g
->
bgšdex
 = 
	`¡bi__g‘8
(
s
);

6545 
g
->
¿tio
 = 
	`¡bi__g‘8
(
s
);

6546 
g
->
Œª¥¬’t
 = -1;

6548 ià(
g
->
w
 > 
STBI_MAX_DIMENSIONS
è 
	`¡bi__”r
("too†arge","Very†arge image (corrupt?)");

6549 ià(
g
->
h
 > 
STBI_MAX_DIMENSIONS
è 
	`¡bi__”r
("too†arge","Very†arge image (corrupt?)");

6551 ià(
comp
 != 0) *comp = 4;

6553 ià(
is_šfo
)  1;

6555 ià(
g
->
æags
 & 0x80)

6556 
	`¡bi__gif_·r£_cŞÜbË
(
s
,
g
->
·l
, 2 << (g->
æags
 & 7), -1);

6559 
	}
}

6561 
	$¡bi__gif_šfo_¿w
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
)

6563 
¡bi__gif
* 
g
 = (¡bi__gif*è
	`¡bi__m®loc
((stbi__gif));

6564 ià(!
g
è 
	`¡bi__”r
("outofmem", "Out of memory");

6565 ià(!
	`¡bi__gif_h—d”
(
s
, 
g
, 
comp
, 1)) {

6566 
	`STBI_FREE
(
g
);

6567 
	`¡bi__»wšd
Ğ
s
 );

6570 ià(
x
è*x = 
g
->
w
;

6571 ià(
y
è*y = 
g
->
h
;

6572 
	`STBI_FREE
(
g
);

6574 
	}
}

6576 
	$¡bi__out_gif_code
(
¡bi__gif
 *
g
, 
¡bi__ušt16
 
code
)

6578 
¡bi_uc
 *
p
, *
c
;

6579 
idx
;

6583 ià(
g
->
codes
[
code
].
´efix
 >= 0)

6584 
	`¡bi__out_gif_code
(
g
, g->
codes
[
code
].
´efix
);

6586 ià(
g
->
cur_y
 >ğg->
max_y
) ;

6588 
idx
 = 
g
->
cur_x
 + g->
cur_y
;

6589 
p
 = &
g
->
out
[
idx
];

6590 
g
->
hi¡Üy
[
idx
 / 4] = 1;

6592 
c
 = &
g
->
cŞÜ_bË
[g->
codes
[
code
].
suffix
 * 4];

6593 ià(
c
[3] > 128) {

6594 
p
[0] = 
c
[2];

6595 
p
[1] = 
c
[1];

6596 
p
[2] = 
c
[0];

6597 
p
[3] = 
c
[3];

6599 
g
->
cur_x
 += 4;

6601 ià(
g
->
cur_x
 >ğg->
max_x
) {

6602 
g
->
cur_x
 = g->
¡¬t_x
;

6603 
g
->
cur_y
 +ğg->
¡•
;

6605 
g
->
cur_y
 >ğg->
max_y
 && g->
·r£
 > 0) {

6606 
g
->
¡•
 = (1 << g->
·r£
è* g->
lše_size
;

6607 
g
->
cur_y
 = g->
¡¬t_y
 + (g->
¡•
 >> 1);

6608 --
g
->
·r£
;

6611 
	}
}

6613 
¡bi_uc
 *
	$¡bi__´oûss_gif_¿¡”
(
¡bi__cÚ‹xt
 *
s
, 
¡bi__gif
 *
g
)

6615 
¡bi_uc
 
lzw_cs
;

6616 
¡bi__št32
 
Ën
, 
š™_code
;

6617 
¡bi__ušt32
 
fœ¡
;

6618 
¡bi__št32
 
codesize
, 
codemask
, 
ava
, 
Şdcode
, 
b™s
, 
v®id_b™s
, 
ş—r
;

6619 
¡bi__gif_lzw
 *
p
;

6621 
lzw_cs
 = 
	`¡bi__g‘8
(
s
);

6622 ià(
lzw_cs
 > 12è 
NULL
;

6623 
ş—r
 = 1 << 
lzw_cs
;

6624 
fœ¡
 = 1;

6625 
codesize
 = 
lzw_cs
 + 1;

6626 
codemask
 = (1 << 
codesize
) - 1;

6627 
b™s
 = 0;

6628 
v®id_b™s
 = 0;

6629 
š™_code
 = 0; in™_cod< 
ş—r
; init_code++) {

6630 
g
->
codes
[
š™_code
].
´efix
 = -1;

6631 
g
->
codes
[
š™_code
].
fœ¡
 = (
¡bi_uc
) init_code;

6632 
g
->
codes
[
š™_code
].
suffix
 = (
¡bi_uc
) init_code;

6636 
ava
 = 
ş—r
+2;

6637 
Şdcode
 = -1;

6639 
Ën
 = 0;

6641 ià(
v®id_b™s
 < 
codesize
) {

6642 ià(
Ën
 == 0) {

6643 
Ën
 = 
	`¡bi__g‘8
(
s
);

6644 ià(
Ën
 == 0)

6645  
g
->
out
;

6647 --
Ën
;

6648 
b™s
 |ğ(
¡bi__št32
è
	`¡bi__g‘8
(
s
è<< 
v®id_b™s
;

6649 
v®id_b™s
 += 8;

6651 
¡bi__št32
 
code
 = 
b™s
 & 
codemask
;

6652 
b™s
 >>ğ
codesize
;

6653 
v®id_b™s
 -ğ
codesize
;

6655 ià(
code
 =ğ
ş—r
) {

6656 
codesize
 = 
lzw_cs
 + 1;

6657 
codemask
 = (1 << 
codesize
) - 1;

6658 
ava
 = 
ş—r
 + 2;

6659 
Şdcode
 = -1;

6660 
fœ¡
 = 0;

6661 } ià(
code
 =ğ
ş—r
 + 1) {

6662 
	`¡bi__sk
(
s
, 
Ën
);

6663 (
Ën
 = 
	`¡bi__g‘8
(
s
)) > 0)

6664 
	`¡bi__sk
(
s
,
Ën
);

6665  
g
->
out
;

6666 } ià(
code
 <ğ
ava
) {

6667 ià(
fœ¡
) {

6668  
	`¡bi__”½uc
("no clear code", "Corrupt GIF");

6671 ià(
Şdcode
 >= 0) {

6672 
p
 = &
g
->
codes
[
ava
++];

6673 ià(
ava
 > 8192) {

6674  
	`¡bi__”½uc
("too many codes", "Corrupt GIF");

6677 
p
->
´efix
 = (
¡bi__št16
è
Şdcode
;

6678 
p
->
fœ¡
 = 
g
->
codes
[
Şdcode
].first;

6679 
p
->
suffix
 = (
code
 =ğ
ava
è?…->
fœ¡
 : 
g
->
codes
[code].first;

6680 } ià(
code
 =ğ
ava
)

6681  
	`¡bi__”½uc
("illegal code in„aster", "Corrupt GIF");

6683 
	`¡bi__out_gif_code
(
g
, (
¡bi__ušt16
è
code
);

6685 ià((
ava
 & 
codemask
) == 0 &&‡vail <= 0x0FFF) {

6686 
codesize
++;

6687 
codemask
 = (1 << 
codesize
) - 1;

6690 
Şdcode
 = 
code
;

6692  
	`¡bi__”½uc
("illegal code in„aster", "Corrupt GIF");

6696 
	}
}

6700 
¡bi_uc
 *
	$¡bi__gif_lßd_Ãxt
(
¡bi__cÚ‹xt
 *
s
, 
¡bi__gif
 *
g
, *
comp
, 
»q_comp
, 
¡bi_uc
 *
two_back
)

6702 
di¥o£
;

6703 
fœ¡_äame
;

6704 
pi
;

6705 
pcouÁ
;

6706 
	`STBI_NOTUSED
(
»q_comp
);

6709 
fœ¡_äame
 = 0;

6710 ià(
g
->
out
 == 0) {

6711 ià(!
	`¡bi__gif_h—d”
(
s
, 
g
, 
comp
,0))  0;

6712 ià(!
	`¡bi__mad3sizes_v®id
(4, 
g
->
w
, g->
h
, 0))

6713  
	`¡bi__”½uc
("too†arge", "GIF image isoo†arge");

6714 
pcouÁ
 = 
g
->
w
 * g->
h
;

6715 
g
->
out
 = (
¡bi_uc
 *è
	`¡bi__m®loc
(4 * 
pcouÁ
);

6716 
g
->
background
 = (
¡bi_uc
 *è
	`¡bi__m®loc
(4 * 
pcouÁ
);

6717 
g
->
hi¡Üy
 = (
¡bi_uc
 *è
	`¡bi__m®loc
(
pcouÁ
);

6718 ià(!
g
->
out
 || !g->
background
 || !g->
hi¡Üy
)

6719  
	`¡bi__”½uc
("outofmem", "Out of memory");

6724 
	`mem£t
(
g
->
out
, 0x00, 4 * 
pcouÁ
);

6725 
	`mem£t
(
g
->
background
, 0x00, 4 * 
pcouÁ
);

6726 
	`mem£t
(
g
->
hi¡Üy
, 0x00, 
pcouÁ
);

6727 
fœ¡_äame
 = 1;

6730 
di¥o£
 = (
g
->
eæags
 & 0x1C) >> 2;

6731 
pcouÁ
 = 
g
->
w
 * g->
h
;

6733 ià((
di¥o£
 =ğ3è&& (
two_back
 == 0)) {

6734 
di¥o£
 = 2;

6737 ià(
di¥o£
 == 3) {

6738 
pi
 = 0;…˜< 
pcouÁ
; ++pi) {

6739 ià(
g
->
hi¡Üy
[
pi
]) {

6740 
	`memıy
Ğ&
g
->
out
[
pi
 * 4], &
two_back
[pi * 4], 4 );

6743 } ià(
di¥o£
 == 2) {

6745 
pi
 = 0;…˜< 
pcouÁ
; ++pi) {

6746 ià(
g
->
hi¡Üy
[
pi
]) {

6747 
	`memıy
Ğ&
g
->
out
[
pi
 * 4], &g->
background
[pi * 4], 4 );

6758 
	`memıy
Ğ
g
->
background
, g->
out
, 4 * g->
w
 * g->
h
 );

6762 
	`mem£t
Ğ
g
->
hi¡Üy
, 0x00, g->
w
 * g->
h
 );

6765 
g
 = 
	`¡bi__g‘8
(
s
);

6766 
g
) {

6769 
¡bi__št32
 
x
, 
y
, 
w
, 
h
;

6770 
¡bi_uc
 *
o
;

6772 
x
 = 
	`¡bi__g‘16Ë
(
s
);

6773 
y
 = 
	`¡bi__g‘16Ë
(
s
);

6774 
w
 = 
	`¡bi__g‘16Ë
(
s
);

6775 
h
 = 
	`¡bi__g‘16Ë
(
s
);

6776 ià(((
x
 + 
w
è> (
g
->w)è|| ((
y
 + 
h
) > (g->h)))

6777  
	`¡bi__”½uc
("bad Image Descriptor", "Corrupt GIF");

6779 
g
->
lše_size
 = g->
w
 * 4;

6780 
g
->
¡¬t_x
 = 
x
 * 4;

6781 
g
->
¡¬t_y
 = 
y
 * g->
lše_size
;

6782 
g
->
max_x
 = g->
¡¬t_x
 + 
w
 * 4;

6783 
g
->
max_y
 = g->
¡¬t_y
 + 
h
 * g->
lše_size
;

6784 
g
->
cur_x
 = g->
¡¬t_x
;

6785 
g
->
cur_y
 = g->
¡¬t_y
;

6791 ià(
w
 == 0)

6792 
g
->
cur_y
 = g->
max_y
;

6794 
g
->
læags
 = 
	`¡bi__g‘8
(
s
);

6796 ià(
g
->
læags
 & 0x40) {

6797 
g
->
¡•
 = 8 * g->
lše_size
;

6798 
g
->
·r£
 = 3;

6800 
g
->
¡•
 = g->
lše_size
;

6801 
g
->
·r£
 = 0;

6804 ià(
g
->
læags
 & 0x80) {

6805 
	`¡bi__gif_·r£_cŞÜbË
(
s
,
g
->
Í®
, 2 << (g->
læags
 & 7), g->
eæags
 & 0x01 ? g->
Œª¥¬’t
 : -1);

6806 
g
->
cŞÜ_bË
 = (
¡bi_uc
 *èg->
Í®
;

6807 } ià(
g
->
æags
 & 0x80) {

6808 
g
->
cŞÜ_bË
 = (
¡bi_uc
 *èg->
·l
;

6810  
	`¡bi__”½uc
("missing colorable", "Corrupt GIF");

6812 
o
 = 
	`¡bi__´oûss_gif_¿¡”
(
s
, 
g
);

6813 ià(!
o
è 
NULL
;

6816 
pcouÁ
 = 
g
->
w
 * g->
h
;

6817 ià(
fœ¡_äame
 && (
g
->
bgšdex
 > 0)) {

6819 
pi
 = 0;…˜< 
pcouÁ
; ++pi) {

6820 ià(
g
->
hi¡Üy
[
pi
] == 0) {

6821 
g
->
·l
[g->
bgšdex
][3] = 255;

6822 
	`memıy
Ğ&
g
->
out
[
pi
 * 4], &g->
·l
[g->
bgšdex
], 4 );

6827  
o
;

6832 
Ën
;

6833 
ext
 = 
	`¡bi__g‘8
(
s
);

6834 ià(
ext
 == 0xF9) {

6835 
Ën
 = 
	`¡bi__g‘8
(
s
);

6836 ià(
Ën
 == 4) {

6837 
g
->
eæags
 = 
	`¡bi__g‘8
(
s
);

6838 
g
->
d–ay
 = 10 * 
	`¡bi__g‘16Ë
(
s
);

6841 ià(
g
->
Œª¥¬’t
 >= 0) {

6842 
g
->
·l
[g->
Œª¥¬’t
][3] = 255;

6844 ià(
g
->
eæags
 & 0x01) {

6845 
g
->
Œª¥¬’t
 = 
	`¡bi__g‘8
(
s
);

6846 ià(
g
->
Œª¥¬’t
 >= 0) {

6847 
g
->
·l
[g->
Œª¥¬’t
][3] = 0;

6851 
	`¡bi__sk
(
s
, 1);

6852 
g
->
Œª¥¬’t
 = -1;

6855 
	`¡bi__sk
(
s
, 
Ën
);

6859 (
Ën
 = 
	`¡bi__g‘8
(
s
)) != 0) {

6860 
	`¡bi__sk
(
s
, 
Ën
);

6866  (
¡bi_uc
 *è
s
;

6869  
	`¡bi__”½uc
("unknown code", "Corrupt GIF");

6872 
	}
}

6874 *
	$¡bi__lßd_gif_maš_outofmem
(
¡bi__gif
 *
g
, 
¡bi_uc
 *
out
, **
d–ays
)

6876 
	`STBI_FREE
(
g
->
out
);

6877 
	`STBI_FREE
(
g
->
hi¡Üy
);

6878 
	`STBI_FREE
(
g
->
background
);

6880 ià(
out
è
	`STBI_FREE
(out);

6881 ià(
d–ays
 && *d–aysè
	`STBI_FREE
(*delays);

6882  
	`¡bi__”½uc
("outofmem", "Out of memory");

6883 
	}
}

6885 *
	$¡bi__lßd_gif_maš
(
¡bi__cÚ‹xt
 *
s
, **
d–ays
, *
x
, *
y
, *
z
, *
comp
, 
»q_comp
)

6887 ià(
	`¡bi__gif_‹¡
(
s
)) {

6888 
Ïy”s
 = 0;

6889 
¡bi_uc
 *
u
 = 0;

6890 
¡bi_uc
 *
out
 = 0;

6891 
¡bi_uc
 *
two_back
 = 0;

6892 
¡bi__gif
 
g
;

6893 
¡ride
;

6894 
out_size
 = 0;

6895 
d–ays_size
 = 0;

6897 
	`STBI_NOTUSED
(
out_size
);

6898 
	`STBI_NOTUSED
(
d–ays_size
);

6900 
	`mem£t
(&
g
, 0, (g));

6901 ià(
d–ays
) {

6902 *
d–ays
 = 0;

6906 
u
 = 
	`¡bi__gif_lßd_Ãxt
(
s
, &
g
, 
comp
, 
»q_comp
, 
two_back
);

6907 ià(
u
 =ğ(
¡bi_uc
 *è
s
) u = 0;

6909 ià(
u
) {

6910 *
x
 = 
g
.
w
;

6911 *
y
 = 
g
.
h
;

6912 ++
Ïy”s
;

6913 
¡ride
 = 
g
.
w
 * g.
h
 * 4;

6915 ià(
out
) {

6916 *
tmp
 = (
¡bi_uc
*è
	`STBI_REALLOC_SIZED
Ğ
out
, 
out_size
, 
Ïy”s
 * 
¡ride
 );

6917 ià(!
tmp
)

6918  
	`¡bi__lßd_gif_maš_outofmem
(&
g
, 
out
, 
d–ays
);

6920 
out
 = (
¡bi_uc
*è
tmp
;

6921 
out_size
 = 
Ïy”s
 * 
¡ride
;

6924 ià(
d–ays
) {

6925 *
Ãw_d–ays
 = (*è
	`STBI_REALLOC_SIZED
Ğ*
d–ays
, 
d–ays_size
, (è* 
Ïy”s
 );

6926 ià(!
Ãw_d–ays
)

6927  
	`¡bi__lßd_gif_maš_outofmem
(&
g
, 
out
, 
d–ays
);

6928 *
d–ays
 = 
Ãw_d–ays
;

6929 
d–ays_size
 = 
Ïy”s
 * ();

6932 
out
 = (
¡bi_uc
*)
	`¡bi__m®loc
Ğ
Ïy”s
 * 
¡ride
 );

6933 ià(!
out
)

6934  
	`¡bi__lßd_gif_maš_outofmem
(&
g
, 
out
, 
d–ays
);

6935 
out_size
 = 
Ïy”s
 * 
¡ride
;

6936 ià(
d–ays
) {

6937 *
d–ays
 = (*è
	`¡bi__m®loc
Ğ
Ïy”s
 * () );

6938 ià(!*
d–ays
)

6939  
	`¡bi__lßd_gif_maš_outofmem
(&
g
, 
out
, 
d–ays
);

6940 
d–ays_size
 = 
Ïy”s
 * ();

6943 
	`memıy
Ğ
out
 + ((
Ïy”s
 - 1è* 
¡ride
), 
u
, stride );

6944 ià(
Ïy”s
 >= 2) {

6945 
two_back
 = 
out
 - 2 * 
¡ride
;

6948 ià(
d–ays
) {

6949 (*
d–ays
)[
Ïy”s
 - 1U] = 
g
.
d–ay
;

6952 } 
u
 != 0);

6955 
	`STBI_FREE
(
g
.
out
);

6956 
	`STBI_FREE
(
g
.
hi¡Üy
);

6957 
	`STBI_FREE
(
g
.
background
);

6960 ià(
»q_comp
 &&„eq_comp != 4)

6961 
out
 = 
	`¡bi__cÚv”t_fÜm©
(out, 4, 
»q_comp
, 
Ïy”s
 * 
g
.
w
, g.
h
);

6963 *
z
 = 
Ïy”s
;

6964  
out
;

6966  
	`¡bi__”½uc
("not GIF", "Image was‚ot‡s‡ gifype.");

6968 
	}
}

6970 *
	$¡bi__gif_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
)

6972 
¡bi_uc
 *
u
 = 0;

6973 
¡bi__gif
 
g
;

6974 
	`mem£t
(&
g
, 0, (g));

6975 
	`STBI_NOTUSED
(
ri
);

6977 
u
 = 
	`¡bi__gif_lßd_Ãxt
(
s
, &
g
, 
comp
, 
»q_comp
, 0);

6978 ià(
u
 =ğ(
¡bi_uc
 *è
s
) u = 0;

6979 ià(
u
) {

6980 *
x
 = 
g
.
w
;

6981 *
y
 = 
g
.
h
;

6985 ià(
»q_comp
 &&„eq_comp != 4)

6986 
u
 = 
	`¡bi__cÚv”t_fÜm©
(u, 4, 
»q_comp
, 
g
.
w
, g.
h
);

6987 } ià(
g
.
out
) {

6989 
	`STBI_FREE
(
g
.
out
);

6993 
	`STBI_FREE
(
g
.
hi¡Üy
);

6994 
	`STBI_FREE
(
g
.
background
);

6996  
u
;

6997 
	}
}

6999 
	$¡bi__gif_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
)

7001  
	`¡bi__gif_šfo_¿w
(
s
,
x
,
y
,
comp
);

7002 
	}
}

7008 #iâdeà
STBI_NO_HDR


7009 
	$¡bi__hdr_‹¡_cÜe
(
¡bi__cÚ‹xt
 *
s
, cÚ¡ *
sigÇtu»
)

7011 
i
;

7012 
i
=0; 
sigÇtu»
[i]; ++i)

7013 ià(
	`¡bi__g‘8
(
s
è!ğ
sigÇtu»
[
i
])

7015 
	`¡bi__»wšd
(
s
);

7017 
	}
}

7019 
	$¡bi__hdr_‹¡
(
¡bi__cÚ‹xt
* 
s
)

7021 
r
 = 
	`¡bi__hdr_‹¡_cÜe
(
s
, "#?RADIANCE\n");

7022 
	`¡bi__»wšd
(
s
);

7023 if(!
r
) {

7024 
r
 = 
	`¡bi__hdr_‹¡_cÜe
(
s
, "#?RGBE\n");

7025 
	`¡bi__»wšd
(
s
);

7027  
r
;

7028 
	}
}

7030 
	#STBI__HDR_BUFLEN
 1024

	)

7031 *
	$¡bi__hdr_g‘tok’
(
¡bi__cÚ‹xt
 *
z
, *
bufãr
)

7033 
Ën
=0;

7034 
c
 = '\0';

7036 
c
 = (è
	`¡bi__g‘8
(
z
);

7038 !
	`¡bi__©_eof
(
z
è&& 
c
 != '\n') {

7039 
bufãr
[
Ën
++] = 
c
;

7040 ià(
Ën
 =ğ
STBI__HDR_BUFLEN
-1) {

7042 !
	`¡bi__©_eof
(
z
è&& 
	`¡bi__g‘8
(z) != '\n')

7046 
c
 = (è
	`¡bi__g‘8
(
z
);

7049 
bufãr
[
Ën
] = 0;

7050  
bufãr
;

7051 
	}
}

7053 
	$¡bi__hdr_cÚv”t
(*
ouut
, 
¡bi_uc
 *
šput
, 
»q_comp
)

7055 iàĞ
šput
[3] != 0 ) {

7056 
f1
;

7058 
f1
 = (è
	`ldexp
(1.0f, 
šput
[3] - ()(128 + 8));

7059 ià(
»q_comp
 <= 2)

7060 
ouut
[0] = (
šput
[0] + iÅut[1] + iÅut[2]è* 
f1
 / 3;

7062 
ouut
[0] = 
šput
[0] * 
f1
;

7063 
ouut
[1] = 
šput
[1] * 
f1
;

7064 
ouut
[2] = 
šput
[2] * 
f1
;

7066 ià(
»q_comp
 =ğ2è
ouut
[1] = 1;

7067 ià(
»q_comp
 =ğ4è
ouut
[3] = 1;

7069 
»q_comp
) {

7070 4: 
ouut
[3] = 1;

7071 3: 
ouut
[0] = output[1] = output[2] = 0;

7073 2: 
ouut
[1] = 1;

7074 1: 
ouut
[0] = 0;

7078 
	}
}

7080 *
	$¡bi__hdr_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
)

7082 
bufãr
[
STBI__HDR_BUFLEN
];

7083 *
tok’
;

7084 
v®id
 = 0;

7085 
width
, 
height
;

7086 
¡bi_uc
 *
sÿÆše
;

7087 *
hdr_d©a
;

7088 
Ën
;

7089 
couÁ
, 
v®ue
;

7090 
i
, 
j
, 
k
, 
c1
,
c2
, 
z
;

7091 cÚ¡ *
h—d”Tok’
;

7092 
	`STBI_NOTUSED
(
ri
);

7095 
h—d”Tok’
 = 
	`¡bi__hdr_g‘tok’
(
s
,
bufãr
);

7096 ià(
	`¡rcmp
(
h—d”Tok’
, "#?RADIANCE") != 0 && strcmp(headerToken, "#?RGBE") != 0)

7097  
	`¡bi__”½f
("not HDR", "Corrupt HDR image");

7101 
tok’
 = 
	`¡bi__hdr_g‘tok’
(
s
,
bufãr
);

7102 ià(
tok’
[0] == 0) ;

7103 ià(
	`¡rcmp
(
tok’
, "FORMAT=32-b™_¾e_rgbe"è=ğ0è
v®id
 = 1;

7106 ià(!
v®id
è 
	`¡bi__”½f
("unsupported format", "Unsupported HDR format");

7110 
tok’
 = 
	`¡bi__hdr_g‘tok’
(
s
,
bufãr
);

7111 ià(
	`¡ºcmp
(
tok’
, "-Y ", 3)è 
	`¡bi__”½f
("unsupported data†ayout", "Unsupported HDR format");

7112 
tok’
 += 3;

7113 
height
 = (è
	`¡¹Ş
(
tok’
, &token, 10);

7114 *
tok’
 == ' ') ++token;

7115 ià(
	`¡ºcmp
(
tok’
, "+X ", 3)è 
	`¡bi__”½f
("unsupported data†ayout", "Unsupported HDR format");

7116 
tok’
 += 3;

7117 
width
 = (è
	`¡¹Ş
(
tok’
, 
NULL
, 10);

7119 ià(
height
 > 
STBI_MAX_DIMENSIONS
è 
	`¡bi__”½f
("too†arge","Very†arge image (corrupt?)");

7120 ià(
width
 > 
STBI_MAX_DIMENSIONS
è 
	`¡bi__”½f
("too†arge","Very†arge image (corrupt?)");

7122 *
x
 = 
width
;

7123 *
y
 = 
height
;

7125 ià(
comp
) *comp = 3;

7126 ià(
»q_comp
 == 0)„eq_comp = 3;

7128 ià(!
	`¡bi__mad4sizes_v®id
(
width
, 
height
, 
»q_comp
, (), 0))

7129  
	`¡bi__”½f
("too†arge", "HDR image isoo†arge");

7132 
hdr_d©a
 = (*è
	`¡bi__m®loc_mad4
(
width
, 
height
, 
»q_comp
, (), 0);

7133 ià(!
hdr_d©a
)

7134  
	`¡bi__”½f
("outofmem", "Out of memory");

7138 iàĞ
width
 < 8 || width >= 32768) {

7140 
j
=0; j < 
height
; ++j) {

7141 
i
=0; i < 
width
; ++i) {

7142 
¡bi_uc
 
rgbe
[4];

7143 
maš_decode_loİ
:

7144 
	`¡bi__g‘n
(
s
, 
rgbe
, 4);

7145 
	`¡bi__hdr_cÚv”t
(
hdr_d©a
 + 
j
 * 
width
 * 
»q_comp
 + 
i
 *„eq_comp, 
rgbe
,„eq_comp);

7150 
sÿÆše
 = 
NULL
;

7152 
j
 = 0; j < 
height
; ++j) {

7153 
c1
 = 
	`¡bi__g‘8
(
s
);

7154 
c2
 = 
	`¡bi__g‘8
(
s
);

7155 
Ën
 = 
	`¡bi__g‘8
(
s
);

7156 ià(
c1
 !ğ2 || 
c2
 !ğ2 || (
Ën
 & 0x80)) {

7159 
¡bi_uc
 
rgbe
[4];

7160 
rgbe
[0] = (
¡bi_uc
è
c1
;

7161 
rgbe
[1] = (
¡bi_uc
è
c2
;

7162 
rgbe
[2] = (
¡bi_uc
è
Ën
;

7163 
rgbe
[3] = (
¡bi_uc
è
	`¡bi__g‘8
(
s
);

7164 
	`¡bi__hdr_cÚv”t
(
hdr_d©a
, 
rgbe
, 
»q_comp
);

7165 
i
 = 1;

7166 
j
 = 0;

7167 
	`STBI_FREE
(
sÿÆše
);

7168 
maš_decode_loİ
;

7170 
Ën
 <<= 8;

7171 
Ën
 |ğ
	`¡bi__g‘8
(
s
);

7172 ià(
Ën
 !ğ
width
è{ 
	`STBI_FREE
(
hdr_d©a
); STBI_FREE(
sÿÆše
);  
	`¡bi__”½f
("invalid decoded scanline†ength", "corrupt HDR"); }

7173 ià(
sÿÆše
 =ğ
NULL
) {

7174 
sÿÆše
 = (
¡bi_uc
 *è
	`¡bi__m®loc_mad2
(
width
, 4, 0);

7175 ià(!
sÿÆše
) {

7176 
	`STBI_FREE
(
hdr_d©a
);

7177  
	`¡bi__”½f
("outofmem", "Out of memory");

7181 
k
 = 0; k < 4; ++k) {

7182 
Æeá
;

7183 
i
 = 0;

7184 (
Æeá
 = 
width
 - 
i
) > 0) {

7185 
couÁ
 = 
	`¡bi__g‘8
(
s
);

7186 ià(
couÁ
 > 128) {

7188 
v®ue
 = 
	`¡bi__g‘8
(
s
);

7189 
couÁ
 -= 128;

7190 ià(
couÁ
 > 
Æeá
è{ 
	`STBI_FREE
(
hdr_d©a
); STBI_FREE(
sÿÆše
);  
	`¡bi__”½f
("corrupt", "bad RLE data in HDR"); }

7191 
z
 = 0; z < 
couÁ
; ++z)

7192 
sÿÆše
[
i
++ * 4 + 
k
] = 
v®ue
;

7195 ià(
couÁ
 > 
Æeá
è{ 
	`STBI_FREE
(
hdr_d©a
); STBI_FREE(
sÿÆše
);  
	`¡bi__”½f
("corrupt", "bad RLE data in HDR"); }

7196 
z
 = 0; z < 
couÁ
; ++z)

7197 
sÿÆše
[
i
++ * 4 + 
k
] = 
	`¡bi__g‘8
(
s
);

7201 
i
=0; i < 
width
; ++i)

7202 
	`¡bi__hdr_cÚv”t
(
hdr_d©a
+(
j
*
width
 + 
i
)*
»q_comp
, 
sÿÆše
 + i*4,„eq_comp);

7204 ià(
sÿÆše
)

7205 
	`STBI_FREE
(
sÿÆše
);

7208  
hdr_d©a
;

7209 
	}
}

7211 
	$¡bi__hdr_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
)

7213 
bufãr
[
STBI__HDR_BUFLEN
];

7214 *
tok’
;

7215 
v®id
 = 0;

7216 
dummy
;

7218 ià(!
x
èx = &
dummy
;

7219 ià(!
y
èy = &
dummy
;

7220 ià(!
comp
ècom°ğ&
dummy
;

7222 ià(
	`¡bi__hdr_‹¡
(
s
) == 0) {

7223 
	`¡bi__»wšd
Ğ
s
 );

7228 
tok’
 = 
	`¡bi__hdr_g‘tok’
(
s
,
bufãr
);

7229 ià(
tok’
[0] == 0) ;

7230 ià(
	`¡rcmp
(
tok’
, "FORMAT=32-b™_¾e_rgbe"è=ğ0è
v®id
 = 1;

7233 ià(!
v®id
) {

7234 
	`¡bi__»wšd
Ğ
s
 );

7237 
tok’
 = 
	`¡bi__hdr_g‘tok’
(
s
,
bufãr
);

7238 ià(
	`¡ºcmp
(
tok’
, "-Y ", 3)) {

7239 
	`¡bi__»wšd
Ğ
s
 );

7242 
tok’
 += 3;

7243 *
y
 = (è
	`¡¹Ş
(
tok’
, &token, 10);

7244 *
tok’
 == ' ') ++token;

7245 ià(
	`¡ºcmp
(
tok’
, "+X ", 3)) {

7246 
	`¡bi__»wšd
Ğ
s
 );

7249 
tok’
 += 3;

7250 *
x
 = (è
	`¡¹Ş
(
tok’
, 
NULL
, 10);

7251 *
comp
 = 3;

7253 
	}
}

7256 #iâdeà
STBI_NO_BMP


7257 
	$¡bi__bmp_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
)

7259 *
p
;

7260 
¡bi__bmp_d©a
 
šfo
;

7262 
šfo
.
®l_a
 = 255;

7263 
p
 = 
	`¡bi__bmp_·r£_h—d”
(
s
, &
šfo
);

7264 ià(
p
 =ğ
NULL
) {

7265 
	`¡bi__»wšd
Ğ
s
 );

7268 ià(
x
è*x = 
s
->
img_x
;

7269 ià(
y
è*y = 
s
->
img_y
;

7270 ià(
comp
) {

7271 ià(
šfo
.
bµ
 =ğ24 && info.
ma
 == 0xff000000)

7272 *
comp
 = 3;

7274 *
comp
 = 
šfo
.
ma
 ? 4 : 3;

7277 
	}
}

7280 #iâdeà
STBI_NO_PSD


7281 
	$¡bi__psd_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
)

7283 
chªÃlCouÁ
, 
dummy
, 
d•th
;

7284 ià(!
x
èx = &
dummy
;

7285 ià(!
y
èy = &
dummy
;

7286 ià(!
comp
ècom°ğ&
dummy
;

7287 ià(
	`¡bi__g‘32be
(
s
) != 0x38425053) {

7288 
	`¡bi__»wšd
Ğ
s
 );

7291 ià(
	`¡bi__g‘16be
(
s
) != 1) {

7292 
	`¡bi__»wšd
Ğ
s
 );

7295 
	`¡bi__sk
(
s
, 6);

7296 
chªÃlCouÁ
 = 
	`¡bi__g‘16be
(
s
);

7297 ià(
chªÃlCouÁ
 < 0 || channelCount > 16) {

7298 
	`¡bi__»wšd
Ğ
s
 );

7301 *
y
 = 
	`¡bi__g‘32be
(
s
);

7302 *
x
 = 
	`¡bi__g‘32be
(
s
);

7303 
d•th
 = 
	`¡bi__g‘16be
(
s
);

7304 ià(
d•th
 != 8 && depth != 16) {

7305 
	`¡bi__»wšd
Ğ
s
 );

7308 ià(
	`¡bi__g‘16be
(
s
) != 3) {

7309 
	`¡bi__»wšd
Ğ
s
 );

7312 *
comp
 = 4;

7314 
	}
}

7316 
	$¡bi__psd_is16
(
¡bi__cÚ‹xt
 *
s
)

7318 
chªÃlCouÁ
, 
d•th
;

7319 ià(
	`¡bi__g‘32be
(
s
) != 0x38425053) {

7320 
	`¡bi__»wšd
Ğ
s
 );

7323 ià(
	`¡bi__g‘16be
(
s
) != 1) {

7324 
	`¡bi__»wšd
Ğ
s
 );

7327 
	`¡bi__sk
(
s
, 6);

7328 
chªÃlCouÁ
 = 
	`¡bi__g‘16be
(
s
);

7329 ià(
chªÃlCouÁ
 < 0 || channelCount > 16) {

7330 
	`¡bi__»wšd
Ğ
s
 );

7333 
	`STBI_NOTUSED
(
	`¡bi__g‘32be
(
s
));

7334 
	`STBI_NOTUSED
(
	`¡bi__g‘32be
(
s
));

7335 
d•th
 = 
	`¡bi__g‘16be
(
s
);

7336 ià(
d•th
 != 16) {

7337 
	`¡bi__»wšd
Ğ
s
 );

7341 
	}
}

7344 #iâdeà
STBI_NO_PIC


7345 
	$¡bi__pic_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
)

7347 
aù_comp
=0,
num_·ck‘s
=0,
chašed
,
dummy
;

7348 
¡bi__pic_·ck‘
 
·ck‘s
[10];

7350 ià(!
x
èx = &
dummy
;

7351 ià(!
y
èy = &
dummy
;

7352 ià(!
comp
ècom°ğ&
dummy
;

7354 ià(!
	`¡bi__pic_is4
(
s
,"\x53\x80\xF6\x34")) {

7355 
	`¡bi__»wšd
(
s
);

7359 
	`¡bi__sk
(
s
, 88);

7361 *
x
 = 
	`¡bi__g‘16be
(
s
);

7362 *
y
 = 
	`¡bi__g‘16be
(
s
);

7363 ià(
	`¡bi__©_eof
(
s
)) {

7364 
	`¡bi__»wšd
Ğ
s
);

7367 iàĞ(*
x
è!ğ0 && (1 << 28è/ (*xè< (*
y
)) {

7368 
	`¡bi__»wšd
Ğ
s
 );

7372 
	`¡bi__sk
(
s
, 8);

7375 
¡bi__pic_·ck‘
 *
·ck‘
;

7377 ià(
num_·ck‘s
==(
·ck‘s
)/(packets[0]))

7380 
·ck‘
 = &
·ck‘s
[
num_·ck‘s
++];

7381 
chašed
 = 
	`¡bi__g‘8
(
s
);

7382 
·ck‘
->
size
 = 
	`¡bi__g‘8
(
s
);

7383 
·ck‘
->
ty³
 = 
	`¡bi__g‘8
(
s
);

7384 
·ck‘
->
chªÃl
 = 
	`¡bi__g‘8
(
s
);

7385 
aù_comp
 |ğ
·ck‘
->
chªÃl
;

7387 ià(
	`¡bi__©_eof
(
s
)) {

7388 
	`¡bi__»wšd
Ğ
s
 );

7391 ià(
·ck‘
->
size
 != 8) {

7392 
	`¡bi__»wšd
Ğ
s
 );

7395 } 
chašed
);

7397 *
comp
 = (
aù_comp
 & 0x10 ? 4 : 3);

7400 
	}
}

7414 #iâdeà
STBI_NO_PNM


7416 
	$¡bi__²m_‹¡
(
¡bi__cÚ‹xt
 *
s
)

7418 
p
, 
t
;

7419 
p
 = (è
	`¡bi__g‘8
(
s
);

7420 
t
 = (è
	`¡bi__g‘8
(
s
);

7421 ià(
p
 !ğ'P' || (
t
 != '5' && != '6')) {

7422 
	`¡bi__»wšd
Ğ
s
 );

7426 
	}
}

7428 *
	$¡bi__²m_lßd
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
, 
»q_comp
, 
¡bi__»suÉ_šfo
 *
ri
)

7430 
¡bi_uc
 *
out
;

7431 
	`STBI_NOTUSED
(
ri
);

7433 
ri
->
b™s_³r_chªÃl
 = 
	`¡bi__²m_šfo
(
s
, (*)&s->
img_x
, (*)&s->
img_y
, (*)&s->
img_n
);

7434 ià(
ri
->
b™s_³r_chªÃl
 == 0)

7437 ià(
s
->
img_y
 > 
STBI_MAX_DIMENSIONS
è 
	`¡bi__”½uc
("too†arge","Very†arge image (corrupt?)");

7438 ià(
s
->
img_x
 > 
STBI_MAX_DIMENSIONS
è 
	`¡bi__”½uc
("too†arge","Very†arge image (corrupt?)");

7440 *
x
 = 
s
->
img_x
;

7441 *
y
 = 
s
->
img_y
;

7442 ià(
comp
è*com°ğ
s
->
img_n
;

7444 ià(!
	`¡bi__mad4sizes_v®id
(
s
->
img_n
, s->
img_x
, s->
img_y
, 
ri
->
b™s_³r_chªÃl
 / 8, 0))

7445  
	`¡bi__”½uc
("too†arge", "PNMoo†arge");

7447 
out
 = (
¡bi_uc
 *è
	`¡bi__m®loc_mad4
(
s
->
img_n
, s->
img_x
, s->
img_y
, 
ri
->
b™s_³r_chªÃl
 / 8, 0);

7448 ià(!
out
è 
	`¡bi__”½uc
("outofmem", "Out of memory");

7449 
	`¡bi__g‘n
(
s
, 
out
, s->
img_n
 * s->
img_x
 * s->
img_y
 * (
ri
->
b™s_³r_chªÃl
 / 8));

7451 ià(
»q_comp
 &&„eq_com°!ğ
s
->
img_n
) {

7452 
out
 = 
	`¡bi__cÚv”t_fÜm©
(out, 
s
->
img_n
, 
»q_comp
, s->
img_x
, s->
img_y
);

7453 ià(
out
 =ğ
NULL
)  out;

7455  
out
;

7456 
	}
}

7458 
	$¡bi__²m_is¥aû
(
c
)

7460  
c
 == ' ' || c == '\t' || c == '\n' || c == '\v' || c == '\f' || c == '\r';

7461 
	}
}

7463 
	$¡bi__²m_sk_wh™e¥aû
(
¡bi__cÚ‹xt
 *
s
, *
c
)

7466 !
	`¡bi__©_eof
(
s
è&& 
	`¡bi__²m_is¥aû
(*
c
))

7467 *
c
 = (è
	`¡bi__g‘8
(
s
);

7469 ià(
	`¡bi__©_eof
(
s
è|| *
c
 != '#')

7472 !
	`¡bi__©_eof
(
s
è&& *
c
 != '\n' && *c != '\r' )

7473 *
c
 = (è
	`¡bi__g‘8
(
s
);

7475 
	}
}

7477 
	$¡bi__²m_isdig™
(
c
)

7479  
c
 >= '0' && c <= '9';

7480 
	}
}

7482 
	$¡bi__²m_g‘š‹g”
(
¡bi__cÚ‹xt
 *
s
, *
c
)

7484 
v®ue
 = 0;

7486 !
	`¡bi__©_eof
(
s
è&& 
	`¡bi__²m_isdig™
(*
c
)) {

7487 
v®ue
 = v®ue*10 + (*
c
 - '0');

7488 *
c
 = (è
	`¡bi__g‘8
(
s
);

7491  
v®ue
;

7492 
	}
}

7494 
	$¡bi__²m_šfo
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
)

7496 
maxv
, 
dummy
;

7497 
c
, 
p
, 
t
;

7499 ià(!
x
èx = &
dummy
;

7500 ià(!
y
èy = &
dummy
;

7501 ià(!
comp
ècom°ğ&
dummy
;

7503 
	`¡bi__»wšd
(
s
);

7506 
p
 = (è
	`¡bi__g‘8
(
s
);

7507 
t
 = (è
	`¡bi__g‘8
(
s
);

7508 ià(
p
 !ğ'P' || (
t
 != '5' && != '6')) {

7509 
	`¡bi__»wšd
(
s
);

7513 *
comp
 = (
t
 == '6') ? 3 : 1;

7515 
c
 = (è
	`¡bi__g‘8
(
s
);

7516 
	`¡bi__²m_sk_wh™e¥aû
(
s
, &
c
);

7518 *
x
 = 
	`¡bi__²m_g‘š‹g”
(
s
, &
c
);

7519 
	`¡bi__²m_sk_wh™e¥aû
(
s
, &
c
);

7521 *
y
 = 
	`¡bi__²m_g‘š‹g”
(
s
, &
c
);

7522 
	`¡bi__²m_sk_wh™e¥aû
(
s
, &
c
);

7524 
maxv
 = 
	`¡bi__²m_g‘š‹g”
(
s
, &
c
);

7525 ià(
maxv
 > 65535)

7526  
	`¡bi__”r
("max value > 65535", "PPM image supports only 8-bit‡nd 16-bit images");

7527 ià(
maxv
 > 255)

7531 
	}
}

7533 
	$¡bi__²m_is16
(
¡bi__cÚ‹xt
 *
s
)

7535 ià(
	`¡bi__²m_šfo
(
s
, 
NULL
, NULL, NULL) == 16)

7538 
	}
}

7541 
	$¡bi__šfo_maš
(
¡bi__cÚ‹xt
 *
s
, *
x
, *
y
, *
comp
)

7543 #iâdeà
STBI_NO_JPEG


7544 ià(
	`¡bi__j³g_šfo
(
s
, 
x
, 
y
, 
comp
))  1;

7547 #iâdeà
STBI_NO_PNG


7548 ià(
	`¡bi__²g_šfo
(
s
, 
x
, 
y
, 
comp
))  1;

7551 #iâdeà
STBI_NO_GIF


7552 ià(
	`¡bi__gif_šfo
(
s
, 
x
, 
y
, 
comp
))  1;

7555 #iâdeà
STBI_NO_BMP


7556 ià(
	`¡bi__bmp_šfo
(
s
, 
x
, 
y
, 
comp
))  1;

7559 #iâdeà
STBI_NO_PSD


7560 ià(
	`¡bi__psd_šfo
(
s
, 
x
, 
y
, 
comp
))  1;

7563 #iâdeà
STBI_NO_PIC


7564 ià(
	`¡bi__pic_šfo
(
s
, 
x
, 
y
, 
comp
))  1;

7567 #iâdeà
STBI_NO_PNM


7568 ià(
	`¡bi__²m_šfo
(
s
, 
x
, 
y
, 
comp
))  1;

7571 #iâdeà
STBI_NO_HDR


7572 ià(
	`¡bi__hdr_šfo
(
s
, 
x
, 
y
, 
comp
))  1;

7576 #iâdeà
STBI_NO_TGA


7577 ià(
	`¡bi__tga_šfo
(
s
, 
x
, 
y
, 
comp
))

7580  
	`¡bi__”r
("unknown imageype", "Image‚ot of‡ny knownype, or corrupt");

7581 
	}
}

7583 
	$¡bi__is_16_maš
(
¡bi__cÚ‹xt
 *
s
)

7585 #iâdeà
STBI_NO_PNG


7586 ià(
	`¡bi__²g_is16
(
s
))  1;

7589 #iâdeà
STBI_NO_PSD


7590 ià(
	`¡bi__psd_is16
(
s
))  1;

7593 #iâdeà
STBI_NO_PNM


7594 ià(
	`¡bi__²m_is16
(
s
))  1;

7597 
	}
}

7599 #iâdeà
STBI_NO_STDIO


7600 
STBIDEF
 
	$¡bi_šfo
(cÚ¡ *
f’ame
, *
x
, *
y
, *
comp
)

7602 
FILE
 *
f
 = 
	`¡bi__fİ’
(
f’ame
, "rb");

7603 
»suÉ
;

7604 ià(!
f
è 
	`¡bi__”r
("can't fopen", "Unableo open file");

7605 
»suÉ
 = 
	`¡bi_šfo_äom_fe
(
f
, 
x
, 
y
, 
comp
);

7606 
	`fşo£
(
f
);

7607  
»suÉ
;

7608 
	}
}

7610 
STBIDEF
 
	$¡bi_šfo_äom_fe
(
FILE
 *
f
, *
x
, *
y
, *
comp
)

7612 
r
;

7613 
¡bi__cÚ‹xt
 
s
;

7614 
pos
 = 
	`á–l
(
f
);

7615 
	`¡bi__¡¬t_fe
(&
s
, 
f
);

7616 
r
 = 
	`¡bi__šfo_maš
(&
s
,
x
,
y
,
comp
);

7617 
	`f£ek
(
f
,
pos
,
SEEK_SET
);

7618  
r
;

7619 
	}
}

7621 
STBIDEF
 
	$¡bi_is_16_b™
(cÚ¡ *
f’ame
)

7623 
FILE
 *
f
 = 
	`¡bi__fİ’
(
f’ame
, "rb");

7624 
»suÉ
;

7625 ià(!
f
è 
	`¡bi__”r
("can't fopen", "Unableo open file");

7626 
»suÉ
 = 
	`¡bi_is_16_b™_äom_fe
(
f
);

7627 
	`fşo£
(
f
);

7628  
»suÉ
;

7629 
	}
}

7631 
STBIDEF
 
	$¡bi_is_16_b™_äom_fe
(
FILE
 *
f
)

7633 
r
;

7634 
¡bi__cÚ‹xt
 
s
;

7635 
pos
 = 
	`á–l
(
f
);

7636 
	`¡bi__¡¬t_fe
(&
s
, 
f
);

7637 
r
 = 
	`¡bi__is_16_maš
(&
s
);

7638 
	`f£ek
(
f
,
pos
,
SEEK_SET
);

7639  
r
;

7640 
	}
}

7643 
STBIDEF
 
	$¡bi_šfo_äom_memÜy
(
¡bi_uc
 cÚ¡ *
bufãr
, 
Ën
, *
x
, *
y
, *
comp
)

7645 
¡bi__cÚ‹xt
 
s
;

7646 
	`¡bi__¡¬t_mem
(&
s
,
bufãr
,
Ën
);

7647  
	`¡bi__šfo_maš
(&
s
,
x
,
y
,
comp
);

7648 
	}
}

7650 
STBIDEF
 
	$¡bi_šfo_äom_ÿÎbacks
(
¡bi_io_ÿÎbacks
 cÚ¡ *
c
, *
u£r
, *
x
, *
y
, *
comp
)

7652 
¡bi__cÚ‹xt
 
s
;

7653 
	`¡bi__¡¬t_ÿÎbacks
(&
s
, (
¡bi_io_ÿÎbacks
 *è
c
, 
u£r
);

7654  
	`¡bi__šfo_maš
(&
s
,
x
,
y
,
comp
);

7655 
	}
}

7657 
STBIDEF
 
	$¡bi_is_16_b™_äom_memÜy
(
¡bi_uc
 cÚ¡ *
bufãr
, 
Ën
)

7659 
¡bi__cÚ‹xt
 
s
;

7660 
	`¡bi__¡¬t_mem
(&
s
,
bufãr
,
Ën
);

7661  
	`¡bi__is_16_maš
(&
s
);

7662 
	}
}

7664 
STBIDEF
 
	$¡bi_is_16_b™_äom_ÿÎbacks
(
¡bi_io_ÿÎbacks
 cÚ¡ *
c
, *
u£r
)

7666 
¡bi__cÚ‹xt
 
s
;

7667 
	`¡bi__¡¬t_ÿÎbacks
(&
s
, (
¡bi_io_ÿÎbacks
 *è
c
, 
u£r
);

7668  
	`¡bi__is_16_maš
(&
s
);

7669 
	}
}

	@include/stb_image_write.h

151 #iâdeà
INCLUDE_STB_IMAGE_WRITE_H


152 
	#INCLUDE_STB_IMAGE_WRITE_H


	)

154 
	~<¡dlib.h
>

157 #iâdeà
STBIWDEF


158 #ifdeà
STB_IMAGE_WRITE_STATIC


159 
	#STBIWDEF
 

	)

161 #ifdeà
__ılu¥lus


162 
	#STBIWDEF
 "C"

	)

164 
	#STBIWDEF
 

	)

169 #iâdeà
STB_IMAGE_WRITE_STATIC


170 
STBIWDEF
 
¡bi_wr™e_tga_w™h_¾e
;

171 
STBIWDEF
 
	g¡bi_wr™e_²g_com´essiÚ_Ëv–
;

172 
STBIWDEF
 
	g¡bi_wr™e_fÜû_²g_f‹r
;

175 #iâdeà
STBI_WRITE_NO_STDIO


176 
STBIWDEF
 
¡bi_wr™e_²g
(cÚ¡ *
f’ame
, 
w
, 
h
, 
comp
, cÚ¡ *
d©a
, 
¡ride_š_by‹s
);

177 
STBIWDEF
 
¡bi_wr™e_bmp
(cÚ¡ *
f’ame
, 
w
, 
h
, 
comp
, cÚ¡ *
d©a
);

178 
STBIWDEF
 
¡bi_wr™e_tga
(cÚ¡ *
f’ame
, 
w
, 
h
, 
comp
, cÚ¡ *
d©a
);

179 
STBIWDEF
 
¡bi_wr™e_hdr
(cÚ¡ *
f’ame
, 
w
, 
h
, 
comp
, cÚ¡ *
d©a
);

180 
STBIWDEF
 
¡bi_wr™e_jpg
(cÚ¡ *
f’ame
, 
x
, 
y
, 
comp
, cÚ¡ *
d©a
, 
qu®™y
);

182 #ifdeà
STBIW_WINDOWS_UTF8


183 
STBIWDEF
 
¡biw_cÚv”t_wch¬_to_utf8
(*
bufãr
, 
size_t
 
bufã¾’
, cÚ¡ 
wch¬_t
* 
šput
);

187 
	t¡bi_wr™e_func
(*
	tcÚ‹xt
, *
	td©a
, 
	tsize
);

189 
STBIWDEF
 
¡bi_wr™e_²g_to_func
(
¡bi_wr™e_func
 *
func
, *
cÚ‹xt
, 
w
, 
h
, 
comp
, cÚ¡ *
d©a
, 
¡ride_š_by‹s
);

190 
STBIWDEF
 
¡bi_wr™e_bmp_to_func
(
¡bi_wr™e_func
 *
func
, *
cÚ‹xt
, 
w
, 
h
, 
comp
, cÚ¡ *
d©a
);

191 
STBIWDEF
 
¡bi_wr™e_tga_to_func
(
¡bi_wr™e_func
 *
func
, *
cÚ‹xt
, 
w
, 
h
, 
comp
, cÚ¡ *
d©a
);

192 
STBIWDEF
 
¡bi_wr™e_hdr_to_func
(
¡bi_wr™e_func
 *
func
, *
cÚ‹xt
, 
w
, 
h
, 
comp
, cÚ¡ *
d©a
);

193 
STBIWDEF
 
¡bi_wr™e_jpg_to_func
(
¡bi_wr™e_func
 *
func
, *
cÚ‹xt
, 
x
, 
y
, 
comp
, cÚ¡ *
d©a
, 
qu®™y
);

195 
STBIWDEF
 
¡bi_æ_v”tiÿÎy_Ú_wr™e
(
æ_boŞ—n
);

199 #ifdeà
STB_IMAGE_WRITE_IMPLEMENTATION


201 #ifdeà
_WIN32


202 #iâdeà
_CRT_SECURE_NO_WARNINGS


203 
	#_CRT_SECURE_NO_WARNINGS


	)

205 #iâdeà
_CRT_NONSTDC_NO_DEPRECATE


206 
	#_CRT_NONSTDC_NO_DEPRECATE


	)

210 #iâdeà
STBI_WRITE_NO_STDIO


211 
	~<¡dio.h
>

214 
	~<¡d¬g.h
>

215 
	~<¡dlib.h
>

216 
	~<¡ršg.h
>

217 
	~<m©h.h
>

219 #ià
defšed
(
STBIW_MALLOC
è&& defšed(
STBIW_FREE
è&& (defšed(
STBIW_REALLOC
è|| defšed(
STBIW_REALLOC_SIZED
))

221 #–ià!
defšed
(
STBIW_MALLOC
è&& !defšed(
STBIW_FREE
è&& !defšed(
STBIW_REALLOC
è&& !defšed(
STBIW_REALLOC_SIZED
)

227 #iâdeà
STBIW_MALLOC


228 
	#STBIW_MALLOC
(
sz
è
	`m®loc
(sz)

	)

229 
	#STBIW_REALLOC
(
p
,
Ãwsz
è
	`»®loc
Õ,Ãwsz)

	)

230 
	#STBIW_FREE
(
p
è
	`ä“
Õ)

	)

233 #iâdeà
STBIW_REALLOC_SIZED


234 
	#STBIW_REALLOC_SIZED
(
p
,
Şdsz
,
Ãwsz
è
	`STBIW_REALLOC
Õ,Ãwsz)

	)

238 #iâdeà
STBIW_MEMMOVE


239 
	#STBIW_MEMMOVE
(
a
,
b
,
sz
è
	`memmove
×,b,sz)

	)

243 #iâdeà
STBIW_ASSERT


244 
	~<as£¹.h
>

245 
	#STBIW_ASSERT
(
x
è
	`as£¹
(x)

	)

248 
	#STBIW_UCHAR
(
x
è(è((xè& 0xff)

	)

250 #ifdeà
STB_IMAGE_WRITE_STATIC


251 
	g¡bi_wr™e_²g_com´essiÚ_Ëv–
 = 8;

252 
	g¡bi_wr™e_tga_w™h_¾e
 = 1;

253 
	g¡bi_wr™e_fÜû_²g_f‹r
 = -1;

255 
	g¡bi_wr™e_²g_com´essiÚ_Ëv–
 = 8;

256 
	g¡bi_wr™e_tga_w™h_¾e
 = 1;

257 
	g¡bi_wr™e_fÜû_²g_f‹r
 = -1;

260 
	g¡bi__æ_v”tiÿÎy_Ú_wr™e
 = 0;

262 
STBIWDEF
 
	$¡bi_æ_v”tiÿÎy_Ú_wr™e
(
æag
)

264 
¡bi__æ_v”tiÿÎy_Ú_wr™e
 = 
æag
;

265 
	}
}

269 
¡bi_wr™e_func
 *
	mfunc
;

270 *
	mcÚ‹xt
;

271 
	mbufãr
[64];

272 
	mbuf_u£d
;

273 } 
	t¡bi__wr™e_cÚ‹xt
;

276 
	$¡bi__¡¬t_wr™e_ÿÎbacks
(
¡bi__wr™e_cÚ‹xt
 *
s
, 
¡bi_wr™e_func
 *
c
, *
cÚ‹xt
)

278 
s
->
func
 = 
c
;

279 
s
->
cÚ‹xt
 = context;

280 
	}
}

282 #iâdeà
STBI_WRITE_NO_STDIO


284 
	$¡bi__¡dio_wr™e
(*
cÚ‹xt
, *
d©a
, 
size
)

286 
	`fwr™e
(
d©a
,1,
size
,(
FILE
*è
cÚ‹xt
);

287 
	}
}

289 #ià
defšed
(
_WIN32
è&& defšed(
STBIW_WINDOWS_UTF8
)

290 #ifdeà
__ılu¥lus


291 
	#STBIW_EXTERN
 "C"

	)

293 
	#STBIW_EXTERN
 

	)

295 
STBIW_EXTERN
 
	$__deş¥ec
(
dÎimpÜt
è
__¡dÿÎ
 
	`MuÉiBy‹ToWideCh¬
(
ı
, 
æags
, cÚ¡ *
¡r
, 
cbmb
, 
wch¬_t
 *
wide¡r
, 
cchwide
);

296 
STBIW_EXTERN
 
	$__deş¥ec
(
dÎimpÜt
è
__¡dÿÎ
 
	`WideCh¬ToMuÉiBy‹
(
ı
, 
æags
, cÚ¡ 
wch¬_t
 *
wide¡r
, 
cchwide
, *
¡r
, 
cbmb
, cÚ¡ *
defch¬
, *
u£d_deçuÉ
);

298 
STBIWDEF
 
	$¡biw_cÚv”t_wch¬_to_utf8
(*
bufãr
, 
size_t
 
bufã¾’
, cÚ¡ 
wch¬_t
* 
šput
)

300  
	`WideCh¬ToMuÉiBy‹
(65001 , 0, 
šput
, -1, 
bufãr
, (è
bufã¾’
, 
NULL
, NULL);

301 
	}
}

304 
FILE
 *
	$¡biw__fİ’
(cÚ¡ *
f’ame
, cÚ¡ *
mode
)

306 
FILE
 *
f
;

307 #ià
	`defšed
(
_WIN32
è&& defšed(
STBIW_WINDOWS_UTF8
)

308 
wch¬_t
 
wMode
[64];

309 
wch¬_t
 
wF’ame
[1024];

310 ià(0 =ğ
	`MuÉiBy‹ToWideCh¬
(65001 , 0, 
f’ame
, -1, 
wF’ame
, (wFilename)/(*wFilename)))

313 ià(0 =ğ
	`MuÉiBy‹ToWideCh¬
(65001 , 0, 
mode
, -1, 
wMode
, (wMode)/(*wMode)))

316 #ià
	`defšed
(
_MSC_VER
) && _MSC_VER >= 1400

317 ià(0 !ğ
	`_wfİ’_s
(&
f
, 
wF’ame
, 
wMode
))

318 
f
 = 0;

320 
f
 = 
	`_wfİ’
(
wF’ame
, 
wMode
);

323 #–ià
	`defšed
(
_MSC_VER
) && _MSC_VER >= 1400

324 ià(0 !ğ
	`fİ’_s
(&
f
, 
f’ame
, 
mode
))

325 
f
=0;

327 
f
 = 
	`fİ’
(
f’ame
, 
mode
);

329  
f
;

330 
	}
}

332 
	$¡bi__¡¬t_wr™e_fe
(
¡bi__wr™e_cÚ‹xt
 *
s
, cÚ¡ *
f’ame
)

334 
FILE
 *
f
 = 
	`¡biw__fİ’
(
f’ame
, "wb");

335 
	`¡bi__¡¬t_wr™e_ÿÎbacks
(
s
, 
¡bi__¡dio_wr™e
, (*è
f
);

336  
f
 !ğ
NULL
;

337 
	}
}

339 
	$¡bi__’d_wr™e_fe
(
¡bi__wr™e_cÚ‹xt
 *
s
)

341 
	`fşo£
((
FILE
 *)
s
->
cÚ‹xt
);

342 
	}
}

346 
	t¡biw_ušt32
;

347 
	t¡b_image_wr™e_‹¡
[(
¡biw_ušt32
)==4 ? 1 : -1];

349 
	$¡biw__wr™efv
(
¡bi__wr™e_cÚ‹xt
 *
s
, cÚ¡ *
fmt
, 
va_li¡
 
v
)

351 *
fmt
) {

352 *
fmt
++) {

354 '1': { 
x
 = 
	`STBIW_UCHAR
(
	`va_¬g
(
v
, ));

355 
s
->
	`func
(s->
cÚ‹xt
,&
x
,1);

357 '2': { 
x
 = 
	`va_¬g
(
v
,);

358 
b
[2];

359 
b
[0] = 
	`STBIW_UCHAR
(
x
);

360 
b
[1] = 
	`STBIW_UCHAR
(
x
>>8);

361 
s
->
	`func
(s->
cÚ‹xt
,
b
,2);

363 '4': { 
¡biw_ušt32
 
x
 = 
	`va_¬g
(
v
,);

364 
b
[4];

365 
b
[0]=
	`STBIW_UCHAR
(
x
);

366 
b
[1]=
	`STBIW_UCHAR
(
x
>>8);

367 
b
[2]=
	`STBIW_UCHAR
(
x
>>16);

368 
b
[3]=
	`STBIW_UCHAR
(
x
>>24);

369 
s
->
	`func
(s->
cÚ‹xt
,
b
,4);

372 
	`STBIW_ASSERT
(0);

376 
	}
}

378 
	$¡biw__wr™ef
(
¡bi__wr™e_cÚ‹xt
 *
s
, cÚ¡ *
fmt
, ...)

380 
va_li¡
 
v
;

381 
	`va_¡¬t
(
v
, 
fmt
);

382 
	`¡biw__wr™efv
(
s
, 
fmt
, 
v
);

383 
	`va_’d
(
v
);

384 
	}
}

386 
	$¡biw__wr™e_æush
(
¡bi__wr™e_cÚ‹xt
 *
s
)

388 ià(
s
->
buf_u£d
) {

389 
s
->
	`func
(s->
cÚ‹xt
, &s->
bufãr
, s->
buf_u£d
);

390 
s
->
buf_u£d
 = 0;

392 
	}
}

394 
	$¡biw__putc
(
¡bi__wr™e_cÚ‹xt
 *
s
, 
c
)

396 
s
->
	`func
(s->
cÚ‹xt
, &
c
, 1);

397 
	}
}

399 
	$¡biw__wr™e1
(
¡bi__wr™e_cÚ‹xt
 *
s
, 
a
)

401 ià((
size_t
)
s
->
buf_u£d
 + 1 > (s->
bufãr
))

402 
	`¡biw__wr™e_æush
(
s
);

403 
s
->
bufãr
[s->
buf_u£d
++] = 
a
;

404 
	}
}

406 
	$¡biw__wr™e3
(
¡bi__wr™e_cÚ‹xt
 *
s
, 
a
, 
b
, 
c
)

408 
n
;

409 ià((
size_t
)
s
->
buf_u£d
 + 3 > (s->
bufãr
))

410 
	`¡biw__wr™e_æush
(
s
);

411 
n
 = 
s
->
buf_u£d
;

412 
s
->
buf_u£d
 = 
n
+3;

413 
s
->
bufãr
[
n
+0] = 
a
;

414 
s
->
bufãr
[
n
+1] = 
b
;

415 
s
->
bufãr
[
n
+2] = 
c
;

416 
	}
}

418 
	$¡biw__wr™e_pix–
(
¡bi__wr™e_cÚ‹xt
 *
s
, 
rgb_dœ
, 
comp
, 
wr™e_®pha
, 
ex·nd_mÚo
, *
d
)

420 
bg
[3] = { 255, 0, 255}, 
px
[3];

421 
k
;

423 ià(
wr™e_®pha
 < 0)

424 
	`¡biw__wr™e1
(
s
, 
d
[
comp
 - 1]);

426 
comp
) {

429 ià(
ex·nd_mÚo
)

430 
	`¡biw__wr™e3
(
s
, 
d
[0], d[0], d[0]);

432 
	`¡biw__wr™e1
(
s
, 
d
[0]);

435 ià(!
wr™e_®pha
) {

437 
k
 = 0; k < 3; ++k)

438 
px
[
k
] = 
bg
[k] + ((
d
[k] - bg[k]) * d[3]) / 255;

439 
	`¡biw__wr™e3
(
s
, 
px
[1 - 
rgb_dœ
],…x[1],…x[1 +„gb_dir]);

444 
	`¡biw__wr™e3
(
s
, 
d
[1 - 
rgb_dœ
], d[1], d[1 +„gb_dir]);

447 ià(
wr™e_®pha
 > 0)

448 
	`¡biw__wr™e1
(
s
, 
d
[
comp
 - 1]);

449 
	}
}

451 
	$¡biw__wr™e_pix–s
(
¡bi__wr™e_cÚ‹xt
 *
s
, 
rgb_dœ
, 
vdœ
, 
x
, 
y
, 
comp
, *
d©a
, 
wr™e_®pha
, 
sÿÆše_·d
, 
ex·nd_mÚo
)

453 
¡biw_ušt32
 
z”o
 = 0;

454 
i
,
j
, 
j_’d
;

456 ià(
y
 <= 0)

459 ià(
¡bi__æ_v”tiÿÎy_Ú_wr™e
)

460 
vdœ
 *= -1;

462 ià(
vdœ
 < 0) {

463 
j_’d
 = -1; 
j
 = 
y
-1;

465 
j_’d
 = 
y
; 
j
 = 0;

468 ; 
j
 !ğ
j_’d
; j +ğ
vdœ
) {

469 
i
=0; i < 
x
; ++i) {

470 *
d
 = (*è
d©a
 + (
j
*
x
+
i
)*
comp
;

471 
	`¡biw__wr™e_pix–
(
s
, 
rgb_dœ
, 
comp
, 
wr™e_®pha
, 
ex·nd_mÚo
, 
d
);

473 
	`¡biw__wr™e_æush
(
s
);

474 
s
->
	`func
(s->
cÚ‹xt
, &
z”o
, 
sÿÆše_·d
);

476 
	}
}

478 
	$¡biw__outfe
(
¡bi__wr™e_cÚ‹xt
 *
s
, 
rgb_dœ
, 
vdœ
, 
x
, 
y
, 
comp
, 
ex·nd_mÚo
, *
d©a
, 
®pha
, 
·d
, cÚ¡ *
fmt
, ...)

480 ià(
y
 < 0 || 
x
 < 0) {

483 
va_li¡
 
v
;

484 
	`va_¡¬t
(
v
, 
fmt
);

485 
	`¡biw__wr™efv
(
s
, 
fmt
, 
v
);

486 
	`va_’d
(
v
);

487 
	`¡biw__wr™e_pix–s
(
s
,
rgb_dœ
,
vdœ
,
x
,
y
,
comp
,
d©a
,
®pha
,
·d
, 
ex·nd_mÚo
);

490 
	}
}

492 
	$¡bi_wr™e_bmp_cÜe
(
¡bi__wr™e_cÚ‹xt
 *
s
, 
x
, 
y
, 
comp
, cÚ¡ *
d©a
)

494 ià(
comp
 != 4) {

496 
·d
 = (-
x
*3) & 3;

497  
	`¡biw__outfe
(
s
,-1,-1,
x
,
y
,
comp
,1,(*è
d©a
,0,
·d
,

499 'B', 'M', 14+40+(
x
*3+
·d
)*
y
, 0,0, 14+40,

500 40, 
x
,
y
, 1,24, 0,0,0,0,0,0);

505  
	`¡biw__outfe
(
s
,-1,-1,
x
,
y
,
comp
,1,(*)
d©a
,1,0,

507 'B', 'M', 14+108+
x
*
y
*4, 0, 0, 14+108,

508 108, 
x
,
y
, 1,32, 3,0,0,0,0,0, 0xff0000,0xff00,0xff,0xff000000u, 0, 0,0,0, 0,0,0, 0,0,0, 0,0,0);

510 
	}
}

512 
STBIWDEF
 
	$¡bi_wr™e_bmp_to_func
(
¡bi_wr™e_func
 *
func
, *
cÚ‹xt
, 
x
, 
y
, 
comp
, cÚ¡ *
d©a
)

514 
¡bi__wr™e_cÚ‹xt
 
s
 = { 0 };

515 
	`¡bi__¡¬t_wr™e_ÿÎbacks
(&
s
, 
func
, 
cÚ‹xt
);

516  
	`¡bi_wr™e_bmp_cÜe
(&
s
, 
x
, 
y
, 
comp
, 
d©a
);

517 
	}
}

519 #iâdeà
STBI_WRITE_NO_STDIO


520 
STBIWDEF
 
	$¡bi_wr™e_bmp
(cÚ¡ *
f’ame
, 
x
, 
y
, 
comp
, cÚ¡ *
d©a
)

522 
¡bi__wr™e_cÚ‹xt
 
s
 = { 0 };

523 ià(
	`¡bi__¡¬t_wr™e_fe
(&
s
,
f’ame
)) {

524 
r
 = 
	`¡bi_wr™e_bmp_cÜe
(&
s
, 
x
, 
y
, 
comp
, 
d©a
);

525 
	`¡bi__’d_wr™e_fe
(&
s
);

526  
r
;

529 
	}
}

532 
	$¡bi_wr™e_tga_cÜe
(
¡bi__wr™e_cÚ‹xt
 *
s
, 
x
, 
y
, 
comp
, *
d©a
)

534 
has_®pha
 = (
comp
 == 2 || comp == 4);

535 
cŞÜby‹s
 = 
has_®pha
 ? 
comp
-1 : comp;

536 
fÜm©
 = 
cŞÜby‹s
 < 2 ? 3 : 2;

538 ià(
y
 < 0 || 
x
 < 0)

541 ià(!
¡bi_wr™e_tga_w™h_¾e
) {

542  
	`¡biw__outfe
(
s
, -1, -1, 
x
, 
y
, 
comp
, 0, (*è
d©a
, 
has_®pha
, 0,

543 "111 221 2222 11", 0, 0, 
fÜm©
, 0, 0, 0, 0, 0, 
x
, 
y
, (
cŞÜby‹s
 + 
has_®pha
) * 8, has_alpha * 8);

545 
i
,
j
,
k
;

546 
j’d
, 
jdœ
;

548 
	`¡biw__wr™ef
(
s
, "111 221 2222 11", 0,0,
fÜm©
+8, 0,0,0, 0,0,
x
,
y
, (
cŞÜby‹s
 + 
has_®pha
) * 8, has_alpha * 8);

550 ià(
¡bi__æ_v”tiÿÎy_Ú_wr™e
) {

551 
j
 = 0;

552 
j’d
 = 
y
;

553 
jdœ
 = 1;

555 
j
 = 
y
-1;

556 
j’d
 = -1;

557 
jdœ
 = -1;

559 ; 
j
 !ğ
j’d
; j +ğ
jdœ
) {

560 *
row
 = (*è
d©a
 + 
j
 * 
x
 * 
comp
;

561 
Ën
;

563 
i
 = 0; i < 
x
; i +ğ
Ën
) {

564 *
begš
 = 
row
 + 
i
 * 
comp
;

565 
diff
 = 1;

566 
Ën
 = 1;

568 ià(
i
 < 
x
 - 1) {

569 ++
Ën
;

570 
diff
 = 
	`memcmp
(
begš
, 
row
 + (
i
 + 1è* 
comp
, comp);

571 ià(
diff
) {

572 cÚ¡ *
´ev
 = 
begš
;

573 
k
 = 
i
 + 2; k < 
x
 && 
Ën
 < 128; ++k) {

574 ià(
	`memcmp
(
´ev
, 
row
 + 
k
 * 
comp
, comp)) {

575 
´ev
 +ğ
comp
;

576 ++
Ën
;

578 --
Ën
;

583 
k
 = 
i
 + 2; k < 
x
 && 
Ën
 < 128; ++k) {

584 ià(!
	`memcmp
(
begš
, 
row
 + 
k
 * 
comp
, comp)) {

585 ++
Ën
;

593 ià(
diff
) {

594 
h—d”
 = 
	`STBIW_UCHAR
(
Ën
 - 1);

595 
	`¡biw__wr™e1
(
s
, 
h—d”
);

596 
k
 = 0; k < 
Ën
; ++k) {

597 
	`¡biw__wr™e_pix–
(
s
, -1, 
comp
, 
has_®pha
, 0, 
begš
 + 
k
 * comp);

600 
h—d”
 = 
	`STBIW_UCHAR
(
Ën
 - 129);

601 
	`¡biw__wr™e1
(
s
, 
h—d”
);

602 
	`¡biw__wr™e_pix–
(
s
, -1, 
comp
, 
has_®pha
, 0, 
begš
);

606 
	`¡biw__wr™e_æush
(
s
);

609 
	}
}

611 
STBIWDEF
 
	$¡bi_wr™e_tga_to_func
(
¡bi_wr™e_func
 *
func
, *
cÚ‹xt
, 
x
, 
y
, 
comp
, cÚ¡ *
d©a
)

613 
¡bi__wr™e_cÚ‹xt
 
s
 = { 0 };

614 
	`¡bi__¡¬t_wr™e_ÿÎbacks
(&
s
, 
func
, 
cÚ‹xt
);

615  
	`¡bi_wr™e_tga_cÜe
(&
s
, 
x
, 
y
, 
comp
, (*è
d©a
);

616 
	}
}

618 #iâdeà
STBI_WRITE_NO_STDIO


619 
STBIWDEF
 
	$¡bi_wr™e_tga
(cÚ¡ *
f’ame
, 
x
, 
y
, 
comp
, cÚ¡ *
d©a
)

621 
¡bi__wr™e_cÚ‹xt
 
s
 = { 0 };

622 ià(
	`¡bi__¡¬t_wr™e_fe
(&
s
,
f’ame
)) {

623 
r
 = 
	`¡bi_wr™e_tga_cÜe
(&
s
, 
x
, 
y
, 
comp
, (*è
d©a
);

624 
	`¡bi__’d_wr™e_fe
(&
s
);

625  
r
;

628 
	}
}

635 
	#¡biw__max
(
a
, 
b
è(×è> (bè? (aè: (b))

	)

637 #iâdeà
STBI_WRITE_NO_STDIO


639 
	$¡biw__lš—r_to_rgbe
(*
rgbe
, *
lš—r
)

641 
expÚ’t
;

642 
maxcomp
 = 
	`¡biw__max
(
lš—r
[0], stbiw__max(linear[1],†inear[2]));

644 ià(
maxcomp
 < 1e-32f) {

645 
rgbe
[0] =„gbe[1] =„gbe[2] =„gbe[3] = 0;

647 
nÜm®ize
 = (è
	`äexp
(
maxcomp
, &
expÚ’t
) * 256.0f/maxcomp;

649 
rgbe
[0] = ()(
lš—r
[0] * 
nÜm®ize
);

650 
rgbe
[1] = ()(
lš—r
[1] * 
nÜm®ize
);

651 
rgbe
[2] = ()(
lš—r
[2] * 
nÜm®ize
);

652 
rgbe
[3] = ()(
expÚ’t
 + 128);

654 
	}
}

656 
	$¡biw__wr™e_run_d©a
(
¡bi__wr™e_cÚ‹xt
 *
s
, 
Ëngth
, 
d©aby‹
)

658 
Ëngthby‹
 = 
	`STBIW_UCHAR
(
Ëngth
+128);

659 
	`STBIW_ASSERT
(
Ëngth
+128 <= 255);

660 
s
->
	`func
(s->
cÚ‹xt
, &
Ëngthby‹
, 1);

661 
s
->
	`func
(s->
cÚ‹xt
, &
d©aby‹
, 1);

662 
	}
}

664 
	$¡biw__wr™e_dump_d©a
(
¡bi__wr™e_cÚ‹xt
 *
s
, 
Ëngth
, *
d©a
)

666 
Ëngthby‹
 = 
	`STBIW_UCHAR
(
Ëngth
);

667 
	`STBIW_ASSERT
(
Ëngth
 <= 128);

668 
s
->
	`func
(s->
cÚ‹xt
, &
Ëngthby‹
, 1);

669 
s
->
	`func
(s->
cÚ‹xt
, 
d©a
, 
Ëngth
);

670 
	}
}

672 
	$¡biw__wr™e_hdr_sÿÆše
(
¡bi__wr™e_cÚ‹xt
 *
s
, 
width
, 
ncomp
, *
sü©ch
, *
sÿÆše
)

674 
sÿÆšeh—d”
[4] = { 2, 2, 0, 0 };

675 
rgbe
[4];

676 
lš—r
[3];

677 
x
;

679 
sÿÆšeh—d”
[2] = (
width
&0xff00)>>8;

680 
sÿÆšeh—d”
[3] = (
width
&0x00ff);

683 ià(
width
 < 8 || width >= 32768) {

684 
x
=0; x < 
width
; x++) {

685 
ncomp
) {

687 3: 
lš—r
[2] = 
sÿÆše
[
x
*
ncomp
 + 2];

688 
lš—r
[1] = 
sÿÆše
[
x
*
ncomp
 + 1];

689 
lš—r
[0] = 
sÿÆše
[
x
*
ncomp
 + 0];

692 
lš—r
[0] =†š—r[1] =†š—r[2] = 
sÿÆše
[
x
*
ncomp
 + 0];

695 
	`¡biw__lš—r_to_rgbe
(
rgbe
, 
lš—r
);

696 
s
->
	`func
(s->
cÚ‹xt
, 
rgbe
, 4);

699 
c
,
r
;

701 
x
=0; x < 
width
; x++) {

702 
ncomp
) {

704 3: 
lš—r
[2] = 
sÿÆše
[
x
*
ncomp
 + 2];

705 
lš—r
[1] = 
sÿÆše
[
x
*
ncomp
 + 1];

706 
lš—r
[0] = 
sÿÆše
[
x
*
ncomp
 + 0];

709 
lš—r
[0] =†š—r[1] =†š—r[2] = 
sÿÆše
[
x
*
ncomp
 + 0];

712 
	`¡biw__lš—r_to_rgbe
(
rgbe
, 
lš—r
);

713 
sü©ch
[
x
 + 
width
*0] = 
rgbe
[0];

714 
sü©ch
[
x
 + 
width
*1] = 
rgbe
[1];

715 
sü©ch
[
x
 + 
width
*2] = 
rgbe
[2];

716 
sü©ch
[
x
 + 
width
*3] = 
rgbe
[3];

719 
s
->
	`func
(s->
cÚ‹xt
, 
sÿÆšeh—d”
, 4);

722 
c
=0; c < 4; c++) {

723 *
comp
 = &
sü©ch
[
width
*
c
];

725 
x
 = 0;

726 
x
 < 
width
) {

728 
r
 = 
x
;

729 
r
+2 < 
width
) {

730 ià(
comp
[
r
] == comp[r+1] && comp[r] == comp[r+2])

732 ++
r
;

734 ià(
r
+2 >ğ
width
)

735 
r
 = 
width
;

737 
x
 < 
r
) {

738 
Ën
 = 
r
-
x
;

739 ià(
Ën
 > 128)†en = 128;

740 
	`¡biw__wr™e_dump_d©a
(
s
, 
Ën
, &
comp
[
x
]);

741 
x
 +ğ
Ën
;

744 ià(
r
+2 < 
width
) {

746 
r
 < 
width
 && 
comp
[r] =ğcomp[
x
])

747 ++
r
;

749 
x
 < 
r
) {

750 
Ën
 = 
r
-
x
;

751 ià(
Ën
 > 127)†en = 127;

752 
	`¡biw__wr™e_run_d©a
(
s
, 
Ën
, 
comp
[
x
]);

753 
x
 +ğ
Ën
;

759 
	}
}

761 
	$¡bi_wr™e_hdr_cÜe
(
¡bi__wr™e_cÚ‹xt
 *
s
, 
x
, 
y
, 
comp
, *
d©a
)

763 ià(
y
 <ğ0 || 
x
 <ğ0 || 
d©a
 =ğ
NULL
)

767 *
sü©ch
 = (*è
	`STBIW_MALLOC
(
x
*4);

768 
i
, 
Ën
;

769 
bufãr
[128];

770 
h—d”
[] = "#?RADIANCE\n# Written by stb_image_write.h\nFORMAT=32-bit_rle_rgbe\n";

771 
s
->
	`func
(s->
cÚ‹xt
, 
h—d”
, (header)-1);

773 #ifdeà
__STDC_LIB_EXT1__


774 
Ën
 = 
	`¥rštf_s
(
bufãr
, (bufãr), "EXPOSUREğ 1.0000000000000\n\n-Y %d +X %d\n", 
y
, 
x
);

776 
Ën
 = 
	`¥rštf
(
bufãr
, "EXPOSUREğ 1.0000000000000\n\n-Y %d +X %d\n", 
y
, 
x
);

778 
s
->
	`func
(s->
cÚ‹xt
, 
bufãr
, 
Ën
);

780 
i
=0; i < 
y
; i++)

781 
	`¡biw__wr™e_hdr_sÿÆše
(
s
, 
x
, 
comp
, 
sü©ch
, 
d©a
 + comp*x*(
¡bi__æ_v”tiÿÎy_Ú_wr™e
 ? 
y
-1-
i
 : i));

782 
	`STBIW_FREE
(
sü©ch
);

785 
	}
}

787 
STBIWDEF
 
	$¡bi_wr™e_hdr_to_func
(
¡bi_wr™e_func
 *
func
, *
cÚ‹xt
, 
x
, 
y
, 
comp
, cÚ¡ *
d©a
)

789 
¡bi__wr™e_cÚ‹xt
 
s
 = { 0 };

790 
	`¡bi__¡¬t_wr™e_ÿÎbacks
(&
s
, 
func
, 
cÚ‹xt
);

791  
	`¡bi_wr™e_hdr_cÜe
(&
s
, 
x
, 
y
, 
comp
, (*è
d©a
);

792 
	}
}

794 
STBIWDEF
 
	$¡bi_wr™e_hdr
(cÚ¡ *
f’ame
, 
x
, 
y
, 
comp
, cÚ¡ *
d©a
)

796 
¡bi__wr™e_cÚ‹xt
 
s
 = { 0 };

797 ià(
	`¡bi__¡¬t_wr™e_fe
(&
s
,
f’ame
)) {

798 
r
 = 
	`¡bi_wr™e_hdr_cÜe
(&
s
, 
x
, 
y
, 
comp
, (*è
d©a
);

799 
	`¡bi__’d_wr™e_fe
(&
s
);

800  
r
;

803 
	}
}

812 #iâdeà
STBIW_ZLIB_COMPRESS


814 
	#¡biw__sb¿w
(
a
è((*è(*è×è- 2)

	)

815 
	#¡biw__sbm
(
a
è
	`¡biw__sb¿w
×)[0]

	)

816 
	#¡biw__sbn
(
a
è
	`¡biw__sb¿w
×)[1]

	)

818 
	#¡biw__sbÃedgrow
(
a
,
n
è(×)==0 || 
	`¡biw__sbn
×)+À>ğ
	`¡biw__sbm
×))

	)

819 
	#¡biw__sbmaybegrow
(
a
,
n
è(
	`¡biw__sbÃedgrow
×,Ò)è? 
	`¡biw__sbgrow
×,nè: 0)

	)

820 
	#¡biw__sbgrow
(
a
,
n
è
	`¡biw__sbgrowf
((**è&×), (n), (*×)))

	)

822 
	#¡biw__sbpush
(
a
, 
v
è(
	`¡biw__sbmaybegrow
×,1), (a)[
	`¡biw__sbn
×)++] = (v))

	)

823 
	#¡biw__sbcouÁ
(
a
è(×è? 
	`¡biw__sbn
×è: 0)

	)

824 
	#¡biw__sbä“
(
a
è(×è? 
	`STBIW_FREE
(
	`¡biw__sb¿w
×)),0 : 0)

	)

826 *
	$¡biw__sbgrowf
(**
¬r
, 
šüem’t
, 
™emsize
)

828 
m
 = *
¬r
 ? 2*
	`¡biw__sbm
(*¬r)+
šüem’t
 : increment+1;

829 *
p
 = 
	`STBIW_REALLOC_SIZED
(*
¬r
 ? 
	`¡biw__sb¿w
(*¬rè: 0, *¬¸? (
	`¡biw__sbm
(*¬r)*
™emsize
 + ()*2è: 0, i‹msiz* 
m
 + ()*2);

830 
	`STBIW_ASSERT
(
p
);

831 ià(
p
) {

832 ià(!*
¬r
è((*è
p
)[1] = 0;

833 *
¬r
 = (*è((*è
p
 + 2);

834 
	`¡biw__sbm
(*
¬r
èğ
m
;

836  *
¬r
;

837 
	}
}

839 *
	$¡biw__zlib_æushf
(*
d©a
, *
b™bufãr
, *
b™couÁ
)

841 *
b™couÁ
 >= 8) {

842 
	`¡biw__sbpush
(
d©a
, 
	`STBIW_UCHAR
(*
b™bufãr
));

843 *
b™bufãr
 >>= 8;

844 *
b™couÁ
 -= 8;

846  
d©a
;

847 
	}
}

849 
	$¡biw__zlib_b™»v
(
code
, 
codeb™s
)

851 
»s
=0;

852 
codeb™s
--) {

853 
»s
 = (» << 1è| (
code
 & 1);

854 
code
 >>= 1;

856  
»s
;

857 
	}
}

859 
	$¡biw__zlib_couÁm
(*
a
, *
b
, 
lim™
)

861 
i
;

862 
i
=0; i < 
lim™
 && i < 258; ++i)

863 ià(
a
[
i
] !ğ
b
[i]) ;

864  
i
;

865 
	}
}

867 
	$¡biw__zhash
(*
d©a
)

869 
¡biw_ušt32
 
hash
 = 
d©a
[0] + (data[1] << 8) + (data[2] << 16);

870 
hash
 ^= hash << 3;

871 
hash
 += hash >> 5;

872 
hash
 ^= hash << 4;

873 
hash
 += hash >> 17;

874 
hash
 ^= hash << 25;

875 
hash
 += hash >> 6;

876  
hash
;

877 
	}
}

879 
	#¡biw__zlib_æush
(è(
out
 = 
	`¡biw__zlib_æushf
(out, &
b™buf
, &
b™couÁ
))

	)

880 
	#¡biw__zlib_add
(
code
,
codeb™s
) \

881 (
b™buf
 |ğ(
code
è<< 
b™couÁ
, b™couÁ +ğ(
codeb™s
), 
	`¡biw__zlib_æush
())

	)

882 
	#¡biw__zlib_hufç
(
b
,
c
è
	`¡biw__zlib_add
(
	`¡biw__zlib_b™»v
(b,c),c)

	)

884 
	#¡biw__zlib_huff1
(
n
è
	`¡biw__zlib_hufç
(0x30 + (n), 8)

	)

885 
	#¡biw__zlib_huff2
(
n
è
	`¡biw__zlib_hufç
(0x190 + (n)-144, 9)

	)

886 
	#¡biw__zlib_huff3
(
n
è
	`¡biw__zlib_hufç
(0 + (n)-256,7)

	)

887 
	#¡biw__zlib_huff4
(
n
è
	`¡biw__zlib_hufç
(0xc0 + (n)-280,8)

	)

888 
	#¡biw__zlib_huff
(
n
è(Òè<ğ143 ? 
	`¡biw__zlib_huff1
Òè: (nè<ğ255 ? 
	`¡biw__zlib_huff2
Òè: (nè<ğ279 ? 
	`¡biw__zlib_huff3
Òè: 
	`¡biw__zlib_huff4
Ò))

	)

889 
	#¡biw__zlib_huffb
(
n
è(Òè<ğ143 ? 
	`¡biw__zlib_huff1
Òè: 
	`¡biw__zlib_huff2
Ò))

	)

891 
	#¡biw__ZHASH
 16384

	)

895 
STBIWDEF
 * 
	$¡bi_zlib_com´ess
(*
d©a
, 
d©a_Ën
, *
out_Ën
, 
qu®™y
)

897 #ifdeà
STBIW_ZLIB_COMPRESS


899  
	`STBIW_ZLIB_COMPRESS
(
d©a
, 
d©a_Ën
, 
out_Ën
, 
qu®™y
);

901 
Ëngthc
[] = { 3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258, 259 };

902 
Ëngtheb
[]= { 0,0,0,0,0,0,0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0 };

903 
di¡c
[] = { 1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577, 32768 };

904 
di¡eb
[] = { 0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13 };

905 
b™buf
=0;

906 
i
,
j
, 
b™couÁ
=0;

907 *
out
 = 
NULL
;

908 ***
hash_bË
 = (***è
	`STBIW_MALLOC
(
¡biw__ZHASH
 * (**));

909 ià(
hash_bË
 =ğ
NULL
)

910  
NULL
;

911 ià(
qu®™y
 < 5) quality = 5;

913 
	`¡biw__sbpush
(
out
, 0x78);

914 
	`¡biw__sbpush
(
out
, 0x5e);

915 
	`¡biw__zlib_add
(1,1);

916 
	`¡biw__zlib_add
(1,2);

918 
i
=0; i < 
¡biw__ZHASH
; ++i)

919 
hash_bË
[
i
] = 
NULL
;

921 
i
=0;

922 
i
 < 
d©a_Ën
-3) {

924 
h
 = 
	`¡biw__zhash
(
d©a
+
i
)&(
¡biw__ZHASH
-1), 
be¡
=3;

925 *
be¡loc
 = 0;

926 **
hli¡
 = 
hash_bË
[
h
];

927 
n
 = 
	`¡biw__sbcouÁ
(
hli¡
);

928 
j
=0; j < 
n
; ++j) {

929 ià(
hli¡
[
j
]-
d©a
 > 
i
-32768) {

930 
d
 = 
	`¡biw__zlib_couÁm
(
hli¡
[
j
], 
d©a
+
i
, 
d©a_Ën
-i);

931 ià(
d
 >ğ
be¡
è{ be¡=d; 
be¡loc
=
hli¡
[
j
]; }

935 ià(
hash_bË
[
h
] && 
	`¡biw__sbn
(hash_bË[h]è=ğ2*
qu®™y
) {

936 
	`STBIW_MEMMOVE
(
hash_bË
[
h
], hash_bË[h]+
qu®™y
, (hash_table[h][0])*quality);

937 
	`¡biw__sbn
(
hash_bË
[
h
]èğ
qu®™y
;

939 
	`¡biw__sbpush
(
hash_bË
[
h
],
d©a
+
i
);

941 ià(
be¡loc
) {

943 
h
 = 
	`¡biw__zhash
(
d©a
+
i
+1)&(
¡biw__ZHASH
-1);

944 
hli¡
 = 
hash_bË
[
h
];

945 
n
 = 
	`¡biw__sbcouÁ
(
hli¡
);

946 
j
=0; j < 
n
; ++j) {

947 ià(
hli¡
[
j
]-
d©a
 > 
i
-32767) {

948 
e
 = 
	`¡biw__zlib_couÁm
(
hli¡
[
j
], 
d©a
+
i
+1, 
d©a_Ën
-i-1);

949 ià(
e
 > 
be¡
) {

950 
be¡loc
 = 
NULL
;

957 ià(
be¡loc
) {

958 
d
 = (è(
d©a
+
i
 - 
be¡loc
);

959 
	`STBIW_ASSERT
(
d
 <ğ32767 && 
be¡
 <= 258);

960 
j
=0; 
be¡
 > 
Ëngthc
[j+1]-1; ++j);

961 
	`¡biw__zlib_huff
(
j
+257);

962 ià(
Ëngtheb
[
j
]è
	`¡biw__zlib_add
(
be¡
 - 
Ëngthc
[j],†engtheb[j]);

963 
j
=0; 
d
 > 
di¡c
[j+1]-1; ++j);

964 
	`¡biw__zlib_add
(
	`¡biw__zlib_b™»v
(
j
,5),5);

965 ià(
di¡eb
[
j
]è
	`¡biw__zlib_add
(
d
 - 
di¡c
[j], disteb[j]);

966 
i
 +ğ
be¡
;

968 
	`¡biw__zlib_huffb
(
d©a
[
i
]);

969 ++
i
;

973 ;
i
 < 
d©a_Ën
; ++i)

974 
	`¡biw__zlib_huffb
(
d©a
[
i
]);

975 
	`¡biw__zlib_huff
(256);

977 
b™couÁ
)

978 
	`¡biw__zlib_add
(0,1);

980 
i
=0; i < 
¡biw__ZHASH
; ++i)

981 (è
	`¡biw__sbä“
(
hash_bË
[
i
]);

982 
	`STBIW_FREE
(
hash_bË
);

985 ià(
	`¡biw__sbn
(
out
è> 
d©a_Ën
 + 2 + ((data_len+32766)/32767)*5) {

986 
	`¡biw__sbn
(
out
) = 2;

987 
j
 = 0; j < 
d©a_Ën
;) {

988 
blockËn
 = 
d©a_Ën
 - 
j
;

989 ià(
blockËn
 > 32767) blocklen = 32767;

990 
	`¡biw__sbpush
(
out
, 
d©a_Ën
 - 
j
 =ğ
blockËn
);

991 
	`¡biw__sbpush
(
out
, 
	`STBIW_UCHAR
(
blockËn
));

992 
	`¡biw__sbpush
(
out
, 
	`STBIW_UCHAR
(
blockËn
 >> 8));

993 
	`¡biw__sbpush
(
out
, 
	`STBIW_UCHAR
(~
blockËn
));

994 
	`¡biw__sbpush
(
out
, 
	`STBIW_UCHAR
(~
blockËn
 >> 8));

995 
	`memıy
(
out
+
	`¡biw__sbn
(out), 
d©a
+
j
, 
blockËn
);

996 
	`¡biw__sbn
(
out
è+ğ
blockËn
;

997 
j
 +ğ
blockËn
;

1003 
s1
=1, 
s2
=0;

1004 
blockËn
 = (è(
d©a_Ën
 % 5552);

1005 
j
=0;

1006 
j
 < 
d©a_Ën
) {

1007 
i
=0; i < 
blockËn
; ++iè{ 
s1
 +ğ
d©a
[
j
+i]; 
s2
 += s1; }

1008 
s1
 %ğ65521; 
s2
 %= 65521;

1009 
j
 +ğ
blockËn
;

1010 
blockËn
 = 5552;

1012 
	`¡biw__sbpush
(
out
, 
	`STBIW_UCHAR
(
s2
 >> 8));

1013 
	`¡biw__sbpush
(
out
, 
	`STBIW_UCHAR
(
s2
));

1014 
	`¡biw__sbpush
(
out
, 
	`STBIW_UCHAR
(
s1
 >> 8));

1015 
	`¡biw__sbpush
(
out
, 
	`STBIW_UCHAR
(
s1
));

1017 *
out_Ën
 = 
	`¡biw__sbn
(
out
);

1019 
	`STBIW_MEMMOVE
(
	`¡biw__sb¿w
(
out
), out, *
out_Ën
);

1020  (*è
	`¡biw__sb¿w
(
out
);

1022 
	}
}

1024 
	$¡biw__üc32
(*
bufãr
, 
Ën
)

1026 #ifdeà
STBIW_CRC32


1027  
	`STBIW_CRC32
(
bufãr
, 
Ën
);

1029 
üc_bË
[256] =

1065 
üc
 = ~0u;

1066 
i
;

1067 
i
=0; i < 
Ën
; ++i)

1068 
üc
 = (üø>> 8è^ 
üc_bË
[
bufãr
[
i
] ^ (crc & 0xff)];

1069  ~
üc
;

1071 
	}
}

1073 
	#¡biw__w²g4
(
o
,
a
,
b
,
c
,
d
è((o)[0]=
	`STBIW_UCHAR
×),(o)[1]=STBIW_UCHAR(b),(o)[2]=STBIW_UCHAR(c),(o)[3]=STBIW_UCHAR(d),(o)+=4)

	)

1074 
	#¡biw__wp32
(
d©a
,
v
è
	`¡biw__w²g4
(d©a, (v)>>24,(v)>>16,(v)>>8,(v));

	)

1075 
	#¡biw__w±ag
(
d©a
,
s
è
	`¡biw__w²g4
(d©a, s[0],s[1],s[2],s[3])

	)

1077 
	$¡biw__wpüc
(**
d©a
, 
Ën
)

1079 
üc
 = 
	`¡biw__üc32
(*
d©a
 - 
Ën
 - 4,†en+4);

1080 
	`¡biw__wp32
(*
d©a
, 
üc
);

1081 
	}
}

1083 
	$¡biw__·‘h
(
a
, 
b
, 
c
)

1085 
p
 = 
a
 + 
b
 - 
c
, 
·
 = 
	`abs
Õ-a), 
pb
 =‡bsÕ-b), 
pc
 =‡bs(p-c);

1086 ià(
·
 <ğ
pb
 &&…¨<ğ
pc
è 
	`STBIW_UCHAR
(
a
);

1087 ià(
pb
 <ğ
pc
è 
	`STBIW_UCHAR
(
b
);

1088  
	`STBIW_UCHAR
(
c
);

1089 
	}
}

1092 
	$¡biw__’code_²g_lše
(*
pix–s
, 
¡ride_by‹s
, 
width
, 
height
, 
y
, 
n
, 
f‹r_ty³
, sigÃd *
lše_bufãr
)

1094 
m­pšg
[] = { 0,1,2,3,4 };

1095 
fœ¡m­
[] = { 0,1,0,5,6 };

1096 *
mym­
 = (
y
 !ğ0è? 
m­pšg
 : 
fœ¡m­
;

1097 
i
;

1098 
ty³
 = 
mym­
[
f‹r_ty³
];

1099 *
z
 = 
pix–s
 + 
¡ride_by‹s
 * (
¡bi__æ_v”tiÿÎy_Ú_wr™e
 ? 
height
-1-
y
 : y);

1100 
sigÃd_¡ride
 = 
¡bi__æ_v”tiÿÎy_Ú_wr™e
 ? -
¡ride_by‹s
 : stride_bytes;

1102 ià(
ty³
==0) {

1103 
	`memıy
(
lše_bufãr
, 
z
, 
width
*
n
);

1108 
i
 = 0; i < 
n
; ++i) {

1109 
ty³
) {

1110 1: 
lše_bufãr
[
i
] = 
z
[i]; ;

1111 2: 
lše_bufãr
[
i
] = 
z
[i] - z[i-
sigÃd_¡ride
]; ;

1112 3: 
lše_bufãr
[
i
] = 
z
[i] - (z[i-
sigÃd_¡ride
]>>1); ;

1113 4: 
lše_bufãr
[
i
] = (sigÃd è(
z
[i] - 
	`¡biw__·‘h
(0,z[i-
sigÃd_¡ride
],0)); ;

1114 5: 
lše_bufãr
[
i
] = 
z
[i]; ;

1115 6: 
lše_bufãr
[
i
] = 
z
[i]; ;

1118 
ty³
) {

1119 1: 
i
=
n
; i < 
width
*n; ++iè
lše_bufãr
[i] = 
z
[i] - z[i-n]; ;

1120 2: 
i
=
n
; i < 
width
*n; ++iè
lše_bufãr
[i] = 
z
[i] - z[i-
sigÃd_¡ride
]; ;

1121 3: 
i
=
n
; i < 
width
*n; ++iè
lše_bufãr
[i] = 
z
[i] - ((z[i-n] + z[i-
sigÃd_¡ride
])>>1); ;

1122 4: 
i
=
n
; i < 
width
*n; ++iè
lše_bufãr
[i] = 
z
[i] - 
	`¡biw__·‘h
(z[i-n], z[i-
sigÃd_¡ride
], z[i-signed_stride-n]); ;

1123 5: 
i
=
n
; i < 
width
*n; ++iè
lše_bufãr
[i] = 
z
[i] - (z[i-n]>>1); ;

1124 6: 
i
=
n
; i < 
width
*n; ++iè
lše_bufãr
[i] = 
z
[i] - 
	`¡biw__·‘h
(z[i-n], 0,0); ;

1126 
	}
}

1128 
STBIWDEF
 *
	$¡bi_wr™e_²g_to_mem
(cÚ¡ *
pix–s
, 
¡ride_by‹s
, 
x
, 
y
, 
n
, *
out_Ën
)

1130 
fÜû_f‹r
 = 
¡bi_wr™e_fÜû_²g_f‹r
;

1131 
ùy³
[5] = { -1, 0, 4, 2, 6 };

1132 
sig
[8] = { 137,80,78,71,13,10,26,10 };

1133 *
out
,*
o
, *
ft
, *
zlib
;

1134 sigÃd *
lše_bufãr
;

1135 
j
,
zËn
;

1137 ià(
¡ride_by‹s
 == 0)

1138 
¡ride_by‹s
 = 
x
 * 
n
;

1140 ià(
fÜû_f‹r
 >= 5) {

1141 
fÜû_f‹r
 = -1;

1144 
ft
 = (*è
	`STBIW_MALLOC
((
x
*
n
+1è* 
y
); if (!filt)  0;

1145 
lše_bufãr
 = (sigÃd *è
	`STBIW_MALLOC
(
x
 * 
n
); ià(!lše_bufãrè{ 
	`STBIW_FREE
(
ft
);  0; }

1146 
j
=0; j < 
y
; ++j) {

1147 
f‹r_ty³
;

1148 ià(
fÜû_f‹r
 > -1) {

1149 
f‹r_ty³
 = 
fÜû_f‹r
;

1150 
	`¡biw__’code_²g_lše
((*)(
pix–s
), 
¡ride_by‹s
, 
x
, 
y
, 
j
, 
n
, 
fÜû_f‹r
, 
lše_bufãr
);

1152 
be¡_f‹r
 = 0, 
be¡_f‹r_v®
 = 0x7fffffff, 
e¡
, 
i
;

1153 
f‹r_ty³
 = 0; filter_type < 5; filter_type++) {

1154 
	`¡biw__’code_²g_lše
((*)(
pix–s
), 
¡ride_by‹s
, 
x
, 
y
, 
j
, 
n
, 
f‹r_ty³
, 
lše_bufãr
);

1157 
e¡
 = 0;

1158 
i
 = 0; i < 
x
*
n
; ++i) {

1159 
e¡
 +ğ
	`abs
((sigÃd è
lše_bufãr
[
i
]);

1161 ià(
e¡
 < 
be¡_f‹r_v®
) {

1162 
be¡_f‹r_v®
 = 
e¡
;

1163 
be¡_f‹r
 = 
f‹r_ty³
;

1166 ià(
f‹r_ty³
 !ğ
be¡_f‹r
) {

1167 
	`¡biw__’code_²g_lše
((*)(
pix–s
), 
¡ride_by‹s
, 
x
, 
y
, 
j
, 
n
, 
be¡_f‹r
, 
lše_bufãr
);

1168 
f‹r_ty³
 = 
be¡_f‹r
;

1172 
ft
[
j
*(
x
*
n
+1)] = (è
f‹r_ty³
;

1173 
	`STBIW_MEMMOVE
(
ft
+
j
*(
x
*
n
+1)+1, 
lše_bufãr
, x*n);

1175 
	`STBIW_FREE
(
lše_bufãr
);

1176 
zlib
 = 
	`¡bi_zlib_com´ess
(
ft
, 
y
*Ğ
x
*
n
+1), &
zËn
, 
¡bi_wr™e_²g_com´essiÚ_Ëv–
);

1177 
	`STBIW_FREE
(
ft
);

1178 ià(!
zlib
)  0;

1181 
out
 = (*è
	`STBIW_MALLOC
(8 + 12+13 + 12+
zËn
 + 12);

1182 ià(!
out
)  0;

1183 *
out_Ën
 = 8 + 12+13 + 12+
zËn
 + 12;

1185 
o
=
out
;

1186 
	`STBIW_MEMMOVE
(
o
,
sig
,8); o+= 8;

1187 
	`¡biw__wp32
(
o
, 13);

1188 
	`¡biw__w±ag
(
o
, "IHDR");

1189 
	`¡biw__wp32
(
o
, 
x
);

1190 
	`¡biw__wp32
(
o
, 
y
);

1191 *
o
++ = 8;

1192 *
o
++ = 
	`STBIW_UCHAR
(
ùy³
[
n
]);

1193 *
o
++ = 0;

1194 *
o
++ = 0;

1195 *
o
++ = 0;

1196 
	`¡biw__wpüc
(&
o
,13);

1198 
	`¡biw__wp32
(
o
, 
zËn
);

1199 
	`¡biw__w±ag
(
o
, "IDAT");

1200 
	`STBIW_MEMMOVE
(
o
, 
zlib
, 
zËn
);

1201 
o
 +ğ
zËn
;

1202 
	`STBIW_FREE
(
zlib
);

1203 
	`¡biw__wpüc
(&
o
, 
zËn
);

1205 
	`¡biw__wp32
(
o
,0);

1206 
	`¡biw__w±ag
(
o
, "IEND");

1207 
	`¡biw__wpüc
(&
o
,0);

1209 
	`STBIW_ASSERT
(
o
 =ğ
out
 + *
out_Ën
);

1211  
out
;

1212 
	}
}

1214 #iâdeà
STBI_WRITE_NO_STDIO


1215 
STBIWDEF
 
	$¡bi_wr™e_²g
(cÚ¡ *
f’ame
, 
x
, 
y
, 
comp
, cÚ¡ *
d©a
, 
¡ride_by‹s
)

1217 
FILE
 *
f
;

1218 
Ën
;

1219 *
²g
 = 
	`¡bi_wr™e_²g_to_mem
((cÚ¡ *è
d©a
, 
¡ride_by‹s
, 
x
, 
y
, 
comp
, &
Ën
);

1220 ià(
²g
 =ğ
NULL
)  0;

1222 
f
 = 
	`¡biw__fİ’
(
f’ame
, "wb");

1223 ià(!
f
è{ 
	`STBIW_FREE
(
²g
);  0; }

1224 
	`fwr™e
(
²g
, 1, 
Ën
, 
f
);

1225 
	`fşo£
(
f
);

1226 
	`STBIW_FREE
(
²g
);

1228 
	}
}

1231 
STBIWDEF
 
	$¡bi_wr™e_²g_to_func
(
¡bi_wr™e_func
 *
func
, *
cÚ‹xt
, 
x
, 
y
, 
comp
, cÚ¡ *
d©a
, 
¡ride_by‹s
)

1233 
Ën
;

1234 *
²g
 = 
	`¡bi_wr™e_²g_to_mem
((cÚ¡ *è
d©a
, 
¡ride_by‹s
, 
x
, 
y
, 
comp
, &
Ën
);

1235 ià(
²g
 =ğ
NULL
)  0;

1236 
	`func
(
cÚ‹xt
, 
²g
, 
Ën
);

1237 
	`STBIW_FREE
(
²g
);

1239 
	}
}

1250 cÚ¡ 
	g¡biw__jpg_ZigZag
[] = { 0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,

1253 
	$¡biw__jpg_wr™eB™s
(
¡bi__wr™e_cÚ‹xt
 *
s
, *
b™BufP
, *
b™CÁP
, cÚ¡ *
bs
) {

1254 
b™Buf
 = *
b™BufP
, 
b™CÁ
 = *
b™CÁP
;

1255 
b™CÁ
 +ğ
bs
[1];

1256 
b™Buf
 |ğ
bs
[0] << (24 - 
b™CÁ
);

1257 
b™CÁ
 >= 8) {

1258 
c
 = (
b™Buf
 >> 16) & 255;

1259 
	`¡biw__putc
(
s
, 
c
);

1260 if(
c
 == 255) {

1261 
	`¡biw__putc
(
s
, 0);

1263 
b™Buf
 <<= 8;

1264 
b™CÁ
 -= 8;

1266 *
b™BufP
 = 
b™Buf
;

1267 *
b™CÁP
 = 
b™CÁ
;

1268 
	}
}

1270 
	$¡biw__jpg_DCT
(*
d0p
, *
d1p
, *
d2p
, *
d3p
, *
d4p
, *
d5p
, *
d6p
, *
d7p
) {

1271 
d0
 = *
d0p
, 
d1
 = *
d1p
, 
d2
 = *
d2p
, 
d3
 = *
d3p
, 
d4
 = *
d4p
, 
d5
 = *
d5p
, 
d6
 = *
d6p
, 
d7
 = *
d7p
;

1272 
z1
, 
z2
, 
z3
, 
z4
, 
z5
, 
z11
, 
z13
;

1274 
tmp0
 = 
d0
 + 
d7
;

1275 
tmp7
 = 
d0
 - 
d7
;

1276 
tmp1
 = 
d1
 + 
d6
;

1277 
tmp6
 = 
d1
 - 
d6
;

1278 
tmp2
 = 
d2
 + 
d5
;

1279 
tmp5
 = 
d2
 - 
d5
;

1280 
tmp3
 = 
d3
 + 
d4
;

1281 
tmp4
 = 
d3
 - 
d4
;

1284 
tmp10
 = 
tmp0
 + 
tmp3
;

1285 
tmp13
 = 
tmp0
 - 
tmp3
;

1286 
tmp11
 = 
tmp1
 + 
tmp2
;

1287 
tmp12
 = 
tmp1
 - 
tmp2
;

1289 
d0
 = 
tmp10
 + 
tmp11
;

1290 
d4
 = 
tmp10
 - 
tmp11
;

1292 
z1
 = (
tmp12
 + 
tmp13
) * 0.707106781f;

1293 
d2
 = 
tmp13
 + 
z1
;

1294 
d6
 = 
tmp13
 - 
z1
;

1297 
tmp10
 = 
tmp4
 + 
tmp5
;

1298 
tmp11
 = 
tmp5
 + 
tmp6
;

1299 
tmp12
 = 
tmp6
 + 
tmp7
;

1302 
z5
 = (
tmp10
 - 
tmp12
) * 0.382683433f;

1303 
z2
 = 
tmp10
 * 0.541196100à+ 
z5
;

1304 
z4
 = 
tmp12
 * 1.306562965à+ 
z5
;

1305 
z3
 = 
tmp11
 * 0.707106781f;

1307 
z11
 = 
tmp7
 + 
z3
;

1308 
z13
 = 
tmp7
 - 
z3
;

1310 *
d5p
 = 
z13
 + 
z2
;

1311 *
d3p
 = 
z13
 - 
z2
;

1312 *
d1p
 = 
z11
 + 
z4
;

1313 *
d7p
 = 
z11
 - 
z4
;

1315 *
d0p
 = 
d0
; *
d2p
 = 
d2
; *
d4p
 = 
d4
; *
d6p
 = 
d6
;

1316 
	}
}

1318 
	$¡biw__jpg_ÿlcB™s
(
v®
, 
b™s
[2]) {

1319 
tmp1
 = 
v®
 < 0 ? -val : val;

1320 
v®
 = val < 0 ? val-1 : val;

1321 
b™s
[1] = 1;

1322 
tmp1
 >>= 1) {

1323 ++
b™s
[1];

1325 
b™s
[0] = 
v®
 & ((1<<bits[1])-1);

1326 
	}
}

1328 
	$¡biw__jpg_´oûssDU
(
¡bi__wr™e_cÚ‹xt
 *
s
, *
b™Buf
, *
b™CÁ
, *
CDU
, 
du_¡ride
, *
fdtbl
, 
DC
, cÚ¡ 
HTDC
[256][2], cÚ¡ 
HTAC
[256][2]) {

1329 cÚ¡ 
EOB
[2] = { 
HTAC
[0x00][0], HTAC[0x00][1] };

1330 cÚ¡ 
M16z”Ûs
[2] = { 
HTAC
[0xF0][0], HTAC[0xF0][1] };

1331 
d©aOff
, 
i
, 
j
, 
n
, 
diff
, 
’d0pos
, 
x
, 
y
;

1332 
DU
[64];

1335 
d©aOff
=0, 
n
=
du_¡ride
*8; dataOff<n; dataOff+=du_stride) {

1336 
	`¡biw__jpg_DCT
(&
CDU
[
d©aOff
], &CDU[dataOff+1], &CDU[dataOff+2], &CDU[dataOff+3], &CDU[dataOff+4], &CDU[dataOff+5], &CDU[dataOff+6], &CDU[dataOff+7]);

1339 
d©aOff
=0; dataOff<8; ++dataOff) {

1340 
	`¡biw__jpg_DCT
(&
CDU
[
d©aOff
], &CDU[d©aOff+
du_¡ride
], &CDU[dataOff+du_stride*2], &CDU[dataOff+du_stride*3], &CDU[dataOff+du_stride*4],

1341 &
CDU
[
d©aOff
+
du_¡ride
*5], &CDU[dataOff+du_stride*6], &CDU[dataOff+du_stride*7]);

1344 
y
 = 0, 
j
=0; y < 8; ++y) {

1345 
x
 = 0; x < 8; ++x,++
j
) {

1346 
v
;

1347 
i
 = 
y
*
du_¡ride
+
x
;

1348 
v
 = 
CDU
[
i
]*
fdtbl
[
j
];

1351 
DU
[
¡biw__jpg_ZigZag
[
j
]] = ()(
v
 < 0 ? v - 0.5f : v + 0.5f);

1356 
diff
 = 
DU
[0] - 
DC
;

1357 ià(
diff
 == 0) {

1358 
	`¡biw__jpg_wr™eB™s
(
s
, 
b™Buf
, 
b™CÁ
, 
HTDC
[0]);

1360 
b™s
[2];

1361 
	`¡biw__jpg_ÿlcB™s
(
diff
, 
b™s
);

1362 
	`¡biw__jpg_wr™eB™s
(
s
, 
b™Buf
, 
b™CÁ
, 
HTDC
[
b™s
[1]]);

1363 
	`¡biw__jpg_wr™eB™s
(
s
, 
b™Buf
, 
b™CÁ
, 
b™s
);

1366 
’d0pos
 = 63;

1367 ; (
’d0pos
>0)&&(
DU
[end0pos]==0); --end0pos) {

1370 if(
’d0pos
 == 0) {

1371 
	`¡biw__jpg_wr™eB™s
(
s
, 
b™Buf
, 
b™CÁ
, 
EOB
);

1372  
DU
[0];

1374 
i
 = 1; i <ğ
’d0pos
; ++i) {

1375 
¡¬os
 = 
i
;

1376 
Äz”Ûs
;

1377 
b™s
[2];

1378 ; 
DU
[
i
]==0 && i<=
’d0pos
; ++i) {

1380 
Äz”Ûs
 = 
i
-
¡¬os
;

1381 iàĞ
Äz”Ûs
 >= 16 ) {

1382 
Êg
 = 
Äz”Ûs
>>4;

1383 
Äm¬k”
;

1384 
Äm¬k”
=1;‚rm¬k” <ğ
Êg
; ++nrmarker)

1385 
	`¡biw__jpg_wr™eB™s
(
s
, 
b™Buf
, 
b™CÁ
, 
M16z”Ûs
);

1386 
Äz”Ûs
 &= 15;

1388 
	`¡biw__jpg_ÿlcB™s
(
DU
[
i
], 
b™s
);

1389 
	`¡biw__jpg_wr™eB™s
(
s
, 
b™Buf
, 
b™CÁ
, 
HTAC
[(
Äz”Ûs
<<4)+
b™s
[1]]);

1390 
	`¡biw__jpg_wr™eB™s
(
s
, 
b™Buf
, 
b™CÁ
, 
b™s
);

1392 if(
’d0pos
 != 63) {

1393 
	`¡biw__jpg_wr™eB™s
(
s
, 
b™Buf
, 
b™CÁ
, 
EOB
);

1395  
DU
[0];

1396 
	}
}

1398 
	$¡bi_wr™e_jpg_cÜe
(
¡bi__wr™e_cÚ‹xt
 *
s
, 
width
, 
height
, 
comp
, cÚ¡ * 
d©a
, 
qu®™y
) {

1400 cÚ¡ 
¡d_dc_lumšªû_Äcodes
[] = {0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0};

1401 cÚ¡ 
¡d_dc_lumšªû_v®ues
[] = {0,1,2,3,4,5,6,7,8,9,10,11};

1402 cÚ¡ 
¡d_ac_lumšªû_Äcodes
[] = {0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,0x7d};

1403 cÚ¡ 
¡d_ac_lumšªû_v®ues
[] = {

1412 cÚ¡ 
¡d_dc_chromšªû_Äcodes
[] = {0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0};

1413 cÚ¡ 
¡d_dc_chromšªû_v®ues
[] = {0,1,2,3,4,5,6,7,8,9,10,11};

1414 cÚ¡ 
¡d_ac_chromšªû_Äcodes
[] = {0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,0x77};

1415 cÚ¡ 
¡d_ac_chromšªû_v®ues
[] = {

1425 cÚ¡ 
YDC_HT
[256][2] = { {0,2},{2,3},{3,3},{4,3},{5,3},{6,3},{14,4},{30,5},{62,6},{126,7},{254,8},{510,9}};

1426 cÚ¡ 
UVDC_HT
[256][2] = { {0,2},{1,2},{2,2},{6,3},{14,4},{30,5},{62,6},{126,7},{254,8},{510,9},{1022,10},{2046,11}};

1427 cÚ¡ 
YAC_HT
[256][2] = {

1445 cÚ¡ 
UVAC_HT
[256][2] = {

1463 cÚ¡ 
YQT
[] = {16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,

1465 cÚ¡ 
UVQT
[] = {17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,

1467 cÚ¡ 
¯sf
[] = { 1.0f * 2.828427125f, 1.387039845f * 2.828427125f, 1.306562965f * 2.828427125f, 1.175875602f * 2.828427125f,

1470 
row
, 
cŞ
, 
i
, 
k
, 
sub§m¶e
;

1471 
fdtbl_Y
[64], 
fdtbl_UV
[64];

1472 
YTabË
[64], 
UVTabË
[64];

1474 if(!
d©a
 || !
width
 || !
height
 || 
comp
 > 4 || comp < 1) {

1478 
qu®™y
 = quality ? quality : 90;

1479 
sub§m¶e
 = 
qu®™y
 <= 90 ? 1 : 0;

1480 
qu®™y
 = quality < 1 ? 1 : quality > 100 ? 100 : quality;

1481 
qu®™y
 = quality < 50 ? 5000 / quality : 200 - quality * 2;

1483 
i
 = 0; i < 64; ++i) {

1484 
uvti
, 
yti
 = (
YQT
[
i
]*
qu®™y
+50)/100;

1485 
YTabË
[
¡biw__jpg_ZigZag
[
i
]] = (è(
yti
 < 1 ? 1 : yti > 255 ? 255 : yti);

1486 
uvti
 = (
UVQT
[
i
]*
qu®™y
+50)/100;

1487 
UVTabË
[
¡biw__jpg_ZigZag
[
i
]] = (è(
uvti
 < 1 ? 1 : uvti > 255 ? 255 : uvti);

1490 
row
 = 0, 
k
 = 0;„ow < 8; ++row) {

1491 
cŞ
 = 0; cŞ < 8; ++cŞ, ++
k
) {

1492 
fdtbl_Y
[
k
] = 1 / (
YTabË
 [
¡biw__jpg_ZigZag
[k]] * 
¯sf
[
row
] *‡asf[
cŞ
]);

1493 
fdtbl_UV
[
k
] = 1 / (
UVTabË
[
¡biw__jpg_ZigZag
[k]] * 
¯sf
[
row
] *‡asf[
cŞ
]);

1499 cÚ¡ 
h—d0
[] = { 0xFF,0xD8,0xFF,0xE0,0,0x10,'J','F','I','F',0,1,1,0,0,1,0,1,0,0,0xFF,0xDB,0,0x84,0 };

1500 cÚ¡ 
h—d2
[] = { 0xFF,0xDA,0,0xC,3,1,0,2,0x11,3,0x11,0,0x3F,0 };

1501 cÚ¡ 
h—d1
[] = { 0xFF,0xC0,0,0x11,8,()(
height
>>8),
	`STBIW_UCHAR
(height),()(
width
>>8),STBIW_UCHAR(width),

1502 3,1,()(
sub§m¶e
?0x22:0x11),0,2,0x11,1,3,0x11,1,0xFF,0xC4,0x01,0xA2,0 };

1503 
s
->
	`func
(s->
cÚ‹xt
, (*)
h—d0
, (head0));

1504 
s
->
	`func
(s->
cÚ‹xt
, (*)
YTabË
, (YTable));

1505 
	`¡biw__putc
(
s
, 1);

1506 
s
->
	`func
(s->
cÚ‹xt
, 
UVTabË
, (UVTable));

1507 
s
->
	`func
(s->
cÚ‹xt
, (*)
h—d1
, (head1));

1508 
s
->
	`func
(s->
cÚ‹xt
, (*)(
¡d_dc_lumšªû_Äcodes
+1), (std_dc_luminance_nrcodes)-1);

1509 
s
->
	`func
(s->
cÚ‹xt
, (*)
¡d_dc_lumšªû_v®ues
, (std_dc_luminance_values));

1510 
	`¡biw__putc
(
s
, 0x10);

1511 
s
->
	`func
(s->
cÚ‹xt
, (*)(
¡d_ac_lumšªû_Äcodes
+1), (std_ac_luminance_nrcodes)-1);

1512 
s
->
	`func
(s->
cÚ‹xt
, (*)
¡d_ac_lumšªû_v®ues
, (std_ac_luminance_values));

1513 
	`¡biw__putc
(
s
, 1);

1514 
s
->
	`func
(s->
cÚ‹xt
, (*)(
¡d_dc_chromšªû_Äcodes
+1), (std_dc_chrominance_nrcodes)-1);

1515 
s
->
	`func
(s->
cÚ‹xt
, (*)
¡d_dc_chromšªû_v®ues
, (std_dc_chrominance_values));

1516 
	`¡biw__putc
(
s
, 0x11);

1517 
s
->
	`func
(s->
cÚ‹xt
, (*)(
¡d_ac_chromšªû_Äcodes
+1), (std_ac_chrominance_nrcodes)-1);

1518 
s
->
	`func
(s->
cÚ‹xt
, (*)
¡d_ac_chromšªû_v®ues
, (std_ac_chrominance_values));

1519 
s
->
	`func
(s->
cÚ‹xt
, (*)
h—d2
, (head2));

1524 cÚ¡ 
flB™s
[] = {0x7F, 7};

1525 
DCY
=0, 
DCU
=0, 
DCV
=0;

1526 
b™Buf
=0, 
b™CÁ
=0;

1528 
ofsG
 = 
comp
 > 2 ? 1 : 0, 
ofsB
 = comp > 2 ? 2 : 0;

1529 cÚ¡ *
d©aR
 = (cÚ¡ *)
d©a
;

1530 cÚ¡ *
d©aG
 = 
d©aR
 + 
ofsG
;

1531 cÚ¡ *
d©aB
 = 
d©aR
 + 
ofsB
;

1532 
x
, 
y
, 
pos
;

1533 if(
sub§m¶e
) {

1534 
y
 = 0; y < 
height
; y += 16) {

1535 
x
 = 0; x < 
width
; x += 16) {

1536 
Y
[256], 
U
[256], 
V
[256];

1537 
row
 = 
y
, 
pos
 = 0;„ow < y+16; ++row) {

1539 
şam³d_row
 = (
row
 < 
height
) ?„ow : height - 1;

1540 
ba£_p
 = (
¡bi__æ_v”tiÿÎy_Ú_wr™e
 ? (
height
-1-
şam³d_row
è: cÏm³d_row)*
width
*
comp
;

1541 
cŞ
 = 
x
; cŞ < x+16; ++cŞ, ++
pos
) {

1543 
p
 = 
ba£_p
 + ((
cŞ
 < 
width
è? cŞ : (width-1))*
comp
;

1544 
r
 = 
d©aR
[
p
], 
g
 = 
d©aG
[p], 
b
 = 
d©aB
[p];

1545 
Y
[
pos
]ğ+0.29900f*
r
 + 0.58700f*
g
 + 0.11400f*
b
 - 128;

1546 
U
[
pos
]ğ-0.16874f*
r
 - 0.33126f*
g
 + 0.50000f*
b
;

1547 
V
[
pos
]ğ+0.50000f*
r
 - 0.41869f*
g
 - 0.08131f*
b
;

1550 
DCY
 = 
	`¡biw__jpg_´oûssDU
(
s
, &
b™Buf
, &
b™CÁ
, 
Y
+0, 16, 
fdtbl_Y
, DCY, 
YDC_HT
, 
YAC_HT
);

1551 
DCY
 = 
	`¡biw__jpg_´oûssDU
(
s
, &
b™Buf
, &
b™CÁ
, 
Y
+8, 16, 
fdtbl_Y
, DCY, 
YDC_HT
, 
YAC_HT
);

1552 
DCY
 = 
	`¡biw__jpg_´oûssDU
(
s
, &
b™Buf
, &
b™CÁ
, 
Y
+128, 16, 
fdtbl_Y
, DCY, 
YDC_HT
, 
YAC_HT
);

1553 
DCY
 = 
	`¡biw__jpg_´oûssDU
(
s
, &
b™Buf
, &
b™CÁ
, 
Y
+136, 16, 
fdtbl_Y
, DCY, 
YDC_HT
, 
YAC_HT
);

1557 
subU
[64], 
subV
[64];

1558 
yy
, 
xx
;

1559 
yy
 = 0, 
pos
 = 0; yy < 8; ++yy) {

1560 
xx
 = 0; xx < 8; ++xx, ++
pos
) {

1561 
j
 = 
yy
*32+
xx
*2;

1562 
subU
[
pos
] = (
U
[
j
+0] + U[j+1] + U[j+16] + U[j+17]) * 0.25f;

1563 
subV
[
pos
] = (
V
[
j
+0] + V[j+1] + V[j+16] + V[j+17]) * 0.25f;

1566 
DCU
 = 
	`¡biw__jpg_´oûssDU
(
s
, &
b™Buf
, &
b™CÁ
, 
subU
, 8, 
fdtbl_UV
, DCU, 
UVDC_HT
, 
UVAC_HT
);

1567 
DCV
 = 
	`¡biw__jpg_´oûssDU
(
s
, &
b™Buf
, &
b™CÁ
, 
subV
, 8, 
fdtbl_UV
, DCV, 
UVDC_HT
, 
UVAC_HT
);

1572 
y
 = 0; y < 
height
; y += 8) {

1573 
x
 = 0; x < 
width
; x += 8) {

1574 
Y
[64], 
U
[64], 
V
[64];

1575 
row
 = 
y
, 
pos
 = 0;„ow < y+8; ++row) {

1577 
şam³d_row
 = (
row
 < 
height
) ?„ow : height - 1;

1578 
ba£_p
 = (
¡bi__æ_v”tiÿÎy_Ú_wr™e
 ? (
height
-1-
şam³d_row
è: cÏm³d_row)*
width
*
comp
;

1579 
cŞ
 = 
x
; cŞ < x+8; ++cŞ, ++
pos
) {

1581 
p
 = 
ba£_p
 + ((
cŞ
 < 
width
è? cŞ : (width-1))*
comp
;

1582 
r
 = 
d©aR
[
p
], 
g
 = 
d©aG
[p], 
b
 = 
d©aB
[p];

1583 
Y
[
pos
]ğ+0.29900f*
r
 + 0.58700f*
g
 + 0.11400f*
b
 - 128;

1584 
U
[
pos
]ğ-0.16874f*
r
 - 0.33126f*
g
 + 0.50000f*
b
;

1585 
V
[
pos
]ğ+0.50000f*
r
 - 0.41869f*
g
 - 0.08131f*
b
;

1589 
DCY
 = 
	`¡biw__jpg_´oûssDU
(
s
, &
b™Buf
, &
b™CÁ
, 
Y
, 8, 
fdtbl_Y
, DCY, 
YDC_HT
, 
YAC_HT
);

1590 
DCU
 = 
	`¡biw__jpg_´oûssDU
(
s
, &
b™Buf
, &
b™CÁ
, 
U
, 8, 
fdtbl_UV
, DCU, 
UVDC_HT
, 
UVAC_HT
);

1591 
DCV
 = 
	`¡biw__jpg_´oûssDU
(
s
, &
b™Buf
, &
b™CÁ
, 
V
, 8, 
fdtbl_UV
, DCV, 
UVDC_HT
, 
UVAC_HT
);

1597 
	`¡biw__jpg_wr™eB™s
(
s
, &
b™Buf
, &
b™CÁ
, 
flB™s
);

1601 
	`¡biw__putc
(
s
, 0xFF);

1602 
	`¡biw__putc
(
s
, 0xD9);

1605 
	}
}

1607 
STBIWDEF
 
	$¡bi_wr™e_jpg_to_func
(
¡bi_wr™e_func
 *
func
, *
cÚ‹xt
, 
x
, 
y
, 
comp
, cÚ¡ *
d©a
, 
qu®™y
)

1609 
¡bi__wr™e_cÚ‹xt
 
s
 = { 0 };

1610 
	`¡bi__¡¬t_wr™e_ÿÎbacks
(&
s
, 
func
, 
cÚ‹xt
);

1611  
	`¡bi_wr™e_jpg_cÜe
(&
s
, 
x
, 
y
, 
comp
, (*è
d©a
, 
qu®™y
);

1612 
	}
}

1615 #iâdeà
STBI_WRITE_NO_STDIO


1616 
STBIWDEF
 
	$¡bi_wr™e_jpg
(cÚ¡ *
f’ame
, 
x
, 
y
, 
comp
, cÚ¡ *
d©a
, 
qu®™y
)

1618 
¡bi__wr™e_cÚ‹xt
 
s
 = { 0 };

1619 ià(
	`¡bi__¡¬t_wr™e_fe
(&
s
,
f’ame
)) {

1620 
r
 = 
	`¡bi_wr™e_jpg_cÜe
(&
s
, 
x
, 
y
, 
comp
, 
d©a
, 
qu®™y
);

1621 
	`¡bi__’d_wr™e_fe
(&
s
);

1622  
r
;

1625 
	}
}

	@include/stb_rect_pack.h

66 #iâdeà
STB_INCLUDE_STB_RECT_PACK_H


67 
	#STB_INCLUDE_STB_RECT_PACK_H


	)

69 
	#STB_RECT_PACK_VERSION
 1

	)

71 #ifdeà
STBRP_STATIC


72 
	#STBRP_DEF
 

	)

74 
	#STBRP_DEF
 

	)

77 #ifdeà
__ılu¥lus


81 
¡b½_cÚ‹xt
 
	t¡b½_cÚ‹xt
;

82 
¡b½_node
 
	t¡b½_node
;

83 
¡b½_»ù
 
	t¡b½_»ù
;

85 
	t¡b½_coÜd
;

87 
	#STBRP__MAXVAL
 0x7fffffff

	)

90 
STBRP_DEF
 
¡b½_·ck_»ùs
 (
¡b½_cÚ‹xt
 *
cÚ‹xt
, 
¡b½_»ù
 *
»ùs
, 
num_»ùs
);

115 
	s¡b½_»ù


118 
id
;

121 
¡b½_coÜd
 
w
, 
h
;

124 
¡b½_coÜd
 
x
, 
y
;

125 
was_·cked
;

130 
STBRP_DEF
 
¡b½_š™_rg‘
 (
¡b½_cÚ‹xt
 *
cÚ‹xt
, 
width
, 
height
, 
¡b½_node
 *
nodes
, 
num_nodes
);

151 
STBRP_DEF
 
¡b½_£tup_®low_out_of_mem
 (
¡b½_cÚ‹xt
 *
cÚ‹xt
, 
®low_out_of_mem
);

157 
STBRP_DEF
 
¡b½_£tup_heuri¡ic
 (
¡b½_cÚ‹xt
 *
cÚ‹xt
, 
heuri¡ic
);

164 
STBRP_HEURISTIC_Skylše_deçuÉ
=0,

165 
STBRP_HEURISTIC_Skylše_BL_sÜtHeight
 = 
STBRP_HEURISTIC_Skylše_deçuÉ
,

166 
STBRP_HEURISTIC_Skylše_BF_sÜtHeight


175 
	s¡b½_node


177 
¡b½_coÜd
 
x
,
y
;

178 
¡b½_node
 *
Ãxt
;

181 
	s¡b½_cÚ‹xt


183 
width
;

184 
height
;

185 
®ign
;

186 
š™_mode
;

187 
heuri¡ic
;

188 
num_nodes
;

189 
¡b½_node
 *
aùive_h—d
;

190 
¡b½_node
 *
ä“_h—d
;

191 
¡b½_node
 
exŒa
[2];

194 #ifdeà
__ılu¥lus


205 #ifdeà
STB_RECT_PACK_IMPLEMENTATION


206 #iâdeà
STBRP_SORT


207 
	~<¡dlib.h
>

208 
	#STBRP_SORT
 
qsÜt


	)

211 #iâdeà
STBRP_ASSERT


212 
	~<as£¹.h
>

213 
	#STBRP_ASSERT
 
as£¹


	)

216 #ifdeà
_MSC_VER


217 
	#STBRP__NOTUSED
(
v
è()(v)

	)

218 
	#STBRP__CDECL
 
__cdeş


	)

220 
	#STBRP__NOTUSED
(
v
è()(v)

	)

221 
	#STBRP__CDECL


	)

226 
STBRP__INIT_skylše
 = 1

229 
STBRP_DEF
 
	$¡b½_£tup_heuri¡ic
(
¡b½_cÚ‹xt
 *
cÚ‹xt
, 
heuri¡ic
)

231 
cÚ‹xt
->
š™_mode
) {

232 
STBRP__INIT_skylše
:

233 
	`STBRP_ASSERT
(
heuri¡ic
 =ğ
STBRP_HEURISTIC_Skylše_BL_sÜtHeight
 || heuri¡iø=ğ
STBRP_HEURISTIC_Skylše_BF_sÜtHeight
);

234 
cÚ‹xt
->
heuri¡ic
 = heuristic;

237 
	`STBRP_ASSERT
(0);

239 
	}
}

241 
STBRP_DEF
 
	$¡b½_£tup_®low_out_of_mem
(
¡b½_cÚ‹xt
 *
cÚ‹xt
, 
®low_out_of_mem
)

243 ià(
®low_out_of_mem
)

248 
cÚ‹xt
->
®ign
 = 1;

257 
cÚ‹xt
->
®ign
 = (cÚ‹xt->
width
 + cÚ‹xt->
num_nodes
-1) / context->num_nodes;

259 
	}
}

261 
STBRP_DEF
 
	$¡b½_š™_rg‘
(
¡b½_cÚ‹xt
 *
cÚ‹xt
, 
width
, 
height
, 
¡b½_node
 *
nodes
, 
num_nodes
)

263 
i
;

265 
i
=0; i < 
num_nodes
-1; ++i)

266 
nodes
[
i
].
Ãxt
 = &nodes[i+1];

267 
nodes
[
i
].
Ãxt
 = 
NULL
;

268 
cÚ‹xt
->
š™_mode
 = 
STBRP__INIT_skylše
;

269 
cÚ‹xt
->
heuri¡ic
 = 
STBRP_HEURISTIC_Skylše_deçuÉ
;

270 
cÚ‹xt
->
ä“_h—d
 = &
nodes
[0];

271 
cÚ‹xt
->
aùive_h—d
 = &cÚ‹xt->
exŒa
[0];

272 
cÚ‹xt
->
width
 = width;

273 
cÚ‹xt
->
height
 = height;

274 
cÚ‹xt
->
num_nodes
 =‚um_nodes;

275 
	`¡b½_£tup_®low_out_of_mem
(
cÚ‹xt
, 0);

278 
cÚ‹xt
->
exŒa
[0].
x
 = 0;

279 
cÚ‹xt
->
exŒa
[0].
y
 = 0;

280 
cÚ‹xt
->
exŒa
[0].
Ãxt
 = &context->extra[1];

281 
cÚ‹xt
->
exŒa
[1].
x
 = (
¡b½_coÜd
è
width
;

282 
cÚ‹xt
->
exŒa
[1].
y
 = (1<<30);

283 
cÚ‹xt
->
exŒa
[1].
Ãxt
 = 
NULL
;

284 
	}
}

287 
	$¡b½__skylše_fšd_mš_y
(
¡b½_cÚ‹xt
 *
c
, 
¡b½_node
 *
fœ¡
, 
x0
, 
width
, *
pwa¡e
)

289 
¡b½_node
 *
node
 = 
fœ¡
;

290 
x1
 = 
x0
 + 
width
;

291 
mš_y
, 
vis™ed_width
, 
wa¡e_¬—
;

293 
	`STBRP__NOTUSED
(
c
);

295 
	`STBRP_ASSERT
(
fœ¡
->
x
 <ğ
x0
);

299 
node
->
Ãxt
->
x
 <ğ
x0
)

300 ++
node
;

302 
	`STBRP_ASSERT
(
node
->
Ãxt
->
x
 > 
x0
);

305 
	`STBRP_ASSERT
(
node
->
x
 <ğ
x0
);

307 
mš_y
 = 0;

308 
wa¡e_¬—
 = 0;

309 
vis™ed_width
 = 0;

310 
node
->
x
 < 
x1
) {

311 ià(
node
->
y
 > 
mš_y
) {

315 
wa¡e_¬—
 +ğ
vis™ed_width
 * (
node
->
y
 - 
mš_y
);

316 
mš_y
 = 
node
->
y
;

318 ià(
node
->
x
 < 
x0
)

319 
vis™ed_width
 +ğ
node
->
Ãxt
->
x
 - 
x0
;

321 
vis™ed_width
 +ğ
node
->
Ãxt
->
x
 -‚ode->x;

324 
und”_width
 = 
node
->
Ãxt
->
x
 -‚ode->x;

325 ià(
und”_width
 + 
vis™ed_width
 > 
width
)

326 
und”_width
 = 
width
 - 
vis™ed_width
;

327 
wa¡e_¬—
 +ğ
und”_width
 * (
mš_y
 - 
node
->
y
);

328 
vis™ed_width
 +ğ
und”_width
;

330 
node
 =‚ode->
Ãxt
;

333 *
pwa¡e
 = 
wa¡e_¬—
;

334  
mš_y
;

335 
	}
}

339 
	mx
,
	my
;

340 
¡b½_node
 **
	m´ev_lšk
;

341 } 
	t¡b½__fšd»suÉ
;

343 
¡b½__fšd»suÉ
 
	$¡b½__skylše_fšd_be¡_pos
(
¡b½_cÚ‹xt
 *
c
, 
width
, 
height
)

345 
be¡_wa¡e
 = (1<<30), 
be¡_x
, 
be¡_y
 = (1 << 30);

346 
¡b½__fšd»suÉ
 
ä
;

347 
¡b½_node
 **
´ev
, *
node
, *

, **
be¡
 = 
NULL
;

350 
width
 = (width + 
c
->
®ign
 - 1);

351 
width
 -ğwidth % 
c
->
®ign
;

352 
	`STBRP_ASSERT
(
width
 % 
c
->
®ign
 == 0);

355 ià(
width
 > 
c
->width || 
height
 > c->height) {

356 
ä
.
´ev_lšk
 = 
NULL
;

357 
ä
.
x
 = fr.
y
 = 0;

358  
ä
;

361 
node
 = 
c
->
aùive_h—d
;

362 
´ev
 = &
c
->
aùive_h—d
;

363 
node
->
x
 + 
width
 <ğ
c
->width) {

364 
y
,
wa¡e
;

365 
y
 = 
	`¡b½__skylše_fšd_mš_y
(
c
, 
node
,‚ode->
x
, 
width
, &
wa¡e
);

366 ià(
c
->
heuri¡ic
 =ğ
STBRP_HEURISTIC_Skylše_BL_sÜtHeight
) {

368 ià(
y
 < 
be¡_y
) {

369 
be¡_y
 = 
y
;

370 
be¡
 = 
´ev
;

374 ià(
y
 + 
height
 <ğ
c
->height) {

376 ià(
y
 < 
be¡_y
 || (y =ğbe¡_y && 
wa¡e
 < 
be¡_wa¡e
)) {

377 
be¡_y
 = 
y
;

378 
be¡_wa¡e
 = 
wa¡e
;

379 
be¡
 = 
´ev
;

383 
´ev
 = &
node
->
Ãxt
;

384 
node
 =‚ode->
Ãxt
;

387 
be¡_x
 = (
be¡
 =ğ
NULL
è? 0 : (*be¡)->
x
;

406 ià(
c
->
heuri¡ic
 =ğ
STBRP_HEURISTIC_Skylše_BF_sÜtHeight
) {

407 

 = 
c
->
aùive_h—d
;

408 
node
 = 
c
->
aùive_h—d
;

409 
´ev
 = &
c
->
aùive_h—d
;

411 

->
x
 < 
width
)

412 

 =a->
Ãxt
;

413 

) {

414 
xpos
 = 

->
x
 - 
width
;

415 
y
,
wa¡e
;

416 
	`STBRP_ASSERT
(
xpos
 >= 0);

418 
node
->
Ãxt
->
x
 <ğ
xpos
) {

419 
´ev
 = &
node
->
Ãxt
;

420 
node
 =‚ode->
Ãxt
;

422 
	`STBRP_ASSERT
(
node
->
Ãxt
->
x
 > 
xpos
 &&‚ode->x <= xpos);

423 
y
 = 
	`¡b½__skylše_fšd_mš_y
(
c
, 
node
, 
xpos
, 
width
, &
wa¡e
);

424 ià(
y
 + 
height
 <ğ
c
->height) {

425 ià(
y
 <ğ
be¡_y
) {

426 ià(
y
 < 
be¡_y
 || 
wa¡e
 < 
be¡_wa¡e
 || (wa¡e==be¡_wa¡&& 
xpos
 < 
be¡_x
)) {

427 
be¡_x
 = 
xpos
;

428 
	`STBRP_ASSERT
(
y
 <ğ
be¡_y
);

429 
be¡_y
 = 
y
;

430 
be¡_wa¡e
 = 
wa¡e
;

431 
be¡
 = 
´ev
;

435 

 =a->
Ãxt
;

439 
ä
.
´ev_lšk
 = 
be¡
;

440 
ä
.
x
 = 
be¡_x
;

441 
ä
.
y
 = 
be¡_y
;

442  
ä
;

443 
	}
}

445 
¡b½__fšd»suÉ
 
	$¡b½__skylše_·ck_»ùªgË
(
¡b½_cÚ‹xt
 *
cÚ‹xt
, 
width
, 
height
)

448 
¡b½__fšd»suÉ
 
»s
 = 
	`¡b½__skylše_fšd_be¡_pos
(
cÚ‹xt
, 
width
, 
height
);

449 
¡b½_node
 *
node
, *
cur
;

455 ià(
»s
.
´ev_lšk
 =ğ
NULL
 ||„es.
y
 + 
height
 > 
cÚ‹xt
->heighˆ|| cÚ‹xt->
ä“_h—d
 == NULL) {

456 
»s
.
´ev_lšk
 = 
NULL
;

457  
»s
;

461 
node
 = 
cÚ‹xt
->
ä“_h—d
;

462 
node
->
x
 = (
¡b½_coÜd
è
»s
.x;

463 
node
->
y
 = (
¡b½_coÜd
è(
»s
.y + 
height
);

465 
cÚ‹xt
->
ä“_h—d
 = 
node
->
Ãxt
;

471 
cur
 = *
»s
.
´ev_lšk
;

472 ià(
cur
->
x
 < 
»s
.x) {

474 
¡b½_node
 *
Ãxt
 = 
cur
->next;

475 
cur
->
Ãxt
 = 
node
;

476 
cur
 = 
Ãxt
;

478 *
»s
.
´ev_lšk
 = 
node
;

483 
cur
->
Ãxt
 && cur->Ãxt->
x
 <ğ
»s
.x + 
width
) {

484 
¡b½_node
 *
Ãxt
 = 
cur
->next;

486 
cur
->
Ãxt
 = 
cÚ‹xt
->
ä“_h—d
;

487 
cÚ‹xt
->
ä“_h—d
 = 
cur
;

488 
cur
 = 
Ãxt
;

492 
node
->
Ãxt
 = 
cur
;

494 ià(
cur
->
x
 < 
»s
.x + 
width
)

495 
cur
->
x
 = (
¡b½_coÜd
è(
»s
.x + 
width
);

497 #ifdeà
_DEBUG


498 
cur
 = 
cÚ‹xt
->
aùive_h—d
;

499 
cur
->
x
 < 
cÚ‹xt
->
width
) {

500 
	`STBRP_ASSERT
(
cur
->
x
 < cur->
Ãxt
->x);

501 
cur
 = cur->
Ãxt
;

503 
	`STBRP_ASSERT
(
cur
->
Ãxt
 =ğ
NULL
);

506 
couÁ
=0;

507 
cur
 = 
cÚ‹xt
->
aùive_h—d
;

508 
cur
) {

509 
cur
 = cur->
Ãxt
;

510 ++
couÁ
;

512 
cur
 = 
cÚ‹xt
->
ä“_h—d
;

513 
cur
) {

514 
cur
 = cur->
Ãxt
;

515 ++
couÁ
;

517 
	`STBRP_ASSERT
(
couÁ
 =ğ
cÚ‹xt
->
num_nodes
+2);

521  
»s
;

522 
	}
}

524 
STBRP__CDECL
 
	$»ù_height_com·»
(cÚ¡ *
a
, cÚ¡ *
b
)

526 cÚ¡ 
¡b½_»ù
 *
p
 = (cÚ¡ stb½_»ù *è
a
;

527 cÚ¡ 
¡b½_»ù
 *
q
 = (cÚ¡ stb½_»ù *è
b
;

528 ià(
p
->
h
 > 
q
->h)

530 ià(
p
->
h
 < 
q
->h)

532  (
p
->
w
 > 
q
->w) ? -1 : (p->w < q->w);

533 
	}
}

535 
STBRP__CDECL
 
	$»ù_Üigš®_Üd”
(cÚ¡ *
a
, cÚ¡ *
b
)

537 cÚ¡ 
¡b½_»ù
 *
p
 = (cÚ¡ stb½_»ù *è
a
;

538 cÚ¡ 
¡b½_»ù
 *
q
 = (cÚ¡ stb½_»ù *è
b
;

539  (
p
->
was_·cked
 < 
q
->was_packed) ? -1 : (p->was_packed > q->was_packed);

540 
	}
}

542 
STBRP_DEF
 
	$¡b½_·ck_»ùs
(
¡b½_cÚ‹xt
 *
cÚ‹xt
, 
¡b½_»ù
 *
»ùs
, 
num_»ùs
)

544 
i
, 
®l_»ùs_·cked
 = 1;

547 
i
=0; i < 
num_»ùs
; ++i) {

548 
»ùs
[
i
].
was_·cked
 = i;

552 
	`STBRP_SORT
(
»ùs
, 
num_»ùs
, Ôeùs[0]), 
»ù_height_com·»
);

554 
i
=0; i < 
num_»ùs
; ++i) {

555 ià(
»ùs
[
i
].
w
 =ğ0 ||„eùs[i].
h
 == 0) {

556 
»ùs
[
i
].
x
 =„eùs[i].
y
 = 0;

558 
¡b½__fšd»suÉ
 
ä
 = 
	`¡b½__skylše_·ck_»ùªgË
(
cÚ‹xt
, 
»ùs
[
i
].
w
,„eùs[i].
h
);

559 ià(
ä
.
´ev_lšk
) {

560 
»ùs
[
i
].
x
 = (
¡b½_coÜd
è
ä
.x;

561 
»ùs
[
i
].
y
 = (
¡b½_coÜd
è
ä
.y;

563 
»ùs
[
i
].
x
 =„eùs[i].
y
 = 
STBRP__MAXVAL
;

569 
	`STBRP_SORT
(
»ùs
, 
num_»ùs
, Ôeùs[0]), 
»ù_Üigš®_Üd”
);

572 
i
=0; i < 
num_»ùs
; ++i) {

573 
»ùs
[
i
].
was_·cked
 = !Ôeùs[i].
x
 =ğ
STBRP__MAXVAL
 &&„eùs[i].
y
 == STBRP__MAXVAL);

574 ià(!
»ùs
[
i
].
was_·cked
)

575 
®l_»ùs_·cked
 = 0;

579  
®l_»ùs_·cked
;

580 
	}
}

	@include/stb_truetype.h

278 
	#STB_TRUETYPE_IMPLEMENTATION


279 
	~"¡b_Œu‘y³.h
"

	)

281 
	g‰f_bufãr
[1<<20];

282 
	g‹mp_b™m­
[512*512];

284 
¡b‰_bakedch¬
 
	gcd©a
[96];

285 
GLušt
 
	gáex
;

287 
	$my_¡b‰_š™fÚt
()

289 
	`ä—d
(
‰f_bufãr
, 1, 1<<20, 
	`fİ’
("c:/windows/fonts/times.ttf", "rb"));

290 
	`¡b‰_BakeFÚtB™m­
(
‰f_bufãr
,0, 32.0, 
‹mp_b™m­
,512,512, 32,96, 
cd©a
);

292 
	`glG’Textu»s
(1, &
áex
);

293 
	`glBšdTextu»
(
GL_TEXTURE_2D
, 
áex
);

294 
	`glTexImage2D
(
GL_TEXTURE_2D
, 0, 
GL_ALPHA
, 512,512, 0, GL_ALPHA, 
GL_UNSIGNED_BYTE
, 
‹mp_b™m­
);

296 
	`glTexP¬am‘”i
(
GL_TEXTURE_2D
, 
GL_TEXTURE_MIN_FILTER
, 
GL_LINEAR
);

297 
	}
}

299 
	$my_¡b‰_´št
(
x
, 
y
, *
‹xt
)

302 
	`glEÇbË
(
GL_BLEND
);

303 
	`glBËndFunc
(
GL_SRC_ALPHA
, 
GL_ONE_MINUS_SRC_ALPHA
);

304 
	`glEÇbË
(
GL_TEXTURE_2D
);

305 
	`glBšdTextu»
(
GL_TEXTURE_2D
, 
áex
);

306 
	`glBegš
(
GL_QUADS
);

307 *
‹xt
) {

308 ià(*
‹xt
 >= 32 && *text < 128) {

309 
¡b‰_®igÃd_quad
 
q
;

310 
	`¡b‰_G‘BakedQuad
(
cd©a
, 512,512, *
‹xt
-32, &
x
,&
y
,&
q
,1);

311 
	`glTexCoÜd2f
(
q
.
s0
,q.
t0
); 
	`glV”‹x2f
(q.
x0
,q.
y0
);

312 
	`glTexCoÜd2f
(
q
.
s1
,q.
t0
); 
	`glV”‹x2f
(q.
x1
,q.
y0
);

313 
	`glTexCoÜd2f
(
q
.
s1
,q.
t1
); 
	`glV”‹x2f
(q.
x1
,q.
y1
);

314 
	`glTexCoÜd2f
(
q
.
s0
,q.
t1
); 
	`glV”‹x2f
(q.
x0
,q.
y1
);

316 ++
‹xt
;

318 
	`glEnd
();

319 
	}
}

328 
	~<¡dio.h
>

329 
	#STB_TRUETYPE_IMPLEMENTATION


330 
	~"¡b_Œu‘y³.h
"

	)

332 
	g‰f_bufãr
[1<<25];

334 
	$maš
(
¬gc
, **
¬gv
)

336 
¡b‰_fÚtšfo
 
fÚt
;

337 *
b™m­
;

338 
w
,
h
,
i
,
j
,
c
 = (
¬gc
 > 1 ? 
	`©oi
(
¬gv
[1]è: 'a'), 
s
 = (argc > 2 ?‡toi(argv[2]) : 20);

340 
	`ä—d
(
‰f_bufãr
, 1, 1<<25, 
	`fİ’
(
¬gc
 > 3 ? 
¬gv
[3] : "c:/windows/fonts/arialbd.ttf", "rb"));

342 
	`¡b‰_In™FÚt
(&
fÚt
, 
‰f_bufãr
, 
	`¡b‰_G‘FÚtOff£tFÜIndex
(ttf_buffer,0));

343 
b™m­
 = 
	`¡b‰_G‘Cod•oštB™m­
(&
fÚt
, 0,
	`¡b‰_SÿËFÜPix–Height
(&fÚt, 
s
), 
c
, &
w
, &
h
, 0,0);

345 
j
=0; j < 
h
; ++j) {

346 
i
=0; i < 
w
; ++i)

347 
	`putch¬
(" .:ioVM@"[
b™m­
[
j
*
w
+
i
]>>5]);

348 
	`putch¬
('\n');

351 
	}
}

372 
	gbufãr
[24<<20];

373 
	gsü“n
[20][79];

375 
	$maš
(
¬g
, **
¬gv
)

377 
¡b‰_fÚtšfo
 
fÚt
;

378 
i
,
j
,
asûÁ
,
ba£lše
,
ch
=0;

379 
sÿË
, 
xpos
=2;

380 *
‹xt
 = "Heljo World!";

382 
	`ä—d
(
bufãr
, 1, 1000000, 
	`fİ’
("c:/windows/fonts/arialbd.ttf", "rb"));

383 
	`¡b‰_In™FÚt
(&
fÚt
, 
bufãr
, 0);

385 
sÿË
 = 
	`¡b‰_SÿËFÜPix–Height
(&
fÚt
, 15);

386 
	`¡b‰_G‘FÚtVM‘rics
(&
fÚt
, &
asûÁ
,0,0);

387 
ba£lše
 = (è(
asûÁ
*
sÿË
);

389 
‹xt
[
ch
]) {

390 
advªû
,
lsb
,
x0
,
y0
,
x1
,
y1
;

391 
x_shiá
 = 
xpos
 - (è
	`æoÜ
(xpos);

392 
	`¡b‰_G‘Cod•oštHM‘rics
(&
fÚt
, 
‹xt
[
ch
], &
advªû
, &
lsb
);

393 
	`¡b‰_G‘Cod•oštB™m­BoxSubpix–
(&
fÚt
, 
‹xt
[
ch
], 
sÿË
,sÿË,
x_shiá
,0, &
x0
,&
y0
,&
x1
,&
y1
);

394 
	`¡b‰_MakeCod•oštB™m­Subpix–
(&
fÚt
, &
sü“n
[
ba£lše
 + 
y0
][(è
xpos
 + 
x0
], 
x1
-x0,
y1
-y0, 79, 
sÿË
,sÿË,
x_shiá
,0, 
‹xt
[
ch
]);

399 
xpos
 +ğ(
advªû
 * 
sÿË
);

400 ià(
‹xt
[
ch
+1])

401 
xpos
 +ğ
sÿË
*
	`¡b‰_G‘Cod•oštK”nAdvªû
(&
fÚt
, 
‹xt
[
ch
],text[ch+1]);

402 ++
ch
;

405 
j
=0; j < 20; ++j) {

406 
i
=0; i < 78; ++i)

407 
	`putch¬
(" .:ioVM@"[
sü“n
[
j
][
i
]>>5]);

408 
	`putch¬
('\n');

412 
	}
}

425 #ifdeà
STB_TRUETYPE_IMPLEMENTATION


427 #iâdeà
¡b‰_ušt8


428 
	t¡b‰_ušt8
;

429 sigÃd 
	t¡b‰_št8
;

430 
	t¡b‰_ušt16
;

431 sigÃd 
	t¡b‰_št16
;

432 
	t¡b‰_ušt32
;

433 sigÃd 
	t¡b‰_št32
;

436 
	t¡b‰__check_size32
[(
¡b‰_št32
)==4 ? 1 : -1];

437 
	t¡b‰__check_size16
[(
¡b‰_št16
)==2 ? 1 : -1];

440 #iâdeà
STBTT_iæoÜ


441 
	~<m©h.h
>

442 
	#STBTT_iæoÜ
(
x
è((è
	`æoÜ
(x))

	)

443 
	#STBTT_iû
(
x
è((è
	`û
(x))

	)

446 #iâdeà
STBTT_sq¹


447 
	~<m©h.h
>

448 
	#STBTT_sq¹
(
x
è
	`sq¹
(x)

	)

449 
	#STBTT_pow
(
x
,
y
è
	`pow
(x,y)

	)

452 #iâdeà
STBTT_fmod


453 
	~<m©h.h
>

454 
	#STBTT_fmod
(
x
,
y
è
	`fmod
(x,y)

	)

457 #iâdeà
STBTT_cos


458 
	~<m©h.h
>

459 
	#STBTT_cos
(
x
è
	`cos
(x)

	)

460 
	#STBTT_acos
(
x
è
	`acos
(x)

	)

463 #iâdeà
STBTT_çbs


464 
	~<m©h.h
>

465 
	#STBTT_çbs
(
x
è
	`çbs
(x)

	)

469 #iâdeà
STBTT_m®loc


470 
	~<¡dlib.h
>

471 
	#STBTT_m®loc
(
x
,
u
è(()(u),
	`m®loc
(x))

	)

472 
	#STBTT_ä“
(
x
,
u
è(()(u),
	`ä“
(x))

	)

475 #iâdeà
STBTT_as£¹


476 
	~<as£¹.h
>

477 
	#STBTT_as£¹
(
x
è
	`as£¹
(x)

	)

480 #iâdeà
STBTT_¡¾’


481 
	~<¡ršg.h
>

482 
	#STBTT_¡¾’
(
x
è
	`¡¾’
(x)

	)

485 #iâdeà
STBTT_memıy


486 
	~<¡ršg.h
>

487 
	#STBTT_memıy
 
memıy


	)

488 
	#STBTT_mem£t
 
mem£t


	)

499 #iâdeà
__STB_INCLUDE_STB_TRUETYPE_H__


500 
	#__STB_INCLUDE_STB_TRUETYPE_H__


	)

502 #ifdeà
STBTT_STATIC


503 
	#STBTT_DEF
 

	)

505 
	#STBTT_DEF
 

	)

508 #ifdeà
__ılu¥lus


515 *
d©a
;

516 
cursÜ
;

517 
size
;

518 } 
	t¡b‰__buf
;

529 
x0
,
y0
,
x1
,
y1
;

530 
xoff
,
yoff
,
xadvªû
;

531 } 
	t¡b‰_bakedch¬
;

533 
STBTT_DEF
 
¡b‰_BakeFÚtB™m­
(cÚ¡ *
d©a
, 
off£t
,

534 
pix–_height
,

535 *
pix–s
, 
pw
, 
ph
,

536 
fœ¡_ch¬
, 
num_ch¬s
,

537 
¡b‰_bakedch¬
 *
ch¬d©a
);

545 
x0
,
y0
,
s0
,
t0
;

546 
x1
,
y1
,
s1
,
t1
;

547 } 
	t¡b‰_®igÃd_quad
;

549 
STBTT_DEF
 
¡b‰_G‘BakedQuad
(cÚ¡ 
¡b‰_bakedch¬
 *
ch¬d©a
, 
pw
, 
ph
,

550 
ch¬_šdex
,

551 *
xpos
, *
ypos
,

552 
¡b‰_®igÃd_quad
 *
q
,

553 
İ’gl_fÌuË
);

564 
STBTT_DEF
 
¡b‰_G‘SÿËdFÚtVM‘rics
(cÚ¡ *
fÚtd©a
, 
šdex
, 
size
, *
asûÁ
, *
desûÁ
, *
lšeG­
);

577 
x0
,
y0
,
x1
,
y1
;

578 
xoff
,
yoff
,
xadvªû
;

579 
xoff2
,
yoff2
;

580 } 
	t¡b‰_·ckedch¬
;

582 
¡b‰_·ck_cÚ‹xt
 
	t¡b‰_·ck_cÚ‹xt
;

583 
¡b‰_fÚtšfo
 
	t¡b‰_fÚtšfo
;

584 #iâdeà
STB_RECT_PACK_VERSION


585 
¡b½_»ù
 
	t¡b½_»ù
;

588 
STBTT_DEF
 
¡b‰_PackBegš
(
¡b‰_·ck_cÚ‹xt
 *
¥c
, *
pix–s
, 
width
, 
height
, 
¡ride_š_by‹s
, 
·ddšg
, *
®loc_cÚ‹xt
);

599 
STBTT_DEF
 
¡b‰_PackEnd
 (
¡b‰_·ck_cÚ‹xt
 *
¥c
);

602 
	#STBTT_POINT_SIZE
(
x
è(-(x))

	)

604 
STBTT_DEF
 
¡b‰_PackFÚtRªge
(
¡b‰_·ck_cÚ‹xt
 *
¥c
, cÚ¡ *
fÚtd©a
, 
fÚt_šdex
, 
fÚt_size
,

605 
fœ¡_unicode_ch¬_š_¿nge
, 
num_ch¬s_š_¿nge
, 
¡b‰_·ckedch¬
 *
ch¬d©a_fÜ_¿nge
);

621 
fÚt_size
;

622 
fœ¡_unicode_cod•ošt_š_¿nge
;

623 *
¬¿y_of_unicode_cod•ošts
;

624 
num_ch¬s
;

625 
¡b‰_·ckedch¬
 *
ch¬d©a_fÜ_¿nge
;

626 
h_ov”§m¶e
, 
v_ov”§m¶e
;

627 } 
	t¡b‰_·ck_¿nge
;

629 
STBTT_DEF
 
¡b‰_PackFÚtRªges
(
¡b‰_·ck_cÚ‹xt
 *
¥c
, cÚ¡ *
fÚtd©a
, 
fÚt_šdex
, 
¡b‰_·ck_¿nge
 *
¿nges
, 
num_¿nges
);

635 
STBTT_DEF
 
¡b‰_PackS‘Ov”§m¶šg
(
¡b‰_·ck_cÚ‹xt
 *
¥c
, 
h_ov”§m¶e
, 
v_ov”§m¶e
);

651 
STBTT_DEF
 
¡b‰_PackS‘SkMissšgCod•ošts
(
¡b‰_·ck_cÚ‹xt
 *
¥c
, 
sk
);

657 
STBTT_DEF
 
¡b‰_G‘PackedQuad
(cÚ¡ 
¡b‰_·ckedch¬
 *
ch¬d©a
, 
pw
, 
ph
,

658 
ch¬_šdex
,

659 *
xpos
, *
ypos
,

660 
¡b‰_®igÃd_quad
 *
q
,

661 
®ign_to_š‹g”
);

663 
STBTT_DEF
 
¡b‰_PackFÚtRªgesG©h”Reùs
(
¡b‰_·ck_cÚ‹xt
 *
¥c
, cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
¡b‰_·ck_¿nge
 *
¿nges
, 
num_¿nges
, 
¡b½_»ù
 *
»ùs
);

664 
STBTT_DEF
 
¡b‰_PackFÚtRªgesPackReùs
(
¡b‰_·ck_cÚ‹xt
 *
¥c
, 
¡b½_»ù
 *
»ùs
, 
num_»ùs
);

665 
STBTT_DEF
 
¡b‰_PackFÚtRªgesR’d”IÁoReùs
(
¡b‰_·ck_cÚ‹xt
 *
¥c
, cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
¡b‰_·ck_¿nge
 *
¿nges
, 
num_¿nges
, 
¡b½_»ù
 *
»ùs
);

678 
	s¡b‰_·ck_cÚ‹xt
 {

679 *
u£r_®loÿtÜ_cÚ‹xt
;

680 *
·ck_šfo
;

681 
width
;

682 
height
;

683 
¡ride_š_by‹s
;

684 
·ddšg
;

685 
sk_missšg
;

686 
h_ov”§m¶e
, 
v_ov”§m¶e
;

687 *
pix–s
;

688 *
nodes
;

697 
STBTT_DEF
 
¡b‰_G‘Numb”OfFÚts
(cÚ¡ *
d©a
);

704 
STBTT_DEF
 
¡b‰_G‘FÚtOff£tFÜIndex
(cÚ¡ *
d©a
, 
šdex
);

713 
	s¡b‰_fÚtšfo


715 * 
u£rd©a
;

716 * 
d©a
;

717 
fÚt¡¬t
;

719 
numGlyphs
;

721 
loÿ
,
h—d
,
glyf
,
hh—
,
hmtx
,
k”n
,
gpos
,
svg
;

722 
šdex_m­
;

723 
šdexToLocFÜm©
;

725 
¡b‰__buf
 
cff
;

726 
¡b‰__buf
 
ch¬¡ršgs
;

727 
¡b‰__buf
 
gsubrs
;

728 
¡b‰__buf
 
subrs
;

729 
¡b‰__buf
 
fÚtdiùs
;

730 
¡b‰__buf
 
fd£Ëù
;

733 
STBTT_DEF
 
¡b‰_In™FÚt
(
¡b‰_fÚtšfo
 *
šfo
, cÚ¡ *
d©a
, 
off£t
);

745 
STBTT_DEF
 
¡b‰_FšdGlyphIndex
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
unicode_cod•ošt
);

758 
STBTT_DEF
 
¡b‰_SÿËFÜPix–Height
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
pix–s
);

766 
STBTT_DEF
 
¡b‰_SÿËFÜM­pšgEmToPix–s
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
pix–s
);

771 
STBTT_DEF
 
¡b‰_G‘FÚtVM‘rics
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, *
asûÁ
, *
desûÁ
, *
lšeG­
);

779 
STBTT_DEF
 
¡b‰_G‘FÚtVM‘ricsOS2
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, *
typoAsûÁ
, *
typoDesûÁ
, *
typoLšeG­
);

785 
STBTT_DEF
 
¡b‰_G‘FÚtBoundšgBox
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, *
x0
, *
y0
, *
x1
, *
y1
);

788 
STBTT_DEF
 
¡b‰_G‘Cod•oštHM‘rics
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
cod•ošt
, *
advªûWidth
, *
ËáSideB—ršg
);

793 
STBTT_DEF
 
¡b‰_G‘Cod•oštK”nAdvªû
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
ch1
, 
ch2
);

796 
STBTT_DEF
 
¡b‰_G‘Cod•oštBox
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
cod•ošt
, *
x0
, *
y0
, *
x1
, *
y1
);

799 
STBTT_DEF
 
¡b‰_G‘GlyphHM‘rics
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
glyph_šdex
, *
advªûWidth
, *
ËáSideB—ršg
);

800 
STBTT_DEF
 
¡b‰_G‘GlyphK”nAdvªû
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
glyph1
, 
glyph2
);

801 
STBTT_DEF
 
¡b‰_G‘GlyphBox
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
glyph_šdex
, *
x0
, *
y0
, *
x1
, *
y1
);

804 
	s¡b‰_k”nšg’Œy


806 
glyph1
;

807 
glyph2
;

808 
advªû
;

809 } 
	t¡b‰_k”nšg’Œy
;

811 
STBTT_DEF
 
¡b‰_G‘K”nšgTabËL’gth
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
);

812 
STBTT_DEF
 
¡b‰_G‘K”nšgTabË
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
¡b‰_k”nšg’Œy
* 
bË
, 
bË_Ëngth
);

823 #iâdeà
STBTT_vmove


825 
STBTT_vmove
=1,

826 
STBTT_vlše
,

827 
STBTT_vcurve
,

828 
STBTT_vcubic


832 #iâdeà
¡b‰_v”‹x


834 
	#¡b‰_v”‹x_ty³
 

835 ¡ruù

	)

837 
¡b‰_v”‹x_ty³
 
x
,
y
,
cx
,
cy
,
cx1
,
cy1
;

838 
ty³
,
·ddšg
;

839 } 
	t¡b‰_v”‹x
;

842 
STBTT_DEF
 
¡b‰_IsGlyphEm±y
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
glyph_šdex
);

845 
STBTT_DEF
 
¡b‰_G‘Cod•oštSh­e
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
unicode_cod•ošt
, 
¡b‰_v”‹x
 **
v”tiûs
);

846 
STBTT_DEF
 
¡b‰_G‘GlyphSh­e
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
glyph_šdex
, 
¡b‰_v”‹x
 **
v”tiûs
);

857 
STBTT_DEF
 
¡b‰_F»eSh­e
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
¡b‰_v”‹x
 *
v”tiûs
);

860 
STBTT_DEF
 *
¡b‰_FšdSVGDoc
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
gl
);

861 
STBTT_DEF
 
¡b‰_G‘Cod•oštSVG
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
unicode_cod•ošt
, cÚ¡ **
svg
);

862 
STBTT_DEF
 
¡b‰_G‘GlyphSVG
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
gl
, cÚ¡ **
svg
);

871 
STBTT_DEF
 
¡b‰_F»eB™m­
(*
b™m­
, *
u£rd©a
);

874 
STBTT_DEF
 *
¡b‰_G‘Cod•oštB™m­
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
sÿË_x
, 
sÿË_y
, 
cod•ošt
, *
width
, *
height
, *
xoff
, *
yoff
);

883 
STBTT_DEF
 *
¡b‰_G‘Cod•oštB™m­Subpix–
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
sÿË_x
, 
sÿË_y
, 
shiá_x
, 
shiá_y
, 
cod•ošt
, *
width
, *
height
, *
xoff
, *
yoff
);

887 
STBTT_DEF
 
¡b‰_MakeCod•oštB™m­
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, *
ouut
, 
out_w
, 
out_h
, 
out_¡ride
, 
sÿË_x
, 
sÿË_y
, 
cod•ošt
);

893 
STBTT_DEF
 
¡b‰_MakeCod•oštB™m­Subpix–
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, *
ouut
, 
out_w
, 
out_h
, 
out_¡ride
, 
sÿË_x
, 
sÿË_y
, 
shiá_x
, 
shiá_y
, 
cod•ošt
);

897 
STBTT_DEF
 
¡b‰_MakeCod•oštB™m­Subpix–P»f‹r
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, *
ouut
, 
out_w
, 
out_h
, 
out_¡ride
, 
sÿË_x
, 
sÿË_y
, 
shiá_x
, 
shiá_y
, 
ov”§m¶e_x
, 
ov”§m¶e_y
, *
sub_x
, *
sub_y
, 
cod•ošt
);

901 
STBTT_DEF
 
¡b‰_G‘Cod•oštB™m­Box
(cÚ¡ 
¡b‰_fÚtšfo
 *
fÚt
, 
cod•ošt
, 
sÿË_x
, 
sÿË_y
, *
ix0
, *
iy0
, *
ix1
, *
iy1
);

908 
STBTT_DEF
 
¡b‰_G‘Cod•oštB™m­BoxSubpix–
(cÚ¡ 
¡b‰_fÚtšfo
 *
fÚt
, 
cod•ošt
, 
sÿË_x
, 
sÿË_y
, 
shiá_x
, 
shiá_y
, *
ix0
, *
iy0
, *
ix1
, *
iy1
);

914 
STBTT_DEF
 *
¡b‰_G‘GlyphB™m­
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
sÿË_x
, 
sÿË_y
, 
glyph
, *
width
, *
height
, *
xoff
, *
yoff
);

915 
STBTT_DEF
 *
¡b‰_G‘GlyphB™m­Subpix–
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
sÿË_x
, 
sÿË_y
, 
shiá_x
, 
shiá_y
, 
glyph
, *
width
, *
height
, *
xoff
, *
yoff
);

916 
STBTT_DEF
 
¡b‰_MakeGlyphB™m­
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, *
ouut
, 
out_w
, 
out_h
, 
out_¡ride
, 
sÿË_x
, 
sÿË_y
, 
glyph
);

917 
STBTT_DEF
 
¡b‰_MakeGlyphB™m­Subpix–
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, *
ouut
, 
out_w
, 
out_h
, 
out_¡ride
, 
sÿË_x
, 
sÿË_y
, 
shiá_x
, 
shiá_y
, 
glyph
);

918 
STBTT_DEF
 
¡b‰_MakeGlyphB™m­Subpix–P»f‹r
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, *
ouut
, 
out_w
, 
out_h
, 
out_¡ride
, 
sÿË_x
, 
sÿË_y
, 
shiá_x
, 
shiá_y
, 
ov”§m¶e_x
, 
ov”§m¶e_y
, *
sub_x
, *
sub_y
, 
glyph
);

919 
STBTT_DEF
 
¡b‰_G‘GlyphB™m­Box
(cÚ¡ 
¡b‰_fÚtšfo
 *
fÚt
, 
glyph
, 
sÿË_x
, 
sÿË_y
, *
ix0
, *
iy0
, *
ix1
, *
iy1
);

920 
STBTT_DEF
 
¡b‰_G‘GlyphB™m­BoxSubpix–
(cÚ¡ 
¡b‰_fÚtšfo
 *
fÚt
, 
glyph
, 
sÿË_x
, 
sÿË_y
,
shiá_x
, 
shiá_y
, *
ix0
, *
iy0
, *
ix1
, *
iy1
);

926 
w
,
h
,
¡ride
;

927 *
pix–s
;

928 } 
	t¡b‰__b™m­
;

931 
STBTT_DEF
 
¡b‰_Ra¡”ize
(
¡b‰__b™m­
 *
»suÉ
,

932 
æ©Ãss_š_pix–s
,

933 
¡b‰_v”‹x
 *
v”tiûs
,

934 
num_v”ts
,

935 
sÿË_x
, 
sÿË_y
,

936 
shiá_x
, 
shiá_y
,

937 
x_off
, 
y_off
,

938 
šv”t
,

939 *
u£rd©a
);

945 
STBTT_DEF
 
¡b‰_F»eSDF
(*
b™m­
, *
u£rd©a
);

948 
STBTT_DEF
 * 
¡b‰_G‘GlyphSDF
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
sÿË
, 
glyph
, 
·ddšg
, 
Úedge_v®ue
, 
pix–_di¡_sÿË
, *
width
, *
height
, *
xoff
, *
yoff
);

949 
STBTT_DEF
 * 
¡b‰_G‘Cod•oštSDF
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
sÿË
, 
cod•ošt
, 
·ddšg
, 
Úedge_v®ue
, 
pix–_di¡_sÿË
, *
width
, *
height
, *
xoff
, *
yoff
);

1021 
STBTT_DEF
 
¡b‰_FšdM©chšgFÚt
(cÚ¡ *
fÚtd©a
, cÚ¡ *
Çme
, 
æags
);

1026 
	#STBTT_MACSTYLE_DONTCARE
 0

	)

1027 
	#STBTT_MACSTYLE_BOLD
 1

	)

1028 
	#STBTT_MACSTYLE_ITALIC
 2

	)

1029 
	#STBTT_MACSTYLE_UNDERSCORE
 4

	)

1030 
	#STBTT_MACSTYLE_NONE
 8

1031 

	)

1032 
STBTT_DEF
 
¡b‰_Com·»UTF8toUTF16_big’dŸn
(cÚ¡ *
s1
, 
Ën1
, cÚ¡ *
s2
, 
Ën2
);

1036 
STBTT_DEF
 cÚ¡ *
¡b‰_G‘FÚtNameSŒšg
(cÚ¡ 
¡b‰_fÚtšfo
 *
fÚt
, *
Ëngth
, 
¶©fÜmID
, 
’codšgID
, 
ÏnguageID
, 
ÇmeID
);

1045 
STBTT_PLATFORM_ID_UNICODE
 =0,

1046 
STBTT_PLATFORM_ID_MAC
 =1,

1047 
STBTT_PLATFORM_ID_ISO
 =2,

1048 
STBTT_PLATFORM_ID_MICROSOFT
 =3

1052 
STBTT_UNICODE_EID_UNICODE_1_0
 =0,

1053 
STBTT_UNICODE_EID_UNICODE_1_1
 =1,

1054 
STBTT_UNICODE_EID_ISO_10646
 =2,

1055 
STBTT_UNICODE_EID_UNICODE_2_0_BMP
=3,

1056 
STBTT_UNICODE_EID_UNICODE_2_0_FULL
=4

1060 
STBTT_MS_EID_SYMBOL
 =0,

1061 
STBTT_MS_EID_UNICODE_BMP
 =1,

1062 
STBTT_MS_EID_SHIFTJIS
 =2,

1063 
STBTT_MS_EID_UNICODE_FULL
 =10

1067 
STBTT_MAC_EID_ROMAN
 =0, 
STBTT_MAC_EID_ARABIC
 =4,

1068 
STBTT_MAC_EID_JAPANESE
 =1, 
STBTT_MAC_EID_HEBREW
 =5,

1069 
STBTT_MAC_EID_CHINESE_TRAD
 =2, 
STBTT_MAC_EID_GREEK
 =6,

1070 
STBTT_MAC_EID_KOREAN
 =3, 
STBTT_MAC_EID_RUSSIAN
 =7

1075 
STBTT_MS_LANG_ENGLISH
 =0x0409, 
STBTT_MS_LANG_ITALIAN
 =0x0410,

1076 
STBTT_MS_LANG_CHINESE
 =0x0804, 
STBTT_MS_LANG_JAPANESE
 =0x0411,

1077 
STBTT_MS_LANG_DUTCH
 =0x0413, 
STBTT_MS_LANG_KOREAN
 =0x0412,

1078 
STBTT_MS_LANG_FRENCH
 =0x040c, 
STBTT_MS_LANG_RUSSIAN
 =0x0419,

1079 
STBTT_MS_LANG_GERMAN
 =0x0407, 
STBTT_MS_LANG_SPANISH
 =0x0409,

1080 
STBTT_MS_LANG_HEBREW
 =0x040d, 
STBTT_MS_LANG_SWEDISH
 =0x041D

1084 
STBTT_MAC_LANG_ENGLISH
 =0 , 
STBTT_MAC_LANG_JAPANESE
 =11,

1085 
STBTT_MAC_LANG_ARABIC
 =12, 
STBTT_MAC_LANG_KOREAN
 =23,

1086 
STBTT_MAC_LANG_DUTCH
 =4 , 
STBTT_MAC_LANG_RUSSIAN
 =32,

1087 
STBTT_MAC_LANG_FRENCH
 =1 , 
STBTT_MAC_LANG_SPANISH
 =6 ,

1088 
STBTT_MAC_LANG_GERMAN
 =2 , 
STBTT_MAC_LANG_SWEDISH
 =5 ,

1089 
STBTT_MAC_LANG_HEBREW
 =10, 
STBTT_MAC_LANG_CHINESE_SIMPLIFIED
 =33,

1090 
STBTT_MAC_LANG_ITALIAN
 =3 , 
STBTT_MAC_LANG_CHINESE_TRAD
 =19

1093 #ifdeà
__ılu¥lus


1106 #ifdeà
STB_TRUETYPE_IMPLEMENTATION


1108 #iâdeà
STBTT_MAX_OVERSAMPLE


1109 
	#STBTT_MAX_OVERSAMPLE
 8

	)

1112 #ià
STBTT_MAX_OVERSAMPLE
 > 255

1116 
	t¡b‰__‹¡_ov”§m¶e_pow2
[(
STBTT_MAX_OVERSAMPLE
 & (STBTT_MAX_OVERSAMPLE-1)) == 0 ? 1 : -1];

1118 #iâdeà
STBTT_RASTERIZER_VERSION


1119 
	#STBTT_RASTERIZER_VERSION
 2

	)

1122 #ifdeà
_MSC_VER


1123 
	#STBTT__NOTUSED
(
v
è()(v)

	)

1125 
	#STBTT__NOTUSED
(
v
è()(v)

	)

1133 
¡b‰_ušt8
 
	$¡b‰__buf_g‘8
(
¡b‰__buf
 *
b
)

1135 ià(
b
->
cursÜ
 >ğb->
size
)

1137  
b
->
d©a
[b->
cursÜ
++];

1138 
	}
}

1140 
¡b‰_ušt8
 
	$¡b‰__buf_³ek8
(
¡b‰__buf
 *
b
)

1142 ià(
b
->
cursÜ
 >ğb->
size
)

1144  
b
->
d©a
[b->
cursÜ
];

1145 
	}
}

1147 
	$¡b‰__buf_£ek
(
¡b‰__buf
 *
b
, 
o
)

1149 
	`STBTT_as£¹
(!(
o
 > 
b
->
size
 || o < 0));

1150 
b
->
cursÜ
 = (
o
 > b->
size
 || o < 0) ? b->size : o;

1151 
	}
}

1153 
	$¡b‰__buf_sk
(
¡b‰__buf
 *
b
, 
o
)

1155 
	`¡b‰__buf_£ek
(
b
, b->
cursÜ
 + 
o
);

1156 
	}
}

1158 
¡b‰_ušt32
 
	$¡b‰__buf_g‘
(
¡b‰__buf
 *
b
, 
n
)

1160 
¡b‰_ušt32
 
v
 = 0;

1161 
i
;

1162 
	`STBTT_as£¹
(
n
 >= 1 &&‚ <= 4);

1163 
i
 = 0; i < 
n
; i++)

1164 
v
 = (v << 8è| 
	`¡b‰__buf_g‘8
(
b
);

1165  
v
;

1166 
	}
}

1168 
¡b‰__buf
 
	$¡b‰__Ãw_buf
(cÚ¡ *
p
, 
size_t
 
size
)

1170 
¡b‰__buf
 
r
;

1171 
	`STBTT_as£¹
(
size
 < 0x40000000);

1172 
r
.
d©a
 = (
¡b‰_ušt8
*è
p
;

1173 
r
.
size
 = () size;

1174 
r
.
cursÜ
 = 0;

1175  
r
;

1176 
	}
}

1178 
	#¡b‰__buf_g‘16
(
b
è
	`¡b‰__buf_g‘
((b), 2)

	)

1179 
	#¡b‰__buf_g‘32
(
b
è
	`¡b‰__buf_g‘
((b), 4)

	)

1181 
¡b‰__buf
 
	$¡b‰__buf_¿nge
(cÚ¡ 
¡b‰__buf
 *
b
, 
o
, 
s
)

1183 
¡b‰__buf
 
r
 = 
	`¡b‰__Ãw_buf
(
NULL
, 0);

1184 ià(
o
 < 0 || 
s
 < 0 || o > 
b
->
size
 || s > b->siz- oè 
r
;

1185 
r
.
d©a
 = 
b
->d©¨+ 
o
;

1186 
r
.
size
 = 
s
;

1187  
r
;

1188 
	}
}

1190 
¡b‰__buf
 
	$¡b‰__cff_g‘_šdex
(
¡b‰__buf
 *
b
)

1192 
couÁ
, 
¡¬t
, 
offsize
;

1193 
¡¬t
 = 
b
->
cursÜ
;

1194 
couÁ
 = 
	`¡b‰__buf_g‘16
(
b
);

1195 ià(
couÁ
) {

1196 
offsize
 = 
	`¡b‰__buf_g‘8
(
b
);

1197 
	`STBTT_as£¹
(
offsize
 >= 1 && offsize <= 4);

1198 
	`¡b‰__buf_sk
(
b
, 
offsize
 * 
couÁ
);

1199 
	`¡b‰__buf_sk
(
b
, 
	`¡b‰__buf_g‘
(b, 
offsize
) - 1);

1201  
	`¡b‰__buf_¿nge
(
b
, 
¡¬t
, b->
cursÜ
 - start);

1202 
	}
}

1204 
¡b‰_ušt32
 
	$¡b‰__cff_št
(
¡b‰__buf
 *
b
)

1206 
b0
 = 
	`¡b‰__buf_g‘8
(
b
);

1207 ià(
b0
 >= 32 && b0 <= 246)  b0 - 139;

1208 ià(
b0
 >ğ247 && b0 <ğ250è (b0 - 247)*256 + 
	`¡b‰__buf_g‘8
(
b
) + 108;

1209 ià(
b0
 >ğ251 && b0 <ğ254è -(b0 - 251)*256 - 
	`¡b‰__buf_g‘8
(
b
) - 108;

1210 ià(
b0
 =ğ28è 
	`¡b‰__buf_g‘16
(
b
);

1211 ià(
b0
 =ğ29è 
	`¡b‰__buf_g‘32
(
b
);

1212 
	`STBTT_as£¹
(0);

1214 
	}
}

1216 
	$¡b‰__cff_sk_İ”ªd
(
¡b‰__buf
 *
b
) {

1217 
v
, 
b0
 = 
	`¡b‰__buf_³ek8
(
b
);

1218 
	`STBTT_as£¹
(
b0
 >= 28);

1219 ià(
b0
 == 30) {

1220 
	`¡b‰__buf_sk
(
b
, 1);

1221 
b
->
cursÜ
 < b->
size
) {

1222 
v
 = 
	`¡b‰__buf_g‘8
(
b
);

1223 ià((
v
 & 0xF) == 0xF || (v >> 4) == 0xF)

1227 
	`¡b‰__cff_št
(
b
);

1229 
	}
}

1231 
¡b‰__buf
 
	$¡b‰__diù_g‘
(
¡b‰__buf
 *
b
, 
key
)

1233 
	`¡b‰__buf_£ek
(
b
, 0);

1234 
b
->
cursÜ
 < b->
size
) {

1235 
¡¬t
 = 
b
->
cursÜ
, 
’d
, 
İ
;

1236 
	`¡b‰__buf_³ek8
(
b
) >= 28)

1237 
	`¡b‰__cff_sk_İ”ªd
(
b
);

1238 
’d
 = 
b
->
cursÜ
;

1239 
İ
 = 
	`¡b‰__buf_g‘8
(
b
);

1240 ià(
İ
 =ğ12èİ = 
	`¡b‰__buf_g‘8
(
b
) | 0x100;

1241 ià(
İ
 =ğ
key
è 
	`¡b‰__buf_¿nge
(
b
, 
¡¬t
, 
’d
-start);

1243  
	`¡b‰__buf_¿nge
(
b
, 0, 0);

1244 
	}
}

1246 
	$¡b‰__diù_g‘_šts
(
¡b‰__buf
 *
b
, 
key
, 
outcouÁ
, 
¡b‰_ušt32
 *
out
)

1248 
i
;

1249 
¡b‰__buf
 
İ”ªds
 = 
	`¡b‰__diù_g‘
(
b
, 
key
);

1250 
i
 = 0; i < 
outcouÁ
 && 
İ”ªds
.
cursÜ
 < o³¿nds.
size
; i++)

1251 
out
[
i
] = 
	`¡b‰__cff_št
(&
İ”ªds
);

1252 
	}
}

1254 
	$¡b‰__cff_šdex_couÁ
(
¡b‰__buf
 *
b
)

1256 
	`¡b‰__buf_£ek
(
b
, 0);

1257  
	`¡b‰__buf_g‘16
(
b
);

1258 
	}
}

1260 
¡b‰__buf
 
	$¡b‰__cff_šdex_g‘
(
¡b‰__buf
 
b
, 
i
)

1262 
couÁ
, 
offsize
, 
¡¬t
, 
’d
;

1263 
	`¡b‰__buf_£ek
(&
b
, 0);

1264 
couÁ
 = 
	`¡b‰__buf_g‘16
(&
b
);

1265 
offsize
 = 
	`¡b‰__buf_g‘8
(&
b
);

1266 
	`STBTT_as£¹
(
i
 >ğ0 && i < 
couÁ
);

1267 
	`STBTT_as£¹
(
offsize
 >= 1 && offsize <= 4);

1268 
	`¡b‰__buf_sk
(&
b
, 
i
*
offsize
);

1269 
¡¬t
 = 
	`¡b‰__buf_g‘
(&
b
, 
offsize
);

1270 
’d
 = 
	`¡b‰__buf_g‘
(&
b
, 
offsize
);

1271  
	`¡b‰__buf_¿nge
(&
b
, 2+(
couÁ
+1)*
offsize
+
¡¬t
, 
’d
 - start);

1272 
	}
}

1282 
	#‰BYTE
(
p
è(* (
¡b‰_ušt8
 *èÕ))

	)

1283 
	#‰CHAR
(
p
è(* (
¡b‰_št8
 *èÕ))

	)

1284 
	#‰Fixed
(
p
è
	`‰LONG
Õ)

	)

1286 
¡b‰_ušt16
 
	$‰USHORT
(
¡b‰_ušt8
 *
p
è{ …[0]*256 +…[1]; 
	}
}

1287 
¡b‰_št16
 
	$‰SHORT
(
¡b‰_ušt8
 *
p
è{ …[0]*256 +…[1]; 
	}
}

1288 
¡b‰_ušt32
 
	$‰ULONG
(
¡b‰_ušt8
 *
p
è{  (p[0]<<24è+ (p[1]<<16è+ (p[2]<<8è+…[3]; 
	}
}

1289 
¡b‰_št32
 
	$‰LONG
(
¡b‰_ušt8
 *
p
è{  (p[0]<<24è+ (p[1]<<16è+ (p[2]<<8è+…[3]; 
	}
}

1291 
	#¡b‰_g4
(
p
,
c0
,
c1
,
c2
,
c3
è(Õ)[0] =ğ(c0è&& (p)[1] =ğ(c1è&& (p)[2] =ğ(c2è&& (p)[3] =ğ(c3))

	)

1292 
	#¡b‰_g
(
p
,
¡r
è
	`¡b‰_g4
Õ,¡r[0],¡r[1],¡r[2],¡r[3])

	)

1294 
	$¡b‰__isfÚt
(
¡b‰_ušt8
 *
fÚt
)

1297 ià(
	`¡b‰_g4
(
fÚt
, '1',0,0,0))  1;

1298 ià(
	`¡b‰_g
(
fÚt
, "typ1"))  1;

1299 ià(
	`¡b‰_g
(
fÚt
, "OTTO"))  1;

1300 ià(
	`¡b‰_g4
(
fÚt
, 0,1,0,0))  1;

1301 ià(
	`¡b‰_g
(
fÚt
, "true"))  1;

1303 
	}
}

1306 
¡b‰_ušt32
 
	$¡b‰__fšd_bË
(
¡b‰_ušt8
 *
d©a
, 
¡b‰_ušt32
 
fÚt¡¬t
, cÚ¡ *
g
)

1308 
¡b‰_št32
 
num_bËs
 = 
	`‰USHORT
(
d©a
+
fÚt¡¬t
+4);

1309 
¡b‰_ušt32
 
bËdœ
 = 
fÚt¡¬t
 + 12;

1310 
¡b‰_št32
 
i
;

1311 
i
=0; i < 
num_bËs
; ++i) {

1312 
¡b‰_ušt32
 
loc
 = 
bËdœ
 + 16*
i
;

1313 ià(
	`¡b‰_g
(
d©a
+
loc
+0, 
g
))

1314  
	`‰ULONG
(
d©a
+
loc
+8);

1317 
	}
}

1319 
	$¡b‰_G‘FÚtOff£tFÜIndex_š‹º®
(*
fÚt_cŞËùiÚ
, 
šdex
)

1322 ià(
	`¡b‰__isfÚt
(
fÚt_cŞËùiÚ
))

1323  
šdex
 == 0 ? 0 : -1;

1326 ià(
	`¡b‰_g
(
fÚt_cŞËùiÚ
, "ttcf")) {

1328 ià(
	`‰ULONG
(
fÚt_cŞËùiÚ
+4) == 0x00010000 ||tULONG(font_collection+4) == 0x00020000) {

1329 
¡b‰_št32
 
n
 = 
	`‰LONG
(
fÚt_cŞËùiÚ
+8);

1330 ià(
šdex
 >ğ
n
)

1332  
	`‰ULONG
(
fÚt_cŞËùiÚ
+12+
šdex
*4);

1336 
	}
}

1338 
	$¡b‰_G‘Numb”OfFÚts_š‹º®
(*
fÚt_cŞËùiÚ
)

1341 ià(
	`¡b‰__isfÚt
(
fÚt_cŞËùiÚ
))

1345 ià(
	`¡b‰_g
(
fÚt_cŞËùiÚ
, "ttcf")) {

1347 ià(
	`‰ULONG
(
fÚt_cŞËùiÚ
+4) == 0x00010000 ||tULONG(font_collection+4) == 0x00020000) {

1348  
	`‰LONG
(
fÚt_cŞËùiÚ
+8);

1352 
	}
}

1354 
¡b‰__buf
 
	$¡b‰__g‘_subrs
(
¡b‰__buf
 
cff
, stb‰__buà
fÚtdiù
)

1356 
¡b‰_ušt32
 
subrsoff
 = 0, 
´iv©e_loc
[2] = { 0, 0 };

1357 
¡b‰__buf
 
pdiù
;

1358 
	`¡b‰__diù_g‘_šts
(&
fÚtdiù
, 18, 2, 
´iv©e_loc
);

1359 ià(!
´iv©e_loc
[1] || !´iv©e_loc[0]è 
	`¡b‰__Ãw_buf
(
NULL
, 0);

1360 
pdiù
 = 
	`¡b‰__buf_¿nge
(&
cff
, 
´iv©e_loc
[1],…rivate_loc[0]);

1361 
	`¡b‰__diù_g‘_šts
(&
pdiù
, 19, 1, &
subrsoff
);

1362 ià(!
subrsoff
è 
	`¡b‰__Ãw_buf
(
NULL
, 0);

1363 
	`¡b‰__buf_£ek
(&
cff
, 
´iv©e_loc
[1]+
subrsoff
);

1364  
	`¡b‰__cff_g‘_šdex
(&
cff
);

1365 
	}
}

1368 
	$¡b‰__g‘_svg
(
¡b‰_fÚtšfo
 *
šfo
)

1370 
¡b‰_ušt32
 
t
;

1371 ià(
šfo
->
svg
 < 0) {

1372 
t
 = 
	`¡b‰__fšd_bË
(
šfo
->
d©a
, info->
fÚt¡¬t
, "SVG ");

1373 ià(
t
) {

1374 
¡b‰_ušt32
 
off£t
 = 
	`‰ULONG
(
šfo
->
d©a
 + 
t
 + 2);

1375 
šfo
->
svg
 = 
t
 + 
off£t
;

1377 
šfo
->
svg
 = 0;

1380  
šfo
->
svg
;

1381 
	}
}

1383 
	$¡b‰_In™FÚt_š‹º®
(
¡b‰_fÚtšfo
 *
šfo
, *
d©a
, 
fÚt¡¬t
)

1385 
¡b‰_ušt32
 
cm­
, 
t
;

1386 
¡b‰_št32
 
i
,
numTabËs
;

1388 
šfo
->
d©a
 = data;

1389 
šfo
->
fÚt¡¬t
 = fontstart;

1390 
šfo
->
cff
 = 
	`¡b‰__Ãw_buf
(
NULL
, 0);

1392 
cm­
 = 
	`¡b‰__fšd_bË
(
d©a
, 
fÚt¡¬t
, "cmap");

1393 
šfo
->
loÿ
 = 
	`¡b‰__fšd_bË
(
d©a
, 
fÚt¡¬t
, "loca");

1394 
šfo
->
h—d
 = 
	`¡b‰__fšd_bË
(
d©a
, 
fÚt¡¬t
, "head");

1395 
šfo
->
glyf
 = 
	`¡b‰__fšd_bË
(
d©a
, 
fÚt¡¬t
, "glyf");

1396 
šfo
->
hh—
 = 
	`¡b‰__fšd_bË
(
d©a
, 
fÚt¡¬t
, "hhea");

1397 
šfo
->
hmtx
 = 
	`¡b‰__fšd_bË
(
d©a
, 
fÚt¡¬t
, "hmtx");

1398 
šfo
->
k”n
 = 
	`¡b‰__fšd_bË
(
d©a
, 
fÚt¡¬t
, "kern");

1399 
šfo
->
gpos
 = 
	`¡b‰__fšd_bË
(
d©a
, 
fÚt¡¬t
, "GPOS");

1401 ià(!
cm­
 || !
šfo
->
h—d
 || !šfo->
hh—
 || !šfo->
hmtx
)

1403 ià(
šfo
->
glyf
) {

1405 ià(!
šfo
->
loÿ
)  0;

1408 
¡b‰__buf
 
b
, 
tİdiù
, 
tİdiùidx
;

1409 
¡b‰_ušt32
 
c¡y³
 = 2, 
ch¬¡ršgs
 = 0, 
fd¬¿yoff
 = 0, 
fd£Ëùoff
 = 0;

1410 
¡b‰_ušt32
 
cff
;

1412 
cff
 = 
	`¡b‰__fšd_bË
(
d©a
, 
fÚt¡¬t
, "CFF ");

1413 ià(!
cff
)  0;

1415 
šfo
->
fÚtdiùs
 = 
	`¡b‰__Ãw_buf
(
NULL
, 0);

1416 
šfo
->
fd£Ëù
 = 
	`¡b‰__Ãw_buf
(
NULL
, 0);

1419 
šfo
->
cff
 = 
	`¡b‰__Ãw_buf
(
d©a
+cff, 512*1024*1024);

1420 
b
 = 
šfo
->
cff
;

1423 
	`¡b‰__buf_sk
(&
b
, 2);

1424 
	`¡b‰__buf_£ek
(&
b
, 
	`¡b‰__buf_g‘8
(&b));

1428 
	`¡b‰__cff_g‘_šdex
(&
b
);

1429 
tİdiùidx
 = 
	`¡b‰__cff_g‘_šdex
(&
b
);

1430 
tİdiù
 = 
	`¡b‰__cff_šdex_g‘
(
tİdiùidx
, 0);

1431 
	`¡b‰__cff_g‘_šdex
(&
b
);

1432 
šfo
->
gsubrs
 = 
	`¡b‰__cff_g‘_šdex
(&
b
);

1434 
	`¡b‰__diù_g‘_šts
(&
tİdiù
, 17, 1, &
ch¬¡ršgs
);

1435 
	`¡b‰__diù_g‘_šts
(&
tİdiù
, 0x100 | 6, 1, &
c¡y³
);

1436 
	`¡b‰__diù_g‘_šts
(&
tİdiù
, 0x100 | 36, 1, &
fd¬¿yoff
);

1437 
	`¡b‰__diù_g‘_šts
(&
tİdiù
, 0x100 | 37, 1, &
fd£Ëùoff
);

1438 
šfo
->
subrs
 = 
	`¡b‰__g‘_subrs
(
b
, 
tİdiù
);

1441 ià(
c¡y³
 != 2)  0;

1442 ià(
ch¬¡ršgs
 == 0)  0;

1444 ià(
fd¬¿yoff
) {

1446 ià(!
fd£Ëùoff
)  0;

1447 
	`¡b‰__buf_£ek
(&
b
, 
fd¬¿yoff
);

1448 
šfo
->
fÚtdiùs
 = 
	`¡b‰__cff_g‘_šdex
(&
b
);

1449 
šfo
->
fd£Ëù
 = 
	`¡b‰__buf_¿nge
(&
b
, 
fd£Ëùoff
, b.
size
-fdselectoff);

1452 
	`¡b‰__buf_£ek
(&
b
, 
ch¬¡ršgs
);

1453 
šfo
->
ch¬¡ršgs
 = 
	`¡b‰__cff_g‘_šdex
(&
b
);

1456 
t
 = 
	`¡b‰__fšd_bË
(
d©a
, 
fÚt¡¬t
, "maxp");

1457 ià(
t
)

1458 
šfo
->
numGlyphs
 = 
	`‰USHORT
(
d©a
+
t
+4);

1460 
šfo
->
numGlyphs
 = 0xffff;

1462 
šfo
->
svg
 = -1;

1467 
numTabËs
 = 
	`‰USHORT
(
d©a
 + 
cm­
 + 2);

1468 
šfo
->
šdex_m­
 = 0;

1469 
i
=0; i < 
numTabËs
; ++i) {

1470 
¡b‰_ušt32
 
’codšg_»cÜd
 = 
cm­
 + 4 + 8 * 
i
;

1472 
	`‰USHORT
(
d©a
+
’codšg_»cÜd
)) {

1473 
STBTT_PLATFORM_ID_MICROSOFT
:

1474 
	`‰USHORT
(
d©a
+
’codšg_»cÜd
+2)) {

1475 
STBTT_MS_EID_UNICODE_BMP
:

1476 
STBTT_MS_EID_UNICODE_FULL
:

1478 
šfo
->
šdex_m­
 = 
cm­
 + 
	`‰ULONG
(
d©a
+
’codšg_»cÜd
+4);

1482 
STBTT_PLATFORM_ID_UNICODE
:

1485 
šfo
->
šdex_m­
 = 
cm­
 + 
	`‰ULONG
(
d©a
+
’codšg_»cÜd
+4);

1489 ià(
šfo
->
šdex_m­
 == 0)

1492 
šfo
->
šdexToLocFÜm©
 = 
	`‰USHORT
(
d©a
+šfo->
h—d
 + 50);

1494 
	}
}

1496 
STBTT_DEF
 
	$¡b‰_FšdGlyphIndex
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
unicode_cod•ošt
)

1498 
¡b‰_ušt8
 *
d©a
 = 
šfo
->data;

1499 
¡b‰_ušt32
 
šdex_m­
 = 
šfo
->index_map;

1501 
¡b‰_ušt16
 
fÜm©
 = 
	`‰USHORT
(
d©a
 + 
šdex_m­
 + 0);

1502 ià(
fÜm©
 == 0) {

1503 
¡b‰_št32
 
by‹s
 = 
	`‰USHORT
(
d©a
 + 
šdex_m­
 + 2);

1504 ià(
unicode_cod•ošt
 < 
by‹s
-6)

1505  
	`‰BYTE
(
d©a
 + 
šdex_m­
 + 6 + 
unicode_cod•ošt
);

1507 } ià(
fÜm©
 == 6) {

1508 
¡b‰_ušt32
 
fœ¡
 = 
	`‰USHORT
(
d©a
 + 
šdex_m­
 + 6);

1509 
¡b‰_ušt32
 
couÁ
 = 
	`‰USHORT
(
d©a
 + 
šdex_m­
 + 8);

1510 ià((
¡b‰_ušt32
è
unicode_cod•ošt
 >ğ
fœ¡
 && (¡b‰_ušt32èunicode_cod•ošˆ< fœ¡+
couÁ
)

1511  
	`‰USHORT
(
d©a
 + 
šdex_m­
 + 10 + (
unicode_cod•ošt
 - 
fœ¡
)*2);

1513 } ià(
fÜm©
 == 2) {

1514 
	`STBTT_as£¹
(0);

1516 } ià(
fÜm©
 == 4) {

1517 
¡b‰_ušt16
 
£gcouÁ
 = 
	`‰USHORT
(
d©a
+
šdex_m­
+6) >> 1;

1518 
¡b‰_ušt16
 
£¬chRªge
 = 
	`‰USHORT
(
d©a
+
šdex_m­
+8) >> 1;

1519 
¡b‰_ušt16
 
’ŒyS–eùÜ
 = 
	`‰USHORT
(
d©a
+
šdex_m­
+10);

1520 
¡b‰_ušt16
 
¿ngeShiá
 = 
	`‰USHORT
(
d©a
+
šdex_m­
+12) >> 1;

1523 
¡b‰_ušt32
 
’dCouÁ
 = 
šdex_m­
 + 14;

1524 
¡b‰_ušt32
 
£¬ch
 = 
’dCouÁ
;

1526 ià(
unicode_cod•ošt
 > 0xffff)

1531 ià(
unicode_cod•ošt
 >ğ
	`‰USHORT
(
d©a
 + 
£¬ch
 + 
¿ngeShiá
*2))

1532 
£¬ch
 +ğ
¿ngeShiá
*2;

1535 
£¬ch
 -= 2;

1536 
’ŒyS–eùÜ
) {

1537 
¡b‰_ušt16
 
’d
;

1538 
£¬chRªge
 >>= 1;

1539 
’d
 = 
	`‰USHORT
(
d©a
 + 
£¬ch
 + 
£¬chRªge
*2);

1540 ià(
unicode_cod•ošt
 > 
’d
)

1541 
£¬ch
 +ğ
£¬chRªge
*2;

1542 --
’ŒyS–eùÜ
;

1544 
£¬ch
 += 2;

1547 
¡b‰_ušt16
 
off£t
, 
¡¬t
, 
Ï¡
;

1548 
¡b‰_ušt16
 
™em
 = (¡b‰_ušt16è((
£¬ch
 - 
’dCouÁ
) >> 1);

1550 
¡¬t
 = 
	`‰USHORT
(
d©a
 + 
šdex_m­
 + 14 + 
£gcouÁ
*2 + 2 + 2*
™em
);

1551 
Ï¡
 = 
	`‰USHORT
(
d©a
 + 
’dCouÁ
 + 2*
™em
);

1552 ià(
unicode_cod•ošt
 < 
¡¬t
 || unicode_cod•ošˆ> 
Ï¡
)

1555 
off£t
 = 
	`‰USHORT
(
d©a
 + 
šdex_m­
 + 14 + 
£gcouÁ
*6 + 2 + 2*
™em
);

1556 ià(
off£t
 == 0)

1557  (
¡b‰_ušt16
è(
unicode_cod•ošt
 + 
	`‰SHORT
(
d©a
 + 
šdex_m­
 + 14 + 
£gcouÁ
*4 + 2 + 2*
™em
));

1559  
	`‰USHORT
(
d©a
 + 
off£t
 + (
unicode_cod•ošt
-
¡¬t
)*2 + 
šdex_m­
 + 14 + 
£gcouÁ
*6 + 2 + 2*
™em
);

1561 } ià(
fÜm©
 == 12 || format == 13) {

1562 
¡b‰_ušt32
 
ngroups
 = 
	`‰ULONG
(
d©a
+
šdex_m­
+12);

1563 
¡b‰_št32
 
low
,
high
;

1564 
low
 = 0; 
high
 = (
¡b‰_št32
)
ngroups
;

1566 
low
 < 
high
) {

1567 
¡b‰_št32
 
mid
 = 
low
 + ((
high
-low) >> 1);

1568 
¡b‰_ušt32
 
¡¬t_ch¬
 = 
	`‰ULONG
(
d©a
+
šdex_m­
+16+
mid
*12);

1569 
¡b‰_ušt32
 
’d_ch¬
 = 
	`‰ULONG
(
d©a
+
šdex_m­
+16+
mid
*12+4);

1570 ià((
¡b‰_ušt32
è
unicode_cod•ošt
 < 
¡¬t_ch¬
)

1571 
high
 = 
mid
;

1572 ià((
¡b‰_ušt32
è
unicode_cod•ošt
 > 
’d_ch¬
)

1573 
low
 = 
mid
+1;

1575 
¡b‰_ušt32
 
¡¬t_glyph
 = 
	`‰ULONG
(
d©a
+
šdex_m­
+16+
mid
*12+8);

1576 ià(
fÜm©
 == 12)

1577  
¡¬t_glyph
 + 
unicode_cod•ošt
-
¡¬t_ch¬
;

1579  
¡¬t_glyph
;

1585 
	`STBTT_as£¹
(0);

1587 
	}
}

1589 
STBTT_DEF
 
	$¡b‰_G‘Cod•oštSh­e
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
unicode_cod•ošt
, 
¡b‰_v”‹x
 **
v”tiûs
)

1591  
	`¡b‰_G‘GlyphSh­e
(
šfo
, 
	`¡b‰_FšdGlyphIndex
(šfo, 
unicode_cod•ošt
), 
v”tiûs
);

1592 
	}
}

1594 
	$¡b‰_£tv”‹x
(
¡b‰_v”‹x
 *
v
, 
¡b‰_ušt8
 
ty³
, 
¡b‰_št32
 
x
, stb‰_št32 
y
, stb‰_št32 
cx
, stb‰_št32 
cy
)

1596 
v
->
ty³
 =ype;

1597 
v
->
x
 = (
¡b‰_št16
) x;

1598 
v
->
y
 = (
¡b‰_št16
) y;

1599 
v
->
cx
 = (
¡b‰_št16
) cx;

1600 
v
->
cy
 = (
¡b‰_št16
) cy;

1601 
	}
}

1603 
	$¡b‰__G‘GlyfOff£t
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
glyph_šdex
)

1605 
g1
,
g2
;

1607 
	`STBTT_as£¹
(!
šfo
->
cff
.
size
);

1609 ià(
glyph_šdex
 >ğ
šfo
->
numGlyphs
)  -1;

1610 ià(
šfo
->
šdexToLocFÜm©
 >= 2)  -1;

1612 ià(
šfo
->
šdexToLocFÜm©
 == 0) {

1613 
g1
 = 
šfo
->
glyf
 + 
	`‰USHORT
(šfo->
d©a
 + info->
loÿ
 + 
glyph_šdex
 * 2) * 2;

1614 
g2
 = 
šfo
->
glyf
 + 
	`‰USHORT
(šfo->
d©a
 + info->
loÿ
 + 
glyph_šdex
 * 2 + 2) * 2;

1616 
g1
 = 
šfo
->
glyf
 + 
	`‰ULONG
 (šfo->
d©a
 + info->
loÿ
 + 
glyph_šdex
 * 4);

1617 
g2
 = 
šfo
->
glyf
 + 
	`‰ULONG
 (šfo->
d©a
 + info->
loÿ
 + 
glyph_šdex
 * 4 + 4);

1620  
g1
==
g2
 ? -1 : g1;

1621 
	}
}

1623 
¡b‰__G‘GlyphInfoT2
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
glyph_šdex
, *
x0
, *
y0
, *
x1
, *
y1
);

1625 
STBTT_DEF
 
	$¡b‰_G‘GlyphBox
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
glyph_šdex
, *
x0
, *
y0
, *
x1
, *
y1
)

1627 ià(
šfo
->
cff
.
size
) {

1628 
	`¡b‰__G‘GlyphInfoT2
(
šfo
, 
glyph_šdex
, 
x0
, 
y0
, 
x1
, 
y1
);

1630 
g
 = 
	`¡b‰__G‘GlyfOff£t
(
šfo
, 
glyph_šdex
);

1631 ià(
g
 < 0)  0;

1633 ià(
x0
è*x0 = 
	`‰SHORT
(
šfo
->
d©a
 + 
g
 + 2);

1634 ià(
y0
è*y0 = 
	`‰SHORT
(
šfo
->
d©a
 + 
g
 + 4);

1635 ià(
x1
è*x1 = 
	`‰SHORT
(
šfo
->
d©a
 + 
g
 + 6);

1636 ià(
y1
è*y1 = 
	`‰SHORT
(
šfo
->
d©a
 + 
g
 + 8);

1639 
	}
}

1641 
STBTT_DEF
 
	$¡b‰_G‘Cod•oštBox
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
cod•ošt
, *
x0
, *
y0
, *
x1
, *
y1
)

1643  
	`¡b‰_G‘GlyphBox
(
šfo
, 
	`¡b‰_FšdGlyphIndex
(šfo,
cod•ošt
), 
x0
,
y0
,
x1
,
y1
);

1644 
	}
}

1646 
STBTT_DEF
 
	$¡b‰_IsGlyphEm±y
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
glyph_šdex
)

1648 
¡b‰_št16
 
numb”OfCÚtours
;

1649 
g
;

1650 ià(
šfo
->
cff
.
size
)

1651  
	`¡b‰__G‘GlyphInfoT2
(
šfo
, 
glyph_šdex
, 
NULL
, NULL, NULL, NULL) == 0;

1652 
g
 = 
	`¡b‰__G‘GlyfOff£t
(
šfo
, 
glyph_šdex
);

1653 ià(
g
 < 0)  1;

1654 
numb”OfCÚtours
 = 
	`‰SHORT
(
šfo
->
d©a
 + 
g
);

1655  
numb”OfCÚtours
 == 0;

1656 
	}
}

1658 
	$¡b‰__şo£_sh­e
(
¡b‰_v”‹x
 *
v”tiûs
, 
num_v”tiûs
, 
was_off
, 
¡¬t_off
,

1659 
¡b‰_št32
 
sx
, stb‰_št32 
sy
, stb‰_št32 
scx
, stb‰_št32 
scy
, stb‰_št32 
cx
, stb‰_št32 
cy
)

1661 ià(
¡¬t_off
) {

1662 ià(
was_off
)

1663 
	`¡b‰_£tv”‹x
(&
v”tiûs
[
num_v”tiûs
++], 
STBTT_vcurve
, (
cx
+
scx
)>>1, (
cy
+
scy
)>>1, cx,cy);

1664 
	`¡b‰_£tv”‹x
(&
v”tiûs
[
num_v”tiûs
++], 
STBTT_vcurve
, 
sx
,
sy
,
scx
,
scy
);

1666 ià(
was_off
)

1667 
	`¡b‰_£tv”‹x
(&
v”tiûs
[
num_v”tiûs
++], 
STBTT_vcurve
,
sx
,
sy
,
cx
,
cy
);

1669 
	`¡b‰_£tv”‹x
(&
v”tiûs
[
num_v”tiûs
++], 
STBTT_vlše
,
sx
,
sy
,0,0);

1671  
num_v”tiûs
;

1672 
	}
}

1674 
	$¡b‰__G‘GlyphSh­eTT
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
glyph_šdex
, 
¡b‰_v”‹x
 **
pv”tiûs
)

1676 
¡b‰_št16
 
numb”OfCÚtours
;

1677 
¡b‰_ušt8
 *
’dPtsOfCÚtours
;

1678 
¡b‰_ušt8
 *
d©a
 = 
šfo
->data;

1679 
¡b‰_v”‹x
 *
v”tiûs
=0;

1680 
num_v”tiûs
=0;

1681 
g
 = 
	`¡b‰__G‘GlyfOff£t
(
šfo
, 
glyph_šdex
);

1683 *
pv”tiûs
 = 
NULL
;

1685 ià(
g
 < 0)  0;

1687 
numb”OfCÚtours
 = 
	`‰SHORT
(
d©a
 + 
g
);

1689 ià(
numb”OfCÚtours
 > 0) {

1690 
¡b‰_ušt8
 
æags
=0,
æagcouÁ
;

1691 
¡b‰_št32
 
šs
, 
i
,
j
=0,
m
,
n
, 
Ãxt_move
, 
was_off
=0, 
off
, 
¡¬t_off
=0;

1692 
¡b‰_št32
 
x
,
y
,
cx
,
cy
,
sx
,
sy
, 
scx
,
scy
;

1693 
¡b‰_ušt8
 *
pošts
;

1694 
’dPtsOfCÚtours
 = (
d©a
 + 
g
 + 10);

1695 
šs
 = 
	`‰USHORT
(
d©a
 + 
g
 + 10 + 
numb”OfCÚtours
 * 2);

1696 
pošts
 = 
d©a
 + 
g
 + 10 + 
numb”OfCÚtours
 * 2 + 2 + 
šs
;

1698 
n
 = 1+
	`‰USHORT
(
’dPtsOfCÚtours
 + 
numb”OfCÚtours
*2-2);

1700 
m
 = 
n
 + 2*
numb”OfCÚtours
;

1701 
v”tiûs
 = (
¡b‰_v”‹x
 *è
	`STBTT_m®loc
(
m
 * (v”tiûs[0]), 
šfo
->
u£rd©a
);

1702 ià(
v”tiûs
 == 0)

1705 
Ãxt_move
 = 0;

1706 
æagcouÁ
=0;

1712 
off
 = 
m
 - 
n
;

1716 
i
=0; i < 
n
; ++i) {

1717 ià(
æagcouÁ
 == 0) {

1718 
æags
 = *
pošts
++;

1719 ià(
æags
 & 8)

1720 
æagcouÁ
 = *
pošts
++;

1722 --
æagcouÁ
;

1723 
v”tiûs
[
off
+
i
].
ty³
 = 
æags
;

1727 
x
=0;

1728 
i
=0; i < 
n
; ++i) {

1729 
æags
 = 
v”tiûs
[
off
+
i
].
ty³
;

1730 ià(
æags
 & 2) {

1731 
¡b‰_št16
 
dx
 = *
pošts
++;

1732 
x
 +ğ(
æags
 & 16è? 
dx
 : -dx;

1734 ià(!(
æags
 & 16)) {

1735 
x
 = x + (
¡b‰_št16
è(
pošts
[0]*256 +…oints[1]);

1736 
pošts
 += 2;

1739 
v”tiûs
[
off
+
i
].
x
 = (
¡b‰_št16
) x;

1743 
y
=0;

1744 
i
=0; i < 
n
; ++i) {

1745 
æags
 = 
v”tiûs
[
off
+
i
].
ty³
;

1746 ià(
æags
 & 4) {

1747 
¡b‰_št16
 
dy
 = *
pošts
++;

1748 
y
 +ğ(
æags
 & 32è? 
dy
 : -dy;

1750 ià(!(
æags
 & 32)) {

1751 
y
 = y + (
¡b‰_št16
è(
pošts
[0]*256 +…oints[1]);

1752 
pošts
 += 2;

1755 
v”tiûs
[
off
+
i
].
y
 = (
¡b‰_št16
) y;

1759 
num_v”tiûs
=0;

1760 
sx
 = 
sy
 = 
cx
 = 
cy
 = 
scx
 = 
scy
 = 0;

1761 
i
=0; i < 
n
; ++i) {

1762 
æags
 = 
v”tiûs
[
off
+
i
].
ty³
;

1763 
x
 = (
¡b‰_št16
è
v”tiûs
[
off
+
i
].x;

1764 
y
 = (
¡b‰_št16
è
v”tiûs
[
off
+
i
].y;

1766 ià(
Ãxt_move
 =ğ
i
) {

1767 ià(
i
 != 0)

1768 
num_v”tiûs
 = 
	`¡b‰__şo£_sh­e
(
v”tiûs
,‚um_v”tiûs, 
was_off
, 
¡¬t_off
, 
sx
,
sy
,
scx
,
scy
,
cx
,
cy
);

1771 
¡¬t_off
 = !(
æags
 & 1);

1772 ià(
¡¬t_off
) {

1775 
scx
 = 
x
;

1776 
scy
 = 
y
;

1777 ià(!(
v”tiûs
[
off
+
i
+1].
ty³
 & 1)) {

1779 
sx
 = (
x
 + (
¡b‰_št32
è
v”tiûs
[
off
+
i
+1].x) >> 1;

1780 
sy
 = (
y
 + (
¡b‰_št32
è
v”tiûs
[
off
+
i
+1].y) >> 1;

1783 
sx
 = (
¡b‰_št32
è
v”tiûs
[
off
+
i
+1].
x
;

1784 
sy
 = (
¡b‰_št32
è
v”tiûs
[
off
+
i
+1].
y
;

1785 ++
i
;

1788 
sx
 = 
x
;

1789 
sy
 = 
y
;

1791 
	`¡b‰_£tv”‹x
(&
v”tiûs
[
num_v”tiûs
++], 
STBTT_vmove
,
sx
,
sy
,0,0);

1792 
was_off
 = 0;

1793 
Ãxt_move
 = 1 + 
	`‰USHORT
(
’dPtsOfCÚtours
+
j
*2);

1794 ++
j
;

1796 ià(!(
æags
 & 1)) {

1797 ià(
was_off
)

1798 
	`¡b‰_£tv”‹x
(&
v”tiûs
[
num_v”tiûs
++], 
STBTT_vcurve
, (
cx
+
x
)>>1, (
cy
+
y
)>>1, cx, cy);

1799 
cx
 = 
x
;

1800 
cy
 = 
y
;

1801 
was_off
 = 1;

1803 ià(
was_off
)

1804 
	`¡b‰_£tv”‹x
(&
v”tiûs
[
num_v”tiûs
++], 
STBTT_vcurve
, 
x
,
y
, 
cx
, 
cy
);

1806 
	`¡b‰_£tv”‹x
(&
v”tiûs
[
num_v”tiûs
++], 
STBTT_vlše
, 
x
,
y
,0,0);

1807 
was_off
 = 0;

1811 
num_v”tiûs
 = 
	`¡b‰__şo£_sh­e
(
v”tiûs
,‚um_v”tiûs, 
was_off
, 
¡¬t_off
, 
sx
,
sy
,
scx
,
scy
,
cx
,
cy
);

1812 } ià(
numb”OfCÚtours
 < 0) {

1814 
mÜe
 = 1;

1815 
¡b‰_ušt8
 *
comp
 = 
d©a
 + 
g
 + 10;

1816 
num_v”tiûs
 = 0;

1817 
v”tiûs
 = 0;

1818 
mÜe
) {

1819 
¡b‰_ušt16
 
æags
, 
gidx
;

1820 
comp_num_v”ts
 = 0, 
i
;

1821 
¡b‰_v”‹x
 *
comp_v”ts
 = 0, *
tmp
 = 0;

1822 
mtx
[6] = {1,0,0,1,0,0}, 
m
, 
n
;

1824 
æags
 = 
	`‰SHORT
(
comp
); comp+=2;

1825 
gidx
 = 
	`‰SHORT
(
comp
); comp+=2;

1827 ià(
æags
 & 2) {

1828 ià(
æags
 & 1) {

1829 
mtx
[4] = 
	`‰SHORT
(
comp
); comp+=2;

1830 
mtx
[5] = 
	`‰SHORT
(
comp
); comp+=2;

1832 
mtx
[4] = 
	`‰CHAR
(
comp
); comp+=1;

1833 
mtx
[5] = 
	`‰CHAR
(
comp
); comp+=1;

1838 
	`STBTT_as£¹
(0);

1840 ià(
æags
 & (1<<3)) {

1841 
mtx
[0] = mtx[3] = 
	`‰SHORT
(
comp
)/16384.0f; comp+=2;

1842 
mtx
[1] = mtx[2] = 0;

1843 } ià(
æags
 & (1<<6)) {

1844 
mtx
[0] = 
	`‰SHORT
(
comp
)/16384.0f; comp+=2;

1845 
mtx
[1] = mtx[2] = 0;

1846 
mtx
[3] = 
	`‰SHORT
(
comp
)/16384.0f; comp+=2;

1847 } ià(
æags
 & (1<<7)) {

1848 
mtx
[0] = 
	`‰SHORT
(
comp
)/16384.0f; comp+=2;

1849 
mtx
[1] = 
	`‰SHORT
(
comp
)/16384.0f; comp+=2;

1850 
mtx
[2] = 
	`‰SHORT
(
comp
)/16384.0f; comp+=2;

1851 
mtx
[3] = 
	`‰SHORT
(
comp
)/16384.0f; comp+=2;

1855 
m
 = (è
	`STBTT_sq¹
(
mtx
[0]*mtx[0] + mtx[1]*mtx[1]);

1856 
n
 = (è
	`STBTT_sq¹
(
mtx
[2]*mtx[2] + mtx[3]*mtx[3]);

1859 
comp_num_v”ts
 = 
	`¡b‰_G‘GlyphSh­e
(
šfo
, 
gidx
, &
comp_v”ts
);

1860 ià(
comp_num_v”ts
 > 0) {

1862 
i
 = 0; i < 
comp_num_v”ts
; ++i) {

1863 
¡b‰_v”‹x
* 
v
 = &
comp_v”ts
[
i
];

1864 
¡b‰_v”‹x_ty³
 
x
,
y
;

1865 
x
=
v
->x; 
y
=v->y;

1866 
v
->
x
 = (
¡b‰_v”‹x_ty³
)(
m
 * (
mtx
[0]*x + mtx[2]*
y
 + mtx[4]));

1867 
v
->
y
 = (
¡b‰_v”‹x_ty³
)(
n
 * (
mtx
[1]*
x
 + mtx[3]*y + mtx[5]));

1868 
x
=
v
->
cx
; 
y
=v->
cy
;

1869 
v
->
cx
 = (
¡b‰_v”‹x_ty³
)(
m
 * (
mtx
[0]*
x
 + mtx[2]*
y
 + mtx[4]));

1870 
v
->
cy
 = (
¡b‰_v”‹x_ty³
)(
n
 * (
mtx
[1]*
x
 + mtx[3]*
y
 + mtx[5]));

1873 
tmp
 = (
¡b‰_v”‹x
*)
	`STBTT_m®loc
((
num_v”tiûs
+
comp_num_v”ts
)*(¡b‰_v”‹x), 
šfo
->
u£rd©a
);

1874 ià(!
tmp
) {

1875 ià(
v”tiûs
è
	`STBTT_ä“
(v”tiûs, 
šfo
->
u£rd©a
);

1876 ià(
comp_v”ts
è
	`STBTT_ä“
(comp_v”ts, 
šfo
->
u£rd©a
);

1879 ià(
num_v”tiûs
 > 0 && 
v”tiûs
è
	`STBTT_memıy
(
tmp
, v”tiûs,‚um_v”tiûs*(
¡b‰_v”‹x
));

1880 
	`STBTT_memıy
(
tmp
+
num_v”tiûs
, 
comp_v”ts
, 
comp_num_v”ts
*(
¡b‰_v”‹x
));

1881 ià(
v”tiûs
è
	`STBTT_ä“
(v”tiûs, 
šfo
->
u£rd©a
);

1882 
v”tiûs
 = 
tmp
;

1883 
	`STBTT_ä“
(
comp_v”ts
, 
šfo
->
u£rd©a
);

1884 
num_v”tiûs
 +ğ
comp_num_v”ts
;

1887 
mÜe
 = 
æags
 & (1<<5);

1893 *
pv”tiûs
 = 
v”tiûs
;

1894  
num_v”tiûs
;

1895 
	}
}

1899 
	mbounds
;

1900 
	m¡¬‹d
;

1901 
	mfœ¡_x
, 
	mfœ¡_y
;

1902 
	mx
, 
	my
;

1903 
¡b‰_št32
 
	mmš_x
, 
	mmax_x
, 
	mmš_y
, 
	mmax_y
;

1905 
¡b‰_v”‹x
 *
	mpv”tiûs
;

1906 
	mnum_v”tiûs
;

1907 } 
	t¡b‰__csùx
;

1909 
	#STBTT__CSCTX_INIT
(
bounds
è{bounds,0, 0,0, 0,0, 0,0,0,0, 
NULL
, 0}

	)

1911 
	$¡b‰__Œack_v”‹x
(
¡b‰__csùx
 *
c
, 
¡b‰_št32
 
x
, stb‰_št32 
y
)

1913 ià(
x
 > 
c
->
max_x
 || !c->
¡¬‹d
) c->max_x = x;

1914 ià(
y
 > 
c
->
max_y
 || !c->
¡¬‹d
) c->max_y = y;

1915 ià(
x
 < 
c
->
mš_x
 || !c->
¡¬‹d
) c->min_x = x;

1916 ià(
y
 < 
c
->
mš_y
 || !c->
¡¬‹d
) c->min_y = y;

1917 
c
->
¡¬‹d
 = 1;

1918 
	}
}

1920 
	$¡b‰__csùx_v
(
¡b‰__csùx
 *
c
, 
¡b‰_ušt8
 
ty³
, 
¡b‰_št32
 
x
, stb‰_št32 
y
, stb‰_št32 
cx
, stb‰_št32 
cy
, stb‰_št32 
cx1
, stb‰_št32 
cy1
)

1922 ià(
c
->
bounds
) {

1923 
	`¡b‰__Œack_v”‹x
(
c
, 
x
, 
y
);

1924 ià(
ty³
 =ğ
STBTT_vcubic
) {

1925 
	`¡b‰__Œack_v”‹x
(
c
, 
cx
, 
cy
);

1926 
	`¡b‰__Œack_v”‹x
(
c
, 
cx1
, 
cy1
);

1929 
	`¡b‰_£tv”‹x
(&
c
->
pv”tiûs
[c->
num_v”tiûs
], 
ty³
, 
x
, 
y
, 
cx
, 
cy
);

1930 
c
->
pv”tiûs
[c->
num_v”tiûs
].
cx1
 = (
¡b‰_št16
) cx1;

1931 
c
->
pv”tiûs
[c->
num_v”tiûs
].
cy1
 = (
¡b‰_št16
) cy1;

1933 
c
->
num_v”tiûs
++;

1934 
	}
}

1936 
	$¡b‰__csùx_şo£_sh­e
(
¡b‰__csùx
 *
ùx
)

1938 ià(
ùx
->
fœ¡_x
 !ğùx->
x
 || ctx->
fœ¡_y
 !ğùx->
y
)

1939 
	`¡b‰__csùx_v
(
ùx
, 
STBTT_vlše
, ()ùx->
fœ¡_x
, ()ùx->
fœ¡_y
, 0, 0, 0, 0);

1940 
	}
}

1942 
	$¡b‰__csùx_rmove_to
(
¡b‰__csùx
 *
ùx
, 
dx
, 
dy
)

1944 
	`¡b‰__csùx_şo£_sh­e
(
ùx
);

1945 
ùx
->
fœ¡_x
 = ctx->
x
 = ctx->x + 
dx
;

1946 
ùx
->
fœ¡_y
 = ctx->
y
 = ctx->y + 
dy
;

1947 
	`¡b‰__csùx_v
(
ùx
, 
STBTT_vmove
, ()ùx->
x
, ()ùx->
y
, 0, 0, 0, 0);

1948 
	}
}

1950 
	$¡b‰__csùx_¾še_to
(
¡b‰__csùx
 *
ùx
, 
dx
, 
dy
)

1952 
ùx
->
x
 +ğ
dx
;

1953 
ùx
->
y
 +ğ
dy
;

1954 
	`¡b‰__csùx_v
(
ùx
, 
STBTT_vlše
, ()ùx->
x
, ()ùx->
y
, 0, 0, 0, 0);

1955 
	}
}

1957 
	$¡b‰__csùx_rccurve_to
(
¡b‰__csùx
 *
ùx
, 
dx1
, 
dy1
, 
dx2
, 
dy2
, 
dx3
, 
dy3
)

1959 
cx1
 = 
ùx
->
x
 + 
dx1
;

1960 
cy1
 = 
ùx
->
y
 + 
dy1
;

1961 
cx2
 = 
cx1
 + 
dx2
;

1962 
cy2
 = 
cy1
 + 
dy2
;

1963 
ùx
->
x
 = 
cx2
 + 
dx3
;

1964 
ùx
->
y
 = 
cy2
 + 
dy3
;

1965 
	`¡b‰__csùx_v
(
ùx
, 
STBTT_vcubic
, ()ùx->
x
, ()ùx->
y
, ()
cx1
, ()
cy1
, ()
cx2
, ()
cy2
);

1966 
	}
}

1968 
¡b‰__buf
 
	$¡b‰__g‘_subr
(
¡b‰__buf
 
idx
, 
n
)

1970 
couÁ
 = 
	`¡b‰__cff_šdex_couÁ
(&
idx
);

1971 
bŸs
 = 107;

1972 ià(
couÁ
 >= 33900)

1973 
bŸs
 = 32768;

1974 ià(
couÁ
 >= 1240)

1975 
bŸs
 = 1131;

1976 
n
 +ğ
bŸs
;

1977 ià(
n
 < 0 ||‚ >ğ
couÁ
)

1978  
	`¡b‰__Ãw_buf
(
NULL
, 0);

1979  
	`¡b‰__cff_šdex_g‘
(
idx
, 
n
);

1980 
	}
}

1982 
¡b‰__buf
 
	$¡b‰__cid_g‘_glyph_subrs
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
glyph_šdex
)

1984 
¡b‰__buf
 
fd£Ëù
 = 
šfo
->fdselect;

1985 
Äªges
, 
¡¬t
, 
’d
, 
v
, 
fmt
, 
fd£ËùÜ
 = -1, 
i
;

1987 
	`¡b‰__buf_£ek
(&
fd£Ëù
, 0);

1988 
fmt
 = 
	`¡b‰__buf_g‘8
(&
fd£Ëù
);

1989 ià(
fmt
 == 0) {

1991 
	`¡b‰__buf_sk
(&
fd£Ëù
, 
glyph_šdex
);

1992 
fd£ËùÜ
 = 
	`¡b‰__buf_g‘8
(&
fd£Ëù
);

1993 } ià(
fmt
 == 3) {

1994 
Äªges
 = 
	`¡b‰__buf_g‘16
(&
fd£Ëù
);

1995 
¡¬t
 = 
	`¡b‰__buf_g‘16
(&
fd£Ëù
);

1996 
i
 = 0; i < 
Äªges
; i++) {

1997 
v
 = 
	`¡b‰__buf_g‘8
(&
fd£Ëù
);

1998 
’d
 = 
	`¡b‰__buf_g‘16
(&
fd£Ëù
);

1999 ià(
glyph_šdex
 >ğ
¡¬t
 && glyph_šdex < 
’d
) {

2000 
fd£ËùÜ
 = 
v
;

2003 
¡¬t
 = 
’d
;

2006 ià(
fd£ËùÜ
 =ğ-1è
	`¡b‰__Ãw_buf
(
NULL
, 0);

2007  
	`¡b‰__g‘_subrs
(
šfo
->
cff
, 
	`¡b‰__cff_šdex_g‘
(šfo->
fÚtdiùs
, 
fd£ËùÜ
));

2008 
	}
}

2010 
	$¡b‰__run_ch¬¡ršg
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
glyph_šdex
, 
¡b‰__csùx
 *
c
)

2012 
š_h—d”
 = 1, 
maskb™s
 = 0, 
subr_¡ack_height
 = 0, 
¥
 = 0, 
v
, 
i
, 
b0
;

2013 
has_subrs
 = 0, 
ş—r_¡ack
;

2014 
s
[48];

2015 
¡b‰__buf
 
subr_¡ack
[10], 
subrs
 = 
šfo
->subrs, 
b
;

2016 
f
;

2018 
	#STBTT__CSERR
(
s
è(0)

	)

2021 
b
 = 
	`¡b‰__cff_šdex_g‘
(
šfo
->
ch¬¡ršgs
, 
glyph_šdex
);

2022 
b
.
cursÜ
 < b.
size
) {

2023 
i
 = 0;

2024 
ş—r_¡ack
 = 1;

2025 
b0
 = 
	`¡b‰__buf_g‘8
(&
b
);

2026 
b0
) {

2030 ià(
š_h—d”
)

2031 
maskb™s
 +ğ(
¥
 / 2);

2032 
š_h—d”
 = 0;

2033 
	`¡b‰__buf_sk
(&
b
, (
maskb™s
 + 7) / 8);

2040 
maskb™s
 +ğ(
¥
 / 2);

2044 
š_h—d”
 = 0;

2045 ià(
¥
 < 2è 
	`STBTT__CSERR
("rmoveto stack");

2046 
	`¡b‰__csùx_rmove_to
(
c
, 
s
[
¥
-2], s[sp-1]);

2049 
š_h—d”
 = 0;

2050 ià(
¥
 < 1è 
	`STBTT__CSERR
("vmoveto stack");

2051 
	`¡b‰__csùx_rmove_to
(
c
, 0, 
s
[
¥
-1]);

2054 
š_h—d”
 = 0;

2055 ià(
¥
 < 1è 
	`STBTT__CSERR
("hmoveto stack");

2056 
	`¡b‰__csùx_rmove_to
(
c
, 
s
[
¥
-1], 0);

2060 ià(
¥
 < 2è 
	`STBTT__CSERR
("rlineto stack");

2061 ; 
i
 + 1 < 
¥
; i += 2)

2062 
	`¡b‰__csùx_¾še_to
(
c
, 
s
[
i
], s[i+1]);

2069 ià(
¥
 < 1è 
	`STBTT__CSERR
("vlineto stack");

2070 
vlš‘o
;

2072 ià(
¥
 < 1è 
	`STBTT__CSERR
("hlineto stack");

2074 ià(
i
 >ğ
¥
) ;

2075 
	`¡b‰__csùx_¾še_to
(
c
, 
s
[
i
], 0);

2076 
i
++;

2077 
vlš‘o
:

2078 ià(
i
 >ğ
¥
) ;

2079 
	`¡b‰__csùx_¾še_to
(
c
, 0, 
s
[
i
]);

2080 
i
++;

2085 ià(
¥
 < 4è 
	`STBTT__CSERR
("hvcurveto stack");

2086 
hvcurv‘o
;

2088 ià(
¥
 < 4è 
	`STBTT__CSERR
("vhcurveto stack");

2090 ià(
i
 + 3 >ğ
¥
) ;

2091 
	`¡b‰__csùx_rccurve_to
(
c
, 0, 
s
[
i
], s[i+1], s[i+2], s[i+3], (
¥
 - i == 5) ? s[i + 4] : 0.0f);

2092 
i
 += 4;

2093 
hvcurv‘o
:

2094 ià(
i
 + 3 >ğ
¥
) ;

2095 
	`¡b‰__csùx_rccurve_to
(
c
, 
s
[
i
], 0, s[i+1], s[i+2], (
¥
 - i == 5) ? s[i+4] : 0.0f, s[i+3]);

2096 
i
 += 4;

2101 ià(
¥
 < 6è 
	`STBTT__CSERR
("rcurveline stack");

2102 ; 
i
 + 5 < 
¥
; i += 6)

2103 
	`¡b‰__csùx_rccurve_to
(
c
, 
s
[
i
], s[i+1], s[i+2], s[i+3], s[i+4], s[i+5]);

2107 ià(
¥
 < 8è 
	`STBTT__CSERR
("rcurveline stack");

2108 ; 
i
 + 5 < 
¥
 - 2; i += 6)

2109 
	`¡b‰__csùx_rccurve_to
(
c
, 
s
[
i
], s[i+1], s[i+2], s[i+3], s[i+4], s[i+5]);

2110 ià(
i
 + 1 >ğ
¥
è 
	`STBTT__CSERR
("rcurveline stack");

2111 
	`¡b‰__csùx_¾še_to
(
c
, 
s
[
i
], s[i+1]);

2115 ià(
¥
 < 8è 
	`STBTT__CSERR
("rlinecurve stack");

2116 ; 
i
 + 1 < 
¥
 - 6; i += 2)

2117 
	`¡b‰__csùx_¾še_to
(
c
, 
s
[
i
], s[i+1]);

2118 ià(
i
 + 5 >ğ
¥
è 
	`STBTT__CSERR
("rlinecurve stack");

2119 
	`¡b‰__csùx_rccurve_to
(
c
, 
s
[
i
], s[i+1], s[i+2], s[i+3], s[i+4], s[i+5]);

2124 ià(
¥
 < 4è 
	`STBTT__CSERR
("(vv|hh)curveto stack");

2125 
f
 = 0.0;

2126 ià(
¥
 & 1è{ 
f
 = 
s
[
i
]; i++; }

2127 ; 
i
 + 3 < 
¥
; i += 4) {

2128 ià(
b0
 == 0x1B)

2129 
	`¡b‰__csùx_rccurve_to
(
c
, 
s
[
i
], 
f
, s[i+1], s[i+2], s[i+3], 0.0);

2131 
	`¡b‰__csùx_rccurve_to
(
c
, 
f
, 
s
[
i
], s[i+1], s[i+2], 0.0, s[i+3]);

2132 
f
 = 0.0;

2137 ià(!
has_subrs
) {

2138 ià(
šfo
->
fd£Ëù
.
size
)

2139 
subrs
 = 
	`¡b‰__cid_g‘_glyph_subrs
(
šfo
, 
glyph_šdex
);

2140 
has_subrs
 = 1;

2144 ià(
¥
 < 1è 
	`STBTT__CSERR
("call(g|)subr stack");

2145 
v
 = (è
s
[--
¥
];

2146 ià(
subr_¡ack_height
 >ğ10è 
	`STBTT__CSERR
("recursion†imit");

2147 
subr_¡ack
[
subr_¡ack_height
++] = 
b
;

2148 
b
 = 
	`¡b‰__g‘_subr
(
b0
 =ğ0x0A ? 
subrs
 : 
šfo
->
gsubrs
, 
v
);

2149 ià(
b
.
size
 =ğ0è 
	`STBTT__CSERR
("subr‚ot found");

2150 
b
.
cursÜ
 = 0;

2151 
ş—r_¡ack
 = 0;

2155 ià(
subr_¡ack_height
 <ğ0è 
	`STBTT__CSERR
("return outside subr");

2156 
b
 = 
subr_¡ack
[--
subr_¡ack_height
];

2157 
ş—r_¡ack
 = 0;

2161 
	`¡b‰__csùx_şo£_sh­e
(
c
);

2165 
dx1
, 
dx2
, 
dx3
, 
dx4
, 
dx5
, 
dx6
, 
dy1
, 
dy2
, 
dy3
, 
dy4
, 
dy5
, 
dy6
;

2166 
dx
, 
dy
;

2167 
b1
 = 
	`¡b‰__buf_g‘8
(&
b
);

2168 
b1
) {

2172 ià(
¥
 < 7è 
	`STBTT__CSERR
("hflex stack");

2173 
dx1
 = 
s
[0];

2174 
dx2
 = 
s
[1];

2175 
dy2
 = 
s
[2];

2176 
dx3
 = 
s
[3];

2177 
dx4
 = 
s
[4];

2178 
dx5
 = 
s
[5];

2179 
dx6
 = 
s
[6];

2180 
	`¡b‰__csùx_rccurve_to
(
c
, 
dx1
, 0, 
dx2
, 
dy2
, 
dx3
, 0);

2181 
	`¡b‰__csùx_rccurve_to
(
c
, 
dx4
, 0, 
dx5
, -
dy2
, 
dx6
, 0);

2185 ià(
¥
 < 13è 
	`STBTT__CSERR
("flex stack");

2186 
dx1
 = 
s
[0];

2187 
dy1
 = 
s
[1];

2188 
dx2
 = 
s
[2];

2189 
dy2
 = 
s
[3];

2190 
dx3
 = 
s
[4];

2191 
dy3
 = 
s
[5];

2192 
dx4
 = 
s
[6];

2193 
dy4
 = 
s
[7];

2194 
dx5
 = 
s
[8];

2195 
dy5
 = 
s
[9];

2196 
dx6
 = 
s
[10];

2197 
dy6
 = 
s
[11];

2199 
	`¡b‰__csùx_rccurve_to
(
c
, 
dx1
, 
dy1
, 
dx2
, 
dy2
, 
dx3
, 
dy3
);

2200 
	`¡b‰__csùx_rccurve_to
(
c
, 
dx4
, 
dy4
, 
dx5
, 
dy5
, 
dx6
, 
dy6
);

2204 ià(
¥
 < 9è 
	`STBTT__CSERR
("hflex1 stack");

2205 
dx1
 = 
s
[0];

2206 
dy1
 = 
s
[1];

2207 
dx2
 = 
s
[2];

2208 
dy2
 = 
s
[3];

2209 
dx3
 = 
s
[4];

2210 
dx4
 = 
s
[5];

2211 
dx5
 = 
s
[6];

2212 
dy5
 = 
s
[7];

2213 
dx6
 = 
s
[8];

2214 
	`¡b‰__csùx_rccurve_to
(
c
, 
dx1
, 
dy1
, 
dx2
, 
dy2
, 
dx3
, 0);

2215 
	`¡b‰__csùx_rccurve_to
(
c
, 
dx4
, 0, 
dx5
, 
dy5
, 
dx6
, -(
dy1
+
dy2
+dy5));

2219 ià(
¥
 < 11è 
	`STBTT__CSERR
("flex1 stack");

2220 
dx1
 = 
s
[0];

2221 
dy1
 = 
s
[1];

2222 
dx2
 = 
s
[2];

2223 
dy2
 = 
s
[3];

2224 
dx3
 = 
s
[4];

2225 
dy3
 = 
s
[5];

2226 
dx4
 = 
s
[6];

2227 
dy4
 = 
s
[7];

2228 
dx5
 = 
s
[8];

2229 
dy5
 = 
s
[9];

2230 
dx6
 = 
dy6
 = 
s
[10];

2231 
dx
 = 
dx1
+
dx2
+
dx3
+
dx4
+
dx5
;

2232 
dy
 = 
dy1
+
dy2
+
dy3
+
dy4
+
dy5
;

2233 ià(
	`STBTT_çbs
(
dx
è> STBTT_çbs(
dy
))

2234 
dy6
 = -
dy
;

2236 
dx6
 = -
dx
;

2237 
	`¡b‰__csùx_rccurve_to
(
c
, 
dx1
, 
dy1
, 
dx2
, 
dy2
, 
dx3
, 
dy3
);

2238 
	`¡b‰__csùx_rccurve_to
(
c
, 
dx4
, 
dy4
, 
dx5
, 
dy5
, 
dx6
, 
dy6
);

2242  
	`STBTT__CSERR
("unimplemented");

2247 ià(
b0
 != 255 && b0 != 28 && b0 < 32)

2248  
	`STBTT__CSERR
("reserved operator");

2251 ià(
b0
 == 255) {

2252 
f
 = ()(
¡b‰_št32
)
	`¡b‰__buf_g‘32
(&
b
) / 0x10000;

2254 
	`¡b‰__buf_sk
(&
b
, -1);

2255 
f
 = ()(
¡b‰_št16
)
	`¡b‰__cff_št
(&
b
);

2257 ià(
¥
 >ğ48è 
	`STBTT__CSERR
("push stack overflow");

2258 
s
[
¥
++] = 
f
;

2259 
ş—r_¡ack
 = 0;

2262 ià(
ş—r_¡ack
è
¥
 = 0;

2264  
	`STBTT__CSERR
("noƒndchar");

2266 #undeà
STBTT__CSERR


2267 
	}
}

2269 
	$¡b‰__G‘GlyphSh­eT2
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
glyph_šdex
, 
¡b‰_v”‹x
 **
pv”tiûs
)

2272 
¡b‰__csùx
 
couÁ_ùx
 = 
	`STBTT__CSCTX_INIT
(1);

2273 
¡b‰__csùx
 
ouut_ùx
 = 
	`STBTT__CSCTX_INIT
(0);

2274 ià(
	`¡b‰__run_ch¬¡ršg
(
šfo
, 
glyph_šdex
, &
couÁ_ùx
)) {

2275 *
pv”tiûs
 = (
¡b‰_v”‹x
*)
	`STBTT_m®loc
(
couÁ_ùx
.
num_v”tiûs
*(¡b‰_v”‹x), 
šfo
->
u£rd©a
);

2276 
ouut_ùx
.
pv”tiûs
 = *pvertices;

2277 ià(
	`¡b‰__run_ch¬¡ršg
(
šfo
, 
glyph_šdex
, &
ouut_ùx
)) {

2278 
	`STBTT_as£¹
(
ouut_ùx
.
num_v”tiûs
 =ğ
couÁ_ùx
.num_vertices);

2279  
ouut_ùx
.
num_v”tiûs
;

2282 *
pv”tiûs
 = 
NULL
;

2284 
	}
}

2286 
	$¡b‰__G‘GlyphInfoT2
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
glyph_šdex
, *
x0
, *
y0
, *
x1
, *
y1
)

2288 
¡b‰__csùx
 
c
 = 
	`STBTT__CSCTX_INIT
(1);

2289 
r
 = 
	`¡b‰__run_ch¬¡ršg
(
šfo
, 
glyph_šdex
, &
c
);

2290 ià(
x0
è*x0 = 
r
 ? 
c
.
mš_x
 : 0;

2291 ià(
y0
è*y0 = 
r
 ? 
c
.
mš_y
 : 0;

2292 ià(
x1
è*x1 = 
r
 ? 
c
.
max_x
 : 0;

2293 ià(
y1
è*y1 = 
r
 ? 
c
.
max_y
 : 0;

2294  
r
 ? 
c
.
num_v”tiûs
 : 0;

2295 
	}
}

2297 
STBTT_DEF
 
	$¡b‰_G‘GlyphSh­e
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
glyph_šdex
, 
¡b‰_v”‹x
 **
pv”tiûs
)

2299 ià(!
šfo
->
cff
.
size
)

2300  
	`¡b‰__G‘GlyphSh­eTT
(
šfo
, 
glyph_šdex
, 
pv”tiûs
);

2302  
	`¡b‰__G‘GlyphSh­eT2
(
šfo
, 
glyph_šdex
, 
pv”tiûs
);

2303 
	}
}

2305 
STBTT_DEF
 
	$¡b‰_G‘GlyphHM‘rics
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
glyph_šdex
, *
advªûWidth
, *
ËáSideB—ršg
)

2307 
¡b‰_ušt16
 
numOfLÚgHÜM‘rics
 = 
	`‰USHORT
(
šfo
->
d©a
+šfo->
hh—
 + 34);

2308 ià(
glyph_šdex
 < 
numOfLÚgHÜM‘rics
) {

2309 ià(
advªûWidth
è*advªûWidth = 
	`‰SHORT
(
šfo
->
d©a
 + info->
hmtx
 + 4*
glyph_šdex
);

2310 ià(
ËáSideB—ršg
è*ËáSideB—ršg = 
	`‰SHORT
(
šfo
->
d©a
 + info->
hmtx
 + 4*
glyph_šdex
 + 2);

2312 ià(
advªûWidth
è*advªûWidth = 
	`‰SHORT
(
šfo
->
d©a
 + info->
hmtx
 + 4*(
numOfLÚgHÜM‘rics
-1));

2313 ià(
ËáSideB—ršg
è*ËáSideB—ršg = 
	`‰SHORT
(
šfo
->
d©a
 + info->
hmtx
 + 4*
numOfLÚgHÜM‘rics
 + 2*(
glyph_šdex
 -‚umOfLongHorMetrics));

2315 
	}
}

2317 
STBTT_DEF
 
	$¡b‰_G‘K”nšgTabËL’gth
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
)

2319 
¡b‰_ušt8
 *
d©a
 = 
šfo
->d©¨+ info->
k”n
;

2322 ià(!
šfo
->
k”n
)

2324 ià(
	`‰USHORT
(
d©a
+2) < 1)

2326 ià(
	`‰USHORT
(
d©a
+8) != 1)

2329  
	`‰USHORT
(
d©a
+10);

2330 
	}
}

2332 
STBTT_DEF
 
	$¡b‰_G‘K”nšgTabË
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
¡b‰_k”nšg’Œy
* 
bË
, 
bË_Ëngth
)

2334 
¡b‰_ušt8
 *
d©a
 = 
šfo
->d©¨+ info->
k”n
;

2335 
k
, 
Ëngth
;

2338 ià(!
šfo
->
k”n
)

2340 ià(
	`‰USHORT
(
d©a
+2) < 1)

2342 ià(
	`‰USHORT
(
d©a
+8) != 1)

2345 
Ëngth
 = 
	`‰USHORT
(
d©a
+10);

2346 ià(
bË_Ëngth
 < 
Ëngth
)

2347 
Ëngth
 = 
bË_Ëngth
;

2349 
k
 = 0; k < 
Ëngth
; k++)

2351 
bË
[
k
].
glyph1
 = 
	`‰USHORT
(
d©a
+18+(k*6));

2352 
bË
[
k
].
glyph2
 = 
	`‰USHORT
(
d©a
+20+(k*6));

2353 
bË
[
k
].
advªû
 = 
	`‰SHORT
(
d©a
+22+(k*6));

2356  
Ëngth
;

2357 
	}
}

2359 
	$¡b‰__G‘GlyphK”nInfoAdvªû
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
glyph1
, 
glyph2
)

2361 
¡b‰_ušt8
 *
d©a
 = 
šfo
->d©¨+ info->
k”n
;

2362 
¡b‰_ušt32
 
ÃedË
, 
¡¿w
;

2363 
l
, 
r
, 
m
;

2366 ià(!
šfo
->
k”n
)

2368 ià(
	`‰USHORT
(
d©a
+2) < 1)

2370 ià(
	`‰USHORT
(
d©a
+8) != 1)

2373 
l
 = 0;

2374 
r
 = 
	`‰USHORT
(
d©a
+10) - 1;

2375 
ÃedË
 = 
glyph1
 << 16 | 
glyph2
;

2376 
l
 <ğ
r
) {

2377 
m
 = (
l
 + 
r
) >> 1;

2378 
¡¿w
 = 
	`‰ULONG
(
d©a
+18+(
m
*6));

2379 ià(
ÃedË
 < 
¡¿w
)

2380 
r
 = 
m
 - 1;

2381 ià(
ÃedË
 > 
¡¿w
)

2382 
l
 = 
m
 + 1;

2384  
	`‰SHORT
(
d©a
+22+(
m
*6));

2387 
	}
}

2389 
¡b‰_št32
 
	$¡b‰__G‘Cov”ageIndex
(
¡b‰_ušt8
 *
cov”ageTabË
, 
glyph
)

2391 
¡b‰_ušt16
 
cov”ageFÜm©
 = 
	`‰USHORT
(
cov”ageTabË
);

2392 
cov”ageFÜm©
) {

2394 
¡b‰_ušt16
 
glyphCouÁ
 = 
	`‰USHORT
(
cov”ageTabË
 + 2);

2397 
¡b‰_št32
 
l
=0, 
r
=
glyphCouÁ
-1, 
m
;

2398 
¡¿w
, 
ÃedË
=
glyph
;

2399 
l
 <ğ
r
) {

2400 
¡b‰_ušt8
 *
glyphA¼ay
 = 
cov”ageTabË
 + 4;

2401 
¡b‰_ušt16
 
glyphID
;

2402 
m
 = (
l
 + 
r
) >> 1;

2403 
glyphID
 = 
	`‰USHORT
(
glyphA¼ay
 + 2 * 
m
);

2404 
¡¿w
 = 
glyphID
;

2405 ià(
ÃedË
 < 
¡¿w
)

2406 
r
 = 
m
 - 1;

2407 ià(
ÃedË
 > 
¡¿w
)

2408 
l
 = 
m
 + 1;

2410  
m
;

2417 
¡b‰_ušt16
 
¿ngeCouÁ
 = 
	`‰USHORT
(
cov”ageTabË
 + 2);

2418 
¡b‰_ušt8
 *
¿ngeA¼ay
 = 
cov”ageTabË
 + 4;

2421 
¡b‰_št32
 
l
=0, 
r
=
¿ngeCouÁ
-1, 
m
;

2422 
¡¿wS¹
, 
¡¿wEnd
, 
ÃedË
=
glyph
;

2423 
l
 <ğ
r
) {

2424 
¡b‰_ušt8
 *
¿ngeRecÜd
;

2425 
m
 = (
l
 + 
r
) >> 1;

2426 
¿ngeRecÜd
 = 
¿ngeA¼ay
 + 6 * 
m
;

2427 
¡¿wS¹
 = 
	`‰USHORT
(
¿ngeRecÜd
);

2428 
¡¿wEnd
 = 
	`‰USHORT
(
¿ngeRecÜd
 + 2);

2429 ià(
ÃedË
 < 
¡¿wS¹
)

2430 
r
 = 
m
 - 1;

2431 ià(
ÃedË
 > 
¡¿wEnd
)

2432 
l
 = 
m
 + 1;

2434 
¡b‰_ušt16
 
¡¬tCov”ageIndex
 = 
	`‰USHORT
(
¿ngeRecÜd
 + 4);

2435  
¡¬tCov”ageIndex
 + 
glyph
 - 
¡¿wS¹
;

2445 
	}
}

2447 
¡b‰_št32
 
	$¡b‰__G‘GlyphCÏss
(
¡b‰_ušt8
 *
şassDefTabË
, 
glyph
)

2449 
¡b‰_ušt16
 
şassDefFÜm©
 = 
	`‰USHORT
(
şassDefTabË
);

2450 
şassDefFÜm©
)

2453 
¡b‰_ušt16
 
¡¬tGlyphID
 = 
	`‰USHORT
(
şassDefTabË
 + 2);

2454 
¡b‰_ušt16
 
glyphCouÁ
 = 
	`‰USHORT
(
şassDefTabË
 + 4);

2455 
¡b‰_ušt8
 *
şassDef1V®ueA¼ay
 = 
şassDefTabË
 + 6;

2457 ià(
glyph
 >ğ
¡¬tGlyphID
 && glyph < s¹GlyphID + 
glyphCouÁ
)

2458  (
¡b‰_št32
)
	`‰USHORT
(
şassDef1V®ueA¼ay
 + 2 * (
glyph
 - 
¡¬tGlyphID
));

2463 
¡b‰_ušt16
 
şassRªgeCouÁ
 = 
	`‰USHORT
(
şassDefTabË
 + 2);

2464 
¡b‰_ušt8
 *
şassRªgeRecÜds
 = 
şassDefTabË
 + 4;

2467 
¡b‰_št32
 
l
=0, 
r
=
şassRªgeCouÁ
-1, 
m
;

2468 
¡¿wS¹
, 
¡¿wEnd
, 
ÃedË
=
glyph
;

2469 
l
 <ğ
r
) {

2470 
¡b‰_ušt8
 *
şassRªgeRecÜd
;

2471 
m
 = (
l
 + 
r
) >> 1;

2472 
şassRªgeRecÜd
 = 
şassRªgeRecÜds
 + 6 * 
m
;

2473 
¡¿wS¹
 = 
	`‰USHORT
(
şassRªgeRecÜd
);

2474 
¡¿wEnd
 = 
	`‰USHORT
(
şassRªgeRecÜd
 + 2);

2475 ià(
ÃedË
 < 
¡¿wS¹
)

2476 
r
 = 
m
 - 1;

2477 ià(
ÃedË
 > 
¡¿wEnd
)

2478 
l
 = 
m
 + 1;

2480  (
¡b‰_št32
)
	`‰USHORT
(
şassRªgeRecÜd
 + 4);

2491 
	}
}

2494 
	#STBTT_GPOS_TODO_as£¹
(
x
)

	)

2496 
¡b‰_št32
 
	$¡b‰__G‘GlyphGPOSInfoAdvªû
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
glyph1
, 
glyph2
)

2498 
¡b‰_ušt16
 
lookupLi¡Off£t
;

2499 
¡b‰_ušt8
 *
lookupLi¡
;

2500 
¡b‰_ušt16
 
lookupCouÁ
;

2501 
¡b‰_ušt8
 *
d©a
;

2502 
¡b‰_št32
 
i
, 
¡i
;

2504 ià(!
šfo
->
gpos
)  0;

2506 
d©a
 = 
šfo
->d©¨+ info->
gpos
;

2508 ià(
	`‰USHORT
(
d©a
+0) != 1)  0;

2509 ià(
	`‰USHORT
(
d©a
+2) != 0)  0;

2511 
lookupLi¡Off£t
 = 
	`‰USHORT
(
d©a
+8);

2512 
lookupLi¡
 = 
d©a
 + 
lookupLi¡Off£t
;

2513 
lookupCouÁ
 = 
	`‰USHORT
(
lookupLi¡
);

2515 
i
=0; i<
lookupCouÁ
; ++i) {

2516 
¡b‰_ušt16
 
lookupOff£t
 = 
	`‰USHORT
(
lookupLi¡
 + 2 + 2 * 
i
);

2517 
¡b‰_ušt8
 *
lookupTabË
 = 
lookupLi¡
 + 
lookupOff£t
;

2519 
¡b‰_ušt16
 
lookupTy³
 = 
	`‰USHORT
(
lookupTabË
);

2520 
¡b‰_ušt16
 
subTabËCouÁ
 = 
	`‰USHORT
(
lookupTabË
 + 4);

2521 
¡b‰_ušt8
 *
subTabËOff£ts
 = 
lookupTabË
 + 6;

2522 ià(
lookupTy³
 != 2)

2525 
¡i
=0; sti<
subTabËCouÁ
; sti++) {

2526 
¡b‰_ušt16
 
subbËOff£t
 = 
	`‰USHORT
(
subTabËOff£ts
 + 2 * 
¡i
);

2527 
¡b‰_ušt8
 *
bË
 = 
lookupTabË
 + 
subbËOff£t
;

2528 
¡b‰_ušt16
 
posFÜm©
 = 
	`‰USHORT
(
bË
);

2529 
¡b‰_ušt16
 
cov”ageOff£t
 = 
	`‰USHORT
(
bË
 + 2);

2530 
¡b‰_št32
 
cov”ageIndex
 = 
	`¡b‰__G‘Cov”ageIndex
(
bË
 + 
cov”ageOff£t
, 
glyph1
);

2531 ià(
cov”ageIndex
 == -1) ;

2533 
posFÜm©
) {

2535 
¡b‰_št32
 
l
, 
r
, 
m
;

2536 
¡¿w
, 
ÃedË
;

2537 
¡b‰_ušt16
 
v®ueFÜm©1
 = 
	`‰USHORT
(
bË
 + 4);

2538 
¡b‰_ušt16
 
v®ueFÜm©2
 = 
	`‰USHORT
(
bË
 + 6);

2539 ià(
v®ueFÜm©1
 =ğ4 && 
v®ueFÜm©2
 == 0) {

2540 
¡b‰_št32
 
v®ueRecÜdPaœSizeInBy‹s
 = 2;

2541 
¡b‰_ušt16
 
·œS‘CouÁ
 = 
	`‰USHORT
(
bË
 + 8);

2542 
¡b‰_ušt16
 
·œPosOff£t
 = 
	`‰USHORT
(
bË
 + 10 + 2 * 
cov”ageIndex
);

2543 
¡b‰_ušt8
 *
·œV®ueTabË
 = 
bË
 + 
·œPosOff£t
;

2544 
¡b‰_ušt16
 
·œV®ueCouÁ
 = 
	`‰USHORT
(
·œV®ueTabË
);

2545 
¡b‰_ušt8
 *
·œV®ueA¼ay
 = 
·œV®ueTabË
 + 2;

2547 ià(
cov”ageIndex
 >ğ
·œS‘CouÁ
)  0;

2549 
ÃedË
=
glyph2
;

2550 
r
=
·œV®ueCouÁ
-1;

2551 
l
=0;

2554 
l
 <ğ
r
) {

2555 
¡b‰_ušt16
 
£cÚdGlyph
;

2556 
¡b‰_ušt8
 *
·œV®ue
;

2557 
m
 = (
l
 + 
r
) >> 1;

2558 
·œV®ue
 = 
·œV®ueA¼ay
 + (2 + 
v®ueRecÜdPaœSizeInBy‹s
è* 
m
;

2559 
£cÚdGlyph
 = 
	`‰USHORT
(
·œV®ue
);

2560 
¡¿w
 = 
£cÚdGlyph
;

2561 ià(
ÃedË
 < 
¡¿w
)

2562 
r
 = 
m
 - 1;

2563 ià(
ÃedË
 > 
¡¿w
)

2564 
l
 = 
m
 + 1;

2566 
¡b‰_št16
 
xAdvªû
 = 
	`‰SHORT
(
·œV®ue
 + 2);

2567  
xAdvªû
;

2576 
¡b‰_ušt16
 
v®ueFÜm©1
 = 
	`‰USHORT
(
bË
 + 4);

2577 
¡b‰_ušt16
 
v®ueFÜm©2
 = 
	`‰USHORT
(
bË
 + 6);

2578 ià(
v®ueFÜm©1
 =ğ4 && 
v®ueFÜm©2
 == 0) {

2579 
¡b‰_ušt16
 
şassDef1Off£t
 = 
	`‰USHORT
(
bË
 + 8);

2580 
¡b‰_ušt16
 
şassDef2Off£t
 = 
	`‰USHORT
(
bË
 + 10);

2581 
glyph1şass
 = 
	`¡b‰__G‘GlyphCÏss
(
bË
 + 
şassDef1Off£t
, 
glyph1
);

2582 
glyph2şass
 = 
	`¡b‰__G‘GlyphCÏss
(
bË
 + 
şassDef2Off£t
, 
glyph2
);

2584 
¡b‰_ušt16
 
şass1CouÁ
 = 
	`‰USHORT
(
bË
 + 12);

2585 
¡b‰_ušt16
 
şass2CouÁ
 = 
	`‰USHORT
(
bË
 + 14);

2586 
¡b‰_ušt8
 *
şass1RecÜds
, *
şass2RecÜds
;

2587 
¡b‰_št16
 
xAdvªû
;

2589 ià(
glyph1şass
 < 0 || glyph1şas >ğ
şass1CouÁ
)  0;

2590 ià(
glyph2şass
 < 0 || glyph2şas >ğ
şass2CouÁ
)  0;

2592 
şass1RecÜds
 = 
bË
 + 16;

2593 
şass2RecÜds
 = 
şass1RecÜds
 + 2 * (
glyph1şass
 * 
şass2CouÁ
);

2594 
xAdvªû
 = 
	`‰SHORT
(
şass2RecÜds
 + 2 * 
glyph2şass
);

2595  
xAdvªû
;

2608 
	}
}

2610 
STBTT_DEF
 
	$¡b‰_G‘GlyphK”nAdvªû
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
g1
, 
g2
)

2612 
xAdvªû
 = 0;

2614 ià(
šfo
->
gpos
)

2615 
xAdvªû
 +ğ
	`¡b‰__G‘GlyphGPOSInfoAdvªû
(
šfo
, 
g1
, 
g2
);

2616 ià(
šfo
->
k”n
)

2617 
xAdvªû
 +ğ
	`¡b‰__G‘GlyphK”nInfoAdvªû
(
šfo
, 
g1
, 
g2
);

2619  
xAdvªû
;

2620 
	}
}

2622 
STBTT_DEF
 
	$¡b‰_G‘Cod•oštK”nAdvªû
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
ch1
, 
ch2
)

2624 ià(!
šfo
->
k”n
 && !šfo->
gpos
)

2626  
	`¡b‰_G‘GlyphK”nAdvªû
(
šfo
, 
	`¡b‰_FšdGlyphIndex
(šfo,
ch1
), stb‰_FšdGlyphIndex(šfo,
ch2
));

2627 
	}
}

2629 
STBTT_DEF
 
	$¡b‰_G‘Cod•oštHM‘rics
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
cod•ošt
, *
advªûWidth
, *
ËáSideB—ršg
)

2631 
	`¡b‰_G‘GlyphHM‘rics
(
šfo
, 
	`¡b‰_FšdGlyphIndex
(šfo,
cod•ošt
), 
advªûWidth
, 
ËáSideB—ršg
);

2632 
	}
}

2634 
STBTT_DEF
 
	$¡b‰_G‘FÚtVM‘rics
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, *
asûÁ
, *
desûÁ
, *
lšeG­
)

2636 ià(
asûÁ
 ) *asûÁ = 
	`‰SHORT
(
šfo
->
d©a
+šfo->
hh—
 + 4);

2637 ià(
desûÁ
è*desûÁ = 
	`‰SHORT
(
šfo
->
d©a
+šfo->
hh—
 + 6);

2638 ià(
lšeG­
è*lšeG­ = 
	`‰SHORT
(
šfo
->
d©a
+šfo->
hh—
 + 8);

2639 
	}
}

2641 
STBTT_DEF
 
	$¡b‰_G‘FÚtVM‘ricsOS2
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, *
typoAsûÁ
, *
typoDesûÁ
, *
typoLšeG­
)

2643 
b
 = 
	`¡b‰__fšd_bË
(
šfo
->
d©a
, info->
fÚt¡¬t
, "OS/2");

2644 ià(!
b
)

2646 ià(
typoAsûÁ
 ) *typoAsûÁ = 
	`‰SHORT
(
šfo
->
d©a
+
b
 + 68);

2647 ià(
typoDesûÁ
è*typoDesûÁ = 
	`‰SHORT
(
šfo
->
d©a
+
b
 + 70);

2648 ià(
typoLšeG­
è*typoLšeG­ = 
	`‰SHORT
(
šfo
->
d©a
+
b
 + 72);

2650 
	}
}

2652 
STBTT_DEF
 
	$¡b‰_G‘FÚtBoundšgBox
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, *
x0
, *
y0
, *
x1
, *
y1
)

2654 *
x0
 = 
	`‰SHORT
(
šfo
->
d©a
 + info->
h—d
 + 36);

2655 *
y0
 = 
	`‰SHORT
(
šfo
->
d©a
 + info->
h—d
 + 38);

2656 *
x1
 = 
	`‰SHORT
(
šfo
->
d©a
 + info->
h—d
 + 40);

2657 *
y1
 = 
	`‰SHORT
(
šfo
->
d©a
 + info->
h—d
 + 42);

2658 
	}
}

2660 
STBTT_DEF
 
	$¡b‰_SÿËFÜPix–Height
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
height
)

2662 
fheight
 = 
	`‰SHORT
(
šfo
->
d©a
 + info->
hh—
 + 4) -tSHORT(info->data + info->hhea + 6);

2663  (è
height
 / 
fheight
;

2664 
	}
}

2666 
STBTT_DEF
 
	$¡b‰_SÿËFÜM­pšgEmToPix–s
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
pix–s
)

2668 
un™sP”Em
 = 
	`‰USHORT
(
šfo
->
d©a
 + info->
h—d
 + 18);

2669  
pix–s
 / 
un™sP”Em
;

2670 
	}
}

2672 
STBTT_DEF
 
	$¡b‰_F»eSh­e
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
¡b‰_v”‹x
 *
v
)

2674 
	`STBTT_ä“
(
v
, 
šfo
->
u£rd©a
);

2675 
	}
}

2677 
STBTT_DEF
 
¡b‰_ušt8
 *
	$¡b‰_FšdSVGDoc
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
gl
)

2679 
i
;

2680 
¡b‰_ušt8
 *
d©a
 = 
šfo
->data;

2681 
¡b‰_ušt8
 *
svg_doc_li¡
 = 
d©a
 + 
	`¡b‰__g‘_svg
((
¡b‰_fÚtšfo
 *è
šfo
);

2683 
numEÁr›s
 = 
	`‰USHORT
(
svg_doc_li¡
);

2684 
¡b‰_ušt8
 *
svg_docs
 = 
svg_doc_li¡
 + 2;

2686 
i
=0; i<
numEÁr›s
; i++) {

2687 
¡b‰_ušt8
 *
svg_doc
 = 
svg_docs
 + (12 * 
i
);

2688 ià((
gl
 >ğ
	`‰USHORT
(
svg_doc
)) && (gl <=tUSHORT(svg_doc + 2)))

2689  
svg_doc
;

2692 
	}
}

2694 
STBTT_DEF
 
	$¡b‰_G‘GlyphSVG
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
gl
, cÚ¡ **
svg
)

2696 
¡b‰_ušt8
 *
d©a
 = 
šfo
->data;

2697 
¡b‰_ušt8
 *
svg_doc
;

2699 ià(
šfo
->
svg
 == 0)

2702 
svg_doc
 = 
	`¡b‰_FšdSVGDoc
(
šfo
, 
gl
);

2703 ià(
svg_doc
 !ğ
NULL
) {

2704 *
svg
 = (*è
d©a
 + 
šfo
->svg + 
	`‰ULONG
(
svg_doc
 + 4);

2705  
	`‰ULONG
(
svg_doc
 + 8);

2709 
	}
}

2711 
STBTT_DEF
 
	$¡b‰_G‘Cod•oštSVG
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
unicode_cod•ošt
, cÚ¡ **
svg
)

2713  
	`¡b‰_G‘GlyphSVG
(
šfo
, 
	`¡b‰_FšdGlyphIndex
(šfo, 
unicode_cod•ošt
), 
svg
);

2714 
	}
}

2721 
STBTT_DEF
 
	$¡b‰_G‘GlyphB™m­BoxSubpix–
(cÚ¡ 
¡b‰_fÚtšfo
 *
fÚt
, 
glyph
, 
sÿË_x
, 
sÿË_y
,
shiá_x
, 
shiá_y
, *
ix0
, *
iy0
, *
ix1
, *
iy1
)

2723 
x0
=0,
y0
=0,
x1
,
y1
;

2724 ià(!
	`¡b‰_G‘GlyphBox
(
fÚt
, 
glyph
, &
x0
,&
y0
,&
x1
,&
y1
)) {

2726 ià(
ix0
) *ix0 = 0;

2727 ià(
iy0
) *iy0 = 0;

2728 ià(
ix1
) *ix1 = 0;

2729 ià(
iy1
) *iy1 = 0;

2732 ià(
ix0
è*ix0 = 
	`STBTT_iæoÜ
Ğ
x0
 * 
sÿË_x
 + 
shiá_x
);

2733 ià(
iy0
è*iy0 = 
	`STBTT_iæoÜ
(-
y1
 * 
sÿË_y
 + 
shiá_y
);

2734 ià(
ix1
è*ix1 = 
	`STBTT_iû
 ( 
x1
 * 
sÿË_x
 + 
shiá_x
);

2735 ià(
iy1
è*iy1 = 
	`STBTT_iû
 (-
y0
 * 
sÿË_y
 + 
shiá_y
);

2737 
	}
}

2739 
STBTT_DEF
 
	$¡b‰_G‘GlyphB™m­Box
(cÚ¡ 
¡b‰_fÚtšfo
 *
fÚt
, 
glyph
, 
sÿË_x
, 
sÿË_y
, *
ix0
, *
iy0
, *
ix1
, *
iy1
)

2741 
	`¡b‰_G‘GlyphB™m­BoxSubpix–
(
fÚt
, 
glyph
, 
sÿË_x
, 
sÿË_y
,0.0f,0.0f, 
ix0
, 
iy0
, 
ix1
, 
iy1
);

2742 
	}
}

2744 
STBTT_DEF
 
	$¡b‰_G‘Cod•oštB™m­BoxSubpix–
(cÚ¡ 
¡b‰_fÚtšfo
 *
fÚt
, 
cod•ošt
, 
sÿË_x
, 
sÿË_y
, 
shiá_x
, 
shiá_y
, *
ix0
, *
iy0
, *
ix1
, *
iy1
)

2746 
	`¡b‰_G‘GlyphB™m­BoxSubpix–
(
fÚt
, 
	`¡b‰_FšdGlyphIndex
(fÚt,
cod•ošt
), 
sÿË_x
, 
sÿË_y
,
shiá_x
,
shiá_y
, 
ix0
,
iy0
,
ix1
,
iy1
);

2747 
	}
}

2749 
STBTT_DEF
 
	$¡b‰_G‘Cod•oštB™m­Box
(cÚ¡ 
¡b‰_fÚtšfo
 *
fÚt
, 
cod•ošt
, 
sÿË_x
, 
sÿË_y
, *
ix0
, *
iy0
, *
ix1
, *
iy1
)

2751 
	`¡b‰_G‘Cod•oštB™m­BoxSubpix–
(
fÚt
, 
cod•ošt
, 
sÿË_x
, 
sÿË_y
,0.0f,0.0f, 
ix0
,
iy0
,
ix1
,
iy1
);

2752 
	}
}

2758 
	s¡b‰__hh—p_chunk


2760 
¡b‰__hh—p_chunk
 *
	mÃxt
;

2761 } 
	t¡b‰__hh—p_chunk
;

2763 
	s¡b‰__hh—p


2765 
¡b‰__hh—p_chunk
 *
	mh—d
;

2766 *
	mfœ¡_ä“
;

2767 
	mnum_»maššg_š_h—d_chunk
;

2768 } 
	t¡b‰__hh—p
;

2770 *
	$¡b‰__hh—p_®loc
(
¡b‰__hh—p
 *
hh
, 
size_t
 
size
, *
u£rd©a
)

2772 ià(
hh
->
fœ¡_ä“
) {

2773 *
p
 = 
hh
->
fœ¡_ä“
;

2774 
hh
->
fœ¡_ä“
 = * (**è
p
;

2775  
p
;

2777 ià(
hh
->
num_»maššg_š_h—d_chunk
 == 0) {

2778 
couÁ
 = (
size
 < 32 ? 2000 : size < 128 ? 800 : 100);

2779 
¡b‰__hh—p_chunk
 *
c
 = (¡b‰__hh—p_chunk *è
	`STBTT_m®loc
((¡b‰__hh—p_chunkè+ 
size
 * 
couÁ
, 
u£rd©a
);

2780 ià(
c
 =ğ
NULL
)

2781  
NULL
;

2782 
c
->
Ãxt
 = 
hh
->
h—d
;

2783 
hh
->
h—d
 = 
c
;

2784 
hh
->
num_»maššg_š_h—d_chunk
 = 
couÁ
;

2786 --
hh
->
num_»maššg_š_h—d_chunk
;

2787  (*è(
hh
->
h—d
è+ (
¡b‰__hh—p_chunk
è+ 
size
 * hh->
num_»maššg_š_h—d_chunk
;

2789 
	}
}

2791 
	$¡b‰__hh—p_ä“
(
¡b‰__hh—p
 *
hh
, *
p
)

2793 *(**è
p
 = 
hh
->
fœ¡_ä“
;

2794 
hh
->
fœ¡_ä“
 = 
p
;

2795 
	}
}

2797 
	$¡b‰__hh—p_ş—nup
(
¡b‰__hh—p
 *
hh
, *
u£rd©a
)

2799 
¡b‰__hh—p_chunk
 *
c
 = 
hh
->
h—d
;

2800 
c
) {

2801 
¡b‰__hh—p_chunk
 *
n
 = 
c
->
Ãxt
;

2802 
	`STBTT_ä“
(
c
, 
u£rd©a
);

2803 
c
 = 
n
;

2805 
	}
}

2807 
	s¡b‰__edge
 {

2808 
	mx0
,
	my0
, 
	mx1
,
	my1
;

2809 
	mšv”t
;

2810 } 
	t¡b‰__edge
;

2813 
	s¡b‰__aùive_edge


2815 
¡b‰__aùive_edge
 *
	mÃxt
;

2816 #ià
STBTT_RASTERIZER_VERSION
==1

2817 
	mx
,
	mdx
;

2818 
	mey
;

2819 
	mdœeùiÚ
;

2820 #–ià
STBTT_RASTERIZER_VERSION
==2

2821 
	mfx
,
	mfdx
,
	mfdy
;

2822 
	mdœeùiÚ
;

2823 
	msy
;

2824 
	mey
;

2828 } 
	t¡b‰__aùive_edge
;

2830 #ià
STBTT_RASTERIZER_VERSION
 == 1

2831 
	#STBTT_FIXSHIFT
 10

	)

2832 
	#STBTT_FIX
 (1 << 
STBTT_FIXSHIFT
)

	)

2833 
	#STBTT_FIXMASK
 (
STBTT_FIX
-1)

	)

2835 
¡b‰__aùive_edge
 *
	$¡b‰__Ãw_aùive
(
¡b‰__hh—p
 *
hh
, 
¡b‰__edge
 *
e
, 
off_x
, 
¡¬t_pošt
, *
u£rd©a
)

2837 
¡b‰__aùive_edge
 *
z
 = (¡b‰__aùive_edg*è
	`¡b‰__hh—p_®loc
(
hh
, (*z), 
u£rd©a
);

2838 
dxdy
 = (
e
->
x1
 -ƒ->
x0
è/ (e->
y1
 -ƒ->
y0
);

2839 
	`STBTT_as£¹
(
z
 !ğ
NULL
);

2840 ià(!
z
)  z;

2843 ià(
dxdy
 < 0)

2844 
z
->
dx
 = -
	`STBTT_iæoÜ
(
STBTT_FIX
 * -
dxdy
);

2846 
z
->
dx
 = 
	`STBTT_iæoÜ
(
STBTT_FIX
 * 
dxdy
);

2848 
z
->
x
 = 
	`STBTT_iæoÜ
(
STBTT_FIX
 * 
e
->
x0
 + z->
dx
 * (
¡¬t_pošt
 -ƒ->
y0
));

2849 
z
->
x
 -ğ
off_x
 * 
STBTT_FIX
;

2851 
z
->
ey
 = 
e
->
y1
;

2852 
z
->
Ãxt
 = 0;

2853 
z
->
dœeùiÚ
 = 
e
->
šv”t
 ? 1 : -1;

2854  
z
;

2855 
	}
}

2856 #–ià
STBTT_RASTERIZER_VERSION
 == 2

2857 
¡b‰__aùive_edge
 *
	$¡b‰__Ãw_aùive
(
¡b‰__hh—p
 *
hh
, 
¡b‰__edge
 *
e
, 
off_x
, 
¡¬t_pošt
, *
u£rd©a
)

2859 
¡b‰__aùive_edge
 *
z
 = (¡b‰__aùive_edg*è
	`¡b‰__hh—p_®loc
(
hh
, (*z), 
u£rd©a
);

2860 
dxdy
 = (
e
->
x1
 -ƒ->
x0
è/ (e->
y1
 -ƒ->
y0
);

2861 
	`STBTT_as£¹
(
z
 !ğ
NULL
);

2863 ià(!
z
)  z;

2864 
z
->
fdx
 = 
dxdy
;

2865 
z
->
fdy
 = 
dxdy
 != 0.0f ? (1.0f/dxdy) : 0.0f;

2866 
z
->
fx
 = 
e
->
x0
 + 
dxdy
 * (
¡¬t_pošt
 -ƒ->
y0
);

2867 
z
->
fx
 -ğ
off_x
;

2868 
z
->
dœeùiÚ
 = 
e
->
šv”t
 ? 1.0f : -1.0f;

2869 
z
->
sy
 = 
e
->
y0
;

2870 
z
->
ey
 = 
e
->
y1
;

2871 
z
->
Ãxt
 = 0;

2872  
z
;

2873 
	}
}

2878 #ià
STBTT_RASTERIZER_VERSION
 == 1

2882 
	$¡b‰__fl_aùive_edges
(*
sÿÆše
, 
Ën
, 
¡b‰__aùive_edge
 *
e
, 
max_weight
)

2885 
x0
=0, 
w
=0;

2887 
e
) {

2888 ià(
w
 == 0) {

2890 
x0
 = 
e
->
x
; 
w
 +ğe->
dœeùiÚ
;

2892 
x1
 = 
e
->
x
; 
w
 +ğe->
dœeùiÚ
;

2894 ià(
w
 == 0) {

2895 
i
 = 
x0
 >> 
STBTT_FIXSHIFT
;

2896 
j
 = 
x1
 >> 
STBTT_FIXSHIFT
;

2898 ià(
i
 < 
Ën
 && 
j
 >= 0) {

2899 ià(
i
 =ğ
j
) {

2901 
sÿÆše
[
i
] = sÿÆše[i] + (
¡b‰_ušt8
è((
x1
 - 
x0
è* 
max_weight
 >> 
STBTT_FIXSHIFT
);

2903 ià(
i
 >= 0)

2904 
sÿÆše
[
i
] = sÿÆše[i] + (
¡b‰_ušt8
è(((
STBTT_FIX
 - (
x0
 & 
STBTT_FIXMASK
)è* 
max_weight
è>> 
STBTT_FIXSHIFT
);

2906 
i
 = -1;

2908 ià(
j
 < 
Ën
)

2909 
sÿÆše
[
j
] = sÿÆše[j] + (
¡b‰_ušt8
è(((
x1
 & 
STBTT_FIXMASK
è* 
max_weight
è>> 
STBTT_FIXSHIFT
);

2911 
j
 = 
Ën
;

2913 ++
i
; i < 
j
; ++i)

2914 
sÿÆše
[
i
] = sÿÆše[i] + (
¡b‰_ušt8
è
max_weight
;

2920 
e
 =ƒ->
Ãxt
;

2922 
	}
}

2924 
	$¡b‰__¿¡”ize_sÜ‹d_edges
(
¡b‰__b™m­
 *
»suÉ
, 
¡b‰__edge
 *
e
, 
n
, 
vsub§m¶e
, 
off_x
, 
off_y
, *
u£rd©a
)

2926 
¡b‰__hh—p
 
hh
 = { 0, 0, 0 };

2927 
¡b‰__aùive_edge
 *
aùive
 = 
NULL
;

2928 
y
,
j
=0;

2929 
max_weight
 = (255 / 
vsub§m¶e
);

2930 
s
;

2931 
sÿÆše_d©a
[512], *
sÿÆše
;

2933 ià(
»suÉ
->
w
 > 512)

2934 
sÿÆše
 = (*è
	`STBTT_m®loc
(
»suÉ
->
w
, 
u£rd©a
);

2936 
sÿÆše
 = 
sÿÆše_d©a
;

2938 
y
 = 
off_y
 * 
vsub§m¶e
;

2939 
e
[
n
].
y0
 = (
off_y
 + 
»suÉ
->
h
è* (è
vsub§m¶e
 + 1;

2941 
j
 < 
»suÉ
->
h
) {

2942 
	`STBTT_mem£t
(
sÿÆše
, 0, 
»suÉ
->
w
);

2943 
s
=0; s < 
vsub§m¶e
; ++s) {

2945 
sÿn_y
 = 
y
 + 0.5f;

2946 
¡b‰__aùive_edge
 **
¡•
 = &
aùive
;

2950 *
¡•
) {

2951 
¡b‰__aùive_edge
 * 
z
 = *
¡•
;

2952 ià(
z
->
ey
 <ğ
sÿn_y
) {

2953 *
¡•
 = 
z
->
Ãxt
;

2954 
	`STBTT_as£¹
(
z
->
dœeùiÚ
);

2955 
z
->
dœeùiÚ
 = 0;

2956 
	`¡b‰__hh—p_ä“
(&
hh
, 
z
);

2958 
z
->
x
 +ğz->
dx
;

2959 
¡•
 = &((*¡•)->
Ãxt
);

2965 
chªged
=0;

2966 
¡•
 = &
aùive
;

2967 *
¡•
 && (*¡•)->
Ãxt
) {

2968 ià((*
¡•
)->
x
 > (*¡•)->
Ãxt
->x) {

2969 
¡b‰__aùive_edge
 *
t
 = *
¡•
;

2970 
¡b‰__aùive_edge
 *
q
 = 
t
->
Ãxt
;

2972 
t
->
Ãxt
 = 
q
->next;

2973 
q
->
Ãxt
 = 
t
;

2974 *
¡•
 = 
q
;

2975 
chªged
 = 1;

2977 
¡•
 = &(*¡•)->
Ãxt
;

2979 ià(!
chªged
) ;

2983 
e
->
y0
 <ğ
sÿn_y
) {

2984 ià(
e
->
y1
 > 
sÿn_y
) {

2985 
¡b‰__aùive_edge
 *
z
 = 
	`¡b‰__Ãw_aùive
(&
hh
, 
e
, 
off_x
, 
sÿn_y
, 
u£rd©a
);

2986 ià(
z
 !ğ
NULL
) {

2988 ià(
aùive
 =ğ
NULL
)

2989 
aùive
 = 
z
;

2990 ià(
z
->
x
 < 
aùive
->x) {

2992 
z
->
Ãxt
 = 
aùive
;

2993 
aùive
 = 
z
;

2996 
¡b‰__aùive_edge
 *
p
 = 
aùive
;

2997 
p
->
Ãxt
 &&…->Ãxt->
x
 < 
z
->x)

2998 
p
 =…->
Ãxt
;

3000 
z
->
Ãxt
 = 
p
->next;

3001 
p
->
Ãxt
 = 
z
;

3005 ++
e
;

3009 ià(
aùive
)

3010 
	`¡b‰__fl_aùive_edges
(
sÿÆše
, 
»suÉ
->
w
, 
aùive
, 
max_weight
);

3012 ++
y
;

3014 
	`STBTT_memıy
(
»suÉ
->
pix–s
 + 
j
 *„esuÉ->
¡ride
, 
sÿÆše
,„esuÉ->
w
);

3015 ++
j
;

3018 
	`¡b‰__hh—p_ş—nup
(&
hh
, 
u£rd©a
);

3020 ià(
sÿÆše
 !ğ
sÿÆše_d©a
)

3021 
	`STBTT_ä“
(
sÿÆše
, 
u£rd©a
);

3022 
	}
}

3024 #–ià
STBTT_RASTERIZER_VERSION
 == 2

3028 
	$¡b‰__hªdË_ş³d_edge
(*
sÿÆše
, 
x
, 
¡b‰__aùive_edge
 *
e
, 
x0
, 
y0
, 
x1
, 
y1
)

3030 ià(
y0
 =ğ
y1
) ;

3031 
	`STBTT_as£¹
(
y0
 < 
y1
);

3032 
	`STBTT_as£¹
(
e
->
sy
 <ğe->
ey
);

3033 ià(
y0
 > 
e
->
ey
) ;

3034 ià(
y1
 < 
e
->
sy
) ;

3035 ià(
y0
 < 
e
->
sy
) {

3036 
x0
 +ğ(
x1
-x0è* (
e
->
sy
 - 
y0
è/ (
y1
-y0);

3037 
y0
 = 
e
->
sy
;

3039 ià(
y1
 > 
e
->
ey
) {

3040 
x1
 +ğ(x1-
x0
è* (
e
->
ey
 - 
y1
è/ (y1-
y0
);

3041 
y1
 = 
e
->
ey
;

3044 ià(
x0
 =ğ
x
)

3045 
	`STBTT_as£¹
(
x1
 <ğ
x
+1);

3046 ià(
x0
 =ğ
x
+1)

3047 
	`STBTT_as£¹
(
x1
 >ğ
x
);

3048 ià(
x0
 <ğ
x
)

3049 
	`STBTT_as£¹
(
x1
 <ğ
x
);

3050 ià(
x0
 >ğ
x
+1)

3051 
	`STBTT_as£¹
(
x1
 >ğ
x
+1);

3053 
	`STBTT_as£¹
(
x1
 >ğ
x
 && x1 <= x+1);

3055 ià(
x0
 <ğ
x
 && 
x1
 <= x)

3056 
sÿÆše
[
x
] +ğ
e
->
dœeùiÚ
 * (
y1
-
y0
);

3057 ià(
x0
 >ğ
x
+1 && 
x1
 >= x+1)

3060 
	`STBTT_as£¹
(
x0
 >ğ
x
 && x0 <ğx+1 && 
x1
 >= x && x1 <= x+1);

3061 
sÿÆše
[
x
] +ğ
e
->
dœeùiÚ
 * (
y1
-
y0
è* (1-((
x0
-x)+(
x1
-x))/2);

3063 
	}
}

3065 
	$¡b‰__sized_Œ­ezoid_¬—
(
height
, 
tİ_width
, 
bÙtom_width
)

3067 
	`STBTT_as£¹
(
tİ_width
 >= 0);

3068 
	`STBTT_as£¹
(
bÙtom_width
 >= 0);

3069  (
tİ_width
 + 
bÙtom_width
è/ 2.0à* 
height
;

3070 
	}
}

3072 
	$¡b‰__pos™iÚ_Œ­ezoid_¬—
(
height
, 
tx0
, 
tx1
, 
bx0
, 
bx1
)

3074  
	`¡b‰__sized_Œ­ezoid_¬—
(
height
, 
tx1
 - 
tx0
, 
bx1
 - 
bx0
);

3075 
	}
}

3077 
	$¡b‰__sized_ŒŸngË_¬—
(
height
, 
width
)

3079  
height
 * 
width
 / 2;

3080 
	}
}

3082 
	$¡b‰__fl_aùive_edges_Ãw
(*
sÿÆše
, *
sÿÆše_fl
, 
Ën
, 
¡b‰__aùive_edge
 *
e
, 
y_tİ
)

3084 
y_bÙtom
 = 
y_tİ
+1;

3086 
e
) {

3090 
	`STBTT_as£¹
(
e
->
ey
 >ğ
y_tİ
);

3092 ià(
e
->
fdx
 == 0) {

3093 
x0
 = 
e
->
fx
;

3094 ià(
x0
 < 
Ën
) {

3095 ià(
x0
 >= 0) {

3096 
	`¡b‰__hªdË_ş³d_edge
(
sÿÆše
,(è
x0
,
e
, x0,
y_tİ
, x0,
y_bÙtom
);

3097 
	`¡b‰__hªdË_ş³d_edge
(
sÿÆše_fl
-1,(è
x0
+1,
e
, x0,
y_tİ
, x0,
y_bÙtom
);

3099 
	`¡b‰__hªdË_ş³d_edge
(
sÿÆše_fl
-1,0,
e
, 
x0
,
y_tİ
, x0,
y_bÙtom
);

3103 
x0
 = 
e
->
fx
;

3104 
dx
 = 
e
->
fdx
;

3105 
xb
 = 
x0
 + 
dx
;

3106 
x_tİ
, 
x_bÙtom
;

3107 
sy0
,
sy1
;

3108 
dy
 = 
e
->
fdy
;

3109 
	`STBTT_as£¹
(
e
->
sy
 <ğ
y_bÙtom
 &&ƒ->
ey
 >ğ
y_tİ
);

3114 ià(
e
->
sy
 > 
y_tİ
) {

3115 
x_tİ
 = 
x0
 + 
dx
 * (
e
->
sy
 - 
y_tİ
);

3116 
sy0
 = 
e
->
sy
;

3118 
x_tİ
 = 
x0
;

3119 
sy0
 = 
y_tİ
;

3121 ià(
e
->
ey
 < 
y_bÙtom
) {

3122 
x_bÙtom
 = 
x0
 + 
dx
 * (
e
->
ey
 - 
y_tİ
);

3123 
sy1
 = 
e
->
ey
;

3125 
x_bÙtom
 = 
xb
;

3126 
sy1
 = 
y_bÙtom
;

3129 ià(
x_tİ
 >ğ0 && 
x_bÙtom
 >ğ0 && x_tİ < 
Ën
 && x_bottom <†en) {

3132 ià((è
x_tİ
 =ğ(è
x_bÙtom
) {

3133 
height
;

3135 
x
 = (è
x_tİ
;

3136 
height
 = (
sy1
 - 
sy0
è* 
e
->
dœeùiÚ
;

3137 
	`STBTT_as£¹
(
x
 >ğ0 && x < 
Ën
);

3138 
sÿÆše
[
x
] +ğ
	`¡b‰__pos™iÚ_Œ­ezoid_¬—
(
height
, 
x_tİ
, x+1.0f, 
x_bÙtom
, x+1.0f);

3139 
sÿÆše_fl
[
x
] +ğ
height
;

3141 
x
,
x1
,
x2
;

3142 
y_üossšg
, 
y_fš®
, 
¡•
, 
sign
, 
¬—
;

3144 ià(
x_tİ
 > 
x_bÙtom
) {

3146 
t
;

3147 
sy0
 = 
y_bÙtom
 - (sy0 - 
y_tİ
);

3148 
sy1
 = 
y_bÙtom
 - (sy1 - 
y_tİ
);

3149 
t
 = 
sy0
, sy0 = 
sy1
, sy1 =;

3150 
t
 = 
x_bÙtom
, x_bÙtom = 
x_tİ
, x_top =;

3151 
dx
 = -dx;

3152 
dy
 = -dy;

3153 
t
 = 
x0
, x0 = 
xb
, xb =;

3155 
	`STBTT_as£¹
(
dy
 >= 0);

3156 
	`STBTT_as£¹
(
dx
 >= 0);

3158 
x1
 = (è
x_tİ
;

3159 
x2
 = (è
x_bÙtom
;

3161 
y_üossšg
 = 
y_tİ
 + 
dy
 * (
x1
+1 - 
x0
);

3164 
y_fš®
 = 
y_tİ
 + 
dy
 * (
x2
 - 
x0
);

3185 ià(
y_üossšg
 > 
y_bÙtom
)

3186 
y_üossšg
 = 
y_bÙtom
;

3188 
sign
 = 
e
->
dœeùiÚ
;

3191 
¬—
 = 
sign
 * (
y_üossšg
-
sy0
);

3194 
sÿÆše
[
x1
] +ğ
	`¡b‰__sized_ŒŸngË_¬—
(
¬—
, x1+1 - 
x_tİ
);

3197 ià(
y_fš®
 > 
y_bÙtom
) {

3198 
y_fš®
 = 
y_bÙtom
;

3199 
dy
 = (
y_fš®
 - 
y_üossšg
 ) / (
x2
 - (
x1
+1));

3212 
¡•
 = 
sign
 * 
dy
 * 1;

3216 
x
 = 
x1
+1; x < 
x2
; ++x) {

3217 
sÿÆše
[
x
] +ğ
¬—
 + 
¡•
/2;

3218 
¬—
 +ğ
¡•
;

3220 
	`STBTT_as£¹
(
	`STBTT_çbs
(
¬—
) <= 1.01f);

3221 
	`STBTT_as£¹
(
sy1
 > 
y_fš®
-0.01f);

3225 
sÿÆše
[
x2
] +ğ
¬—
 + 
sign
 * 
	`¡b‰__pos™iÚ_Œ­ezoid_¬—
(
sy1
-
y_fš®
, (èx2, x2+1.0f, 
x_bÙtom
, x2+1.0f);

3228 
sÿÆše_fl
[
x2
] +ğ
sign
 * (
sy1
-
sy0
);

3238 
x
;

3239 
x
=0; x < 
Ën
; ++x) {

3254 
y0
 = 
y_tİ
;

3255 
x1
 = (è(
x
);

3256 
x2
 = (è(
x
+1);

3257 
x3
 = 
xb
;

3258 
y3
 = 
y_bÙtom
;

3263 
y1
 = (
x
 - 
x0
è/ 
dx
 + 
y_tİ
;

3264 
y2
 = (
x
+1 - 
x0
è/ 
dx
 + 
y_tİ
;

3266 ià(
x0
 < 
x1
 && 
x3
 > 
x2
) {

3267 
	`¡b‰__hªdË_ş³d_edge
(
sÿÆše
,
x
,
e
, 
x0
,
y0
, 
x1
,
y1
);

3268 
	`¡b‰__hªdË_ş³d_edge
(
sÿÆše
,
x
,
e
, 
x1
,
y1
, 
x2
,
y2
);

3269 
	`¡b‰__hªdË_ş³d_edge
(
sÿÆše
,
x
,
e
, 
x2
,
y2
, 
x3
,
y3
);

3270 } ià(
x3
 < 
x1
 && 
x0
 > 
x2
) {

3271 
	`¡b‰__hªdË_ş³d_edge
(
sÿÆše
,
x
,
e
, 
x0
,
y0
, 
x2
,
y2
);

3272 
	`¡b‰__hªdË_ş³d_edge
(
sÿÆše
,
x
,
e
, 
x2
,
y2
, 
x1
,
y1
);

3273 
	`¡b‰__hªdË_ş³d_edge
(
sÿÆše
,
x
,
e
, 
x1
,
y1
, 
x3
,
y3
);

3274 } ià(
x0
 < 
x1
 && 
x3
 > x1) {

3275 
	`¡b‰__hªdË_ş³d_edge
(
sÿÆše
,
x
,
e
, 
x0
,
y0
, 
x1
,
y1
);

3276 
	`¡b‰__hªdË_ş³d_edge
(
sÿÆše
,
x
,
e
, 
x1
,
y1
, 
x3
,
y3
);

3277 } ià(
x3
 < 
x1
 && 
x0
 > x1) {

3278 
	`¡b‰__hªdË_ş³d_edge
(
sÿÆše
,
x
,
e
, 
x0
,
y0
, 
x1
,
y1
);

3279 
	`¡b‰__hªdË_ş³d_edge
(
sÿÆše
,
x
,
e
, 
x1
,
y1
, 
x3
,
y3
);

3280 } ià(
x0
 < 
x2
 && 
x3
 > x2) {

3281 
	`¡b‰__hªdË_ş³d_edge
(
sÿÆše
,
x
,
e
, 
x0
,
y0
, 
x2
,
y2
);

3282 
	`¡b‰__hªdË_ş³d_edge
(
sÿÆše
,
x
,
e
, 
x2
,
y2
, 
x3
,
y3
);

3283 } ià(
x3
 < 
x2
 && 
x0
 > x2) {

3284 
	`¡b‰__hªdË_ş³d_edge
(
sÿÆše
,
x
,
e
, 
x0
,
y0
, 
x2
,
y2
);

3285 
	`¡b‰__hªdË_ş³d_edge
(
sÿÆše
,
x
,
e
, 
x2
,
y2
, 
x3
,
y3
);

3287 
	`¡b‰__hªdË_ş³d_edge
(
sÿÆše
,
x
,
e
, 
x0
,
y0
, 
x3
,
y3
);

3292 
e
 =ƒ->
Ãxt
;

3294 
	}
}

3297 
	$¡b‰__¿¡”ize_sÜ‹d_edges
(
¡b‰__b™m­
 *
»suÉ
, 
¡b‰__edge
 *
e
, 
n
, 
vsub§m¶e
, 
off_x
, 
off_y
, *
u£rd©a
)

3299 
¡b‰__hh—p
 
hh
 = { 0, 0, 0 };

3300 
¡b‰__aùive_edge
 *
aùive
 = 
NULL
;

3301 
y
,
j
=0, 
i
;

3302 
sÿÆše_d©a
[129], *
sÿÆše
, *
sÿÆše2
;

3304 
	`STBTT__NOTUSED
(
vsub§m¶e
);

3306 ià(
»suÉ
->
w
 > 64)

3307 
sÿÆše
 = (*è
	`STBTT_m®loc
((
»suÉ
->
w
*2+1è* (), 
u£rd©a
);

3309 
sÿÆše
 = 
sÿÆše_d©a
;

3311 
sÿÆše2
 = 
sÿÆše
 + 
»suÉ
->
w
;

3313 
y
 = 
off_y
;

3314 
e
[
n
].
y0
 = (è(
off_y
 + 
»suÉ
->
h
) + 1;

3316 
j
 < 
»suÉ
->
h
) {

3318 
sÿn_y_tİ
 = 
y
 + 0.0f;

3319 
sÿn_y_bÙtom
 = 
y
 + 1.0f;

3320 
¡b‰__aùive_edge
 **
¡•
 = &
aùive
;

3322 
	`STBTT_mem£t
(
sÿÆše
 , 0, 
»suÉ
->
w
*(scanline[0]));

3323 
	`STBTT_mem£t
(
sÿÆše2
, 0, (
»suÉ
->
w
+1)*(
sÿÆše
[0]));

3327 *
¡•
) {

3328 
¡b‰__aùive_edge
 * 
z
 = *
¡•
;

3329 ià(
z
->
ey
 <ğ
sÿn_y_tİ
) {

3330 *
¡•
 = 
z
->
Ãxt
;

3331 
	`STBTT_as£¹
(
z
->
dœeùiÚ
);

3332 
z
->
dœeùiÚ
 = 0;

3333 
	`¡b‰__hh—p_ä“
(&
hh
, 
z
);

3335 
¡•
 = &((*¡•)->
Ãxt
);

3340 
e
->
y0
 <ğ
sÿn_y_bÙtom
) {

3341 ià(
e
->
y0
 !ğe->
y1
) {

3342 
¡b‰__aùive_edge
 *
z
 = 
	`¡b‰__Ãw_aùive
(&
hh
, 
e
, 
off_x
, 
sÿn_y_tİ
, 
u£rd©a
);

3343 ià(
z
 !ğ
NULL
) {

3344 ià(
j
 =ğ0 && 
off_y
 != 0) {

3345 ià(
z
->
ey
 < 
sÿn_y_tİ
) {

3347 
z
->
ey
 = 
sÿn_y_tİ
;

3350 
	`STBTT_as£¹
(
z
->
ey
 >ğ
sÿn_y_tİ
);

3352 
z
->
Ãxt
 = 
aùive
;

3353 
aùive
 = 
z
;

3356 ++
e
;

3360 ià(
aùive
)

3361 
	`¡b‰__fl_aùive_edges_Ãw
(
sÿÆše
, 
sÿÆše2
+1, 
»suÉ
->
w
, 
aùive
, 
sÿn_y_tİ
);

3364 
sum
 = 0;

3365 
i
=0; i < 
»suÉ
->
w
; ++i) {

3366 
k
;

3367 
m
;

3368 
sum
 +ğ
sÿÆše2
[
i
];

3369 
k
 = 
sÿÆše
[
i
] + 
sum
;

3370 
k
 = (è
	`STBTT_çbs
(k)*255 + 0.5f;

3371 
m
 = (è
k
;

3372 ià(
m
 > 255) m = 255;

3373 
»suÉ
->
pix–s
[
j
*»suÉ->
¡ride
 + 
i
] = (è
m
;

3377 
¡•
 = &
aùive
;

3378 *
¡•
) {

3379 
¡b‰__aùive_edge
 *
z
 = *
¡•
;

3380 
z
->
fx
 +ğz->
fdx
;

3381 
¡•
 = &((*¡•)->
Ãxt
);

3384 ++
y
;

3385 ++
j
;

3388 
	`¡b‰__hh—p_ş—nup
(&
hh
, 
u£rd©a
);

3390 ià(
sÿÆše
 !ğ
sÿÆše_d©a
)

3391 
	`STBTT_ä“
(
sÿÆše
, 
u£rd©a
);

3392 
	}
}

3397 
	#STBTT__COMPARE
(
a
,
b
è(×)->
y0
 < (b)->y0)

	)

3399 
	$¡b‰__sÜt_edges_šs_sÜt
(
¡b‰__edge
 *
p
, 
n
)

3401 
i
,
j
;

3402 
i
=1; i < 
n
; ++i) {

3403 
¡b‰__edge
 
t
 = 
p
[
i
], *
a
 = &t;

3404 
j
 = 
i
;

3405 
j
 > 0) {

3406 
¡b‰__edge
 *
b
 = &
p
[
j
-1];

3407 
c
 = 
	`STBTT__COMPARE
(
a
,
b
);

3408 ià(!
c
) ;

3409 
p
[
j
] =…[j-1];

3410 --
j
;

3412 ià(
i
 !ğ
j
)

3413 
p
[
j
] = 
t
;

3415 
	}
}

3417 
	$¡b‰__sÜt_edges_quicksÜt
(
¡b‰__edge
 *
p
, 
n
)

3420 
n
 > 12) {

3421 
¡b‰__edge
 
t
;

3422 
c01
,
c12
,
c
,
m
,
i
,
j
;

3425 
m
 = 
n
 >> 1;

3426 
c01
 = 
	`STBTT__COMPARE
(&
p
[0],&p[
m
]);

3427 
c12
 = 
	`STBTT__COMPARE
(&
p
[
m
],&p[
n
-1]);

3429 ià(
c01
 !ğ
c12
) {

3431 
z
;

3432 
c
 = 
	`STBTT__COMPARE
(&
p
[0],&p[
n
-1]);

3435 
z
 = (
c
 =ğ
c12
è? 0 : 
n
-1;

3436 
t
 = 
p
[
z
];

3437 
p
[
z
] =…[
m
];

3438 
p
[
m
] = 
t
;

3442 
t
 = 
p
[0];

3443 
p
[0] =…[
m
];

3444 
p
[
m
] = 
t
;

3447 
i
=1;

3448 
j
=
n
-1;

3452 ;;++
i
) {

3453 ià(!
	`STBTT__COMPARE
(&
p
[
i
], &p[0])) ;

3455 ;;--
j
) {

3456 ià(!
	`STBTT__COMPARE
(&
p
[0], &p[
j
])) ;

3459 ià(
i
 >ğ
j
) ;

3460 
t
 = 
p
[
i
];

3461 
p
[
i
] =…[
j
];

3462 
p
[
j
] = 
t
;

3464 ++
i
;

3465 --
j
;

3468 ià(
j
 < (
n
-
i
)) {

3469 
	`¡b‰__sÜt_edges_quicksÜt
(
p
,
j
);

3470 
p
 =…+
i
;

3471 
n
 =‚-
i
;

3473 
	`¡b‰__sÜt_edges_quicksÜt
(
p
+
i
, 
n
-i);

3474 
n
 = 
j
;

3477 
	}
}

3479 
	$¡b‰__sÜt_edges
(
¡b‰__edge
 *
p
, 
n
)

3481 
	`¡b‰__sÜt_edges_quicksÜt
(
p
, 
n
);

3482 
	`¡b‰__sÜt_edges_šs_sÜt
(
p
, 
n
);

3483 
	}
}

3487 
	mx
,
	my
;

3488 } 
	t¡b‰__pošt
;

3490 
	$¡b‰__¿¡”ize
(
¡b‰__b™m­
 *
»suÉ
, 
¡b‰__pošt
 *
±s
, *
wcouÁ
, 
wšdšgs
, 
sÿË_x
, 
sÿË_y
, 
shiá_x
, 
shiá_y
, 
off_x
, 
off_y
, 
šv”t
, *
u£rd©a
)

3492 
y_sÿË_šv
 = 
šv”t
 ? -
sÿË_y
 : scale_y;

3493 
¡b‰__edge
 *
e
;

3494 
n
,
i
,
j
,
k
,
m
;

3495 #ià
STBTT_RASTERIZER_VERSION
 == 1

3496 
vsub§m¶e
 = 
»suÉ
->
h
 < 8 ? 15 : 5;

3497 #–ià
STBTT_RASTERIZER_VERSION
 == 2

3498 
vsub§m¶e
 = 1;

3505 
n
 = 0;

3506 
i
=0; i < 
wšdšgs
; ++i)

3507 
n
 +ğ
wcouÁ
[
i
];

3509 
e
 = (
¡b‰__edge
 *è
	`STBTT_m®loc
((*eè* (
n
+1), 
u£rd©a
);

3510 ià(
e
 == 0) ;

3511 
n
 = 0;

3513 
m
=0;

3514 
i
=0; i < 
wšdšgs
; ++i) {

3515 
¡b‰__pošt
 *
p
 = 
±s
 + 
m
;

3516 
m
 +ğ
wcouÁ
[
i
];

3517 
j
 = 
wcouÁ
[
i
]-1;

3518 
k
=0; k < 
wcouÁ
[
i
]; 
j
=k++) {

3519 
a
=
k
,
b
=
j
;

3521 ià(
p
[
j
].
y
 =ğp[
k
].y)

3524 
e
[
n
].
šv”t
 = 0;

3525 ià(
šv”t
 ? 
p
[
j
].
y
 >…[
k
].y :…[j].y <…[k].y) {

3526 
e
[
n
].
šv”t
 = 1;

3527 
a
=
j
,
b
=
k
;

3529 
e
[
n
].
x0
 = 
p
[
a
].
x
 * 
sÿË_x
 + 
shiá_x
;

3530 
e
[
n
].
y0
 = (
p
[
a
].
y
 * 
y_sÿË_šv
 + 
shiá_y
è* 
vsub§m¶e
;

3531 
e
[
n
].
x1
 = 
p
[
b
].
x
 * 
sÿË_x
 + 
shiá_x
;

3532 
e
[
n
].
y1
 = (
p
[
b
].
y
 * 
y_sÿË_šv
 + 
shiá_y
è* 
vsub§m¶e
;

3533 ++
n
;

3539 
	`¡b‰__sÜt_edges
(
e
, 
n
);

3542 
	`¡b‰__¿¡”ize_sÜ‹d_edges
(
»suÉ
, 
e
, 
n
, 
vsub§m¶e
, 
off_x
, 
off_y
, 
u£rd©a
);

3544 
	`STBTT_ä“
(
e
, 
u£rd©a
);

3545 
	}
}

3547 
	$¡b‰__add_pošt
(
¡b‰__pošt
 *
pošts
, 
n
, 
x
, 
y
)

3549 ià(!
pošts
) ;

3550 
pošts
[
n
].
x
 = x;

3551 
pošts
[
n
].
y
 = y;

3552 
	}
}

3555 
	$¡b‰__‹s£Ï‹_curve
(
¡b‰__pošt
 *
pošts
, *
num_pošts
, 
x0
, 
y0
, 
x1
, 
y1
, 
x2
, 
y2
, 
obj¥aû_æ©Ãss_squ¬ed
, 
n
)

3558 
mx
 = (
x0
 + 2*
x1
 + 
x2
)/4;

3559 
my
 = (
y0
 + 2*
y1
 + 
y2
)/4;

3561 
dx
 = (
x0
+
x2
)/2 - 
mx
;

3562 
dy
 = (
y0
+
y2
)/2 - 
my
;

3563 ià(
n
 > 16)

3565 ià(
dx
*dx+
dy
*dy > 
obj¥aû_æ©Ãss_squ¬ed
) {

3566 
	`¡b‰__‹s£Ï‹_curve
(
pošts
, 
num_pošts
, 
x0
,
y0
, (x0+
x1
)/2.0f,(y0+
y1
)/2.0f, 
mx
,
my
, 
obj¥aû_æ©Ãss_squ¬ed
,
n
+1);

3567 
	`¡b‰__‹s£Ï‹_curve
(
pošts
, 
num_pošts
, 
mx
,
my
, (
x1
+
x2
)/2.0f,(
y1
+
y2
)/2.0f, x2,y2, 
obj¥aû_æ©Ãss_squ¬ed
,
n
+1);

3569 
	`¡b‰__add_pošt
(
pošts
, *
num_pošts
,
x2
,
y2
);

3570 *
num_pošts
 = *num_points+1;

3573 
	}
}

3575 
	$¡b‰__‹s£Ï‹_cubic
(
¡b‰__pošt
 *
pošts
, *
num_pošts
, 
x0
, 
y0
, 
x1
, 
y1
, 
x2
, 
y2
, 
x3
, 
y3
, 
obj¥aû_æ©Ãss_squ¬ed
, 
n
)

3578 
dx0
 = 
x1
-
x0
;

3579 
dy0
 = 
y1
-
y0
;

3580 
dx1
 = 
x2
-
x1
;

3581 
dy1
 = 
y2
-
y1
;

3582 
dx2
 = 
x3
-
x2
;

3583 
dy2
 = 
y3
-
y2
;

3584 
dx
 = 
x3
-
x0
;

3585 
dy
 = 
y3
-
y0
;

3586 
lÚgËn
 = (è(
	`STBTT_sq¹
(
dx0
*dx0+
dy0
*dy0)+STBTT_sq¹(
dx1
*dx1+
dy1
*dy1)+STBTT_sq¹(
dx2
*dx2+
dy2
*dy2));

3587 
shÜ’
 = (è
	`STBTT_sq¹
(
dx
*dx+
dy
*dy);

3588 
æ©Ãss_squ¬ed
 = 
lÚgËn
*lÚgËn-
shÜ’
*shortlen;

3590 ià(
n
 > 16)

3593 ià(
æ©Ãss_squ¬ed
 > 
obj¥aû_æ©Ãss_squ¬ed
) {

3594 
x01
 = (
x0
+
x1
)/2;

3595 
y01
 = (
y0
+
y1
)/2;

3596 
x12
 = (
x1
+
x2
)/2;

3597 
y12
 = (
y1
+
y2
)/2;

3598 
x23
 = (
x2
+
x3
)/2;

3599 
y23
 = (
y2
+
y3
)/2;

3601 
xa
 = (
x01
+
x12
)/2;

3602 
ya
 = (
y01
+
y12
)/2;

3603 
xb
 = (
x12
+
x23
)/2;

3604 
yb
 = (
y12
+
y23
)/2;

3606 
mx
 = (
xa
+
xb
)/2;

3607 
my
 = (
ya
+
yb
)/2;

3609 
	`¡b‰__‹s£Ï‹_cubic
(
pošts
, 
num_pošts
, 
x0
,
y0
, 
x01
,
y01
, 
xa
,
ya
, 
mx
,
my
, 
obj¥aû_æ©Ãss_squ¬ed
,
n
+1);

3610 
	`¡b‰__‹s£Ï‹_cubic
(
pošts
, 
num_pošts
, 
mx
,
my
, 
xb
,
yb
, 
x23
,
y23
, 
x3
,
y3
, 
obj¥aû_æ©Ãss_squ¬ed
,
n
+1);

3612 
	`¡b‰__add_pošt
(
pošts
, *
num_pošts
,
x3
,
y3
);

3613 *
num_pošts
 = *num_points+1;

3615 
	}
}

3618 
¡b‰__pošt
 *
	$¡b‰_FÏ‰’Curves
(
¡b‰_v”‹x
 *
v”tiûs
, 
num_v”ts
, 
obj¥aû_æ©Ãss
, **
cÚtour_Ëngths
, *
num_cÚtours
, *
u£rd©a
)

3620 
¡b‰__pošt
 *
pošts
=0;

3621 
num_pošts
=0;

3623 
obj¥aû_æ©Ãss_squ¬ed
 = 
obj¥aû_æ©Ãss
 * objspace_flatness;

3624 
i
,
n
=0,
¡¬t
=0, 
·ss
;

3627 
i
=0; i < 
num_v”ts
; ++i)

3628 ià(
v”tiûs
[
i
].
ty³
 =ğ
STBTT_vmove
)

3629 ++
n
;

3631 *
num_cÚtours
 = 
n
;

3632 ià(
n
 == 0)  0;

3634 *
cÚtour_Ëngths
 = (*è
	`STBTT_m®loc
((**cÚtour_Ëngthsè* 
n
, 
u£rd©a
);

3636 ià(*
cÚtour_Ëngths
 == 0) {

3637 *
num_cÚtours
 = 0;

3642 
·ss
=0;…ass < 2; ++pass) {

3643 
x
=0,
y
=0;

3644 ià(
·ss
 == 1) {

3645 
pošts
 = (
¡b‰__pošt
 *è
	`STBTT_m®loc
(
num_pošts
 * Õošts[0]), 
u£rd©a
);

3646 ià(
pošts
 =ğ
NULL
è
”rÜ
;

3648 
num_pošts
 = 0;

3649 
n
= -1;

3650 
i
=0; i < 
num_v”ts
; ++i) {

3651 
v”tiûs
[
i
].
ty³
) {

3652 
STBTT_vmove
:

3654 ià(
n
 >= 0)

3655 (*
cÚtour_Ëngths
)[
n
] = 
num_pošts
 - 
¡¬t
;

3656 ++
n
;

3657 
¡¬t
 = 
num_pošts
;

3659 
x
 = 
v”tiûs
[
i
].x, 
y
 = vertices[i].y;

3660 
	`¡b‰__add_pošt
(
pošts
, 
num_pošts
++, 
x
,
y
);

3662 
STBTT_vlše
:

3663 
x
 = 
v”tiûs
[
i
].x, 
y
 = vertices[i].y;

3664 
	`¡b‰__add_pošt
(
pošts
, 
num_pošts
++, 
x
, 
y
);

3666 
STBTT_vcurve
:

3667 
	`¡b‰__‹s£Ï‹_curve
(
pošts
, &
num_pošts
, 
x
,
y
,

3668 
v”tiûs
[
i
].
cx
, v”tiûs[i].
cy
,

3669 
v”tiûs
[
i
].
x
, v”tiûs[i].
y
,

3670 
obj¥aû_æ©Ãss_squ¬ed
, 0);

3671 
x
 = 
v”tiûs
[
i
].x, 
y
 = vertices[i].y;

3673 
STBTT_vcubic
:

3674 
	`¡b‰__‹s£Ï‹_cubic
(
pošts
, &
num_pošts
, 
x
,
y
,

3675 
v”tiûs
[
i
].
cx
, v”tiûs[i].
cy
,

3676 
v”tiûs
[
i
].
cx1
, v”tiûs[i].
cy1
,

3677 
v”tiûs
[
i
].
x
, v”tiûs[i].
y
,

3678 
obj¥aû_æ©Ãss_squ¬ed
, 0);

3679 
x
 = 
v”tiûs
[
i
].x, 
y
 = vertices[i].y;

3683 (*
cÚtour_Ëngths
)[
n
] = 
num_pošts
 - 
¡¬t
;

3686  
pošts
;

3687 
”rÜ
:

3688 
	`STBTT_ä“
(
pošts
, 
u£rd©a
);

3689 
	`STBTT_ä“
(*
cÚtour_Ëngths
, 
u£rd©a
);

3690 *
cÚtour_Ëngths
 = 0;

3691 *
num_cÚtours
 = 0;

3692  
NULL
;

3693 
	}
}

3695 
STBTT_DEF
 
	$¡b‰_Ra¡”ize
(
¡b‰__b™m­
 *
»suÉ
, 
æ©Ãss_š_pix–s
, 
¡b‰_v”‹x
 *
v”tiûs
, 
num_v”ts
, 
sÿË_x
, 
sÿË_y
, 
shiá_x
, 
shiá_y
, 
x_off
, 
y_off
, 
šv”t
, *
u£rd©a
)

3697 
sÿË
 = 
sÿË_x
 > 
sÿË_y
 ? scale_y : scale_x;

3698 
wšdšg_couÁ
 = 0;

3699 *
wšdšg_Ëngths
 = 
NULL
;

3700 
¡b‰__pošt
 *
wšdšgs
 = 
	`¡b‰_FÏ‰’Curves
(
v”tiûs
, 
num_v”ts
, 
æ©Ãss_š_pix–s
 / 
sÿË
, &
wšdšg_Ëngths
, &
wšdšg_couÁ
, 
u£rd©a
);

3701 ià(
wšdšgs
) {

3702 
	`¡b‰__¿¡”ize
(
»suÉ
, 
wšdšgs
, 
wšdšg_Ëngths
, 
wšdšg_couÁ
, 
sÿË_x
, 
sÿË_y
, 
shiá_x
, 
shiá_y
, 
x_off
, 
y_off
, 
šv”t
, 
u£rd©a
);

3703 
	`STBTT_ä“
(
wšdšg_Ëngths
, 
u£rd©a
);

3704 
	`STBTT_ä“
(
wšdšgs
, 
u£rd©a
);

3706 
	}
}

3708 
STBTT_DEF
 
	$¡b‰_F»eB™m­
(*
b™m­
, *
u£rd©a
)

3710 
	`STBTT_ä“
(
b™m­
, 
u£rd©a
);

3711 
	}
}

3713 
STBTT_DEF
 *
	$¡b‰_G‘GlyphB™m­Subpix–
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
sÿË_x
, 
sÿË_y
, 
shiá_x
, 
shiá_y
, 
glyph
, *
width
, *
height
, *
xoff
, *
yoff
)

3715 
ix0
,
iy0
,
ix1
,
iy1
;

3716 
¡b‰__b™m­
 
gbm
;

3717 
¡b‰_v”‹x
 *
v”tiûs
;

3718 
num_v”ts
 = 
	`¡b‰_G‘GlyphSh­e
(
šfo
, 
glyph
, &
v”tiûs
);

3720 ià(
sÿË_x
 =ğ0èsÿË_x = 
sÿË_y
;

3721 ià(
sÿË_y
 == 0) {

3722 ià(
sÿË_x
 == 0) {

3723 
	`STBTT_ä“
(
v”tiûs
, 
šfo
->
u£rd©a
);

3724  
NULL
;

3726 
sÿË_y
 = 
sÿË_x
;

3729 
	`¡b‰_G‘GlyphB™m­BoxSubpix–
(
šfo
, 
glyph
, 
sÿË_x
, 
sÿË_y
, 
shiá_x
, 
shiá_y
, &
ix0
,&
iy0
,&
ix1
,&
iy1
);

3732 
gbm
.
w
 = (
ix1
 - 
ix0
);

3733 
gbm
.
h
 = (
iy1
 - 
iy0
);

3734 
gbm
.
pix–s
 = 
NULL
;

3736 ià(
width
 ) *width = 
gbm
.
w
;

3737 ià(
height
è*heighˆğ
gbm
.
h
;

3738 ià(
xoff
 ) *xofàğ
ix0
;

3739 ià(
yoff
 ) *yofàğ
iy0
;

3741 ià(
gbm
.
w
 && gbm.
h
) {

3742 
gbm
.
pix–s
 = (*è
	`STBTT_m®loc
(gbm.
w
 * gbm.
h
, 
šfo
->
u£rd©a
);

3743 ià(
gbm
.
pix–s
) {

3744 
gbm
.
¡ride
 = gbm.
w
;

3746 
	`¡b‰_Ra¡”ize
(&
gbm
, 0.35f, 
v”tiûs
, 
num_v”ts
, 
sÿË_x
, 
sÿË_y
, 
shiá_x
, 
shiá_y
, 
ix0
, 
iy0
, 1, 
šfo
->
u£rd©a
);

3749 
	`STBTT_ä“
(
v”tiûs
, 
šfo
->
u£rd©a
);

3750  
gbm
.
pix–s
;

3751 
	}
}

3753 
STBTT_DEF
 *
	$¡b‰_G‘GlyphB™m­
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
sÿË_x
, 
sÿË_y
, 
glyph
, *
width
, *
height
, *
xoff
, *
yoff
)

3755  
	`¡b‰_G‘GlyphB™m­Subpix–
(
šfo
, 
sÿË_x
, 
sÿË_y
, 0.0f, 0.0f, 
glyph
, 
width
, 
height
, 
xoff
, 
yoff
);

3756 
	}
}

3758 
STBTT_DEF
 
	$¡b‰_MakeGlyphB™m­Subpix–
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, *
ouut
, 
out_w
, 
out_h
, 
out_¡ride
, 
sÿË_x
, 
sÿË_y
, 
shiá_x
, 
shiá_y
, 
glyph
)

3760 
ix0
,
iy0
;

3761 
¡b‰_v”‹x
 *
v”tiûs
;

3762 
num_v”ts
 = 
	`¡b‰_G‘GlyphSh­e
(
šfo
, 
glyph
, &
v”tiûs
);

3763 
¡b‰__b™m­
 
gbm
;

3765 
	`¡b‰_G‘GlyphB™m­BoxSubpix–
(
šfo
, 
glyph
, 
sÿË_x
, 
sÿË_y
, 
shiá_x
, 
shiá_y
, &
ix0
,&
iy0
,0,0);

3766 
gbm
.
pix–s
 = 
ouut
;

3767 
gbm
.
w
 = 
out_w
;

3768 
gbm
.
h
 = 
out_h
;

3769 
gbm
.
¡ride
 = 
out_¡ride
;

3771 ià(
gbm
.
w
 && gbm.
h
)

3772 
	`¡b‰_Ra¡”ize
(&
gbm
, 0.35f, 
v”tiûs
, 
num_v”ts
, 
sÿË_x
, 
sÿË_y
, 
shiá_x
, 
shiá_y
, 
ix0
,
iy0
, 1, 
šfo
->
u£rd©a
);

3774 
	`STBTT_ä“
(
v”tiûs
, 
šfo
->
u£rd©a
);

3775 
	}
}

3777 
STBTT_DEF
 
	$¡b‰_MakeGlyphB™m­
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, *
ouut
, 
out_w
, 
out_h
, 
out_¡ride
, 
sÿË_x
, 
sÿË_y
, 
glyph
)

3779 
	`¡b‰_MakeGlyphB™m­Subpix–
(
šfo
, 
ouut
, 
out_w
, 
out_h
, 
out_¡ride
, 
sÿË_x
, 
sÿË_y
, 0.0f,0.0f, 
glyph
);

3780 
	}
}

3782 
STBTT_DEF
 *
	$¡b‰_G‘Cod•oštB™m­Subpix–
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
sÿË_x
, 
sÿË_y
, 
shiá_x
, 
shiá_y
, 
cod•ošt
, *
width
, *
height
, *
xoff
, *
yoff
)

3784  
	`¡b‰_G‘GlyphB™m­Subpix–
(
šfo
, 
sÿË_x
, 
sÿË_y
,
shiá_x
,
shiá_y
, 
	`¡b‰_FšdGlyphIndex
(šfo,
cod•ošt
), 
width
,
height
,
xoff
,
yoff
);

3785 
	}
}

3787 
STBTT_DEF
 
	$¡b‰_MakeCod•oštB™m­Subpix–P»f‹r
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, *
ouut
, 
out_w
, 
out_h
, 
out_¡ride
, 
sÿË_x
, 
sÿË_y
, 
shiá_x
, 
shiá_y
, 
ov”§m¶e_x
, 
ov”§m¶e_y
, *
sub_x
, *
sub_y
, 
cod•ošt
)

3789 
	`¡b‰_MakeGlyphB™m­Subpix–P»f‹r
(
šfo
, 
ouut
, 
out_w
, 
out_h
, 
out_¡ride
, 
sÿË_x
, 
sÿË_y
, 
shiá_x
, 
shiá_y
, 
ov”§m¶e_x
, 
ov”§m¶e_y
, 
sub_x
, 
sub_y
, 
	`¡b‰_FšdGlyphIndex
(šfo,
cod•ošt
));

3790 
	}
}

3792 
STBTT_DEF
 
	$¡b‰_MakeCod•oštB™m­Subpix–
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, *
ouut
, 
out_w
, 
out_h
, 
out_¡ride
, 
sÿË_x
, 
sÿË_y
, 
shiá_x
, 
shiá_y
, 
cod•ošt
)

3794 
	`¡b‰_MakeGlyphB™m­Subpix–
(
šfo
, 
ouut
, 
out_w
, 
out_h
, 
out_¡ride
, 
sÿË_x
, 
sÿË_y
, 
shiá_x
, 
shiá_y
, 
	`¡b‰_FšdGlyphIndex
(šfo,
cod•ošt
));

3795 
	}
}

3797 
STBTT_DEF
 *
	$¡b‰_G‘Cod•oštB™m­
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
sÿË_x
, 
sÿË_y
, 
cod•ošt
, *
width
, *
height
, *
xoff
, *
yoff
)

3799  
	`¡b‰_G‘Cod•oštB™m­Subpix–
(
šfo
, 
sÿË_x
, 
sÿË_y
, 0.0f,0.0f, 
cod•ošt
, 
width
,
height
,
xoff
,
yoff
);

3800 
	}
}

3802 
STBTT_DEF
 
	$¡b‰_MakeCod•oštB™m­
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, *
ouut
, 
out_w
, 
out_h
, 
out_¡ride
, 
sÿË_x
, 
sÿË_y
, 
cod•ošt
)

3804 
	`¡b‰_MakeCod•oštB™m­Subpix–
(
šfo
, 
ouut
, 
out_w
, 
out_h
, 
out_¡ride
, 
sÿË_x
, 
sÿË_y
, 0.0f,0.0f, 
cod•ošt
);

3805 
	}
}

3813 
	$¡b‰_BakeFÚtB™m­_š‹º®
(*
d©a
, 
off£t
,

3814 
pix–_height
,

3815 *
pix–s
, 
pw
, 
ph
,

3816 
fœ¡_ch¬
, 
num_ch¬s
,

3817 
¡b‰_bakedch¬
 *
ch¬d©a
)

3819 
sÿË
;

3820 
x
,
y
,
bÙtom_y
, 
i
;

3821 
¡b‰_fÚtšfo
 
f
;

3822 
f
.
u£rd©a
 = 
NULL
;

3823 ià(!
	`¡b‰_In™FÚt
(&
f
, 
d©a
, 
off£t
))

3825 
	`STBTT_mem£t
(
pix–s
, 0, 
pw
*
ph
);

3826 
x
=
y
=1;

3827 
bÙtom_y
 = 1;

3829 
sÿË
 = 
	`¡b‰_SÿËFÜPix–Height
(&
f
, 
pix–_height
);

3831 
i
=0; i < 
num_ch¬s
; ++i) {

3832 
advªû
, 
lsb
, 
x0
,
y0
,
x1
,
y1
,
gw
,
gh
;

3833 
g
 = 
	`¡b‰_FšdGlyphIndex
(&
f
, 
fœ¡_ch¬
 + 
i
);

3834 
	`¡b‰_G‘GlyphHM‘rics
(&
f
, 
g
, &
advªû
, &
lsb
);

3835 
	`¡b‰_G‘GlyphB™m­Box
(&
f
, 
g
, 
sÿË
,sÿË, &
x0
,&
y0
,&
x1
,&
y1
);

3836 
gw
 = 
x1
-
x0
;

3837 
gh
 = 
y1
-
y0
;

3838 ià(
x
 + 
gw
 + 1 >ğ
pw
)

3839 
y
 = 
bÙtom_y
, 
x
 = 1;

3840 ià(
y
 + 
gh
 + 1 >ğ
ph
)

3841  -
i
;

3842 
	`STBTT_as£¹
(
x
+
gw
 < 
pw
);

3843 
	`STBTT_as£¹
(
y
+
gh
 < 
ph
);

3844 
	`¡b‰_MakeGlyphB™m­
(&
f
, 
pix–s
+
x
+
y
*
pw
, 
gw
,
gh
,pw, 
sÿË
,sÿË, 
g
);

3845 
ch¬d©a
[
i
].
x0
 = (
¡b‰_št16
è
x
;

3846 
ch¬d©a
[
i
].
y0
 = (
¡b‰_št16
è
y
;

3847 
ch¬d©a
[
i
].
x1
 = (
¡b‰_št16
è(
x
 + 
gw
);

3848 
ch¬d©a
[
i
].
y1
 = (
¡b‰_št16
è(
y
 + 
gh
);

3849 
ch¬d©a
[
i
].
xadvªû
 = 
sÿË
 * 
advªû
;

3850 
ch¬d©a
[
i
].
xoff
 = (è
x0
;

3851 
ch¬d©a
[
i
].
yoff
 = (è
y0
;

3852 
x
 = x + 
gw
 + 1;

3853 ià(
y
+
gh
+1 > 
bÙtom_y
)

3854 
bÙtom_y
 = 
y
+
gh
+1;

3856  
bÙtom_y
;

3857 
	}
}

3859 
STBTT_DEF
 
	$¡b‰_G‘BakedQuad
(cÚ¡ 
¡b‰_bakedch¬
 *
ch¬d©a
, 
pw
, 
ph
, 
ch¬_šdex
, *
xpos
, *
ypos
, 
¡b‰_®igÃd_quad
 *
q
, 
İ’gl_fÌuË
)

3861 
d3d_bŸs
 = 
İ’gl_fÌuË
 ? 0 : -0.5f;

3862 
w
 = 1.0à/ 
pw
, 
h
 = 1.0à/ 
ph
;

3863 cÚ¡ 
¡b‰_bakedch¬
 *
b
 = 
ch¬d©a
 + 
ch¬_šdex
;

3864 
round_x
 = 
	`STBTT_iæoÜ
((*
xpos
 + 
b
->
xoff
) + 0.5f);

3865 
round_y
 = 
	`STBTT_iæoÜ
((*
ypos
 + 
b
->
yoff
) + 0.5f);

3867 
q
->
x0
 = 
round_x
 + 
d3d_bŸs
;

3868 
q
->
y0
 = 
round_y
 + 
d3d_bŸs
;

3869 
q
->
x1
 = 
round_x
 + 
b
->x1 - b->
x0
 + 
d3d_bŸs
;

3870 
q
->
y1
 = 
round_y
 + 
b
->y1 - b->
y0
 + 
d3d_bŸs
;

3872 
q
->
s0
 = 
b
->
x0
 * 
w
;

3873 
q
->
t0
 = 
b
->
y0
 * 
h
;

3874 
q
->
s1
 = 
b
->
x1
 * 
w
;

3875 
q
->
t1
 = 
b
->
y1
 * 
h
;

3877 *
xpos
 +ğ
b
->
xadvªû
;

3878 
	}
}

3885 #iâdeà
STB_RECT_PACK_VERSION


3887 
	t¡b½_coÜd
;

3902 
	mwidth
,
	mheight
;

3903 
	mx
,
	my
,
	mbÙtom_y
;

3904 } 
	t¡b½_cÚ‹xt
;

3908 
	mx
;

3909 } 
	t¡b½_node
;

3911 
	s¡b½_»ù


3913 
¡b½_coÜd
 
	mx
,
	my
;

3914 
	mid
,
	mw
,
	mh
,
	mwas_·cked
;

3917 
	$¡b½_š™_rg‘
(
¡b½_cÚ‹xt
 *
cÚ
, 
pw
, 
ph
, 
¡b½_node
 *
nodes
, 
num_nodes
)

3919 
cÚ
->
width
 = 
pw
;

3920 
cÚ
->
height
 = 
ph
;

3921 
cÚ
->
x
 = 0;

3922 
cÚ
->
y
 = 0;

3923 
cÚ
->
bÙtom_y
 = 0;

3924 
	`STBTT__NOTUSED
(
nodes
);

3925 
	`STBTT__NOTUSED
(
num_nodes
);

3926 
	}
}

3928 
	$¡b½_·ck_»ùs
(
¡b½_cÚ‹xt
 *
cÚ
, 
¡b½_»ù
 *
»ùs
, 
num_»ùs
)

3930 
i
;

3931 
i
=0; i < 
num_»ùs
; ++i) {

3932 ià(
cÚ
->
x
 + 
»ùs
[
i
].
w
 > cÚ->
width
) {

3933 
cÚ
->
x
 = 0;

3934 
cÚ
->
y
 = cÚ->
bÙtom_y
;

3936 ià(
cÚ
->
y
 + 
»ùs
[
i
].
h
 > cÚ->
height
)

3938 
»ùs
[
i
].
x
 = 
cÚ
->x;

3939 
»ùs
[
i
].
y
 = 
cÚ
->y;

3940 
»ùs
[
i
].
was_·cked
 = 1;

3941 
cÚ
->
x
 +ğ
»ùs
[
i
].
w
;

3942 ià(
cÚ
->
y
 + 
»ùs
[
i
].
h
 > cÚ->
bÙtom_y
)

3943 
cÚ
->
bÙtom_y
 = cÚ->
y
 + 
»ùs
[
i
].
h
;

3945  ; 
i
 < 
num_»ùs
; ++i)

3946 
»ùs
[
i
].
was_·cked
 = 0;

3947 
	}
}

3957 
STBTT_DEF
 
	$¡b‰_PackBegš
(
¡b‰_·ck_cÚ‹xt
 *
¥c
, *
pix–s
, 
pw
, 
ph
, 
¡ride_š_by‹s
, 
·ddšg
, *
®loc_cÚ‹xt
)

3959 
¡b½_cÚ‹xt
 *
cÚ‹xt
 = (¡b½_cÚ‹xˆ*è
	`STBTT_m®loc
((*cÚ‹xtè,
®loc_cÚ‹xt
);

3960 
num_nodes
 = 
pw
 - 
·ddšg
;

3961 
¡b½_node
 *
nodes
 = (¡b½_nod*è
	`STBTT_m®loc
((*node è* 
num_nodes
,
®loc_cÚ‹xt
);

3963 ià(
cÚ‹xt
 =ğ
NULL
 || 
nodes
 == NULL) {

3964 ià(
cÚ‹xt
 !ğ
NULL
è
	`STBTT_ä“
(cÚ‹xt, 
®loc_cÚ‹xt
);

3965 ià(
nodes
 !ğ
NULL
è
	`STBTT_ä“
Òode , 
®loc_cÚ‹xt
);

3969 
¥c
->
u£r_®loÿtÜ_cÚ‹xt
 = 
®loc_cÚ‹xt
;

3970 
¥c
->
width
 = 
pw
;

3971 
¥c
->
height
 = 
ph
;

3972 
¥c
->
pix–s
 =…ixels;

3973 
¥c
->
·ck_šfo
 = 
cÚ‹xt
;

3974 
¥c
->
nodes
 =‚odes;

3975 
¥c
->
·ddšg
 =…adding;

3976 
¥c
->
¡ride_š_by‹s
 = sŒide_š_by‹ !ğ0 ? sŒide_š_by‹ : 
pw
;

3977 
¥c
->
h_ov”§m¶e
 = 1;

3978 
¥c
->
v_ov”§m¶e
 = 1;

3979 
¥c
->
sk_missšg
 = 0;

3981 
	`¡b½_š™_rg‘
(
cÚ‹xt
, 
pw
-
·ddšg
, 
ph
-·ddšg, 
nodes
, 
num_nodes
);

3983 ià(
pix–s
)

3984 
	`STBTT_mem£t
(
pix–s
, 0, 
pw
*
ph
);

3987 
	}
}

3989 
STBTT_DEF
 
	$¡b‰_PackEnd
 (
¡b‰_·ck_cÚ‹xt
 *
¥c
)

3991 
	`STBTT_ä“
(
¥c
->
nodes
 , spc->
u£r_®loÿtÜ_cÚ‹xt
);

3992 
	`STBTT_ä“
(
¥c
->
·ck_šfo
, spc->
u£r_®loÿtÜ_cÚ‹xt
);

3993 
	}
}

3995 
STBTT_DEF
 
	$¡b‰_PackS‘Ov”§m¶šg
(
¡b‰_·ck_cÚ‹xt
 *
¥c
, 
h_ov”§m¶e
, 
v_ov”§m¶e
)

3997 
	`STBTT_as£¹
(
h_ov”§m¶e
 <ğ
STBTT_MAX_OVERSAMPLE
);

3998 
	`STBTT_as£¹
(
v_ov”§m¶e
 <ğ
STBTT_MAX_OVERSAMPLE
);

3999 ià(
h_ov”§m¶e
 <ğ
STBTT_MAX_OVERSAMPLE
)

4000 
¥c
->
h_ov”§m¶e
 = h_oversample;

4001 ià(
v_ov”§m¶e
 <ğ
STBTT_MAX_OVERSAMPLE
)

4002 
¥c
->
v_ov”§m¶e
 = v_oversample;

4003 
	}
}

4005 
STBTT_DEF
 
	$¡b‰_PackS‘SkMissšgCod•ošts
(
¡b‰_·ck_cÚ‹xt
 *
¥c
, 
sk
)

4007 
¥c
->
sk_missšg
 = 
sk
;

4008 
	}
}

4010 
	#STBTT__OVER_MASK
 (
STBTT_MAX_OVERSAMPLE
-1)

	)

4012 
	$¡b‰__h_´ef‹r
(*
pix–s
, 
w
, 
h
, 
¡ride_š_by‹s
, 
k”Ãl_width
)

4014 
bufãr
[
STBTT_MAX_OVERSAMPLE
];

4015 
§ã_w
 = 
w
 - 
k”Ãl_width
;

4016 
j
;

4017 
	`STBTT_mem£t
(
bufãr
, 0, 
STBTT_MAX_OVERSAMPLE
);

4018 
j
=0; j < 
h
; ++j) {

4019 
i
;

4020 
tÙ®
;

4021 
	`STBTT_mem£t
(
bufãr
, 0, 
k”Ãl_width
);

4023 
tÙ®
 = 0;

4026 
k”Ãl_width
) {

4028 
i
=0; i <ğ
§ã_w
; ++i) {

4029 
tÙ®
 +ğ
pix–s
[
i
] - 
bufãr
[˜& 
STBTT__OVER_MASK
];

4030 
bufãr
[(
i
+
k”Ãl_width
è& 
STBTT__OVER_MASK
] = 
pix–s
[i];

4031 
pix–s
[
i
] = (è(
tÙ®
 / 2);

4035 
i
=0; i <ğ
§ã_w
; ++i) {

4036 
tÙ®
 +ğ
pix–s
[
i
] - 
bufãr
[˜& 
STBTT__OVER_MASK
];

4037 
bufãr
[(
i
+
k”Ãl_width
è& 
STBTT__OVER_MASK
] = 
pix–s
[i];

4038 
pix–s
[
i
] = (è(
tÙ®
 / 3);

4042 
i
=0; i <ğ
§ã_w
; ++i) {

4043 
tÙ®
 +ğ
pix–s
[
i
] - 
bufãr
[˜& 
STBTT__OVER_MASK
];

4044 
bufãr
[(
i
+
k”Ãl_width
è& 
STBTT__OVER_MASK
] = 
pix–s
[i];

4045 
pix–s
[
i
] = (è(
tÙ®
 / 4);

4049 
i
=0; i <ğ
§ã_w
; ++i) {

4050 
tÙ®
 +ğ
pix–s
[
i
] - 
bufãr
[˜& 
STBTT__OVER_MASK
];

4051 
bufãr
[(
i
+
k”Ãl_width
è& 
STBTT__OVER_MASK
] = 
pix–s
[i];

4052 
pix–s
[
i
] = (è(
tÙ®
 / 5);

4056 
i
=0; i <ğ
§ã_w
; ++i) {

4057 
tÙ®
 +ğ
pix–s
[
i
] - 
bufãr
[˜& 
STBTT__OVER_MASK
];

4058 
bufãr
[(
i
+
k”Ãl_width
è& 
STBTT__OVER_MASK
] = 
pix–s
[i];

4059 
pix–s
[
i
] = (è(
tÙ®
 / 
k”Ãl_width
);

4064 ; 
i
 < 
w
; ++i) {

4065 
	`STBTT_as£¹
(
pix–s
[
i
] == 0);

4066 
tÙ®
 -ğ
bufãr
[
i
 & 
STBTT__OVER_MASK
];

4067 
pix–s
[
i
] = (è(
tÙ®
 / 
k”Ãl_width
);

4070 
pix–s
 +ğ
¡ride_š_by‹s
;

4072 
	}
}

4074 
	$¡b‰__v_´ef‹r
(*
pix–s
, 
w
, 
h
, 
¡ride_š_by‹s
, 
k”Ãl_width
)

4076 
bufãr
[
STBTT_MAX_OVERSAMPLE
];

4077 
§ã_h
 = 
h
 - 
k”Ãl_width
;

4078 
j
;

4079 
	`STBTT_mem£t
(
bufãr
, 0, 
STBTT_MAX_OVERSAMPLE
);

4080 
j
=0; j < 
w
; ++j) {

4081 
i
;

4082 
tÙ®
;

4083 
	`STBTT_mem£t
(
bufãr
, 0, 
k”Ãl_width
);

4085 
tÙ®
 = 0;

4088 
k”Ãl_width
) {

4090 
i
=0; i <ğ
§ã_h
; ++i) {

4091 
tÙ®
 +ğ
pix–s
[
i
*
¡ride_š_by‹s
] - 
bufãr
[˜& 
STBTT__OVER_MASK
];

4092 
bufãr
[(
i
+
k”Ãl_width
è& 
STBTT__OVER_MASK
] = 
pix–s
[i*
¡ride_š_by‹s
];

4093 
pix–s
[
i
*
¡ride_š_by‹s
] = (è(
tÙ®
 / 2);

4097 
i
=0; i <ğ
§ã_h
; ++i) {

4098 
tÙ®
 +ğ
pix–s
[
i
*
¡ride_š_by‹s
] - 
bufãr
[˜& 
STBTT__OVER_MASK
];

4099 
bufãr
[(
i
+
k”Ãl_width
è& 
STBTT__OVER_MASK
] = 
pix–s
[i*
¡ride_š_by‹s
];

4100 
pix–s
[
i
*
¡ride_š_by‹s
] = (è(
tÙ®
 / 3);

4104 
i
=0; i <ğ
§ã_h
; ++i) {

4105 
tÙ®
 +ğ
pix–s
[
i
*
¡ride_š_by‹s
] - 
bufãr
[˜& 
STBTT__OVER_MASK
];

4106 
bufãr
[(
i
+
k”Ãl_width
è& 
STBTT__OVER_MASK
] = 
pix–s
[i*
¡ride_š_by‹s
];

4107 
pix–s
[
i
*
¡ride_š_by‹s
] = (è(
tÙ®
 / 4);

4111 
i
=0; i <ğ
§ã_h
; ++i) {

4112 
tÙ®
 +ğ
pix–s
[
i
*
¡ride_š_by‹s
] - 
bufãr
[˜& 
STBTT__OVER_MASK
];

4113 
bufãr
[(
i
+
k”Ãl_width
è& 
STBTT__OVER_MASK
] = 
pix–s
[i*
¡ride_š_by‹s
];

4114 
pix–s
[
i
*
¡ride_š_by‹s
] = (è(
tÙ®
 / 5);

4118 
i
=0; i <ğ
§ã_h
; ++i) {

4119 
tÙ®
 +ğ
pix–s
[
i
*
¡ride_š_by‹s
] - 
bufãr
[˜& 
STBTT__OVER_MASK
];

4120 
bufãr
[(
i
+
k”Ãl_width
è& 
STBTT__OVER_MASK
] = 
pix–s
[i*
¡ride_š_by‹s
];

4121 
pix–s
[
i
*
¡ride_š_by‹s
] = (è(
tÙ®
 / 
k”Ãl_width
);

4126 ; 
i
 < 
h
; ++i) {

4127 
	`STBTT_as£¹
(
pix–s
[
i
*
¡ride_š_by‹s
] == 0);

4128 
tÙ®
 -ğ
bufãr
[
i
 & 
STBTT__OVER_MASK
];

4129 
pix–s
[
i
*
¡ride_š_by‹s
] = (è(
tÙ®
 / 
k”Ãl_width
);

4132 
pix–s
 += 1;

4134 
	}
}

4136 
	$¡b‰__ov”§m¶e_shiá
(
ov”§m¶e
)

4138 ià(!
ov”§m¶e
)

4145  ()-(
ov”§m¶e
 - 1) / (2.0f * ()oversample);

4146 
	}
}

4149 
STBTT_DEF
 
	$¡b‰_PackFÚtRªgesG©h”Reùs
(
¡b‰_·ck_cÚ‹xt
 *
¥c
, cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
¡b‰_·ck_¿nge
 *
¿nges
, 
num_¿nges
, 
¡b½_»ù
 *
»ùs
)

4151 
i
,
j
,
k
;

4152 
missšg_glyph_added
 = 0;

4154 
k
=0;

4155 
i
=0; i < 
num_¿nges
; ++i) {

4156 
fh
 = 
¿nges
[
i
].
fÚt_size
;

4157 
sÿË
 = 
fh
 > 0 ? 
	`¡b‰_SÿËFÜPix–Height
(
šfo
, fhè: 
	`¡b‰_SÿËFÜM­pšgEmToPix–s
(info, -fh);

4158 
¿nges
[
i
].
h_ov”§m¶e
 = (è
¥c
->h_oversample;

4159 
¿nges
[
i
].
v_ov”§m¶e
 = (è
¥c
->v_oversample;

4160 
j
=0; j < 
¿nges
[
i
].
num_ch¬s
; ++j) {

4161 
x0
,
y0
,
x1
,
y1
;

4162 
cod•ošt
 = 
¿nges
[
i
].
¬¿y_of_unicode_cod•ošts
 =ğ
NULL
 ?„ªges[i].
fœ¡_unicode_cod•ošt_š_¿nge
 + 
j
 :„anges[i].array_of_unicode_codepoints[j];

4163 
glyph
 = 
	`¡b‰_FšdGlyphIndex
(
šfo
, 
cod•ošt
);

4164 ià(
glyph
 =ğ0 && (
¥c
->
sk_missšg
 || 
missšg_glyph_added
)) {

4165 
»ùs
[
k
].
w
 =„eùs[k].
h
 = 0;

4167 
	`¡b‰_G‘GlyphB™m­BoxSubpix–
(
šfo
,
glyph
,

4168 
sÿË
 * 
¥c
->
h_ov”§m¶e
,

4169 
sÿË
 * 
¥c
->
v_ov”§m¶e
,

4171 &
x0
,&
y0
,&
x1
,&
y1
);

4172 
»ùs
[
k
].
w
 = (
¡b½_coÜd
è(
x1
-
x0
 + 
¥c
->
·ddšg
 + spc->
h_ov”§m¶e
-1);

4173 
»ùs
[
k
].
h
 = (
¡b½_coÜd
è(
y1
-
y0
 + 
¥c
->
·ddšg
 + spc->
v_ov”§m¶e
-1);

4174 ià(
glyph
 == 0)

4175 
missšg_glyph_added
 = 1;

4177 ++
k
;

4181  
k
;

4182 
	}
}

4184 
STBTT_DEF
 
	$¡b‰_MakeGlyphB™m­Subpix–P»f‹r
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, *
ouut
, 
out_w
, 
out_h
, 
out_¡ride
, 
sÿË_x
, 
sÿË_y
, 
shiá_x
, 
shiá_y
, 
´ef‹r_x
, 
´ef‹r_y
, *
sub_x
, *
sub_y
, 
glyph
)

4186 
	`¡b‰_MakeGlyphB™m­Subpix–
(
šfo
,

4187 
ouut
,

4188 
out_w
 - (
´ef‹r_x
 - 1),

4189 
out_h
 - (
´ef‹r_y
 - 1),

4190 
out_¡ride
,

4191 
sÿË_x
,

4192 
sÿË_y
,

4193 
shiá_x
,

4194 
shiá_y
,

4195 
glyph
);

4197 ià(
´ef‹r_x
 > 1)

4198 
	`¡b‰__h_´ef‹r
(
ouut
, 
out_w
, 
out_h
, 
out_¡ride
, 
´ef‹r_x
);

4200 ià(
´ef‹r_y
 > 1)

4201 
	`¡b‰__v_´ef‹r
(
ouut
, 
out_w
, 
out_h
, 
out_¡ride
, 
´ef‹r_y
);

4203 *
sub_x
 = 
	`¡b‰__ov”§m¶e_shiá
(
´ef‹r_x
);

4204 *
sub_y
 = 
	`¡b‰__ov”§m¶e_shiá
(
´ef‹r_y
);

4205 
	}
}

4208 
STBTT_DEF
 
	$¡b‰_PackFÚtRªgesR’d”IÁoReùs
(
¡b‰_·ck_cÚ‹xt
 *
¥c
, cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
¡b‰_·ck_¿nge
 *
¿nges
, 
num_¿nges
, 
¡b½_»ù
 *
»ùs
)

4210 
i
,
j
,
k
, 
missšg_glyph
 = -1, 
»tuº_v®ue
 = 1;

4213 
Şd_h_ov”
 = 
¥c
->
h_ov”§m¶e
;

4214 
Şd_v_ov”
 = 
¥c
->
v_ov”§m¶e
;

4216 
k
 = 0;

4217 
i
=0; i < 
num_¿nges
; ++i) {

4218 
fh
 = 
¿nges
[
i
].
fÚt_size
;

4219 
sÿË
 = 
fh
 > 0 ? 
	`¡b‰_SÿËFÜPix–Height
(
šfo
, fhè: 
	`¡b‰_SÿËFÜM­pšgEmToPix–s
(info, -fh);

4220 
»c_h
,
»c_v
,
sub_x
,
sub_y
;

4221 
¥c
->
h_ov”§m¶e
 = 
¿nges
[
i
].h_oversample;

4222 
¥c
->
v_ov”§m¶e
 = 
¿nges
[
i
].v_oversample;

4223 
»c_h
 = 1.0à/ 
¥c
->
h_ov”§m¶e
;

4224 
»c_v
 = 1.0à/ 
¥c
->
v_ov”§m¶e
;

4225 
sub_x
 = 
	`¡b‰__ov”§m¶e_shiá
(
¥c
->
h_ov”§m¶e
);

4226 
sub_y
 = 
	`¡b‰__ov”§m¶e_shiá
(
¥c
->
v_ov”§m¶e
);

4227 
j
=0; j < 
¿nges
[
i
].
num_ch¬s
; ++j) {

4228 
¡b½_»ù
 *
r
 = &
»ùs
[
k
];

4229 ià(
r
->
was_·cked
 &&„->
w
 !ğ0 &&„->
h
 != 0) {

4230 
¡b‰_·ckedch¬
 *
bc
 = &
¿nges
[
i
].
ch¬d©a_fÜ_¿nge
[
j
];

4231 
advªû
, 
lsb
, 
x0
,
y0
,
x1
,
y1
;

4232 
cod•ošt
 = 
¿nges
[
i
].
¬¿y_of_unicode_cod•ošts
 =ğ
NULL
 ?„ªges[i].
fœ¡_unicode_cod•ošt_š_¿nge
 + 
j
 :„anges[i].array_of_unicode_codepoints[j];

4233 
glyph
 = 
	`¡b‰_FšdGlyphIndex
(
šfo
, 
cod•ošt
);

4234 
¡b½_coÜd
 
·d
 = (¡b½_coÜdè
¥c
->
·ddšg
;

4237 
r
->
x
 +ğ
·d
;

4238 
r
->
y
 +ğ
·d
;

4239 
r
->
w
 -ğ
·d
;

4240 
r
->
h
 -ğ
·d
;

4241 
	`¡b‰_G‘GlyphHM‘rics
(
šfo
, 
glyph
, &
advªû
, &
lsb
);

4242 
	`¡b‰_G‘GlyphB™m­Box
(
šfo
, 
glyph
,

4243 
sÿË
 * 
¥c
->
h_ov”§m¶e
,

4244 
sÿË
 * 
¥c
->
v_ov”§m¶e
,

4245 &
x0
,&
y0
,&
x1
,&
y1
);

4246 
	`¡b‰_MakeGlyphB™m­Subpix–
(
šfo
,

4247 
¥c
->
pix–s
 + 
r
->
x
 +„->
y
*¥c->
¡ride_š_by‹s
,

4248 
r
->
w
 - 
¥c
->
h_ov”§m¶e
+1,

4249 
r
->
h
 - 
¥c
->
v_ov”§m¶e
+1,

4250 
¥c
->
¡ride_š_by‹s
,

4251 
sÿË
 * 
¥c
->
h_ov”§m¶e
,

4252 
sÿË
 * 
¥c
->
v_ov”§m¶e
,

4254 
glyph
);

4256 ià(
¥c
->
h_ov”§m¶e
 > 1)

4257 
	`¡b‰__h_´ef‹r
(
¥c
->
pix–s
 + 
r
->
x
 +„->
y
*¥c->
¡ride_š_by‹s
,

4258 
r
->
w
,„->
h
, 
¥c
->
¡ride_š_by‹s
,

4259 
¥c
->
h_ov”§m¶e
);

4261 ià(
¥c
->
v_ov”§m¶e
 > 1)

4262 
	`¡b‰__v_´ef‹r
(
¥c
->
pix–s
 + 
r
->
x
 +„->
y
*¥c->
¡ride_š_by‹s
,

4263 
r
->
w
,„->
h
, 
¥c
->
¡ride_š_by‹s
,

4264 
¥c
->
v_ov”§m¶e
);

4266 
bc
->
x0
 = (
¡b‰_št16
è
r
->
x
;

4267 
bc
->
y0
 = (
¡b‰_št16
è
r
->
y
;

4268 
bc
->
x1
 = (
¡b‰_št16
è(
r
->
x
 +„->
w
);

4269 
bc
->
y1
 = (
¡b‰_št16
è(
r
->
y
 +„->
h
);

4270 
bc
->
xadvªû
 = 
sÿË
 * 
advªû
;

4271 
bc
->
xoff
 = (è
x0
 * 
»c_h
 + 
sub_x
;

4272 
bc
->
yoff
 = (è
y0
 * 
»c_v
 + 
sub_y
;

4273 
bc
->
xoff2
 = (
x0
 + 
r
->
w
è* 
»c_h
 + 
sub_x
;

4274 
bc
->
yoff2
 = (
y0
 + 
r
->
h
è* 
»c_v
 + 
sub_y
;

4276 ià(
glyph
 == 0)

4277 
missšg_glyph
 = 
j
;

4278 } ià(
¥c
->
sk_missšg
) {

4279 
»tuº_v®ue
 = 0;

4280 } ià(
r
->
was_·cked
 &&„->
w
 =ğ0 &&„->
h
 =ğ0 && 
missšg_glyph
 >= 0) {

4281 
¿nges
[
i
].
ch¬d©a_fÜ_¿nge
[
j
] =„ªges[i].ch¬d©a_fÜ_¿nge[
missšg_glyph
];

4283 
»tuº_v®ue
 = 0;

4286 ++
k
;

4291 
¥c
->
h_ov”§m¶e
 = 
Şd_h_ov”
;

4292 
¥c
->
v_ov”§m¶e
 = 
Şd_v_ov”
;

4294  
»tuº_v®ue
;

4295 
	}
}

4297 
STBTT_DEF
 
	$¡b‰_PackFÚtRªgesPackReùs
(
¡b‰_·ck_cÚ‹xt
 *
¥c
, 
¡b½_»ù
 *
»ùs
, 
num_»ùs
)

4299 
	`¡b½_·ck_»ùs
((
¡b½_cÚ‹xt
 *è
¥c
->
·ck_šfo
, 
»ùs
, 
num_»ùs
);

4300 
	}
}

4302 
STBTT_DEF
 
	$¡b‰_PackFÚtRªges
(
¡b‰_·ck_cÚ‹xt
 *
¥c
, cÚ¡ *
fÚtd©a
, 
fÚt_šdex
, 
¡b‰_·ck_¿nge
 *
¿nges
, 
num_¿nges
)

4304 
¡b‰_fÚtšfo
 
šfo
;

4305 
i
,
j
,
n
, 
»tuº_v®ue
 = 1;

4307 
¡b½_»ù
 *
»ùs
;

4310 
i
=0; i < 
num_¿nges
; ++i)

4311 
j
=0; j < 
¿nges
[
i
].
num_ch¬s
; ++j)

4312 
¿nges
[
i
].
ch¬d©a_fÜ_¿nge
[
j
].
x0
 =

4313 
¿nges
[
i
].
ch¬d©a_fÜ_¿nge
[
j
].
y0
 =

4314 
¿nges
[
i
].
ch¬d©a_fÜ_¿nge
[
j
].
x1
 =

4315 
¿nges
[
i
].
ch¬d©a_fÜ_¿nge
[
j
].
y1
 = 0;

4317 
n
 = 0;

4318 
i
=0; i < 
num_¿nges
; ++i)

4319 
n
 +ğ
¿nges
[
i
].
num_ch¬s
;

4321 
»ùs
 = (
¡b½_»ù
 *è
	`STBTT_m®loc
((*»ùsè* 
n
, 
¥c
->
u£r_®loÿtÜ_cÚ‹xt
);

4322 ià(
»ùs
 =ğ
NULL
)

4325 
šfo
.
u£rd©a
 = 
¥c
->
u£r_®loÿtÜ_cÚ‹xt
;

4326 
	`¡b‰_In™FÚt
(&
šfo
, 
fÚtd©a
, 
	`¡b‰_G‘FÚtOff£tFÜIndex
(fÚtd©a,
fÚt_šdex
));

4328 
n
 = 
	`¡b‰_PackFÚtRªgesG©h”Reùs
(
¥c
, &
šfo
, 
¿nges
, 
num_¿nges
, 
»ùs
);

4330 
	`¡b‰_PackFÚtRªgesPackReùs
(
¥c
, 
»ùs
, 
n
);

4332 
»tuº_v®ue
 = 
	`¡b‰_PackFÚtRªgesR’d”IÁoReùs
(
¥c
, &
šfo
, 
¿nges
, 
num_¿nges
, 
»ùs
);

4334 
	`STBTT_ä“
(
»ùs
, 
¥c
->
u£r_®loÿtÜ_cÚ‹xt
);

4335  
»tuº_v®ue
;

4336 
	}
}

4338 
STBTT_DEF
 
	$¡b‰_PackFÚtRªge
(
¡b‰_·ck_cÚ‹xt
 *
¥c
, cÚ¡ *
fÚtd©a
, 
fÚt_šdex
, 
fÚt_size
,

4339 
fœ¡_unicode_cod•ošt_š_¿nge
, 
num_ch¬s_š_¿nge
, 
¡b‰_·ckedch¬
 *
ch¬d©a_fÜ_¿nge
)

4341 
¡b‰_·ck_¿nge
 
¿nge
;

4342 
¿nge
.
fœ¡_unicode_cod•ošt_š_¿nge
 = first_unicode_codepoint_in_range;

4343 
¿nge
.
¬¿y_of_unicode_cod•ošts
 = 
NULL
;

4344 
¿nge
.
num_ch¬s
 = 
num_ch¬s_š_¿nge
;

4345 
¿nge
.
ch¬d©a_fÜ_¿nge
 = chardata_for_range;

4346 
¿nge
.
fÚt_size
 = font_size;

4347  
	`¡b‰_PackFÚtRªges
(
¥c
, 
fÚtd©a
, 
fÚt_šdex
, &
¿nge
, 1);

4348 
	}
}

4350 
STBTT_DEF
 
	$¡b‰_G‘SÿËdFÚtVM‘rics
(cÚ¡ *
fÚtd©a
, 
šdex
, 
size
, *
asûÁ
, *
desûÁ
, *
lšeG­
)

4352 
i_asûÁ
, 
i_desûÁ
, 
i_lšeG­
;

4353 
sÿË
;

4354 
¡b‰_fÚtšfo
 
šfo
;

4355 
	`¡b‰_In™FÚt
(&
šfo
, 
fÚtd©a
, 
	`¡b‰_G‘FÚtOff£tFÜIndex
(fÚtd©a, 
šdex
));

4356 
sÿË
 = 
size
 > 0 ? 
	`¡b‰_SÿËFÜPix–Height
(&
šfo
, sizeè: 
	`¡b‰_SÿËFÜM­pšgEmToPix–s
(&info, -size);

4357 
	`¡b‰_G‘FÚtVM‘rics
(&
šfo
, &
i_asûÁ
, &
i_desûÁ
, &
i_lšeG­
);

4358 *
asûÁ
 = (è
i_asûÁ
 * 
sÿË
;

4359 *
desûÁ
 = (è
i_desûÁ
 * 
sÿË
;

4360 *
lšeG­
 = (è
i_lšeG­
 * 
sÿË
;

4361 
	}
}

4363 
STBTT_DEF
 
	$¡b‰_G‘PackedQuad
(cÚ¡ 
¡b‰_·ckedch¬
 *
ch¬d©a
, 
pw
, 
ph
, 
ch¬_šdex
, *
xpos
, *
ypos
, 
¡b‰_®igÃd_quad
 *
q
, 
®ign_to_š‹g”
)

4365 
w
 = 1.0à/ 
pw
, 
h
 = 1.0à/ 
ph
;

4366 cÚ¡ 
¡b‰_·ckedch¬
 *
b
 = 
ch¬d©a
 + 
ch¬_šdex
;

4368 ià(
®ign_to_š‹g”
) {

4369 
x
 = (è
	`STBTT_iæoÜ
((*
xpos
 + 
b
->
xoff
) + 0.5f);

4370 
y
 = (è
	`STBTT_iæoÜ
((*
ypos
 + 
b
->
yoff
) + 0.5f);

4371 
q
->
x0
 = 
x
;

4372 
q
->
y0
 = 
y
;

4373 
q
->
x1
 = 
x
 + 
b
->
xoff2
 - b->
xoff
;

4374 
q
->
y1
 = 
y
 + 
b
->
yoff2
 - b->
yoff
;

4376 
q
->
x0
 = *
xpos
 + 
b
->
xoff
;

4377 
q
->
y0
 = *
ypos
 + 
b
->
yoff
;

4378 
q
->
x1
 = *
xpos
 + 
b
->
xoff2
;

4379 
q
->
y1
 = *
ypos
 + 
b
->
yoff2
;

4382 
q
->
s0
 = 
b
->
x0
 * 
w
;

4383 
q
->
t0
 = 
b
->
y0
 * 
h
;

4384 
q
->
s1
 = 
b
->
x1
 * 
w
;

4385 
q
->
t1
 = 
b
->
y1
 * 
h
;

4387 *
xpos
 +ğ
b
->
xadvªû
;

4388 
	}
}

4395 
	#STBTT_mš
(
a
,
b
è(×è< (bè? (aè: (b))

	)

4396 
	#STBTT_max
(
a
,
b
è(×è< (bè? (bè: (a))

	)

4398 
	$¡b‰__¿y_š‹r£ù_bez›r
(
Üig
[2], 
¿y
[2], 
q0
[2], 
q1
[2], 
q2
[2], 
h™s
[2][2])

4400 
q0³½
 = 
q0
[1]*
¿y
[0] - q0[0]*ray[1];

4401 
q1³½
 = 
q1
[1]*
¿y
[0] - q1[0]*ray[1];

4402 
q2³½
 = 
q2
[1]*
¿y
[0] - q2[0]*ray[1];

4403 
rİ”p
 = 
Üig
[1]*
¿y
[0] - orig[0]*ray[1];

4405 
a
 = 
q0³½
 - 2*
q1³½
 + 
q2³½
;

4406 
b
 = 
q1³½
 - 
q0³½
;

4407 
c
 = 
q0³½
 - 
rİ”p
;

4409 
s0
 = 0., 
s1
 = 0.;

4410 
num_s
 = 0;

4412 ià(
a
 != 0.0) {

4413 
disü
 = 
b
*b - 
a
*
c
;

4414 ià(
disü
 > 0.0) {

4415 
rıÇ
 = -1 / 
a
;

4416 
d
 = (è
	`STBTT_sq¹
(
disü
);

4417 
s0
 = (
b
+
d
è* 
rıÇ
;

4418 
s1
 = (
b
-
d
è* 
rıÇ
;

4419 ià(
s0
 >= 0.0 && s0 <= 1.0)

4420 
num_s
 = 1;

4421 ià(
d
 > 0.0 && 
s1
 >= 0.0 && s1 <= 1.0) {

4422 ià(
num_s
 =ğ0è
s0
 = 
s1
;

4423 ++
num_s
;

4429 
s0
 = 
c
 / (-2 * 
b
);

4430 ià(
s0
 >= 0.0 && s0 <= 1.0)

4431 
num_s
 = 1;

4434 ià(
num_s
 == 0)

4437 
rı_Ën2
 = 1 / (
¿y
[0]*ray[0] +„ay[1]*ray[1]);

4438 
¿yn_x
 = 
¿y
[0] * 
rı_Ën2
, 
¿yn_y
 =„ay[1] *„cp_len2;

4440 
q0d
 = 
q0
[0]*
¿yn_x
 + q0[1]*
¿yn_y
;

4441 
q1d
 = 
q1
[0]*
¿yn_x
 + q1[1]*
¿yn_y
;

4442 
q2d
 = 
q2
[0]*
¿yn_x
 + q2[1]*
¿yn_y
;

4443 
rod
 = 
Üig
[0]*
¿yn_x
 + orig[1]*
¿yn_y
;

4445 
q10d
 = 
q1d
 - 
q0d
;

4446 
q20d
 = 
q2d
 - 
q0d
;

4447 
q0rd
 = 
q0d
 - 
rod
;

4449 
h™s
[0][0] = 
q0rd
 + 
s0
*(2.0à- 2.0f*s0)*
q10d
 + s0*s0*
q20d
;

4450 
h™s
[0][1] = 
a
*
s0
+
b
;

4452 ià(
num_s
 > 1) {

4453 
h™s
[1][0] = 
q0rd
 + 
s1
*(2.0à- 2.0f*s1)*
q10d
 + s1*s1*
q20d
;

4454 
h™s
[1][1] = 
a
*
s1
+
b
;

4460 
	}
}

4462 
	$equ®
(*
a
, *
b
)

4464  (
a
[0] =ğ
b
[0] &&‡[1] == b[1]);

4465 
	}
}

4467 
	$¡b‰__compu‹_üossšgs_x
(
x
, 
y
, 
nv”ts
, 
¡b‰_v”‹x
 *
v”ts
)

4469 
i
;

4470 
Üig
[2], 
¿y
[2] = { 1, 0 };

4471 
y_äac
;

4472 
wšdšg
 = 0;

4475 
y_äac
 = (è
	`STBTT_fmod
(
y
, 1.0f);

4476 ià(
y_äac
 < 0.01f)

4477 
y
 += 0.01f;

4478 ià(
y_äac
 > 0.99f)

4479 
y
 -= 0.01f;

4481 
Üig
[0] = 
x
;

4482 
Üig
[1] = 
y
;

4485 
i
=0; i < 
nv”ts
; ++i) {

4486 ià(
v”ts
[
i
].
ty³
 =ğ
STBTT_vlše
) {

4487 
x0
 = (è
v”ts
[
i
-1].
x
, 
y0
 = (èv”ts[i-1].
y
;

4488 
x1
 = (è
v”ts
[
i
 ].
x
, 
y1
 = (èv”ts[˜].
y
;

4489 ià(
y
 > 
	`STBTT_mš
(
y0
,
y1
è&& y < 
	`STBTT_max
(y0,y1è&& 
x
 > STBTT_mš(
x0
,
x1
)) {

4490 
x_š‹r
 = (
y
 - 
y0
è/ (
y1
 - y0è* (
x1
-
x0
) + x0;

4491 ià(
x_š‹r
 < 
x
)

4492 
wšdšg
 +ğ(
y0
 < 
y1
) ? 1 : -1;

4495 ià(
v”ts
[
i
].
ty³
 =ğ
STBTT_vcurve
) {

4496 
x0
 = (è
v”ts
[
i
-1].
x
 , 
y0
 = (èv”ts[i-1].
y
 ;

4497 
x1
 = (è
v”ts
[
i
 ].
cx
, 
y1
 = (èv”ts[˜].
cy
;

4498 
x2
 = (è
v”ts
[
i
 ].
x
 , 
y2
 = (èv”ts[˜].
y
 ;

4499 
ax
 = 
	`STBTT_mš
(
x0
,STBTT_mš(
x1
,
x2
)), 
ay
 = STBTT_mš(
y0
,STBTT_mš(
y1
,
y2
));

4500 
by
 = 
	`STBTT_max
(
y0
,STBTT_max(
y1
,
y2
));

4501 ià(
y
 > 
ay
 && y < 
by
 && 
x
 > 
ax
) {

4502 
q0
[2],
q1
[2],
q2
[2];

4503 
h™s
[2][2];

4504 
q0
[0] = ()
x0
;

4505 
q0
[1] = ()
y0
;

4506 
q1
[0] = ()
x1
;

4507 
q1
[1] = ()
y1
;

4508 
q2
[0] = ()
x2
;

4509 
q2
[1] = ()
y2
;

4510 ià(
	`equ®
(
q0
,
q1
è||ƒqu®(q1,
q2
)) {

4511 
x0
 = ()
v”ts
[
i
-1].
x
;

4512 
y0
 = ()
v”ts
[
i
-1].
y
;

4513 
x1
 = ()
v”ts
[
i
 ].
x
;

4514 
y1
 = ()
v”ts
[
i
 ].
y
;

4515 ià(
y
 > 
	`STBTT_mš
(
y0
,
y1
è&& y < 
	`STBTT_max
(y0,y1è&& 
x
 > STBTT_mš(
x0
,
x1
)) {

4516 
x_š‹r
 = (
y
 - 
y0
è/ (
y1
 - y0è* (
x1
-
x0
) + x0;

4517 ià(
x_š‹r
 < 
x
)

4518 
wšdšg
 +ğ(
y0
 < 
y1
) ? 1 : -1;

4521 
num_h™s
 = 
	`¡b‰__¿y_š‹r£ù_bez›r
(
Üig
, 
¿y
, 
q0
, 
q1
, 
q2
, 
h™s
);

4522 ià(
num_h™s
 >= 1)

4523 ià(
h™s
[0][0] < 0)

4524 
wšdšg
 +ğ(
h™s
[0][1] < 0 ? -1 : 1);

4525 ià(
num_h™s
 >= 2)

4526 ià(
h™s
[1][0] < 0)

4527 
wšdšg
 +ğ(
h™s
[1][1] < 0 ? -1 : 1);

4532  
wšdšg
;

4533 
	}
}

4535 
	$¡b‰__cub”oÙ
Ğ
x
 )

4537 ià(
x
<0)

4538  -(è
	`STBTT_pow
(-
x
,1.0f/3.0f);

4540  (è
	`STBTT_pow
Ğ
x
,1.0f/3.0f);

4541 
	}
}

4544 
	$¡b‰__sŞve_cubic
(
a
, 
b
, 
c
, * 
r
)

4546 
s
 = -
a
 / 3;

4547 
p
 = 
b
 - 
a
*a / 3;

4548 
q
 = 
a
 * (2*a*¨- 9*
b
è/ 27 + 
c
;

4549 
p3
 = 
p
*p*p;

4550 
d
 = 
q
*q + 4*
p3
 / 27;

4551 ià(
d
 >= 0) {

4552 
z
 = (è
	`STBTT_sq¹
(
d
);

4553 
u
 = (-
q
 + 
z
) / 2;

4554 
v
 = (-
q
 - 
z
) / 2;

4555 
u
 = 
	`¡b‰__cub”oÙ
(u);

4556 
v
 = 
	`¡b‰__cub”oÙ
(v);

4557 
r
[0] = 
s
 + 
u
 + 
v
;

4560 
u
 = (è
	`STBTT_sq¹
(-
p
/3);

4561 
v
 = (è
	`STBTT_acos
(-
	`STBTT_sq¹
(-27/
p3
è* 
q
 / 2) / 3;

4562 
m
 = (è
	`STBTT_cos
(
v
);

4563 
n
 = (è
	`STBTT_cos
(
v
-3.141592/2)*1.732050808f;

4564 
r
[0] = 
s
 + 
u
 * 2 * 
m
;

4565 
r
[1] = 
s
 - 
u
 * (
m
 + 
n
);

4566 
r
[2] = 
s
 - 
u
 * (
m
 - 
n
);

4573 
	}
}

4575 
STBTT_DEF
 * 
	$¡b‰_G‘GlyphSDF
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
sÿË
, 
glyph
, 
·ddšg
, 
Úedge_v®ue
, 
pix–_di¡_sÿË
, *
width
, *
height
, *
xoff
, *
yoff
)

4577 
sÿË_x
 = 
sÿË
, 
sÿË_y
 = scale;

4578 
ix0
,
iy0
,
ix1
,
iy1
;

4579 
w
,
h
;

4580 *
d©a
;

4582 ià(
sÿË
 =ğ0è 
NULL
;

4584 
	`¡b‰_G‘GlyphB™m­BoxSubpix–
(
šfo
, 
glyph
, 
sÿË
, sÿË, 0.0f,0.0f, &
ix0
,&
iy0
,&
ix1
,&
iy1
);

4587 ià(
ix0
 =ğ
ix1
 || 
iy0
 =ğ
iy1
)

4588  
NULL
;

4590 
ix0
 -ğ
·ddšg
;

4591 
iy0
 -ğ
·ddšg
;

4592 
ix1
 +ğ
·ddšg
;

4593 
iy1
 +ğ
·ddšg
;

4595 
w
 = (
ix1
 - 
ix0
);

4596 
h
 = (
iy1
 - 
iy0
);

4598 ià(
width
 ) *width = 
w
;

4599 ià(
height
è*heighˆğ
h
;

4600 ià(
xoff
 ) *xofàğ
ix0
;

4601 ià(
yoff
 ) *yofàğ
iy0
;

4604 
sÿË_y
 = -scale_y;

4607 
x
,
y
,
i
,
j
;

4608 *
´ecompu‹
;

4609 
¡b‰_v”‹x
 *
v”ts
;

4610 
num_v”ts
 = 
	`¡b‰_G‘GlyphSh­e
(
šfo
, 
glyph
, &
v”ts
);

4611 
d©a
 = (*è
	`STBTT_m®loc
(
w
 * 
h
, 
šfo
->
u£rd©a
);

4612 
´ecompu‹
 = (*è
	`STBTT_m®loc
(
num_v”ts
 * (), 
šfo
->
u£rd©a
);

4614 
i
=0,
j
=
num_v”ts
-1; i <‚um_verts; j=i++) {

4615 ià(
v”ts
[
i
].
ty³
 =ğ
STBTT_vlše
) {

4616 
x0
 = 
v”ts
[
i
].
x
*
sÿË_x
, 
y0
 = v”ts[i].
y
*
sÿË_y
;

4617 
x1
 = 
v”ts
[
j
].
x
*
sÿË_x
, 
y1
 = v”ts[j].
y
*
sÿË_y
;

4618 
di¡
 = (è
	`STBTT_sq¹
((
x1
-
x0
)*(x1-x0è+ (
y1
-
y0
)*(y1-y0));

4619 
´ecompu‹
[
i
] = (
di¡
 == 0) ? 0.0f : 1.0f / dist;

4620 } ià(
v”ts
[
i
].
ty³
 =ğ
STBTT_vcurve
) {

4621 
x2
 = 
v”ts
[
j
].
x
 *
sÿË_x
, 
y2
 = v”ts[j].
y
 *
sÿË_y
;

4622 
x1
 = 
v”ts
[
i
].
cx
*
sÿË_x
, 
y1
 = v”ts[i].
cy
*
sÿË_y
;

4623 
x0
 = 
v”ts
[
i
].
x
 *
sÿË_x
, 
y0
 = v”ts[i].
y
 *
sÿË_y
;

4624 
bx
 = 
x0
 - 2*
x1
 + 
x2
, 
by
 = 
y0
 - 2*
y1
 + 
y2
;

4625 
Ën2
 = 
bx
*bx + 
by
*by;

4626 ià(
Ën2
 != 0.0f)

4627 
´ecompu‹
[
i
] = 1.0à/ (
bx
*bx + 
by
*by);

4629 
´ecompu‹
[
i
] = 0.0f;

4631 
´ecompu‹
[
i
] = 0.0f;

4634 
y
=
iy0
; y < 
iy1
; ++y) {

4635 
x
=
ix0
; x < 
ix1
; ++x) {

4636 
v®
;

4637 
mš_di¡
 = 999999.0f;

4638 
sx
 = (è
x
 + 0.5f;

4639 
sy
 = (è
y
 + 0.5f;

4640 
x_g¥aû
 = (
sx
 / 
sÿË_x
);

4641 
y_g¥aû
 = (
sy
 / 
sÿË_y
);

4643 
wšdšg
 = 
	`¡b‰__compu‹_üossšgs_x
(
x_g¥aû
, 
y_g¥aû
, 
num_v”ts
, 
v”ts
);

4645 
i
=0; i < 
num_v”ts
; ++i) {

4646 
x0
 = 
v”ts
[
i
].
x
*
sÿË_x
, 
y0
 = v”ts[i].
y
*
sÿË_y
;

4648 ià(
v”ts
[
i
].
ty³
 =ğ
STBTT_vlše
 && 
´ecompu‹
[i] != 0.0f) {

4649 
x1
 = 
v”ts
[
i
-1].
x
*
sÿË_x
, 
y1
 = v”ts[i-1].
y
*
sÿË_y
;

4651 
di¡
,
di¡2
 = (
x0
-
sx
)*(x0-sxè+ (
y0
-
sy
)*(y0-sy);

4652 ià(
di¡2
 < 
mš_di¡
*min_dist)

4653 
mš_di¡
 = (è
	`STBTT_sq¹
(
di¡2
);

4658 
di¡
 = (è
	`STBTT_çbs
((
x1
-
x0
)*(
y0
-
sy
è- (
y1
-y0)*(x0-
sx
)è* 
´ecompu‹
[
i
];

4659 
	`STBTT_as£¹
(
i
 != 0);

4660 ià(
di¡
 < 
mš_di¡
) {

4664 
dx
 = 
x1
-
x0
, 
dy
 = 
y1
-
y0
;

4665 
px
 = 
x0
-
sx
, 
py
 = 
y0
-
sy
;

4668 
t
 = -(
px
*
dx
 + 
py
*
dy
) / (dx*dx + dy*dy);

4669 ià(
t
 >= 0.0f && <= 1.0f)

4670 
mš_di¡
 = 
di¡
;

4672 } ià(
v”ts
[
i
].
ty³
 =ğ
STBTT_vcurve
) {

4673 
x2
 = 
v”ts
[
i
-1].
x
 *
sÿË_x
, 
y2
 = v”ts[i-1].
y
 *
sÿË_y
;

4674 
x1
 = 
v”ts
[
i
 ].
cx
*
sÿË_x
, 
y1
 = v”ts[˜].
cy
*
sÿË_y
;

4675 
box_x0
 = 
	`STBTT_mš
(STBTT_mš(
x0
,
x1
),
x2
);

4676 
box_y0
 = 
	`STBTT_mš
(STBTT_mš(
y0
,
y1
),
y2
);

4677 
box_x1
 = 
	`STBTT_max
(STBTT_max(
x0
,
x1
),
x2
);

4678 
box_y1
 = 
	`STBTT_max
(STBTT_max(
y0
,
y1
),
y2
);

4680 ià(
sx
 > 
box_x0
-
mš_di¡
 && sx < 
box_x1
+mš_di¡ && 
sy
 > 
box_y0
-mš_di¡ && sy < 
box_y1
+min_dist) {

4681 
num
=0;

4682 
ax
 = 
x1
-
x0
, 
ay
 = 
y1
-
y0
;

4683 
bx
 = 
x0
 - 2*
x1
 + 
x2
, 
by
 = 
y0
 - 2*
y1
 + 
y2
;

4684 
mx
 = 
x0
 - 
sx
, 
my
 = 
y0
 - 
sy
;

4685 
»s
[3] = {0.f,0.f,0.f};

4686 
px
,
py
,
t
,
™
,
di¡2
;

4687 
a_šv
 = 
´ecompu‹
[
i
];

4688 ià(
a_šv
 == 0.0) {

4689 
a
 = 3*(
ax
*
bx
 + 
ay
*
by
);

4690 
b
 = 2*(
ax
*ax + 
ay
*ayè+ (
mx
*
bx
+
my
*
by
);

4691 
c
 = 
mx
*
ax
+
my
*
ay
;

4692 ià(
a
 == 0.0) {

4693 ià(
b
 != 0.0) {

4694 
»s
[
num
++] = -
c
/
b
;

4697 
disüimšªt
 = 
b
*b - 4*
a
*
c
;

4698 ià(
disüimšªt
 < 0)

4699 
num
 = 0;

4701 
roÙ
 = (è
	`STBTT_sq¹
(
disüimšªt
);

4702 
»s
[0] = (-
b
 - 
roÙ
)/(2*
a
);

4703 
»s
[1] = (-
b
 + 
roÙ
)/(2*
a
);

4704 
num
 = 2;

4708 
b
 = 3*(
ax
*
bx
 + 
ay
*
by
è* 
a_šv
;

4709 
c
 = (2*(
ax
*ax + 
ay
*ayè+ (
mx
*
bx
+
my
*
by
)è* 
a_šv
;

4710 
d
 = (
mx
*
ax
+
my
*
ay
è* 
a_šv
;

4711 
num
 = 
	`¡b‰__sŞve_cubic
(
b
, 
c
, 
d
, 
»s
);

4713 
di¡2
 = (
x0
-
sx
)*(x0-sxè+ (
y0
-
sy
)*(y0-sy);

4714 ià(
di¡2
 < 
mš_di¡
*min_dist)

4715 
mš_di¡
 = (è
	`STBTT_sq¹
(
di¡2
);

4717 ià(
num
 >ğ1 && 
»s
[0] >= 0.0f &&„es[0] <= 1.0f) {

4718 
t
 = 
»s
[0], 
™
 = 1.0f -;

4719 
px
 = 
™
*™*
x0
 + 2*
t
*™*
x1
 +*t*
x2
;

4720 
py
 = 
™
*™*
y0
 + 2*
t
*™*
y1
 +*t*
y2
;

4721 
di¡2
 = (
px
-
sx
)*Õx-sxè+ (
py
-
sy
)*(py-sy);

4722 ià(
di¡2
 < 
mš_di¡
 * min_dist)

4723 
mš_di¡
 = (è
	`STBTT_sq¹
(
di¡2
);

4725 ià(
num
 >ğ2 && 
»s
[1] >= 0.0f &&„es[1] <= 1.0f) {

4726 
t
 = 
»s
[1], 
™
 = 1.0f -;

4727 
px
 = 
™
*™*
x0
 + 2*
t
*™*
x1
 +*t*
x2
;

4728 
py
 = 
™
*™*
y0
 + 2*
t
*™*
y1
 +*t*
y2
;

4729 
di¡2
 = (
px
-
sx
)*Õx-sxè+ (
py
-
sy
)*(py-sy);

4730 ià(
di¡2
 < 
mš_di¡
 * min_dist)

4731 
mš_di¡
 = (è
	`STBTT_sq¹
(
di¡2
);

4733 ià(
num
 >ğ3 && 
»s
[2] >= 0.0f &&„es[2] <= 1.0f) {

4734 
t
 = 
»s
[2], 
™
 = 1.0f -;

4735 
px
 = 
™
*™*
x0
 + 2*
t
*™*
x1
 +*t*
x2
;

4736 
py
 = 
™
*™*
y0
 + 2*
t
*™*
y1
 +*t*
y2
;

4737 
di¡2
 = (
px
-
sx
)*Õx-sxè+ (
py
-
sy
)*(py-sy);

4738 ià(
di¡2
 < 
mš_di¡
 * min_dist)

4739 
mš_di¡
 = (è
	`STBTT_sq¹
(
di¡2
);

4744 ià(
wšdšg
 == 0)

4745 
mš_di¡
 = -min_dist;

4746 
v®
 = 
Úedge_v®ue
 + 
pix–_di¡_sÿË
 * 
mš_di¡
;

4747 ià(
v®
 < 0)

4748 
v®
 = 0;

4749 ià(
v®
 > 255)

4750 
v®
 = 255;

4751 
d©a
[(
y
-
iy0
)*
w
+(
x
-
ix0
)] = (è
v®
;

4754 
	`STBTT_ä“
(
´ecompu‹
, 
šfo
->
u£rd©a
);

4755 
	`STBTT_ä“
(
v”ts
, 
šfo
->
u£rd©a
);

4757  
d©a
;

4758 
	}
}

4760 
STBTT_DEF
 * 
	$¡b‰_G‘Cod•oštSDF
(cÚ¡ 
¡b‰_fÚtšfo
 *
šfo
, 
sÿË
, 
cod•ošt
, 
·ddšg
, 
Úedge_v®ue
, 
pix–_di¡_sÿË
, *
width
, *
height
, *
xoff
, *
yoff
)

4762  
	`¡b‰_G‘GlyphSDF
(
šfo
, 
sÿË
, 
	`¡b‰_FšdGlyphIndex
(šfo, 
cod•ošt
), 
·ddšg
, 
Úedge_v®ue
, 
pix–_di¡_sÿË
, 
width
, 
height
, 
xoff
, 
yoff
);

4763 
	}
}

4765 
STBTT_DEF
 
	$¡b‰_F»eSDF
(*
b™m­
, *
u£rd©a
)

4767 
	`STBTT_ä“
(
b™m­
, 
u£rd©a
);

4768 
	}
}

4776 
¡b‰_št32
 
	$¡b‰__Com·»UTF8toUTF16_big’dŸn_´efix
(
¡b‰_ušt8
 *
s1
, 
¡b‰_št32
 
Ën1
, stb‰_ušt8 *
s2
, stb‰_št32 
Ën2
)

4778 
¡b‰_št32
 
i
=0;

4781 
Ën2
) {

4782 
¡b‰_ušt16
 
ch
 = 
s2
[0]*256 + s2[1];

4783 ià(
ch
 < 0x80) {

4784 ià(
i
 >ğ
Ën1
)  -1;

4785 ià(
s1
[
i
++] !ğ
ch
)  -1;

4786 } ià(
ch
 < 0x800) {

4787 ià(
i
+1 >ğ
Ën1
)  -1;

4788 ià(
s1
[
i
++] !ğ0xc0 + (
ch
 >> 6))  -1;

4789 ià(
s1
[
i
++] !ğ0x80 + (
ch
 & 0x3f))  -1;

4790 } ià(
ch
 >= 0xd800 && ch < 0xdc00) {

4791 
¡b‰_ušt32
 
c
;

4792 
¡b‰_ušt16
 
ch2
 = 
s2
[2]*256 + s2[3];

4793 ià(
i
+3 >ğ
Ën1
)  -1;

4794 
c
 = ((
ch
 - 0xd800è<< 10è+ (
ch2
 - 0xdc00) + 0x10000;

4795 ià(
s1
[
i
++] !ğ0xf0 + (
c
 >> 18))  -1;

4796 ià(
s1
[
i
++] !ğ0x80 + ((
c
 >> 12) & 0x3f))  -1;

4797 ià(
s1
[
i
++] !ğ0x80 + ((
c
 >> 6) & 0x3f))  -1;

4798 ià(
s1
[
i
++] !ğ0x80 + ((
c
 ) & 0x3f))  -1;

4799 
s2
 += 2;

4800 
Ën2
 -= 2;

4801 } ià(
ch
 >= 0xdc00 && ch < 0xe000) {

4804 ià(
i
+2 >ğ
Ën1
)  -1;

4805 ià(
s1
[
i
++] !ğ0xe0 + (
ch
 >> 12))  -1;

4806 ià(
s1
[
i
++] !ğ0x80 + ((
ch
 >> 6) & 0x3f))  -1;

4807 ià(
s1
[
i
++] !ğ0x80 + ((
ch
 ) & 0x3f))  -1;

4809 
s2
 += 2;

4810 
Ën2
 -= 2;

4812  
i
;

4813 
	}
}

4815 
	$¡b‰_Com·»UTF8toUTF16_big’dŸn_š‹º®
(*
s1
, 
Ën1
, *
s2
, 
Ën2
)

4817  
Ën1
 =ğ
	`¡b‰__Com·»UTF8toUTF16_big’dŸn_´efix
((
¡b‰_ušt8
*è
s1
,†’1, (¡b‰_ušt8*è
s2
, 
Ën2
);

4818 
	}
}

4822 
STBTT_DEF
 cÚ¡ *
	$¡b‰_G‘FÚtNameSŒšg
(cÚ¡ 
¡b‰_fÚtšfo
 *
fÚt
, *
Ëngth
, 
¶©fÜmID
, 
’codšgID
, 
ÏnguageID
, 
ÇmeID
)

4824 
¡b‰_št32
 
i
,
couÁ
,
¡ršgOff£t
;

4825 
¡b‰_ušt8
 *
fc
 = 
fÚt
->
d©a
;

4826 
¡b‰_ušt32
 
off£t
 = 
fÚt
->
fÚt¡¬t
;

4827 
¡b‰_ušt32
 
nm
 = 
	`¡b‰__fšd_bË
(
fc
, 
off£t
, "name");

4828 ià(!
nm
è 
NULL
;

4830 
couÁ
 = 
	`‰USHORT
(
fc
+
nm
+2);

4831 
¡ršgOff£t
 = 
nm
 + 
	`‰USHORT
(
fc
+nm+4);

4832 
i
=0; i < 
couÁ
; ++i) {

4833 
¡b‰_ušt32
 
loc
 = 
nm
 + 6 + 12 * 
i
;

4834 ià(
¶©fÜmID
 =ğ
	`‰USHORT
(
fc
+
loc
+0è&& 
’codšgID
 ==tUSHORT(fc+loc+2)

4835 && 
ÏnguageID
 =ğ
	`‰USHORT
(
fc
+
loc
+4è&& 
ÇmeID
 ==tUSHORT(fc+loc+6)) {

4836 *
Ëngth
 = 
	`‰USHORT
(
fc
+
loc
+8);

4837  (cÚ¡ *è(
fc
+
¡ršgOff£t
+
	`‰USHORT
(fc+
loc
+10));

4840  
NULL
;

4841 
	}
}

4843 
	$¡b‰__m©ch·œ
(
¡b‰_ušt8
 *
fc
, 
¡b‰_ušt32
 
nm
, stb‰_ušt8 *
Çme
, 
¡b‰_št32
 
Æ’
, stb‰_št32 
rg‘_id
, stb‰_št32 
Ãxt_id
)

4845 
¡b‰_št32
 
i
;

4846 
¡b‰_št32
 
couÁ
 = 
	`‰USHORT
(
fc
+
nm
+2);

4847 
¡b‰_št32
 
¡ršgOff£t
 = 
nm
 + 
	`‰USHORT
(
fc
+nm+4);

4849 
i
=0; i < 
couÁ
; ++i) {

4850 
¡b‰_ušt32
 
loc
 = 
nm
 + 6 + 12 * 
i
;

4851 
¡b‰_št32
 
id
 = 
	`‰USHORT
(
fc
+
loc
+6);

4852 ià(
id
 =ğ
rg‘_id
) {

4854 
¡b‰_št32
 
¶©fÜm
 = 
	`‰USHORT
(
fc
+
loc
+0), 
’codšg
 =tUSHORT(fc+loc+2), 
Ïnguage
 =tUSHORT(fc+loc+4);

4857 ià(
¶©fÜm
 =ğ0 || (¶©fÜm =ğ3 && 
’codšg
 == 1) || (platform == 3 &&ƒncoding == 10)) {

4858 
¡b‰_št32
 
¦’
 = 
	`‰USHORT
(
fc
+
loc
+8);

4859 
¡b‰_št32
 
off
 = 
	`‰USHORT
(
fc
+
loc
+10);

4862 
¡b‰_št32
 
m©chËn
 = 
	`¡b‰__Com·»UTF8toUTF16_big’dŸn_´efix
(
Çme
, 
Æ’
, 
fc
+
¡ršgOff£t
+
off
,
¦’
);

4863 ià(
m©chËn
 >= 0) {

4865 ià(
i
+1 < 
couÁ
 && 
	`‰USHORT
(
fc
+
loc
+12+6è=ğ
Ãxt_id
 &&tUSHORT(fc+loc+12è=ğ
¶©fÜm
 &&tUSHORT(fc+loc+12+2è=ğ
’codšg
 &&tUSHORT(fc+loc+12+4è=ğ
Ïnguage
) {

4866 
¦’
 = 
	`‰USHORT
(
fc
+
loc
+12+8);

4867 
off
 = 
	`‰USHORT
(
fc
+
loc
+12+10);

4868 ià(
¦’
 == 0) {

4869 ià(
m©chËn
 =ğ
Æ’
)

4871 } ià(
m©chËn
 < 
Æ’
 && 
Çme
[matchlen] == ' ') {

4872 ++
m©chËn
;

4873 ià(
	`¡b‰_Com·»UTF8toUTF16_big’dŸn_š‹º®
((*è(
Çme
+
m©chËn
), 
Æ’
-m©chËn, (*)(
fc
+
¡ršgOff£t
+
off
),
¦’
))

4878 ià(
m©chËn
 =ğ
Æ’
)

4888 
	}
}

4890 
	$¡b‰__m©ches
(
¡b‰_ušt8
 *
fc
, 
¡b‰_ušt32
 
off£t
, stb‰_ušt8 *
Çme
, 
¡b‰_št32
 
æags
)

4892 
¡b‰_št32
 
Æ’
 = (¡b‰_št32è
	`STBTT_¡¾’
((*è
Çme
);

4893 
¡b‰_ušt32
 
nm
,
hd
;

4894 ià(!
	`¡b‰__isfÚt
(
fc
+
off£t
))  0;

4897 ià(
æags
) {

4898 
hd
 = 
	`¡b‰__fšd_bË
(
fc
, 
off£t
, "head");

4899 ià((
	`‰USHORT
(
fc
+
hd
+44è& 7è!ğ(
æags
 & 7))  0;

4902 
nm
 = 
	`¡b‰__fšd_bË
(
fc
, 
off£t
, "name");

4903 ià(!
nm
)  0;

4905 ià(
æags
) {

4907 ià(
	`¡b‰__m©ch·œ
(
fc
, 
nm
, 
Çme
, 
Æ’
, 16, -1))  1;

4908 ià(
	`¡b‰__m©ch·œ
(
fc
, 
nm
, 
Çme
, 
Æ’
, 1, -1))  1;

4909 ià(
	`¡b‰__m©ch·œ
(
fc
, 
nm
, 
Çme
, 
Æ’
, 3, -1))  1;

4911 ià(
	`¡b‰__m©ch·œ
(
fc
, 
nm
, 
Çme
, 
Æ’
, 16, 17))  1;

4912 ià(
	`¡b‰__m©ch·œ
(
fc
, 
nm
, 
Çme
, 
Æ’
, 1, 2))  1;

4913 ià(
	`¡b‰__m©ch·œ
(
fc
, 
nm
, 
Çme
, 
Æ’
, 3, -1))  1;

4917 
	}
}

4919 
	$¡b‰_FšdM©chšgFÚt_š‹º®
(*
fÚt_cŞËùiÚ
, *
Çme_utf8
, 
¡b‰_št32
 
æags
)

4921 
¡b‰_št32
 
i
;

4922 
i
=0;;++i) {

4923 
¡b‰_št32
 
off
 = 
	`¡b‰_G‘FÚtOff£tFÜIndex
(
fÚt_cŞËùiÚ
, 
i
);

4924 ià(
off
 < 0)  off;

4925 ià(
	`¡b‰__m©ches
((
¡b‰_ušt8
 *è
fÚt_cŞËùiÚ
, 
off
, (¡b‰_ušt8*è
Çme_utf8
, 
æags
))

4926  
off
;

4928 
	}
}

4930 #ià
defšed
(
__GNUC__
è|| defšed(
__şªg__
)

4931 #´agm¨
GCC
 
dŸgno¡ic
 
push


4932 #´agm¨
GCC
 
dŸgno¡ic
 
ignÜed
 "-Wcast-qual"

4935 
STBTT_DEF
 
	$¡b‰_BakeFÚtB™m­
(cÚ¡ *
d©a
, 
off£t
,

4936 
pix–_height
, *
pix–s
, 
pw
, 
ph
,

4937 
fœ¡_ch¬
, 
num_ch¬s
, 
¡b‰_bakedch¬
 *
ch¬d©a
)

4939  
	`¡b‰_BakeFÚtB™m­_š‹º®
((*è
d©a
, 
off£t
, 
pix–_height
, 
pix–s
, 
pw
, 
ph
, 
fœ¡_ch¬
, 
num_ch¬s
, 
ch¬d©a
);

4940 
	}
}

4942 
STBTT_DEF
 
	$¡b‰_G‘FÚtOff£tFÜIndex
(cÚ¡ *
d©a
, 
šdex
)

4944  
	`¡b‰_G‘FÚtOff£tFÜIndex_š‹º®
((*è
d©a
, 
šdex
);

4945 
	}
}

4947 
STBTT_DEF
 
	$¡b‰_G‘Numb”OfFÚts
(cÚ¡ *
d©a
)

4949  
	`¡b‰_G‘Numb”OfFÚts_š‹º®
((*è
d©a
);

4950 
	}
}

4952 
STBTT_DEF
 
	$¡b‰_In™FÚt
(
¡b‰_fÚtšfo
 *
šfo
, cÚ¡ *
d©a
, 
off£t
)

4954  
	`¡b‰_In™FÚt_š‹º®
(
šfo
, (*è
d©a
, 
off£t
);

4955 
	}
}

4957 
STBTT_DEF
 
	$¡b‰_FšdM©chšgFÚt
(cÚ¡ *
fÚtd©a
, cÚ¡ *
Çme
, 
æags
)

4959  
	`¡b‰_FšdM©chšgFÚt_š‹º®
((*è
fÚtd©a
, (*è
Çme
, 
æags
);

4960 
	}
}

4962 
STBTT_DEF
 
	$¡b‰_Com·»UTF8toUTF16_big’dŸn
(cÚ¡ *
s1
, 
Ën1
, cÚ¡ *
s2
, 
Ën2
)

4964  
	`¡b‰_Com·»UTF8toUTF16_big’dŸn_š‹º®
((*è
s1
, 
Ën1
, (*è
s2
, 
Ën2
);

4965 
	}
}

4967 #ià
defšed
(
__GNUC__
è|| defšed(
__şªg__
)

4968 #´agm¨
GCC
 
dŸgno¡ic
 
pİ


	@rasterize_font_and_dump_bitmap/src/main.cpp

1 
	#STB_RECT_PACK_IMPLEMENTATION


	)

2 
	~"¡b_»ù_·ck.h
"

3 
	#STB_TRUETYPE_IMPLEMENTATION


	)

4 
	~"¡b_Œu‘y³.h
"

5 
	#STB_IMAGE_WRITE_IMPLEMENTATION


	)

6 
	~"¡b_image_wr™e.h
"

8 
	~<¡dio.h
>

9 
	g‰f_bufãr
[1 << 25];

12 
	#FONT_CHARS_TOTAL
 0x7E - 0x20

	)

16 
	sFÚtInfo
 {

17 
	mheight_of_ch¬_š_b™m­
;

18 
	mb™m­_w
, 
	mb™m­_h
;

19 
	masûÁ
, 
	mdesûÁ
, 
	mlše_g­
, 
	mba£lše
;

20 
¡b‰_·ckedch¬
 
	m·cked_ch¬s
[
FONT_CHARS_TOTAL
];

24 
	$maš
(
¬gc
, ** 
¬gv
) {

25 
	`ä—d
(
‰f_bufãr
, 1, 1<<25, 
	`fİ’
("../../../assets/fonts/JetBrainsMono/JetBrainsMono-Light.ttf", "rb"));

26 
¡b‰_fÚtšfo
 
šfo
;

27 
	`as£¹
(
	`¡b‰_In™FÚt
(&
šfo
, 
‰f_bufãr
, 
	`¡b‰_G‘FÚtOff£tFÜIndex
(ttf_buffer, 0)));

29 
¡b‰_·ck_cÚ‹xt
 
pc
;

31 
	#BITMAP_H
 1000

	)

32 
	#BITMAP_W
 1000

	)

34 
b™m­_w
, 
b™m­_h
;

35 
b™m­_h
 = 
BITMAP_H
;

36 
b™m­_w
 = 
BITMAP_W
;

37 
fÚt_height
 = 100.0f;

38 
©Ïs
[
BITMAP_W
 * 
BITMAP_H
];

40 
asûÁ
, 
desûÁ
, 
lše_g­
, 
ba£lše
;

41 
sÿË_çùÜ
 = 
	`¡b‰_SÿËFÜPix–Height
(&
šfo
, 
fÚt_height
);

42 
	`¡b‰_G‘FÚtVM‘rics
(&
šfo
, &
asûÁ
, &
desûÁ
, &
lše_g­
);

43 
asûÁ
 = (asûÁ * 
sÿË_çùÜ
);

44 
desûÁ
 = (desûÁ * 
sÿË_çùÜ
);

45 
lše_g­
 = (line_gap *†ine_gap);

46 
ba£lše
 = (
asûÁ
*
sÿË_çùÜ
);

48 
FÚtInfo
* 
fÚt_šfo
 = (FÚtInfo*)
	`ÿÎoc
(1, (FontInfo));

49 
fÚt_šfo
->
height_of_ch¬_š_b™m­
 = 
fÚt_height
;

50 
fÚt_šfo
->
b™m­_w
 = bitmap_w;

51 
fÚt_šfo
->
b™m­_h
 = 
b™m­_w
;

52 
fÚt_šfo
->
asûÁ
 =‡scent;

53 
fÚt_šfo
->
desûÁ
 = descent;

54 
fÚt_šfo
->
lše_g­
 =†ine_gap;

55 
fÚt_šfo
->
ba£lše
 = baseline;

57 
	`¡b‰_PackBegš
(&
pc
, 
©Ïs
, 1000,1000,0,1,
NULL
);

58 
	`¡b‰_PackS‘Ov”§m¶šg
(&
pc
, 2, 2);

59 
	`¡b‰_PackFÚtRªge
(&
pc
, 
‰f_bufãr
, 0, 
asûÁ
 - 
desûÁ
, 0x20, 0x7E-0x20, 
fÚt_šfo
->
·cked_ch¬s
);

60 
	`¡b‰_PackEnd
(&
pc
);

62 
¡b‰_®igÃd_quad
 
aq1
 = {};

63 
¡b‰_®igÃd_quad
 
aq2
 = {};

65 
xpos
 = 200.0f;

66 
ypos
 = 200.0f;

67 
	`¡b‰_G‘PackedQuad
(
fÚt_šfo
->
·cked_ch¬s
, 1600, 900, 1, &
xpos
, &
ypos
, &
aq1
, 0);

68 
	`¡b‰_G‘PackedQuad
(
fÚt_šfo
->
·cked_ch¬s
, 1600, 900, 2, &
xpos
, &
ypos
, &
aq2
, 0);

70 
	`¡bi_wr™e_²g
("j‘b¿šs_mÚo_light.²g", 
b™m­_w
, 
b™m­_h
, 1, 
©Ïs
, 0);

72 
FILE
* 
fe
 = 
	`fİ’
("jetbrains_mono_light.fi", "w");

73 
	`fwr™e
(
fÚt_šfo
, (
FÚtInfo
), 1, 
fe
);

76 
	`fşo£
(
fe
);

79 
	}
}

	@
1
.
0
8
200
asset_packer/buffers.cpp
asset_packer/main.cpp
include/cgltf.h
include/stb_image.h
include/stb_image_write.h
include/stb_rect_pack.h
include/stb_truetype.h
rasterize_font_and_dump_bitmap/src/main.cpp
